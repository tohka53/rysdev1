import{a as Ke,b as Se,c as ze,d as Pt,e as et,f as tt,g as it,h as qt}from"./chunk-3WXYE67M.js";import{$ as je,A as D,Aa as Ye,B as n,Ba as Qe,C as r,Ca as Q,D as p,Da as J,E as fe,Ea as Z,F as _e,Fa as Ie,G as C,Ga as Oe,H as f,Ha as ye,I as d,J as Dt,Ja as Je,Ka as Nt,La as zt,Ma as Ze,N as X,O as s,Oa as Xe,P as w,Pa as ue,Q as v,Qa as Bt,R as z,Ra as $t,S as Re,Sa as Tt,Ta as te,U as M,Ua as j,V as E,W as k,X as kt,Y as Ce,Z as Ne,_ as ve,a as $e,aa as ce,ba as pe,ca as At,e as qe,ea as oe,f as ke,fa as $,g as We,ga as N,h as he,ha as R,i as Ge,ia as Te,j as u,k as g,l as b,la as Rt,m as y,n as Ae,o as me,oa as jt,p as Vt,pa as Ut,q as Ft,r as l,ra as q,s as I,sa as we,t as A,ta as W,u as He,ua as K,v as x,va as de,w as Le,wa as G,x as m,xa as ee,y as Y,ya as Pe,z as O,za as Lt}from"./chunk-RRQC6EZP.js";import{a as ge,b as Fe,g as h}from"./chunk-6AOLKZEJ.js";function Jt(a,t){a&1&&(b(),n(0,"svg",13),p(1,"path",26)(2,"path",27),r())}function Zt(a,t){a&1&&(b(),n(0,"svg",13),p(1,"path",28),r())}function Xt(a,t){if(a&1&&(n(0,"div",29)(1,"div",30),b(),n(2,"svg",31),p(3,"path",32),r(),y(),n(4,"span"),s(5),r()()()),a&2){let e=d();l(5),w(e.errorMessage)}}function Kt(a,t){a&1&&(n(0,"span",33),b(),n(1,"svg",34),p(2,"path",35),r()())}var nt=class a{constructor(t,e){this.authService=t;this.router=e;console.log("LoginComponent inicializado")}credentials={username:"",password:""};loading=!1;errorMessage="";showPassword=!1;onLogin(){return h(this,null,function*(){if(console.log("onLogin ejecutado"),!this.credentials.username||!this.credentials.password){this.errorMessage="Por favor complete todos los campos",console.log("Error: Campos vac\xEDos");return}this.loading=!0,this.errorMessage="";try{console.log("Intentando login con:",this.credentials.username);let t=yield this.authService.login(this.credentials);t.success?(console.log("Login exitoso, navegando a dashboard"),this.router.navigate(["/dashboard"])):(console.log("Login fall\xF3:",t.message),this.errorMessage=t.message)}catch(t){console.error("Error inesperado en login:",t),this.errorMessage="Error inesperado. Intente nuevamente."}finally{this.loading=!1}})}togglePasswordVisibility(){this.showPassword=!this.showPassword,console.log("Password visibility toggled:",this.showPassword)}goToRegister(){console.log("goToRegister ejecutado - navegando a /register");try{this.router.navigate(["/register"]),console.log("Navegaci\xF3n a /register iniciada")}catch(t){console.error("Error al navegar a register:",t)}}testNavigation(){console.log("Test navigation button clicked!"),alert("\xA1El bot\xF3n funciona! Navegando a register..."),this.goToRegister()}static \u0275fac=function(e){return new(e||a)(I(j),I(ue))};static \u0275cmp=A({type:a,selectors:[["app-login"]],standalone:!1,decls:41,vars:9,consts:[[1,"login-container"],[1,"watermark"],["src","/rh.png","alt","RehabiMovement"],[1,"login-card"],[1,"login-header"],[1,"logo-container"],["src","/rh.png","alt","RehabiMovement",1,"main-logo"],[1,"login-form",3,"ngSubmit"],[1,"form-group"],["for","username"],[1,"input-container"],["id","username","name","username","type","text","autocomplete","username","required","","placeholder","Ingresa tu usuario",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-icon"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["for","password"],["id","password","name","password","autocomplete","current-password","required","","placeholder","Ingresa tu contrase\xF1a",1,"form-control",3,"ngModelChange","type","ngModel"],["type","button",1,"password-toggle",3,"click"],["class","icon","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","error-message",4,"ngIf"],["type","submit",1,"btn-primary",3,"disabled"],["class","loading-spinner",4,"ngIf"],[1,"btn-text"],[1,"toggle-mode"],["type","button",1,"link-btn",3,"click"],[1,"login-footer"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"],[1,"error-message"],[1,"error-content"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"error-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"loading-spinner"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"spinner"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1),p(2,"img",2),r(),n(3,"div",3)(4,"div",4)(5,"div",5),p(6,"img",6),r(),n(7,"h2"),s(8,"Iniciar Sesi\xF3n"),r(),n(9,"p"),s(10,"Ingresa a RehabiMovement"),r()(),n(11,"form",7),f("ngSubmit",function(){return i.onLogin()}),n(12,"div",8)(13,"label",9),s(14,"Nombre de Usuario"),r(),n(15,"div",10)(16,"input",11),k("ngModelChange",function(c){return E(i.credentials.username,c)||(i.credentials.username=c),c}),r(),n(17,"div",12),b(),n(18,"svg",13),p(19,"path",14),r()()()(),y(),n(20,"div",8)(21,"label",15),s(22,"Contrase\xF1a"),r(),n(23,"div",10)(24,"input",16),k("ngModelChange",function(c){return E(i.credentials.password,c)||(i.credentials.password=c),c}),r(),n(25,"button",17),f("click",function(){return i.togglePasswordVisibility()}),x(26,Jt,3,0,"svg",18)(27,Zt,2,0,"svg",18),r()()(),x(28,Xt,6,1,"div",19),n(29,"button",20),x(30,Kt,3,0,"span",21),n(31,"span",22),s(32),r()()(),n(33,"div",23)(34,"p"),s(35," \xBFNo tienes cuenta? "),n(36,"button",24),f("click",function(){return i.goToRegister()}),s(37," Reg\xEDstrate aqu\xED "),r()()(),n(38,"div",25)(39,"p"),s(40,"\xA9 2025 RehabiMovement - Sistema de Gesti\xF3n"),r()()()()),e&2&&(l(16),M("ngModel",i.credentials.username),l(8),m("type",i.showPassword?"text":"password"),M("ngModel",i.credentials.password),l(2),m("ngIf",!i.showPassword),l(),m("ngIf",i.showPassword),l(),m("ngIf",i.errorMessage),l(),m("disabled",i.loading),l(),m("ngIf",i.loading),l(2),v(" ",i.loading?"Iniciando sesi\xF3n...":"Iniciar Sesi\xF3n"," "))},dependencies:[R,ee,q,W,K,ye,G,de],styles:['.login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#f5f7fa,#c3cfe2);padding:20px;position:relative;overflow:hidden}.watermark[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:0;opacity:.15;pointer-events:none;filter:grayscale(20%) blur(.5px)}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:900px;height:auto;max-width:95vw}.watermark-secondary[_ngcontent-%COMP%]{position:absolute;top:30%;right:15%;transform:translate(50%,-50%) rotate(15deg);z-index:0;opacity:.08;pointer-events:none;filter:grayscale(40%) blur(1px)}.watermark-secondary[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:400px;height:auto;max-width:50vw}.login-card[_ngcontent-%COMP%]{background:#ffffffeb;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);border-radius:20px;padding:40px;box-shadow:0 25px 50px #00000026,0 0 0 1px #ffffff4d;width:100%;max-width:420px;position:relative;z-index:1;border:1px solid rgba(255,255,255,.4)}.login-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:35px}.logo-container[_ngcontent-%COMP%]{margin-bottom:20px}.main-logo[_ngcontent-%COMP%]{width:80px;height:80px;object-fit:contain;filter:drop-shadow(0 4px 8px rgba(0,0,0,.1))}.login-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2d3748;margin-bottom:8px;font-size:32px;font-weight:700;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.login-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#718096;margin:0;font-size:16px;font-weight:500}.login-form[_ngcontent-%COMP%]{margin-bottom:30px}.form-group[_ngcontent-%COMP%]{margin-bottom:25px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#2d3748;font-weight:600;font-size:14px;letter-spacing:.025em}.input-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.form-control[_ngcontent-%COMP%]{width:100%;padding:16px 50px 16px 16px;border:2px solid #e2e8f0;border-radius:12px;font-size:16px;transition:all .3s ease;box-sizing:border-box;background:#fffc}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a;background:#fff}.form-control[_ngcontent-%COMP%]::placeholder{color:#a0aec0;font-weight:400}.input-icon[_ngcontent-%COMP%]{position:absolute;right:16px;top:50%;transform:translateY(-50%);pointer-events:none}.password-toggle[_ngcontent-%COMP%]{position:absolute;right:16px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;padding:4px;border-radius:6px;transition:background-color .2s ease}.password-toggle[_ngcontent-%COMP%]:hover{background-color:#667eea1a}.icon[_ngcontent-%COMP%]{width:20px;height:20px;color:#a0aec0;transition:color .2s ease}.password-toggle[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{color:#667eea}.error-message[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fee,#fef0f0);border:1px solid #fed7d7;color:#e53e3e;padding:16px;border-radius:12px;margin-bottom:20px;font-size:14px;font-weight:500}.error-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.error-icon[_ngcontent-%COMP%]{width:20px;height:20px;flex-shrink:0}.btn-primary[_ngcontent-%COMP%]{width:100%;padding:18px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center;gap:10px}.btn-primary[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s ease}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled):before{left:100%}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 10px 25px #667eea66}.btn-primary[_ngcontent-%COMP%]:active{transform:translateY(0)}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed;transform:none}.loading-spinner[_ngcontent-%COMP%]{display:flex;align-items:center}.spinner[_ngcontent-%COMP%]{width:20px;height:20px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.btn-text[_ngcontent-%COMP%]{font-weight:600}.toggle-mode[_ngcontent-%COMP%]{text-align:center;margin-top:30px;padding-top:25px;border-top:1px solid rgba(226,232,240,.8)}.toggle-mode[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#718096;font-size:14px;font-weight:500}.link-btn[_ngcontent-%COMP%]{background:none;border:none;color:#667eea;cursor:pointer;font-weight:600;text-decoration:none;margin-left:4px;padding:2px 4px;border-radius:4px;transition:all .2s ease}.link-btn[_ngcontent-%COMP%]:hover{color:#5a67d8;background-color:#667eea1a}.login-footer[_ngcontent-%COMP%]{text-align:center;margin-top:25px;padding-top:20px;border-top:1px solid rgba(226,232,240,.5)}.login-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#a0aec0;font-size:12px;font-weight:500}@media (max-width: 480px){.login-container[_ngcontent-%COMP%]{padding:15px}.login-card[_ngcontent-%COMP%]{padding:30px 25px;border-radius:16px}.main-logo[_ngcontent-%COMP%]{width:60px;height:60px}.login-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:28px}.form-control[_ngcontent-%COMP%]{padding:14px 45px 14px 14px;font-size:16px}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:700px}.watermark-secondary[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px}}@media (max-width: 320px){.login-card[_ngcontent-%COMP%]{padding:25px 20px}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:500px}.watermark-secondary[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.login-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .6s ease-out}.form-control[_ngcontent-%COMP%]:hover{border-color:#cbd5e0}.form-control[_ngcontent-%COMP%]:focus + .input-icon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{color:#667eea}.form-control.error[_ngcontent-%COMP%]{border-color:#e53e3e;box-shadow:0 0 0 3px #e53e3e1a}.form-control.success[_ngcontent-%COMP%]{border-color:#38a169;box-shadow:0 0 0 3px #38a1691a}']})};function ei(a,t){a&1&&(b(),n(0,"svg",30),p(1,"path",31)(2,"path",32),r())}function ti(a,t){a&1&&(b(),n(0,"svg",30),p(1,"path",33),r())}function ii(a,t){a&1&&(b(),n(0,"svg",30),p(1,"path",31)(2,"path",32),r())}function ni(a,t){a&1&&(b(),n(0,"svg",30),p(1,"path",33),r())}function ri(a,t){if(a&1&&(n(0,"div",34)(1,"div",35),b(),n(2,"svg",36),p(3,"path",37),r(),y(),n(4,"div",38)(5,"p",39),s(6),r()()()()),a&2){let e=d();l(6),w(e.errorMessage)}}function oi(a,t){if(a&1&&(n(0,"div",40)(1,"div",35),b(),n(2,"svg",41),p(3,"path",42),r(),y(),n(4,"div",38)(5,"p",43),s(6),r()()()()),a&2){let e=d();l(6),w(e.successMessage)}}function ai(a,t){a&1&&(n(0,"span",44),b(),n(1,"svg",45),p(2,"path",46),r()())}var rt=class a{constructor(t,e){this.authService=t;this.router=e;console.log("RegisterComponent inicializado")}user={username:"",full_name:"",password:"",status:1,id_perfil:2};confirmPassword="";loading=!1;errorMessage="";successMessage="";showPassword=!1;showConfirmPassword=!1;onRegister(){return h(this,null,function*(){if(console.log("onRegister llamado"),console.log("Datos del formulario:",this.user),this.errorMessage="",this.successMessage="",!this.user.username||!this.user.full_name||!this.user.password||!this.confirmPassword){this.errorMessage="Por favor complete todos los campos",console.log("Error: Campos vac\xEDos");return}if(this.user.password!==this.confirmPassword){this.errorMessage="Las contrase\xF1as no coinciden",console.log("Error: Contrase\xF1as no coinciden");return}if(this.user.password.length<6){this.errorMessage="La contrase\xF1a debe tener al menos 6 caracteres",console.log("Error: Contrase\xF1a muy corta");return}if(this.user.username.length<3){this.errorMessage="El nombre de usuario debe tener al menos 3 caracteres",console.log("Error: Username muy corto");return}if(this.user.username.includes(" ")){this.errorMessage="El nombre de usuario no puede contener espacios",console.log("Error: Username con espacios");return}if(!/^[a-zA-Z0-9_.-]+$/.test(this.user.username)){this.errorMessage="El nombre de usuario solo puede contener letras, n\xFAmeros, guiones, puntos y guiones bajos",console.log("Error: Username con caracteres inv\xE1lidos");return}this.loading=!0,console.log("Iniciando proceso de registro...");try{let e=yield this.authService.register(this.user);console.log("Resultado del registro:",e),e.success?(this.successMessage="Usuario creado exitosamente. Redirigiendo al login...",console.log("Registro exitoso, redirigiendo..."),this.user={username:"",full_name:"",password:"",status:1,id_perfil:2},this.confirmPassword="",setTimeout(()=>{this.router.navigate(["/login"])},2e3)):(this.errorMessage=e.message,console.log("Error en registro:",e.message))}catch(e){console.error("Error inesperado:",e),this.errorMessage="Error inesperado. Intente nuevamente."}finally{this.loading=!1}})}togglePasswordVisibility(){this.showPassword=!this.showPassword,console.log("Password visibility toggled:",this.showPassword)}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword,console.log("Confirm password visibility toggled:",this.showConfirmPassword)}goToLogin(){console.log("Navegando a login"),this.router.navigate(["/login"])}testButton(){console.log("Test button clicked!"),console.log("Current user data:",this.user),console.log("Confirm password:",this.confirmPassword)}static \u0275fac=function(e){return new(e||a)(I(j),I(ue))};static \u0275cmp=A({type:a,selectors:[["app-register"]],standalone:!1,decls:53,vars:15,consts:[["registerForm","ngForm"],[1,"min-h-screen","bg-gradient-to-br","from-green-50","to-teal-100","flex","items-center","justify-center","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8"],[1,"text-center"],[1,"mx-auto","h-12","w-12","bg-green-600","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"],[1,"mt-6","text-3xl","font-extrabold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"bg-white","rounded-lg","shadow-xl","p-8"],[1,"space-y-6",3,"ngSubmit"],["for","fullName",1,"block","text-sm","font-medium","text-gray-700"],[1,"mt-1","relative"],["id","fullName","name","fullName","type","text","autocomplete","name","required","","placeholder","Ingresa tu nombre completo",1,"appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-green-500","focus:border-green-500","focus:z-10","sm:text-sm",3,"ngModelChange","ngModel"],["for","username",1,"block","text-sm","font-medium","text-gray-700"],["id","username","name","username","type","text","autocomplete","username","required","","placeholder","Elige un nombre de usuario",1,"appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-green-500","focus:border-green-500","focus:z-10","sm:text-sm",3,"ngModelChange","ngModel"],["for","password",1,"block","text-sm","font-medium","text-gray-700"],["id","password","name","password","autocomplete","new-password","required","","placeholder","Crea una contrase\xF1a",1,"appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-green-500","focus:border-green-500","focus:z-10","sm:text-sm","pr-10",3,"ngModelChange","type","ngModel"],["type","button",1,"absolute","inset-y-0","right-0","pr-3","flex","items-center",3,"click"],["class","h-5 w-5 text-gray-400","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["for","confirmPassword",1,"block","text-sm","font-medium","text-gray-700"],["id","confirmPassword","name","confirmPassword","autocomplete","new-password","required","","placeholder","Confirma tu contrase\xF1a",1,"appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-green-500","focus:border-green-500","focus:z-10","sm:text-sm","pr-10",3,"ngModelChange","type","ngModel"],["class","bg-red-50 border border-red-200 rounded-md p-4",4,"ngIf"],["class","bg-green-50 border border-green-200 rounded-md p-4",4,"ngIf"],[1,"flex","space-x-2"],["type","button",1,"flex-1","bg-yellow-500","text-white","py-2","px-4","rounded","text-sm",3,"click"],["type","submit",1,"group","relative","w-full","flex","justify-center","py-2","px-4","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-green-600","hover:bg-green-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-green-500","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors","duration-200",3,"disabled"],["class","absolute left-0 inset-y-0 flex items-center pl-3",4,"ngIf"],[1,"text-sm","text-gray-600"],["type","button",1,"font-medium","text-green-600","hover:text-green-500","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"bg-green-50","border","border-green-200","rounded-md","p-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-green-700"],[1,"absolute","left-0","inset-y-0","flex","items-center","pl-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-green-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"]],template:function(e,i){if(e&1){let o=C();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),b(),n(4,"svg",5),p(5,"path",6),r()(),y(),n(6,"h2",7),s(7," Crear Cuenta "),r(),n(8,"p",8),s(9," Reg\xEDstrate para comenzar "),r()(),n(10,"div",9)(11,"form",10,0),f("ngSubmit",function(){return u(o),g(i.onRegister())}),n(13,"div")(14,"label",11),s(15," Nombre Completo "),r(),n(16,"div",12)(17,"input",13),k("ngModelChange",function(_){return u(o),E(i.user.full_name,_)||(i.user.full_name=_),g(_)}),r()()(),n(18,"div")(19,"label",14),s(20," Nombre de Usuario "),r(),n(21,"div",12)(22,"input",15),k("ngModelChange",function(_){return u(o),E(i.user.username,_)||(i.user.username=_),g(_)}),r()()(),n(23,"div")(24,"label",16),s(25," Contrase\xF1a "),r(),n(26,"div",12)(27,"input",17),k("ngModelChange",function(_){return u(o),E(i.user.password,_)||(i.user.password=_),g(_)}),r(),n(28,"button",18),f("click",function(){return u(o),g(i.togglePasswordVisibility())}),x(29,ei,3,0,"svg",19)(30,ti,2,0,"svg",19),r()()(),n(31,"div")(32,"label",20),s(33," Confirmar Contrase\xF1a "),r(),n(34,"div",12)(35,"input",21),k("ngModelChange",function(_){return u(o),E(i.confirmPassword,_)||(i.confirmPassword=_),g(_)}),r(),n(36,"button",18),f("click",function(){return u(o),g(i.toggleConfirmPasswordVisibility())}),x(37,ii,3,0,"svg",19)(38,ni,2,0,"svg",19),r()()(),x(39,ri,7,1,"div",22)(40,oi,7,1,"div",23),n(41,"div",24)(42,"button",25),f("click",function(){return u(o),g(i.onRegister())}),s(43," Test onRegister() "),r()(),n(44,"div")(45,"button",26),x(46,ai,3,0,"span",27),s(47),r()(),n(48,"div",3)(49,"p",28),s(50," \xBFYa tienes cuenta? "),n(51,"button",29),f("click",function(){return u(o),g(i.goToLogin())}),s(52," Inicia sesi\xF3n aqu\xED "),r()()()()()()()}e&2&&(l(17),M("ngModel",i.user.full_name),l(5),M("ngModel",i.user.username),l(5),m("type",i.showPassword?"text":"password"),M("ngModel",i.user.password),l(2),m("ngIf",!i.showPassword),l(),m("ngIf",i.showPassword),l(5),m("type",i.showConfirmPassword?"text":"password"),M("ngModel",i.confirmPassword),l(2),m("ngIf",!i.showConfirmPassword),l(),m("ngIf",i.showConfirmPassword),l(),m("ngIf",i.errorMessage),l(),m("ngIf",i.successMessage),l(5),m("disabled",i.loading),l(),m("ngIf",i.loading),l(),v(" ",i.loading?"Creando cuenta...":"Crear Cuenta"," "))},dependencies:[R,ee,q,W,K,ye,G,de],encapsulation:2})};function si(a,t){a&1&&(b(),n(0,"svg",22),p(1,"path",35),r())}function li(a,t){a&1&&(b(),n(0,"svg",22),p(1,"path",36),r())}function ci(a,t){if(a&1){let e=C();n(0,"button",37),f("click",function(){let o=u(e).index,c=d();return g(c.goToQuote(o))}),r()}if(a&2){let e=t.$implicit,i=t.index,o=d();O("active",i===o.currentQuoteIndex),m("title",e.category+": "+e.text.substring(0,50)+"...")}}function di(a,t){if(a&1){let e=C();n(0,"div",42),f("click",function(){let o=u(e).index,c=d(2);return g(c.goToQuote(o))}),n(1,"div",43),s(2),r(),n(3,"div",44),s(4),r(),n(5,"div",45),s(6),r()()}if(a&2){let e=t.$implicit,i=t.index,o=d(2);O("current",i===o.currentQuoteIndex),l(2),w(e.category),l(2),v("",e.text.substring(0,80),"..."),l(2),w(e.author)}}function mi(a,t){if(a&1&&(n(0,"div",38)(1,"h4",39),s(2,"Otras frases motivacionales:"),r(),n(3,"div",40),x(4,di,7,5,"div",41),r()()),a&2){let e=d();l(4),m("ngForOf",e.motivationalQuotes.slice(0,6))}}var ot=class a{currentQuoteIndex=0;isAutoRotating=!0;intervalId;ROTATION_INTERVAL=12*60*60*1e3;motivationalQuotes=[{text:"Cada paso que das en tu rehabilitaci\xF3n es un paso hacia una vida mejor.",author:"RehabiMovement",category:"Progreso"},{text:"La fortaleza no viene de la capacidad f\xEDsica, sino de una voluntad indomable.",author:"Mahatma Gandhi",category:"Fortaleza"},{text:"No importa cu\xE1n lento vayas, siempre y cuando no te detengas.",author:"Confucio",category:"Perseverancia"},{text:"Tu recuperaci\xF3n no es una carrera, es un viaje. Disfruta cada momento de progreso.",author:"RehabiMovement",category:"Paciencia"},{text:"El dolor es temporal, pero rendirse dura para siempre.",author:"Lance Armstrong",category:"Resistencia"},{text:"Cada ejercicio que haces hoy es una inversi\xF3n en tu futuro yo.",author:"RehabiMovement",category:"Futuro"},{text:"La diferencia entre lo imposible y lo posible radica en la determinaci\xF3n.",author:"Tommy Lasorda",category:"Determinaci\xF3n"},{text:"Tu cuerpo puede hacerlo. Es tu mente la que tienes que convencer.",author:"Motivaci\xF3n Fitness",category:"Mentalidad"},{text:"No se trata de ser perfecto, se trata de ser mejor que ayer.",author:"RehabiMovement",category:"Mejora"},{text:"La rehabilitaci\xF3n es el arte de transformar limitaciones en oportunidades.",author:"RehabiMovement",category:"Transformaci\xF3n"},{text:"Cada d\xEDa sin desistir es una victoria en s\xED misma.",author:"Motivaci\xF3n Personal",category:"Victoria"},{text:"Tu fuerza interior es m\xE1s poderosa que cualquier obst\xE1culo externo.",author:"RehabiMovement",category:"Fuerza Interior"},{text:"El \xE9xito es la suma de peque\xF1os esfuerzos repetidos d\xEDa tras d\xEDa.",author:"Robert Collier",category:"\xC9xito"},{text:"No mires atr\xE1s, no vas en esa direcci\xF3n. Enf\xF3cate en tu progreso.",author:"RehabiMovement",category:"Enfoque"},{text:"La sanaci\xF3n es un proceso, no un destino. Celebra cada peque\xF1o avance.",author:"RehabiMovement",category:"Sanaci\xF3n"},{text:"Tu dedicaci\xF3n de hoy ser\xE1 tu fuerza de ma\xF1ana.",author:"RehabiMovement",category:"Dedicaci\xF3n"},{text:"Los campeones siguen jugando hasta que lo hacen bien.",author:"Billie Jean King",category:"Persistencia"},{text:"La recuperaci\xF3n requiere valent\xEDa para enfrentar tus miedos y seguir adelante.",author:"RehabiMovement",category:"Valent\xEDa"},{text:"Cada sesi\xF3n de terapia es una inversi\xF3n en tu independencia futura.",author:"RehabiMovement",category:"Independencia"},{text:"Cree en ti mismo y en tu capacidad de superar cualquier desaf\xEDo.",author:"RehabiMovement",category:"Autoconfianza"}];ngOnInit(){this.loadSavedState(),this.startAutoRotation()}ngOnDestroy(){this.stopAutoRotation()}loadSavedState(){try{let t=localStorage.getItem("motivational-quote-index"),e=localStorage.getItem("motivational-quote-last-update");t&&e&&(Date.now()-parseInt(e)>=this.ROTATION_INTERVAL?this.nextQuote():this.currentQuoteIndex=parseInt(t))}catch(t){console.error("Error loading saved state:",t)}}saveState(){try{localStorage.setItem("motivational-quote-index",this.currentQuoteIndex.toString()),localStorage.setItem("motivational-quote-last-update",Date.now().toString())}catch(t){console.error("Error saving state:",t)}}startAutoRotation(){this.isAutoRotating&&(this.intervalId=setInterval(()=>{this.nextQuote()},this.ROTATION_INTERVAL))}stopAutoRotation(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}get currentQuote(){return this.motivationalQuotes[this.currentQuoteIndex]}nextQuote(){this.currentQuoteIndex=(this.currentQuoteIndex+1)%this.motivationalQuotes.length,this.saveState()}previousQuote(){this.currentQuoteIndex=this.currentQuoteIndex===0?this.motivationalQuotes.length-1:this.currentQuoteIndex-1,this.saveState()}goToQuote(t){t>=0&&t<this.motivationalQuotes.length&&(this.currentQuoteIndex=t,this.saveState())}toggleAutoRotation(){this.isAutoRotating=!this.isAutoRotating,this.isAutoRotating?this.startAutoRotation():this.stopAutoRotation()}getTimeUntilNextUpdate(){try{let t=localStorage.getItem("motivational-quote-last-update");if(!t)return"No disponible";let e=Date.now()-parseInt(t),i=this.ROTATION_INTERVAL-e;if(i<=0)return"Pr\xF3ximamente";let o=Math.floor(i/(60*60*1e3)),c=Math.floor(i%(60*60*1e3)/(60*1e3));return`${o}h ${c}m`}catch{return"No disponible"}}forceUpdate(){this.nextQuote(),this.stopAutoRotation(),this.isAutoRotating&&this.startAutoRotation()}getProgressPercentage(){return(this.currentQuoteIndex+1)/this.motivationalQuotes.length*100}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=A({type:a,selectors:[["app-motivational-quotes"]],standalone:!1,decls:46,vars:15,consts:[[1,"motivational-quotes-container"],[1,"watermark"],["src","/rh.png","alt","RehabiMovement"],[1,"quote-card"],[1,"quote-header"],[1,"quote-category"],[1,"category-badge"],[1,"quote-controls"],[1,"progress-indicator"],[1,"progress-text"],[1,"progress-bar"],[1,"progress-fill"],[1,"auto-rotation-btn",3,"click","title"],["class","icon","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"quote-content"],[1,"quote-icon"],["fill","currentColor","viewBox","0 0 24 24",1,"icon"],["d","M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h4v10h-10z"],[1,"quote-text"],[1,"quote-author"],[1,"quote-navigation"],["title","Frase anterior",1,"nav-btn","prev-btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"nav-info"],[1,"next-update-info"],[1,"update-label"],[1,"update-time"],["title","Cambiar frase ahora",1,"force-update-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["title","Siguiente frase",1,"nav-btn","next-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"quote-dots"],["class","dot",3,"active","title","click",4,"ngFor","ngForOf"],["class","preview-cards",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"dot",3,"click","title"],[1,"preview-cards"],[1,"preview-title"],[1,"preview-grid"],["class","preview-card",3,"current","click",4,"ngFor","ngForOf"],[1,"preview-card",3,"click"],[1,"preview-category"],[1,"preview-text"],[1,"preview-author"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1),p(2,"img",2),r(),n(3,"div",3)(4,"div",4)(5,"div",5)(6,"span",6),s(7),r()(),n(8,"div",7)(9,"div",8)(10,"span",9),s(11),r(),n(12,"div",10),p(13,"div",11),r()(),n(14,"button",12),f("click",function(){return i.toggleAutoRotation()}),x(15,si,2,0,"svg",13)(16,li,2,0,"svg",13),r()()(),n(17,"div",14)(18,"div",15),b(),n(19,"svg",16),p(20,"path",17),r()(),y(),n(21,"blockquote",18),s(22),r(),n(23,"div",19)(24,"cite"),s(25),r()()(),n(26,"div",20)(27,"button",21),f("click",function(){return i.previousQuote()}),b(),n(28,"svg",22),p(29,"path",23),r()(),y(),n(30,"div",24)(31,"div",25)(32,"span",26),s(33,"Pr\xF3xima actualizaci\xF3n autom\xE1tica:"),r(),n(34,"span",27),s(35),r()(),n(36,"button",28),f("click",function(){return i.forceUpdate()}),b(),n(37,"svg",22),p(38,"path",29),r(),s(39," Cambiar ahora "),r()(),y(),n(40,"button",30),f("click",function(){return i.nextQuote()}),b(),n(41,"svg",22),p(42,"path",31),r()()()(),y(),n(43,"div",32),x(44,ci,1,3,"button",33),r(),x(45,mi,5,1,"div",34),r()),e&2&&(l(7),w(i.currentQuote.category),l(4),z("",i.currentQuoteIndex+1,"/",i.motivationalQuotes.length,""),l(2),Y("width",i.getProgressPercentage(),"%"),l(),O("active",i.isAutoRotating),Dt("title",i.isAutoRotating?"Desactivar rotaci\xF3n autom\xE1tica":"Activar rotaci\xF3n autom\xE1tica"),l(),m("ngIf",i.isAutoRotating),l(),m("ngIf",!i.isAutoRotating),l(6),v(" ",i.currentQuote.text," "),l(3),v("- ",i.currentQuote.author,""),l(10),w(i.getTimeUntilNextUpdate()),l(9),m("ngForOf",i.motivationalQuotes),l(),m("ngIf",i.motivationalQuotes.length>0))},dependencies:[N,R],styles:['.motivational-quotes-container[_ngcontent-%COMP%]{position:relative;width:100%;min-height:600px;padding:30px;overflow:hidden;background:linear-gradient(135deg,#fcfcfd,#f8fafc);border-radius:24px;box-shadow:0 20px 40px #00000014}.watermark[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:0;opacity:.3;pointer-events:none;filter:grayscale(10%) blur(.2px);width:100%;height:100%;display:flex;align-items:center;justify-content:center}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:700px;height:auto;max-width:90vw;object-fit:contain}.quote-card[_ngcontent-%COMP%]{position:relative;z-index:1;background:#ffffffb3;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);border-radius:28px;padding:40px;box-shadow:0 15px 30px #00000008,0 0 0 1px #fff6;border:1px solid rgba(255,255,255,.5);max-width:900px;margin:0 auto;transition:all .3s ease;animation:_ngcontent-%COMP%_fadeInUp .6s ease-out;overflow:hidden}.quote-card[_ngcontent-%COMP%]:hover{transform:translateY(-6px);background:#fffc;box-shadow:0 25px 50px #0000000d,0 0 0 1px #fff9}.quote-card[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background-image:url(/rh.png);background-size:200px auto;background-position:center;background-repeat:no-repeat;opacity:.12;z-index:-1;pointer-events:none;filter:grayscale(20%) blur(.1px)}.quote-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;position:relative;z-index:2}.quote-category[_ngcontent-%COMP%]{display:flex;align-items:center}.category-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:8px 16px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;box-shadow:0 4px 12px #667eea4d}.quote-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.progress-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.progress-text[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#6b7280;min-width:40px}.progress-bar[_ngcontent-%COMP%]{width:80px;height:4px;background:#e5e7ebcc;border-radius:2px;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(135deg,#667eea,#764ba2);transition:width .3s ease;border-radius:2px}.auto-rotation-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:36px;height:36px;background:#f3f4f6cc;border:none;border-radius:8px;cursor:pointer;transition:all .2s ease;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px)}.auto-rotation-btn[_ngcontent-%COMP%]:hover{background:#e5e7ebe6;transform:scale(1.05)}.auto-rotation-btn.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;box-shadow:0 4px 12px #667eea4d}.auto-rotation-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:18px;height:18px}.quote-content[_ngcontent-%COMP%]{text-align:center;margin-bottom:36px;position:relative;z-index:2}.quote-icon[_ngcontent-%COMP%]{margin-bottom:24px;position:relative;z-index:2}.quote-icon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:56px;height:56px;color:#fbbf24;filter:drop-shadow(0 6px 12px rgba(251,191,36,.4))}.quote-text[_ngcontent-%COMP%]{font-size:28px;line-height:1.6;font-weight:500;color:#1f2937;margin-bottom:24px;font-style:italic;position:relative;text-shadow:0 1px 2px rgba(0,0,0,.05);z-index:2}.quote-author[_ngcontent-%COMP%]{margin-top:16px;position:relative;z-index:2}.quote-author[_ngcontent-%COMP%]   cite[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;font-weight:500;font-style:normal}.quote-navigation[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:20px;padding-top:24px;border-top:1px solid rgba(229,231,235,.6);position:relative;z-index:2}.nav-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:44px;height:44px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:50%;cursor:pointer;transition:all .2s ease;box-shadow:0 4px 12px #667eea4d}.nav-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #667eea66}.nav-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:20px;height:20px}.nav-info[_ngcontent-%COMP%]{flex:1;text-align:center}.next-update-info[_ngcontent-%COMP%]{margin-bottom:12px}.update-label[_ngcontent-%COMP%]{display:block;font-size:12px;color:#6b7280;margin-bottom:4px}.update-time[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#374151}.force-update-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:8px 16px;background:#f3f4f6cc;border:1px solid rgba(209,213,219,.7);border-radius:8px;font-size:12px;font-weight:500;color:#374151;cursor:pointer;transition:all .2s ease;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px)}.force-update-btn[_ngcontent-%COMP%]:hover{background:#e5e7ebe6;transform:translateY(-1px)}.force-update-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:14px;height:14px}.quote-dots[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:8px;margin-top:24px;padding:16px}.dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#d1d5dbcc;border:none;cursor:pointer;transition:all .2s ease}.dot[_ngcontent-%COMP%]:hover{background:#9ca3af;transform:scale(1.2)}.dot.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);transform:scale(1.3);box-shadow:0 2px 8px #667eea66}.preview-cards[_ngcontent-%COMP%]{margin-top:50px;position:relative;z-index:1}.preview-title[_ngcontent-%COMP%]{text-align:center;font-size:20px;font-weight:600;color:#374151;margin-bottom:24px}.preview-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;max-width:900px;margin:0 auto}.preview-card[_ngcontent-%COMP%]{background:#fffc;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.6);border-radius:16px;padding:20px;cursor:pointer;transition:all .3s ease;position:relative;overflow:hidden}.preview-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 12px 24px #00000014;background:#ffffffe6}.preview-card.current[_ngcontent-%COMP%]{border-color:#667eea;box-shadow:0 0 0 2px #667eea33;background:#ffffffe6}.preview-category[_ngcontent-%COMP%]{font-size:10px;font-weight:600;color:#667eea;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px}.preview-text[_ngcontent-%COMP%]{font-size:13px;line-height:1.4;color:#374151;margin-bottom:8px}.preview-author[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;font-style:italic}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.7}}.quote-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .6s ease-out}@media (max-width: 768px){.motivational-quotes-container[_ngcontent-%COMP%]{padding:20px;min-height:500px}.watermark[_ngcontent-%COMP%]{opacity:.4}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:450px;min-width:350px}.quote-card[_ngcontent-%COMP%]{padding:28px;border-radius:20px;background:#fff9}.quote-card[_ngcontent-%COMP%]:hover{background:#ffffffb3}.quote-card[_ngcontent-%COMP%]:before{background-size:160px auto;opacity:.16}.quote-text[_ngcontent-%COMP%]{font-size:22px}.quote-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;align-items:stretch}.quote-controls[_ngcontent-%COMP%]{justify-content:center}.quote-navigation[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.nav-info[_ngcontent-%COMP%]{order:-1}.preview-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 480px){.motivational-quotes-container[_ngcontent-%COMP%]{padding:16px}.watermark[_ngcontent-%COMP%]{opacity:.45}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:350px;min-width:280px}.quote-card[_ngcontent-%COMP%]{padding:24px;background:#ffffff8c;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px)}.quote-card[_ngcontent-%COMP%]:hover{background:#ffffffa6}.quote-card[_ngcontent-%COMP%]:before{background-size:140px auto;opacity:.18}.quote-text[_ngcontent-%COMP%]{font-size:20px}.quote-dots[_ngcontent-%COMP%]{gap:6px}.dot[_ngcontent-%COMP%]{width:6px;height:6px}.category-badge[_ngcontent-%COMP%], .nav-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eeae6,#764ba2e6)}.auto-rotation-btn[_ngcontent-%COMP%]{background:#f3f4f6b3}.force-update-btn[_ngcontent-%COMP%]{background:#f3f4f6b3;border:1px solid rgba(209,213,219,.6)}}@media (prefers-color-scheme: dark){.motivational-quotes-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563)}.watermark[_ngcontent-%COMP%]{opacity:.18;filter:grayscale(20%) blur(.2px) invert(.1)}.quote-card[_ngcontent-%COMP%]{background:#6b7280b3;border-color:#9ca3af4d;box-shadow:0 15px 30px #00000026,0 0 0 1px #9ca3af33}.quote-card[_ngcontent-%COMP%]:hover{background:#6b7280cc}.quote-card[_ngcontent-%COMP%]:before{opacity:.08;filter:grayscale(30%) blur(.1px) invert(.1)}.quote-text[_ngcontent-%COMP%]{color:#f9fafb}.quote-author[_ngcontent-%COMP%]   cite[_ngcontent-%COMP%]{color:#d1d5db}.preview-card[_ngcontent-%COMP%]{background:#6b7280a6;border-color:#9ca3af4d}.preview-card[_ngcontent-%COMP%]:hover{background:#6b7280cc}.preview-text[_ngcontent-%COMP%]{color:#f3f4f6}.progress-bar[_ngcontent-%COMP%]{background:#9ca3af80}.auto-rotation-btn[_ngcontent-%COMP%]{background:#9ca3afb3}.force-update-btn[_ngcontent-%COMP%]{background:#9ca3afb3;border-color:#d1d5db80;color:#f3f4f6}.dot[_ngcontent-%COMP%]{background:#d1d5db99}@media (max-width: 480px){.watermark[_ngcontent-%COMP%]{opacity:.28}.quote-card[_ngcontent-%COMP%]{background:#6b728099}.quote-card[_ngcontent-%COMP%]:hover{background:#6b7280b3}.quote-card[_ngcontent-%COMP%]:before{opacity:.12}}}']})};function gi(a,t){a&1&&(n(0,"div",7),p(1,"div",8),r())}function fi(a,t){if(a&1){let e=C();n(0,"img",22),f("error",function(o){return u(e),g(o.target.style.display="none")}),r()}if(a&2){let e=d(2);m("src",e.getUserAvatarUrl(),me)("alt",(e.currentUser==null?null:e.currentUser.full_name)||"Avatar")}}function _i(a,t){if(a&1&&(n(0,"span",23),s(1),r()),a&2){let e=d(2);l(),v(" ",e.getUserInitials()," ")}}function xi(a,t){if(a&1&&(n(0,"div")(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"div",13),x(6,fi,1,2,"img",14)(7,_i,2,1,"ng-template",null,0,oe),r()(),n(9,"div",15)(10,"h2",16),s(11),r(),n(12,"p",17),s(13,"Sistema RehabiMovement - Tu camino hacia la recuperaci\xF3n"),r(),n(14,"div",18),b(),n(15,"svg",19),p(16,"path",20),r(),y(),n(17,"span",21),s(18),r()()()()()(),n(19,"div",9),p(20,"app-motivational-quotes"),r()()),a&2){let e=X(8),i=d();l(6),m("ngIf",i.currentUser==null?null:i.currentUser.avatar_url)("ngIfElse",e),l(5),v("\xA1Bienvenido, ",i.currentUser==null?null:i.currentUser.full_name,"!"),l(7),v("\xDAltima conexi\xF3n: ",i.getCurrentTime(),"")}}var at=class a{constructor(t,e,i){this.authService=t;this.permissionsService=e;this.router=i}currentUser=null;menuItems=[];isSidebarCollapsed=!1;loading=!0;error="";currentRoute="";expandedModules=new Set;stats={todayProgress:0,sessionsCompleted:0,daysActive:0,achievementPoints:0};subscriptions=new $e;ngOnInit(){return h(this,null,function*(){console.log("Dashboard inicializado");try{if(this.currentUser=this.authService.getCurrentUser(),console.log("Usuario actual:",this.currentUser),!this.currentUser){console.log("No hay usuario autenticado, redirigiendo a login"),this.router.navigate(["/login"]);return}yield this.loadUserMenu(),yield this.loadDashboardStats(),this.subscriptions.add(this.router.events.pipe(qe(t=>t instanceof Ze)).subscribe(t=>{this.currentRoute=t.urlAfterRedirects,console.log("Ruta actual:",this.currentRoute)})),this.currentRoute=this.router.url}catch(t){console.error("Error inicializando dashboard:",t),this.error="Error cargando el dashboard"}finally{this.loading=!1}})}ngOnDestroy(){this.subscriptions.unsubscribe()}loadUserMenu(){return h(this,null,function*(){try{console.log("Cargando men\xFA del usuario..."),this.menuItems=yield this.permissionsService.loadUserMenu(),(!this.menuItems||this.menuItems.length===0)&&(console.log("No se obtuvo men\xFA de la BD, usando men\xFA por defecto"),this.menuItems=this.createDefaultMenu()),this.updateExpandedModules(),console.log("Men\xFA cargado:",this.menuItems)}catch(t){console.error("Error cargando men\xFA:",t),this.menuItems=this.createDefaultMenu(),this.updateExpandedModules()}})}createDefaultMenu(){return[{id_modulo:1,nombre:"Dashboard",descripcion:"Panel principal",icono:"fas fa-tachometer-alt",ruta:"/dashboard",orden:1,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1},{id_modulo:2,nombre:"Usuarios",descripcion:"Gesti\xF3n de usuarios",icono:"fas fa-users",ruta:"/usuarios",orden:2,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1},{id_modulo:3,nombre:"Reportes",descripcion:"Sistema de reportes",icono:"fas fa-chart-bar",ruta:"/reportes",orden:3,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1},{id_modulo:4,nombre:"Configuraci\xF3n",descripcion:"Configuraci\xF3n del sistema",icono:"fas fa-cog",ruta:"/configuracion",orden:4,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1}]}updateExpandedModules(){this.menuItems.forEach(t=>{t.expanded===void 0&&(t.expanded=!1),t.children&&t.children.forEach(e=>{e.expanded===void 0&&(e.expanded=!1)})})}loadDashboardStats(){return h(this,null,function*(){try{this.stats={todayProgress:this.calculateTodayProgress(),sessionsCompleted:this.getSessionsCompleted(),daysActive:this.getDaysActive(),achievementPoints:this.getAchievementPoints()}}catch(t){console.error("Error cargando estad\xEDsticas:",t)}})}calculateTodayProgress(){let e=new Date().getHours();return e<8?10:e<12?35:e<16?65:e<20?85:95}getSessionsCompleted(){let t=this.getDaysActive();return Math.floor(t*.8)+15}getDaysActive(){if(!this.currentUser?.created_at)return 1;let t=new Date(this.currentUser.created_at),i=Math.abs(new Date().getTime()-t.getTime()),o=Math.ceil(i/(1e3*60*60*24));return Math.max(1,o)}getAchievementPoints(){let t=this.getSessionsCompleted(),e=this.getDaysActive();return t*10+e*5+Math.floor(this.calculateTodayProgress()/10)*25}getUserAvatarUrl(){return this.authService.getAvatarUrl(this.currentUser||void 0)}toggleSidebar(){this.isSidebarCollapsed=!this.isSidebarCollapsed,console.log("Sidebar colapsado:",this.isSidebarCollapsed)}toggleModule(t){this.expandedModules.has(t)?this.expandedModules.delete(t):this.expandedModules.add(t);let e=this.menuItems.find(i=>i.id_modulo===t);e&&(e.expanded=this.expandedModules.has(t),console.log(`M\xF3dulo ${e.nombre} ${e.expanded?"expandido":"colapsado"}`))}isModuleExpanded(t){return this.expandedModules.has(t)}logout(){console.log("Cerrando sesi\xF3n desde dashboard"),this.permissionsService.clearUserData(),this.currentUser=null,this.menuItems=[],this.authService.logout()}getFilteredMenuItems(){return this.menuItems.filter(t=>!t.modulo_padre_id)}getFilteredChildren(t){return t.children?t.children:this.menuItems.filter(e=>e.modulo_padre_id===t.id_modulo)}isRouteActive(t){return!t||t==="#"?!1:this.currentRoute===t||this.currentRoute.startsWith(t+"/")}navigateTo(t){t&&t!=="#"&&(console.log("Navegando a:",t),this.router.navigate([t]))}getUserInitials(){return this.authService.getUserInitials(this.currentUser||void 0)}getUserRole(){switch(this.currentUser?.id_perfil){case 1:return"Administrador";case 2:return"Usuario";case 3:return"Supervisor";case 4:return"Invitado";default:return"Usuario"}}getPageTitle(){switch(this.currentRoute){case"/dashboard":return"Dashboard";case"/usuarios":return"Gesti\xF3n de Usuarios";case"/reportes":return"Reportes";case"/configuracion":return"Configuraci\xF3n";default:return"Dashboard"}}isDashboardHome(){return this.currentRoute==="/dashboard"}isUsersPage(){return this.currentRoute==="/usuarios"}formatDate(t){return t?new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"N/A"}getCurrentTime(){return new Date().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}refreshDashboard(){return h(this,null,function*(){this.loading=!0;try{yield this.loadUserMenu(),yield this.loadDashboardStats(),yield this.permissionsService.loadUserPermissions()}catch(t){console.error("Error refrescando dashboard:",t)}finally{this.loading=!1}})}static \u0275fac=function(e){return new(e||a)(I(j),I(Ke),I(ue))};static \u0275cmp=A({type:a,selectors:[["app-dashboard"]],standalone:!1,decls:6,vars:2,consts:[["welcomeInitials",""],[1,"min-h-screen","bg-gray-50","flex"],[1,"flex-1","flex","flex-col","overflow-hidden"],[1,"flex-1","overflow-auto"],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],["class","flex justify-center items-center h-64",4,"ngIf"],[4,"ngIf"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-indigo-600"],[1,"mb-8"],[1,"bg-gradient-to-r","from-indigo-500","to-purple-600","rounded-lg","shadow-lg","p-6","text-white"],[1,"flex","items-center"],[1,"flex-shrink-0"],[1,"h-16","w-16","rounded-full","overflow-hidden","bg-white","bg-opacity-20","flex","items-center","justify-center","shadow-lg"],["class","w-full h-full object-cover",3,"src","alt","error",4,"ngIf","ngIfElse"],[1,"ml-6"],[1,"text-3xl","font-bold"],[1,"text-indigo-100","text-lg"],[1,"mt-2","flex","items-center","text-indigo-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm"],[1,"w-full","h-full","object-cover",3,"error","src","alt"],[1,"text-xl","font-bold","text-white"]],template:function(e,i){e&1&&(n(0,"div",1)(1,"div",2)(2,"main",3)(3,"div",4),x(4,gi,2,0,"div",5)(5,xi,21,4,"div",6),r()()()()),e&2&&(l(4),m("ngIf",i.loading),l(),m("ngIf",!i.loading))},dependencies:[R,ot],encapsulation:2})};var vi=(a,t)=>({"bg-green-400":a,"bg-red-400":t}),bi=(a,t,e,i)=>({"bg-purple-100 text-purple-800":a,"bg-blue-100 text-blue-800":t,"bg-yellow-100 text-yellow-800":e,"bg-gray-100 text-gray-800":i}),hi=(a,t)=>({"bg-green-100 text-green-800":a,"bg-red-100 text-red-800":t});function Ci(a,t){if(a&1){let e=C();n(0,"div",43)(1,"div",44),b(),n(2,"svg",45),p(3,"path",46),r(),y(),n(4,"div",47)(5,"p",48),s(6),r()(),n(7,"div",49)(8,"button",50),f("click",function(){u(e);let o=d();return g(o.error="")}),b(),n(9,"svg",51),p(10,"path",52),r()()()()()}if(a&2){let e=d();l(6),w(e.error)}}function wi(a,t){a&1&&(n(0,"div",53)(1,"div",54),p(2,"div",55),n(3,"p",56),s(4,"Cargando usuarios..."),r()()())}function yi(a,t){if(a&1){let e=C();n(0,"img",93),f("error",function(o){return u(e),g(o.target.style.display="none")}),r()}if(a&2){let e=d().$implicit,i=d(2);m("src",i.getUserAvatarUrl(e),me)("alt",e.full_name||"Avatar")}}function Si(a,t){if(a&1&&(n(0,"span",94),s(1),r()),a&2){let e=d().$implicit,i=d(2);l(),v(" ",i.getUserInitials(e)," ")}}function Mi(a,t){if(a&1){let e=C();n(0,"button",95),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.deactivateUser(o))}),b(),n(1,"svg",86),p(2,"path",96),r()()}}function Ei(a,t){if(a&1){let e=C();n(0,"button",97),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.reactivateUser(o))}),b(),n(1,"svg",86),p(2,"path",98),r()()}}function ki(a,t){if(a&1){let e=C();n(0,"tr",69)(1,"td",70)(2,"div",71)(3,"div",72)(4,"div",73),x(5,yi,1,2,"img",74)(6,Si,2,1,"ng-template",null,1,oe),r(),p(8,"div",75),r(),n(9,"div",76)(10,"div",77),s(11),r(),n(12,"div",61),s(13),r()()()(),n(14,"td",70)(15,"div",78),s(16),r()(),n(17,"td",70)(18,"span",79),s(19),r()(),n(20,"td",70)(21,"span",79),b(),n(22,"svg",80),p(23,"circle",81),r(),s(24),r()(),y(),n(25,"td",82),s(26),r(),n(27,"td",83)(28,"div",84)(29,"button",85),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.changeUserAvatar(o))}),b(),n(30,"svg",86),p(31,"path",87)(32,"path",88),r()(),y(),n(33,"button",89),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.openEditModal(o))}),b(),n(34,"svg",86),p(35,"path",90),r()(),x(36,Mi,3,0,"button",91)(37,Ei,3,0,"button",92),r()()()}if(a&2){let e=t.$implicit,i=X(7),o=d(2);l(5),m("ngIf",e.avatar_url)("ngIfElse",i),l(3),m("ngClass",Ce(13,vi,e.status===1,e.status===0)),l(3),w(e.username),l(2),v("ID: ",e.id,""),l(3),w(e.full_name),l(2),m("ngClass",ve(16,bi,e.id_perfil===1,e.id_perfil===2,e.id_perfil===3,e.id_perfil===4)),l(),v(" ",o.getPerfilName(e.id_perfil)," "),l(2),m("ngClass",Ce(21,hi,e.status===1,e.status===0)),l(3),v(" ",o.getStatusText(e.status)," "),l(2),v(" ",o.formatDate(e.created_at)," "),l(10),m("ngIf",e.status===1),l(),m("ngIf",e.status===0)}}function Ti(a,t){if(a&1){let e=C();n(0,"button",107),f("click",function(){u(e);let o=d(3);return g(o.openCreateModal())}),s(1," Crear primer usuario "),r()}}function Pi(a,t){if(a&1){let e=C();n(0,"button",108),f("click",function(){u(e);let o=d(3);return g(o.clearFilters())}),s(1," Limpiar filtros "),r()}}function Ii(a,t){if(a&1&&(n(0,"div",99),b(),n(1,"svg",100),p(2,"path",101),r(),y(),n(3,"h3",102),s(4,"No hay usuarios"),r(),n(5,"p",103),s(6),r(),n(7,"div",104),x(8,Ti,2,0,"button",105)(9,Pi,2,0,"button",106),r()()),a&2){let e=d(2);l(6),v(" ",e.usuarios.length===0?"No se encontraron usuarios en la base de datos.":"No se encontraron usuarios con los filtros aplicados."," "),l(2),m("ngIf",e.usuarios.length===0),l(),m("ngIf",e.usuarios.length>0)}}function Oi(a,t){if(a&1&&(n(0,"div",57)(1,"div",58)(2,"div",59)(3,"h3",60),s(4),r(),n(5,"span",61),s(6),r()()(),n(7,"div",62)(8,"table",63)(9,"thead",64)(10,"tr")(11,"th",65),s(12," Usuario "),r(),n(13,"th",65),s(14," Nombre Completo "),r(),n(15,"th",65),s(16," Perfil "),r(),n(17,"th",65),s(18," Estado "),r(),n(19,"th",65),s(20," Fecha Creaci\xF3n "),r(),n(21,"th",65),s(22," Acciones "),r()()(),n(23,"tbody",66),x(24,ki,38,24,"tr",67),r()(),x(25,Ii,10,3,"div",68),r()()),a&2){let e=d();l(4),z(" Lista de Usuarios (",e.filteredUsuarios.length," de ",e.usuarios.length,") "),l(2),z(" Mostrando ",e.filteredUsuarios.length," resultado",e.filteredUsuarios.length!==1?"s":""," "),l(18),m("ngForOf",e.filteredUsuarios)("ngForTrackBy",e.trackByUserId),l(),m("ngIf",e.filteredUsuarios.length===0&&!e.loading)}}function Vi(a,t){if(a&1){let e=C();n(0,"img",93),f("error",function(o){return u(e),g(o.target.style.display="none")}),r()}if(a&2){let e=d(3);m("src",e.getUserAvatarUrl(e.userForm),me)("alt",e.userForm.full_name||"Avatar")}}function Fi(a,t){if(a&1&&(n(0,"span",147),s(1),r()),a&2){let e=d(3);l(),v(" ",e.getUserInitials(e.userForm)," ")}}function Di(a,t){if(a&1){let e=C();n(0,"div",143)(1,"div",20)(2,"div",144),x(3,Vi,1,2,"img",74)(4,Fi,2,1,"ng-template",null,2,oe),r(),n(6,"button",145),f("click",function(){u(e);let o=X(11);return g(o.click())}),b(),n(7,"svg",146),p(8,"path",87)(9,"path",88),r()(),y(),n(10,"input",42,3),f("change",function(o){u(e);let c=d(2);return g(c.onAvatarSelected(o))}),r()()()}if(a&2){let e=X(5),i=d(2);l(3),m("ngIf",i.userForm.avatar_url)("ngIfElse",e)}}function Ai(a,t){a&1&&(n(0,"span",125),s(1,"*"),r())}function Ri(a,t){if(a&1&&(n(0,"div",148)(1,"div",44),b(),n(2,"svg",45),p(3,"path",46),r(),y(),n(4,"div",47)(5,"p",48),s(6),r()()()()),a&2){let e=d(2);l(6),w(e.error)}}function ji(a,t){a&1&&(b(),n(0,"svg",149),p(1,"path",12),r())}function Ui(a,t){if(a&1){let e=C();n(0,"div",109)(1,"div",110)(2,"div",111),f("click",function(){u(e);let o=d();return g(o.closeModal())}),r(),n(3,"span",112),s(4,"\u200B"),r(),n(5,"div",113)(6,"div",114)(7,"div",115)(8,"div",116),b(),n(9,"svg",117),p(10,"path",118),r()(),y(),n(11,"div",119)(12,"h3",60),s(13),r(),n(14,"div",120)(15,"p",61),s(16),r()()()()(),n(17,"div",121)(18,"form",122),x(19,Di,12,2,"div",123),n(20,"div")(21,"label",124),s(22," Nombre de Usuario "),n(23,"span",125),s(24,"*"),r()(),n(25,"input",126),k("ngModelChange",function(o){u(e);let c=d();return E(c.userForm.username,o)||(c.userForm.username=o),g(o)}),r(),n(26,"p",127),s(27," Solo letras, n\xFAmeros, puntos, guiones y guiones bajos "),r()(),n(28,"div")(29,"label",128),s(30," Nombre Completo "),n(31,"span",125),s(32,"*"),r()(),n(33,"input",129),k("ngModelChange",function(o){u(e);let c=d();return E(c.userForm.full_name,o)||(c.userForm.full_name=o),g(o)}),r()(),n(34,"div")(35,"label",130),s(36),x(37,Ai,2,0,"span",131),r(),n(38,"input",132),k("ngModelChange",function(o){u(e);let c=d();return E(c.userForm.password,o)||(c.userForm.password=o),g(o)}),r(),n(39,"p",127),s(40),r()(),n(41,"div")(42,"label",133),s(43," Perfil de Usuario "),r(),n(44,"select",134),k("ngModelChange",function(o){u(e);let c=d();return E(c.userForm.id_perfil,o)||(c.userForm.id_perfil=o),g(o)}),n(45,"option",32),s(46,"Administrador"),r(),n(47,"option",33),s(48,"Usuario"),r(),n(49,"option",34),s(50,"Supervisor"),r(),n(51,"option",35),s(52,"Invitado"),r()()(),n(53,"div")(54,"label",135),s(55," Estado "),r(),n(56,"select",136),k("ngModelChange",function(o){u(e);let c=d();return E(c.userForm.status,o)||(c.userForm.status=o),g(o)}),n(57,"option",32),s(58,"Activo"),r(),n(59,"option",137),s(60,"Inactivo"),r()()()(),x(61,Ri,7,1,"div",138),r(),n(62,"div",139)(63,"button",140),f("click",function(){u(e);let o=d();return g(o.saveUser())}),x(64,ji,2,0,"svg",141),s(65),r(),n(66,"button",142),f("click",function(){u(e);let o=d();return g(o.closeModal())}),s(67," Cancelar "),r()()()()()}if(a&2){let e=d();l(13),v(" ",e.modalMode==="create"?"Crear Nuevo Usuario":"Editar Usuario"," "),l(3),v(" ",e.modalMode==="create"?"Complete los datos para crear un nuevo usuario.":"Modifique los datos del usuario seleccionado."," "),l(3),m("ngIf",e.modalMode==="edit"),l(6),M("ngModel",e.userForm.username),l(8),M("ngModel",e.userForm.full_name),l(3),v(" ",e.modalMode==="create"?"Contrase\xF1a":"Nueva Contrase\xF1a (opcional)"," "),l(),m("ngIf",e.modalMode==="create"),l(),M("ngModel",e.userForm.password),m("placeholder",e.modalMode==="create"?"M\xEDnimo 6 caracteres":"Dejar vac\xEDo para no cambiar"),l(2),v(" ",e.modalMode==="create"?"M\xEDnimo 6 caracteres":"Dejar vac\xEDo si no desea cambiar la contrase\xF1a"," "),l(4),M("ngModel",e.userForm.id_perfil),l(12),M("ngModel",e.userForm.status),l(5),m("ngIf",e.error),l(2),m("disabled",!e.userForm.username||!e.userForm.full_name||e.modalMode==="create"&&!e.userForm.password),l(),m("ngIf",e.loading),l(),v(" ",e.modalMode==="create"?"Crear Usuario":"Guardar Cambios"," ")}}var st=class a{constructor(t,e){this.supabaseService=t;this.authService=e}usuarios=[];filteredUsuarios=[];loading=!0;error="";searchTerm="";showModal=!1;modalMode="create";selectedUser=null;selectedUserForAvatar=null;userForm={username:"",full_name:"",password:"",status:1,id_perfil:2,avatar_url:""};statusFilter="all";perfilFilter="all";ngOnInit(){return h(this,null,function*(){console.log("UsuariosComponent inicializado"),yield this.loadUsuarios()})}loadUsuarios(){return h(this,null,function*(){this.loading=!0,this.error="";try{console.log("Cargando usuarios desde la base de datos...");let t=yield this.supabaseService.getData("profiles");console.log("Datos recibidos:",t),this.usuarios=t||[],this.filteredUsuarios=[...this.usuarios],this.applyFilters(),console.log("Usuarios cargados exitosamente:",this.usuarios.length)}catch(t){console.error("Error cargando usuarios:",t),this.error="Error al cargar los usuarios. Verifique la conexi\xF3n a la base de datos."}finally{this.loading=!1}})}applyFilters(){let t=[...this.usuarios];if(this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.username?.toLowerCase().includes(e)||i.full_name?.toLowerCase().includes(e))}this.statusFilter==="active"?t=t.filter(e=>e.status===1):this.statusFilter==="inactive"&&(t=t.filter(e=>e.status===0)),this.perfilFilter!=="all"&&(t=t.filter(e=>e.id_perfil===parseInt(this.perfilFilter))),this.filteredUsuarios=t,console.log("Usuarios filtrados:",this.filteredUsuarios.length)}onSearch(){this.applyFilters()}onFilterChange(){this.applyFilters()}openCreateModal(){console.log("Abriendo modal para crear usuario"),this.modalMode="create",this.userForm={username:"",full_name:"",password:"",status:1,id_perfil:2,avatar_url:""},this.error="",this.showModal=!0}openEditModal(t){console.log("Abriendo modal para editar usuario:",t.username),this.modalMode="edit",this.selectedUser=t,this.userForm=Fe(ge({},t),{password:""}),this.error="",this.showModal=!0}closeModal(){console.log("Cerrando modal"),this.showModal=!1,this.selectedUser=null,this.error=""}deactivateUser(t){return h(this,null,function*(){let e=`\xBFEst\xE1 seguro de desactivar al usuario "${t.username}"?`;if(confirm(e))try{console.log("Desactivando usuario:",t.username),yield this.supabaseService.updateData("profiles",t.id.toString(),{status:0}),yield this.loadUsuarios(),console.log("Usuario desactivado exitosamente")}catch(i){console.error("Error desactivando usuario:",i),this.error="Error al desactivar el usuario",setTimeout(()=>this.error="",5e3)}})}reactivateUser(t){return h(this,null,function*(){let e=`\xBFEst\xE1 seguro de reactivar al usuario "${t.username}"?`;if(confirm(e))try{console.log("Reactivando usuario:",t.username),yield this.supabaseService.updateData("profiles",t.id.toString(),{status:1}),yield this.loadUsuarios(),console.log("Usuario reactivado exitosamente")}catch(i){console.error("Error reactivando usuario:",i),this.error="Error al reactivar el usuario",setTimeout(()=>this.error="",5e3)}})}getPerfilName(t){switch(t){case 1:return"Administrador";case 2:return"Usuario";case 3:return"Supervisor";case 4:return"Invitado";default:return"Sin asignar"}}getStatusText(t){return t===1?"Activo":"Inactivo"}getStatusColor(t){return t===1?"green":"red"}formatDate(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(e){return console.error("Error formateando fecha:",e),"Fecha inv\xE1lida"}}refreshUsers(){return h(this,null,function*(){console.log("Refrescando lista de usuarios"),yield this.loadUsuarios()})}clearFilters(){console.log("Limpiando filtros"),this.searchTerm="",this.statusFilter="all",this.perfilFilter="all",this.applyFilters()}trackByUserId(t,e){return e.id||t}changeUserAvatar(t){this.selectedUserForAvatar=t;let e=document.querySelector("#userAvatarFileInput");e&&e.click()}onUserAvatarSelected(t){return h(this,null,function*(){let e=t.target;e.files&&e.files[0]&&this.selectedUserForAvatar&&(yield this.updateUserAvatar(this.selectedUserForAvatar,e.files[0]),e.value="",this.selectedUserForAvatar=null)})}onAvatarSelected(t){return h(this,null,function*(){let e=t.target;if(e.files&&e.files[0]){let i=e.files[0],o=this.validateImageFile(i);if(!o.valid){this.error=o.error||"Archivo inv\xE1lido";return}try{let c=yield this.fileToBase64(i);this.userForm.avatar_url=c,console.log("Avatar seleccionado para el formulario")}catch(c){console.error("Error procesando imagen:",c),this.error="Error al procesar la imagen"}e.value=""}})}updateUserAvatar(t,e){return h(this,null,function*(){try{let i=this.validateImageFile(e);if(!i.valid){alert(i.error||"Archivo inv\xE1lido");return}let o=yield this.fileToBase64(e),c={avatar_url:o};yield this.supabaseService.updateData("profiles",t.id.toString(),c);let _=this.usuarios.findIndex(S=>S.id===t.id);_!==-1&&(this.usuarios[_]=Fe(ge({},this.usuarios[_]),{avatar_url:o}),this.applyFilters()),console.log("Avatar actualizado exitosamente para:",t.username)}catch(i){console.error("Error actualizando avatar:",i),alert("Error al actualizar la foto de perfil")}})}validateImageFile(t){return["image/jpeg","image/jpg","image/png","image/gif"].includes(t.type)?t.size>5242880?{valid:!1,error:"El archivo es demasiado grande. M\xE1ximo 5MB."}:{valid:!0}:{valid:!1,error:"Tipo de archivo no permitido. Use JPG, PNG o GIF."}}fileToBase64(t){return new Promise((e,i)=>{let o=new FileReader;o.readAsDataURL(t),o.onload=()=>e(o.result),o.onerror=c=>i(c)})}resizeImage(t,e=300,i=300,o=.8){return new Promise((c,_)=>{let S=document.createElement("canvas"),P=S.getContext("2d"),T=new Image;T.onload=()=>{let{width:L,height:V}=T;L>V?L>e&&(V=V*e/L,L=e):V>i&&(L=L*i/V,V=i),S.width=L,S.height=V,P?.drawImage(T,0,0,L,V);let B=S.toDataURL(t.type,o);c(B)},T.onerror=_,T.src=URL.createObjectURL(t)})}getUserAvatarUrl(t){return this.authService.getAvatarUrl(t)}getUserInitials(t){return this.authService.getUserInitials(t)}getAvatarColor(t){let e=["bg-indigo-600","bg-green-600","bg-yellow-600","bg-red-600","bg-purple-600","bg-pink-600","bg-blue-600","bg-cyan-600","bg-orange-600"];if(!t.full_name)return"bg-gray-600";let i=t.full_name.charCodeAt(0);return e[i%e.length]}onUserAvatarUpdated(t){let e=this.usuarios.findIndex(i=>i.id===t.id);e!==-1&&(this.usuarios[e]=Fe(ge({},this.usuarios[e]),{avatar_url:t.avatar_url}),this.applyFilters()),console.log("Avatar actualizado para usuario:",t.username)}saveUser(){return h(this,null,function*(){try{if(console.log("Guardando usuario:",this.userForm),this.error="",!this.userForm.username||!this.userForm.full_name){this.error="Nombre de usuario y nombre completo son requeridos";return}if(this.userForm.username.length<3){this.error="El nombre de usuario debe tener al menos 3 caracteres";return}if(!/^[a-zA-Z0-9_.-]+$/.test(this.userForm.username)){this.error="El nombre de usuario solo puede contener letras, n\xFAmeros, guiones, puntos y guiones bajos";return}if(this.modalMode==="create"){if(!this.userForm.password){this.error="La contrase\xF1a es requerida para crear un usuario";return}if(this.userForm.password.length<6){this.error="La contrase\xF1a debe tener al menos 6 caracteres";return}console.log("Verificando si el username existe...");let e=yield this.supabaseService.client.from("profiles").select("username").eq("username",this.userForm.username);if(e.data&&e.data.length>0){this.error="El nombre de usuario ya existe";return}let i={username:this.userForm.username,full_name:this.userForm.full_name,password:this.userForm.password,status:this.userForm.status,id_perfil:this.userForm.id_perfil,avatar_url:this.userForm.avatar_url||null};console.log("Creando usuario:",i),yield this.supabaseService.insertData("profiles",i),console.log("Usuario creado exitosamente")}else{let e={username:this.userForm.username,full_name:this.userForm.full_name,status:this.userForm.status,id_perfil:this.userForm.id_perfil,avatar_url:this.userForm.avatar_url};if(this.userForm.password&&this.userForm.password.length>0){if(this.userForm.password.length<6){this.error="La nueva contrase\xF1a debe tener al menos 6 caracteres";return}e.password=this.userForm.password}console.log("Actualizando usuario:",e),yield this.supabaseService.updateData("profiles",this.selectedUser.id.toString(),e),console.log("Usuario actualizado exitosamente")}yield this.loadUsuarios(),this.closeModal()}catch(t){console.error("Error guardando usuario:",t),this.error="Error al guardar el usuario. Intente nuevamente."}})}static \u0275fac=function(e){return new(e||a)(I(te),I(j))};static \u0275cmp=A({type:a,selectors:[["app-usuarios"]],standalone:!1,decls:60,vars:8,consts:[["userAvatarFileInput",""],["userInitialsTemplate",""],["modalInitialsTemplate",""],["avatarFileInput",""],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],["title","Refrescar lista",1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"md:col-span-2"],["for","search",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],["id","search","type","text","placeholder","Buscar por nombre o usuario...",1,"block","w-full","pl-10","pr-3","py-2","border","border-gray-300","rounded-md","leading-5","bg-white","placeholder-gray-500","focus:outline-none","focus:placeholder-gray-400","focus:ring-1","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","input","ngModel"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["for","statusFilter",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","statusFilter",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","change","ngModel"],["value","all"],["value","active"],["value","inactive"],["for","perfilFilter",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","perfilFilter",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","change","ngModel"],["value","1"],["value","2"],["value","3"],["value","4"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-indigo-600","hover:text-indigo-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","bg-white shadow overflow-hidden sm:rounded-md",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"ml-auto","pl-3"],[1,"text-red-400","hover:text-red-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","justify-center","items-center","h-64"],[1,"text-center"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-indigo-600","mx-auto"],[1,"mt-4","text-gray-600"],[1,"bg-white","shadow","overflow-hidden","sm:rounded-md"],[1,"px-4","py-5","sm:px-6","border-b","border-gray-200"],[1,"flex","justify-between","items-center"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50 transition-colors duration-150",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-12",4,"ngIf"],[1,"hover:bg-gray-50","transition-colors","duration-150"],[1,"px-6","py-4","whitespace-nowrap"],[1,"flex","items-center"],[1,"h-10","w-10","flex-shrink-0","relative"],[1,"h-10","w-10","rounded-full","overflow-hidden","bg-gradient-to-br","from-blue-500","to-purple-600","flex","items-center","justify-center","shadow-lg"],["class","w-full h-full object-cover",3,"src","alt","error",4,"ngIf","ngIfElse"],[1,"absolute","-bottom-0","-right-0","h-3","w-3","rounded-full","border-2","border-white",3,"ngClass"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-900"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["fill","currentColor","viewBox","0 0 8 8",1,"w-2","h-2","mr-1"],["cx","4","cy","4","r","3"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","justify-end","space-x-2"],["title","Cambiar foto de perfil",1,"text-blue-600","hover:text-blue-900","p-1","rounded","hover:bg-blue-50","transition-colors","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 13a3 3 0 11-6 0 3 3 0 016 0z"],["title","Editar usuario",1,"text-indigo-600","hover:text-indigo-900","p-1","rounded","hover:bg-indigo-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["class","text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50 transition-colors duration-150","title","Desactivar usuario",3,"click",4,"ngIf"],["class","text-green-600 hover:text-green-900 p-1 rounded hover:bg-green-50 transition-colors duration-150","title","Reactivar usuario",3,"click",4,"ngIf"],[1,"w-full","h-full","object-cover",3,"error","src","alt"],[1,"text-sm","font-medium","text-white"],["title","Desactivar usuario",1,"text-red-600","hover:text-red-900","p-1","rounded","hover:bg-red-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636"],["title","Reactivar usuario",1,"text-green-600","hover:text-green-900","p-1","rounded","hover:bg-green-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-indigo-600","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-end","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-lg","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-indigo-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-indigo-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"mt-2"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"space-y-4"],["class","flex justify-center",4,"ngIf"],["for","username",1,"block","text-sm","font-medium","text-gray-700"],[1,"text-red-500"],["id","username","type","text","name","username","required","","placeholder","Ej: juan.perez",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"mt-1","text-xs","text-gray-500"],["for","fullName",1,"block","text-sm","font-medium","text-gray-700"],["id","fullName","type","text","name","fullName","required","","placeholder","Ej: Juan P\xE9rez Garc\xEDa",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","password",1,"block","text-sm","font-medium","text-gray-700"],["class","text-red-500",4,"ngIf"],["id","password","type","password","name","password",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel","placeholder"],["for","perfil",1,"block","text-sm","font-medium","text-gray-700"],["id","perfil","name","perfil",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","status",1,"block","text-sm","font-medium","text-gray-700"],["id","status","name","status",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["value","0"],["class","mt-4 bg-red-50 border border-red-200 rounded-md p-3",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-indigo-600","text-base","font-medium","text-white","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","animate-spin -ml-1 mr-3 h-5 w-5 text-white","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","sm:mt-0","sm:ml-3","sm:w-auto","sm:text-sm",3,"click"],[1,"flex","justify-center"],[1,"h-20","w-20","rounded-full","overflow-hidden","bg-gradient-to-br","from-blue-500","to-purple-600","flex","items-center","justify-center","shadow-lg"],["type","button","title","Cambiar foto",1,"absolute","bottom-0","right-0","bg-blue-500","hover:bg-blue-600","text-white","rounded-full","p-1","shadow-lg","transition-all","duration-200","transform","hover:scale-110",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],[1,"text-lg","font-medium","text-white"],[1,"mt-4","bg-red-50","border","border-red-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"]],template:function(e,i){if(e&1){let o=C();n(0,"div",4)(1,"div",5)(2,"div",6)(3,"div")(4,"h1",7),s(5,"Gesti\xF3n de Usuarios"),r(),n(6,"p",8),s(7),r()(),n(8,"div",9)(9,"button",10),f("click",function(){return u(o),g(i.refreshUsers())}),b(),n(10,"svg",11),p(11,"path",12),r(),s(12," Refrescar "),r(),y(),n(13,"button",13),f("click",function(){return u(o),g(i.openCreateModal())}),b(),n(14,"svg",14),p(15,"path",15),r(),s(16," Nuevo Usuario "),r()()()(),y(),n(17,"div",16)(18,"div",17)(19,"div",18)(20,"label",19),s(21," Buscar "),r(),n(22,"div",20)(23,"input",21),k("ngModelChange",function(_){return u(o),E(i.searchTerm,_)||(i.searchTerm=_),g(_)}),f("input",function(){return u(o),g(i.onSearch())}),r(),n(24,"div",22),b(),n(25,"svg",23),p(26,"path",24),r()()()(),y(),n(27,"div")(28,"label",25),s(29," Estado "),r(),n(30,"select",26),k("ngModelChange",function(_){return u(o),E(i.statusFilter,_)||(i.statusFilter=_),g(_)}),f("change",function(){return u(o),g(i.onFilterChange())}),n(31,"option",27),s(32,"Todos"),r(),n(33,"option",28),s(34,"Activos"),r(),n(35,"option",29),s(36,"Inactivos"),r()()(),n(37,"div")(38,"label",30),s(39," Perfil "),r(),n(40,"select",31),k("ngModelChange",function(_){return u(o),E(i.perfilFilter,_)||(i.perfilFilter=_),g(_)}),f("change",function(){return u(o),g(i.onFilterChange())}),n(41,"option",27),s(42,"Todos"),r(),n(43,"option",32),s(44,"Administrador"),r(),n(45,"option",33),s(46,"Usuario"),r(),n(47,"option",34),s(48,"Supervisor"),r(),n(49,"option",35),s(50,"Invitado"),r()()()(),n(51,"div",36)(52,"button",37),f("click",function(){return u(o),g(i.clearFilters())}),s(53," Limpiar filtros "),r()()(),x(54,Ci,11,1,"div",38)(55,wi,5,0,"div",39)(56,Oi,26,7,"div",40),r(),x(57,Ui,68,16,"div",41),n(58,"input",42,0),f("change",function(_){return u(o),g(i.onUserAvatarSelected(_))}),r()}e&2&&(l(7),v(" Administra los usuarios del sistema - Total: ",i.usuarios.length," "),l(16),M("ngModel",i.searchTerm),l(7),M("ngModel",i.statusFilter),l(10),M("ngModel",i.perfilFilter),l(14),m("ngIf",i.error),l(),m("ngIf",i.loading),l(),m("ngIf",!i.loading),l(),m("ngIf",i.showModal))},dependencies:[$,N,R,ee,J,Z,q,Q,W,K,ye,G,de],styles:[`.table-container[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}.user-row[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.user-row[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.modal-backdrop[_ngcontent-%COMP%]{backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px)}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .75rem;border-radius:9999px;font-size:.75rem;font-weight:500;line-height:1}.badge-status[_ngcontent-%COMP%]{gap:.25rem}.action-button[_ngcontent-%COMP%]{transition:all .15s ease-in-out;border-radius:.375rem;padding:.25rem}.action-button[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin:0 auto 1rem;color:#9ca3af}@media (max-width: 640px){.table-container[_ngcontent-%COMP%]{font-size:.875rem}.user-avatar[_ngcontent-%COMP%]{width:2rem;height:2rem}.action-buttons[_ngcontent-%COMP%]{flex-direction:column;gap:.25rem}}.filter-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9);border:1px solid #e2e8f0}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:16rem}.loading-spinner[_ngcontent-%COMP%]{width:3rem;height:3rem;border:2px solid #e5e7eb;border-top:2px solid #4f46e5;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.error-message[_ngcontent-%COMP%]{background-color:#fef2f2;border:1px solid #fecaca;color:#dc2626;padding:1rem;border-radius:.5rem;margin-bottom:1.5rem}.error-icon[_ngcontent-%COMP%]{flex-shrink:0;width:1.25rem;height:1.25rem;color:#f87171}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:50;background-color:#00000080;display:flex;align-items:center;justify-content:center;padding:1rem}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;box-shadow:0 25px 50px -12px #00000040;max-width:32rem;width:100%;max-height:90vh;overflow-y:auto}.form-input[_ngcontent-%COMP%]{transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-input[_ngcontent-%COMP%]:focus{border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e51a;outline:none}.form-select[_ngcontent-%COMP%]{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");background-position:right .5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:2.5rem}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.shadow-subtle[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}.shadow-hover[_ngcontent-%COMP%]{transition:box-shadow .15s ease-in-out}.shadow-hover[_ngcontent-%COMP%]:hover{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}`]})};function Li(a,t){if(a&1&&(n(0,"li"),p(1,"i",110),s(2),r()),a&2){let e=t.$implicit;l(2),v("",e," ")}}function Ni(a,t){if(a&1){let e=C();n(0,"div",103)(1,"div",104)(2,"div",105),p(3,"i"),r(),n(4,"h3",106),s(5),r(),n(6,"p",64),s(7),r(),n(8,"ul",107),x(9,Li,3,1,"li",108),r(),n(10,"button",109),f("click",function(){let o=u(e).$implicit,c=d();return g(c.showMoreInfo(o))}),s(11," M\xE1s informaci\xF3n \u2192 "),r()()()}if(a&2){let e=t.$implicit;l(3),D(e.icon+" text-white text-2xl"),l(2),w(e.title),l(2),w(e.description),l(2),m("ngForOf",e.features)}}function zi(a,t){if(a&1&&(n(0,"div",111)(1,"div",104),p(2,"img",112),n(3,"h4",113),s(4),r(),n(5,"p",114),s(6),r(),n(7,"p",115),s(8),r(),n(9,"p",116),s(10),r()()()),a&2){let e=t.$implicit;l(2),m("src",e.image,me)("alt",e.name),l(2),w(e.name),l(2),w(e.role),l(2),w(e.specialization),l(2),v(" ",e.experience," ")}}function Bi(a,t){a&1&&(n(0,"div",126)(1,"span",127),s(2," M\xE1s Popular "),r()())}function $i(a,t){if(a&1&&(n(0,"li",43),p(1,"i",128),n(2,"span",129),s(3),r()()),a&2){let e=t.$implicit;l(3),w(e)}}function qi(a,t){if(a&1){let e=C();n(0,"div"),x(1,Bi,3,0,"div",117),n(2,"div",118)(3,"div",104)(4,"h3",119),s(5),r(),n(6,"div",120)(7,"span",121),s(8),r(),n(9,"span",122),s(10),r()(),n(11,"ul",123),x(12,$i,4,1,"li",124),r(),n(13,"button",125),f("click",function(){u(e);let o=d();return g(o.bookAppointment())}),s(14),r()()()()}if(a&2){let e=t.$implicit;D("relative bg-white rounded-2xl shadow-lg border "+(e.popular?"border-red-500 ring-2 ring-red-500":"border-gray-200")),l(),m("ngIf",e.popular),l(4),w(e.name),l(3),w(e.price),l(2),w(e.period),l(2),m("ngForOf",e.features),l(),D("w-full py-3 px-6 rounded-lg font-medium transition-colors "+(e.popular?"bg-red-600 text-white hover:bg-red-700":"bg-gray-100 text-gray-900 hover:bg-gray-200")),l(),v(" ",e.buttonText," ")}}var Be=class a{constructor(t){this.router=t}services=[{icon:"fas fa-walking",title:"Evaluaci\xF3n fisioterap\xE9utica personalizada",description:"Realizamos una valoraci\xF3n integral mediante test ortop\xE9dicos, an\xE1lisis de rangos de movimiento, patrones de marcha y pruebas funcionales. Nuestro objetivo es identificar tu condici\xF3n actual, emitir un diagn\xF3stico fisioterap\xE9utico preciso y establecer el mejor plan de tratamiento basado en tus necesidades.",features:["Terapia manual","Ejercicios terap\xE9uticos","Reeducaci\xF3n postural"]},{icon:"fas fa-heartbeat",title:"Fisioterapia Deportiva",description:"Tratamiento especializado para la prevenci\xF3n, recuperaci\xF3n y readaptaci\xF3n de lesiones deportivas. Nos enfocamos en restaurar el movimiento funcional, reducir el dolor y optimizar el rendimiento f\xEDsico mediante ejercicio terap\xE9utico, t\xE9cnicas manuales y programaci\xF3n espec\xEDfica seg\xFAn tu disciplina deportiva.",features:["Prevenci\xF3n de lesiones","Recuperaci\xF3n deportiva","Acondicionamiento f\xEDsico"]},{icon:"fas fa-user-md",title:"Fisioterapia geri\xE1trica",description:"Dise\xF1amos programas de ejercicio seguros y eficaces para personas mayores, basados en herramientas de evaluaci\xF3n cl\xEDnica y funcional. Nuestro enfoque est\xE1 en mejorar fuerza, equilibrio, resistencia y capacidad aer\xF3bica, promoviendo una vejez activa, aut\xF3noma y con prop\xF3sito desde etapas tempranas.",features:["Evaluaci\xF3n completa","Seguimiento continuo","Planes personalizados"]},{icon:"fas fa-spa",title:"Programaci\xF3n de movilidad",description:"A trav\xE9s de ejercicios de movilidad articular, control motor y fuerza, buscamos aumentar tu rango de movimiento y mejorar la calidad del mismo. Ideal para personas con rigidez, dolor, sobrecargas o para quienes desean moverse mejor en su d\xEDa a d\xEDa o actividad f\xEDsica.",features:["Masoterapia","Electroterapia","Termoterapia"]},{icon:"fas fa-spa",title:"Programaci\xF3n de ejercicios funcionales",description:"Creamos un plan de entrenamiento adaptado a tus objetivos individuales: ya sea ganar fuerza, mejorar la postura, prevenir lesiones o aumentar tu rendimiento. Utilizamos movimientos funcionales y progresiones terap\xE9uticas para que alcances tus metas de forma segura, eficiente y sostenible.",features:["Masoterapia","Electroterapia","Termoterapia"]}];pricingPlans=[{name:"B\xE1sico",price:"Q275",period:"por sesi\xF3n",features:["Gu\xEDa de ejercicios","Sesi\xF3n de 45 a 60 minutos","Seguimiento personalizado"],popular:!1,buttonText:"Reservar Cita"},{name:"Profesional",price:"Q1,125",period:"paquete 5 sesiones",features:["Gu\xEDa de ejercicios","Sesiones de 45 a 60 minutos","Seguimiento personalizado"],popular:!0,buttonText:"M\xE1s Popular"},{name:"Premium",price:"Q2,250",period:"paquete 10 sesiones",features:["Gu\xEDa de ejercicios","Sesiones de 45 a 60 minutos","Seguimiento personalizado"],popular:!1,buttonText:"Mejor Valor"}];team=[{name:"Lic. Estuardo Ponciano",role:"Fisioterapeuta Principal",specialization:"Licenciado en fisioterapia",image:"/lucciuki.png",experience:"5 a\xF1os de experiencia"}];ngOnInit(){}scrollToSection(t){let e=document.getElementById(t);e&&e.scrollIntoView({behavior:"smooth"})}goToLogin(){this.router.navigate(["/login"])}contactUs(){this.scrollToSection("contacto")}bookAppointment(){alert("\xA1Pronto podr\xE1s reservar tu cita online! Por ahora cont\xE1ctanos directamente.")}showMoreInfo(t){alert(`M\xE1s informaci\xF3n sobre: ${t.title}

${t.description}`)}getTeamGridClasses(){let t=this.team.length;return t===1?"grid grid-cols-1 justify-items-center":t===2?"grid grid-cols-1 md:grid-cols-2 justify-items-center":"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 justify-items-center"}static \u0275fac=function(e){return new(e||a)(I(ue))};static \u0275cmp=A({type:a,selectors:[["app-landing"]],standalone:!1,decls:264,vars:4,consts:[[1,"min-h-screen","bg-white"],[1,"fixed","top-0","w-full","bg-white/95","backdrop-blur-sm","shadow-sm","z-50"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","items-center","h-16"],[1,"flex","items-center"],[1,"flex-shrink-0","flex","items-center"],[1,"h-8","w-8","bg-red-600","rounded-lg","flex","items-center","justify-center","mr-3"],[1,"fas","fa-heartbeat","text-white"],[1,"text-xl","font-bold","text-gray-900"],[1,"hidden","md:block"],[1,"ml-10","flex","items-baseline","space-x-8"],[1,"text-gray-900","hover:text-red-600","cursor-pointer","transition-colors",3,"click"],[1,"text-gray-700","hover:text-red-600","cursor-pointer","transition-colors",3,"click"],[1,"flex","items-center","space-x-4"],[1,"bg-red-600","text-white","px-4","py-2","rounded-md","hover:bg-red-700","transition-colors",3,"click"],[1,"fas","fa-sign-in-alt","mr-2"],["id","inicio",1,"pt-16","bg-gradient-to-br","from-gray-900","via-gray-800","to-black"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-20"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-12","items-center"],[1,"text-3xl","md:text-6xl","font-bold","text-white","mb-6"],[1,"text-red-500"],[1,"text-xl","text-gray-300","mb-8"],[1,"flex","flex-col","sm:flex-row","gap-4"],[1,"bg-red-600","text-white","px-8","py-3","rounded-lg","hover:bg-red-700","transition-colors","flex","items-center","justify-center",3,"click"],[1,"fas","fa-calendar-check","mr-2"],[1,"border","border-red-600","text-red-500","px-8","py-3","rounded-lg","hover:bg-red-600","hover:text-white","transition-colors",3,"click"],[1,"relative"],[1,"bg-white","rounded-2xl","shadow-2xl","p-8","transform","rotate-3","hover:rotate-0","transition-transform","duration-300"],["src","https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=600&h=400&fit=crop","alt","Fisioterapia",1,"rounded-xl","w-full","h-64","object-cover"],[1,"mt-4"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-gray-600"],["id","servicios",1,"py-20","bg-white"],[1,"max-w-7xl","mx-auto","px-5","sm:px-6","lg:px-8"],[1,"text-center","mb-16"],[1,"text-3xl","md:text-4xl","font-bold","text-gray-900","mb-4"],[1,"text-xl","text-gray-600","max-w-2xl","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-8"],["class","bg-gray-50 rounded-xl p-6 hover:shadow-lg transition-shadow duration-300 hover:border-red-200 border border-transparent",4,"ngFor","ngForOf"],["id","nosotros",1,"py-20","bg-gray-100"],[1,"text-3xl","md:text-4xl","font-bold","text-gray-900","mb-6"],[1,"text-lg","text-gray-600","mb-6"],[1,"space-y-4"],[1,"flex","items-start"],[1,"w-8","h-8","bg-red-600","rounded-full","flex","items-center","justify-center","mr-4","mt-1"],[1,"fas","fa-award","text-white","text-sm"],[1,"font-semibold","text-gray-900"],[1,"fas","fa-heart","text-white","text-sm"],[1,"fas","fa-cogs","text-white","text-sm"],["src","https://images.unsplash.com/photo-1576091160399-112ba8d25d1f?w=600&h=500&fit=crop","alt","Equipo m\xE9dico",1,"rounded-2xl","shadow-2xl"],[1,"absolute","-bottom-6","-left-6","bg-white","rounded-xl","p-6","shadow-lg"],[1,"w-12","h-12","bg-red-100","rounded-full","flex","items-center","justify-center","mr-4"],[1,"fas","fa-users","text-red-600","text-xl"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"mt-20"],[1,"text-2xl","md:text-3xl","font-bold","text-gray-900","text-center","mb-12"],[1,"flex","justify-center"],[1,"gap-8","max-w-4xl",3,"ngClass"],["class","bg-white rounded-xl p-8 shadow-lg hover:shadow-xl transition-shadow border border-gray-200 hover:border-red-200",4,"ngFor","ngForOf"],["id","precios",1,"py-20","bg-white"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-8"],[3,"class",4,"ngFor","ngForOf"],[1,"text-center","mt-12"],[1,"text-gray-600","mb-4"],[1,"text-red-600","hover:text-red-800","font-medium",3,"click"],["id","contacto",1,"py-20","bg-gray-100"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-12"],[1,"space-y-8"],[1,"w-12","h-12","bg-red-600","rounded-full","flex","items-center","justify-center","mr-4"],[1,"fas","fa-map-marker-alt","text-white"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"fas","fa-phone","text-white"],[1,"fas","fa-envelope","text-white"],[1,"fas","fa-clock","text-white"],[1,"bg-white","rounded-2xl","shadow-lg","p-8"],[1,"text-2xl","font-bold","text-gray-900","mb-6"],[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-red-500","focus:border-transparent"],["type","email",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-red-500","focus:border-transparent"],["type","tel",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-red-500","focus:border-transparent"],["rows","4",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-red-500","focus:border-transparent"],["type","submit",1,"w-full","bg-red-600","text-white","py-3","px-6","rounded-lg","hover:bg-red-700","transition-colors"],[1,"fas","fa-paper-plane","mr-2"],[1,"bg-gray-900","text-white","py-12"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-8"],[1,"flex","items-center","mb-4"],[1,"text-xl","font-bold"],[1,"text-gray-400"],[1,"font-semibold","mb-4"],[1,"space-y-2","text-gray-400"],["href","#",1,"hover:text-red-400","transition-colors"],[1,"hover:text-red-400","transition-colors","cursor-pointer",3,"click"],[1,"flex","space-x-4"],["href","https://www.facebook.com/RehabiMovementGT","target","_blank",1,"w-10","h-10","bg-red-600","rounded-full","flex","items-center","justify-center","hover:bg-red-700","transition-colors"],[1,"fab","fa-facebook-f"],["href","https://www.instagram.com/rehabimovementgt/","target","_blank",1,"w-10","h-10","bg-red-600","rounded-full","flex","items-center","justify-center","hover:bg-red-700","transition-colors"],[1,"fab","fa-instagram"],["href","#","target","_blank",1,"w-10","h-10","b]g-red-600","rounded-full","flex","items-center","justify-center","hover:bg-red-700","transition-colors"],[1,"fab","fa-whatsapp"],[1,"border-t","border-gray-800","mt-12","pt-8","text-center","text-gray-400"],[1,"bg-gray-50","rounded-xl","p-6","hover:shadow-lg","transition-shadow","duration-300","hover:border-red-200","border","border-transparent"],[1,"text-center"],[1,"w-16","h-16","bg-red-600","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-xl","font-semibold","text-gray-900","mb-3"],[1,"text-sm","text-gray-500","space-y-1"],[4,"ngFor","ngForOf"],[1,"mt-4","text-red-600","hover:text-red-800","font-medium",3,"click"],[1,"fas","fa-check","text-red-600","mr-2"],[1,"bg-white","rounded-xl","p-8","shadow-lg","hover:shadow-xl","transition-shadow","border","border-gray-200","hover:border-red-200"],[1,"w-32","h-32","rounded-full","mx-auto","mb-6","object-cover","border-4","border-red-100",3,"src","alt"],[1,"text-2xl","font-semibold","text-gray-900","mb-2"],[1,"text-red-600","font-medium","text-lg","mb-3"],[1,"text-gray-600","mb-2"],[1,"text-gray-500","text-sm","bg-gray-50","px-4","py-2","rounded-full","inline-block"],["class","absolute -top-4 left-1/2 transform -translate-x-1/2",4,"ngIf"],[1,"p-8"],[1,"text-2xl","font-bold","text-gray-900","mb-4"],[1,"mb-6"],[1,"text-4xl","font-bold","text-red-600"],[1,"text-gray-600","ml-2"],[1,"space-y-3","mb-8"],["class","flex items-start",4,"ngFor","ngForOf"],[3,"click"],[1,"absolute","-top-4","left-1/2","transform","-translate-x-1/2"],[1,"bg-red-600","text-white","px-4","py-1","rounded-full","text-sm","font-medium"],[1,"fas","fa-check","text-red-600","mr-3","mt-1"],[1,"text-gray-700"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"nav",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),p(7,"i",7),r(),n(8,"span",8),s(9,"RehabiMovement"),r()()(),n(10,"div",9)(11,"div",10)(12,"a",11),f("click",function(){return i.scrollToSection("inicio")}),s(13,"Inicio"),r(),n(14,"a",12),f("click",function(){return i.scrollToSection("servicios")}),s(15,"Servicios"),r(),n(16,"a",12),f("click",function(){return i.scrollToSection("nosotros")}),s(17,"Nosotros"),r(),n(18,"a",12),f("click",function(){return i.scrollToSection("precios")}),s(19,"Precios"),r(),n(20,"a",12),f("click",function(){return i.scrollToSection("contacto")}),s(21,"Contacto"),r()()(),n(22,"div",13)(23,"button",14),f("click",function(){return i.goToLogin()}),p(24,"i",15),s(25,"Login "),r()()()()(),n(26,"section",16)(27,"div",17)(28,"div",18)(29,"div")(30,"h1",19),s(31," Recupera y optimiza "),n(32,"span",20),s(33,"Tu Movimiento"),r()(),n(34,"p",21),s(35," Fisioterapia especializada en Guatemala. El movimiento es vida. Nosotros te ayudamos a recuperarlo. Devolvemos calidad de vida a nuestros pacientes a trav\xE9s de tratamientos personalizados que combinan ejercicio terap\xE9utico, atenci\xF3n cercana y rehabilitaci\xF3n basada en evidencia. Dise\xF1amos planes \xFAnicos para cada etapa de la vida, enfoc\xE1ndonos en el movimiento, la funcionalidad y tu bienestar integral. "),r(),n(36,"div",22)(37,"button",23),f("click",function(){return i.bookAppointment()}),p(38,"i",24),s(39," Reservar Cita "),r(),n(40,"button",25),f("click",function(){return i.scrollToSection("servicios")}),s(41," Conocer Servicios "),r()()(),n(42,"div",26)(43,"div",27),p(44,"img",28),n(45,"div",29)(46,"h3",30),s(47,"Tratamiento Profesional"),r(),n(48,"p",31),s(49,"Con equipos de \xFAltima generaci\xF3n"),r()()()()()()(),n(50,"section",32)(51,"div",33)(52,"div",34)(53,"h2",35),s(54," Nuestros Servicios "),r(),n(55,"p",36),s(56," Ofrecemos una amplia gama de servicios especializaos para tu recuperaci\xF3n y bienestar "),r()(),n(57,"div",37),x(58,Ni,12,5,"div",38),r()()(),n(59,"section",39)(60,"div",2)(61,"div",18)(62,"div")(63,"h2",40),s(64," Qui\xE9nes Somos "),r(),n(65,"p",41),s(66," RehabiMovement es una cl\xEDnica de fisioterapia ubicada en zona 15, Ciudad de Guatemala, comprometida con devolver el movimiento y la calidad de vida a nuestros pacientes. Nos especializamos en la atenci\xF3n personalizada a trav\xE9s del ejercicio terap\xE9utico, siendo este el pilar fundamental de nuestros tratamientos. "),r(),n(67,"p",41),s(68," Con m\xE1s de 5 a\xF1os de experiencia cl\xEDnica, hemos acompa\xF1ado a cientos de personas en su proceso de rehabilitaci\xF3n, desde adultos mayores hasta deportistas, ayud\xE1ndoles a recuperar su funcionalidad, reducir el dolor y alcanzar sus objetivos de salud. "),r(),n(69,"p",41),s(70," Creemos firmemente en el poder del movimiento, el trato humano y la planificaci\xF3n basada en evidencia cient\xEDfica. Nuestro equipo est\xE1 en constante formaci\xF3n para ofrecerte lo mejor de la fisioterapia actual, adaptada a tus necesidades espec\xEDficas. "),r(),n(71,"div",42)(72,"div",43)(73,"div",44),p(74,"i",45),r(),n(75,"div")(76,"h4",46),s(77,"Profesionales Certificados"),r(),n(78,"p",31),s(79,"Nuestro equipo cuenta con las mejores certificaciones internacionales"),r()()(),n(80,"div",43)(81,"div",44),p(82,"i",47),r(),n(83,"div")(84,"h4",46),s(85,"Atenci\xF3n Personalizada"),r(),n(86,"p",31),s(87,"Cada paciente recibe un plan de tratamiento \xFAnico y personalizado"),r()()(),n(88,"div",43)(89,"div",44),p(90,"i",48),r(),n(91,"div")(92,"h4",46),s(93,"Tecnolog\xEDa Avanzada"),r(),n(94,"p",31),s(95,"Utilizamos equipos de \xFAltima generaci\xF3n para mejores resultados"),r()()()()(),n(96,"div",26),p(97,"img",49),n(98,"div",50)(99,"div",4)(100,"div",51),p(101,"i",52),r(),n(102,"div")(103,"p",53),s(104,"500+"),r(),n(105,"p",54),s(106,"Pacientes Satisfechos"),r()()()()()(),n(107,"div",55)(108,"h3",56),s(109," Nuestro Equipo "),r(),n(110,"div",57)(111,"div",58),x(112,zi,11,6,"div",59),r()()()()(),n(113,"section",60)(114,"div",2)(115,"div",34)(116,"h2",35),s(117," Nuestros Precios "),r(),n(118,"p",36),s(119," Planes accesibles para todos los presupuestos. Inversi\xF3n en tu salud y bienestar. "),r()(),n(120,"div",61),x(121,qi,15,10,"div",62),r(),n(122,"div",63)(123,"p",64),s(124," \xBFNecesitas un plan personalizado? "),r(),n(125,"button",65),f("click",function(){return i.contactUs()}),s(126," Cont\xE1ctanos para una consulta gratuita \u2192 "),r()()()(),n(127,"section",66)(128,"div",2)(129,"div",34)(130,"h2",35),s(131," Cont\xE1ctenos "),r(),n(132,"p",36),s(133," Estamos aqu\xED para ayudarte. Cont\xE1ctanos para programar tu consulta inicial. "),r()(),n(134,"div",67)(135,"div")(136,"div",68)(137,"div",43)(138,"div",69),p(139,"i",70),r(),n(140,"div")(141,"h4",71),s(142,"Direcci\xF3n"),r(),n(143,"p",31),s(144," Zona 15, Ciudad de Guatemala"),p(145,"br"),s(146," 19 avenida, 4-02 Vista Hermosa I"),p(147,"br"),s(148," Guatemala, Guatemala "),r()()(),n(149,"div",43)(150,"div",69),p(151,"i",72),r(),n(152,"div")(153,"h4",71),s(154,"Tel\xE9fono"),r(),n(155,"p",31),s(156," +502 5412-1199"),p(157,"br"),s(158," +502 5879-5979 "),r()()(),n(159,"div",43)(160,"div",69),p(161,"i",73),r(),n(162,"div")(163,"h4",71),s(164,"Email"),r(),n(165,"p",31),s(166," rehabimovementgt@gmail.com"),p(167,"br"),r()()(),n(168,"div",43)(169,"div",69),p(170,"i",74),r(),n(171,"div")(172,"h4",71),s(173,"Horarios"),r(),n(174,"p",31),s(175," Lunes a Viernes: 7:00 AM - 8:00 PM"),p(176,"br"),s(177," S\xE1bados: 8:00 AM - 4:00 PM"),p(178,"br"),s(179," Domingos: Cerrado "),r()()()()(),n(180,"div",75)(181,"h3",76),s(182,"Env\xEDanos un mensaje"),r(),n(183,"form",77)(184,"div",78)(185,"div")(186,"label",79),s(187,"Nombre"),r(),p(188,"input",80),r(),n(189,"div")(190,"label",79),s(191,"Apellido"),r(),p(192,"input",80),r()(),n(193,"div")(194,"label",79),s(195,"Email"),r(),p(196,"input",81),r(),n(197,"div")(198,"label",79),s(199,"Tel\xE9fono"),r(),p(200,"input",82),r(),n(201,"div")(202,"label",79),s(203,"Mensaje"),r(),p(204,"textarea",83),r(),n(205,"button",84),p(206,"i",85),s(207," Enviar Mensaje "),r()()()()()(),n(208,"footer",86)(209,"div",2)(210,"div",87)(211,"div")(212,"div",88)(213,"div",6),p(214,"i",7),r(),n(215,"span",89),s(216,"RehabiMovement"),r()(),n(217,"p",90),s(218," Recupera tu movimiento y mejora tu calidad de vida con nuestros tratamientos especializados. "),r()(),n(219,"div")(220,"h4",91),s(221,"Servicios"),r(),n(222,"ul",92)(223,"li")(224,"a",93),s(225,"Rehabilitaci\xF3n Motora"),r()(),n(226,"li")(227,"a",93),s(228,"Fisioterapia Deportiva"),r()(),n(229,"li")(230,"a",93),s(231,"Terapia Personalizada"),r()(),n(232,"li")(233,"a",93),s(234,"Terapias Alternativas"),r()()()(),n(235,"div")(236,"h4",91),s(237,"Enlaces"),r(),n(238,"ul",92)(239,"li")(240,"a",94),f("click",function(){return i.scrollToSection("inicio")}),s(241,"Inicio"),r()(),n(242,"li")(243,"a",94),f("click",function(){return i.scrollToSection("nosotros")}),s(244,"Nosotros"),r()(),n(245,"li")(246,"a",94),f("click",function(){return i.scrollToSection("precios")}),s(247,"Precios"),r()(),n(248,"li")(249,"a",94),f("click",function(){return i.scrollToSection("contacto")}),s(250,"Contacto"),r()()()(),n(251,"div")(252,"h4",91),s(253,"S\xEDguenos"),r(),n(254,"div",95)(255,"a",96),p(256,"i",97),r(),n(257,"a",98),p(258,"i",99),r(),n(259,"a",100),p(260,"i",101),r()()()(),n(261,"div",102)(262,"p"),s(263,"\xA9 2025 RehabiMovement. Todos los derechos reservados."),r()()()()()),e&2&&(l(58),m("ngForOf",i.services),l(53),m("ngClass",i.getTeamGridClasses()),l(),m("ngForOf",i.team),l(9),m("ngForOf",i.pricingPlans))},dependencies:[$,N,R,ee,K,de],styles:['html[_ngcontent-%COMP%]{scroll-behavior:smooth}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}.hero-title[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp 1s ease-out}.hero-subtitle[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp 1s ease-out .2s both}.hero-buttons[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp 1s ease-out .4s both}.hero-image[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp 1s ease-out .6s both}.hero-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_float 3s ease-in-out infinite}.service-card[_ngcontent-%COMP%]{transition:all .3s ease}.service-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;border-color:#dc2626!important}.service-icon[_ngcontent-%COMP%]{transition:all .3s ease}.service-card[_ngcontent-%COMP%]:hover   .service-icon[_ngcontent-%COMP%]{transform:scale(1.1);animation:_ngcontent-%COMP%_pulse 2s infinite}.team-card[_ngcontent-%COMP%]{transition:all .3s ease;max-width:350px}.team-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);border-color:#dc2626!important}.team-avatar[_ngcontent-%COMP%]{transition:all .3s ease}.team-card[_ngcontent-%COMP%]:hover   .team-avatar[_ngcontent-%COMP%]{transform:scale(1.1)}.team-single[_ngcontent-%COMP%]{max-width:400px;margin:0 auto}.team-single[_ngcontent-%COMP%]   .team-avatar[_ngcontent-%COMP%]{width:8rem;height:8rem;border-width:4px}.team-experience-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#e2e8f0);border:1px solid #e2e8f0}.pricing-card[_ngcontent-%COMP%]{transition:all .3s ease}.pricing-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.navbar[_ngcontent-%COMP%]{backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}.nav-link[_ngcontent-%COMP%]{position:relative;transition:all .3s ease}.nav-link[_ngcontent-%COMP%]:hover{color:#dc2626}.nav-link[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-2px;left:0;width:0;height:2px;background-color:#dc2626;transition:width .3s ease}.nav-link[_ngcontent-%COMP%]:hover:after{width:100%}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc2626,#b91c1c);transition:all .3s ease}.btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#b91c1c,#991b1b);transform:translateY(-2px);box-shadow:0 10px 20px #dc26264d}.btn-secondary[_ngcontent-%COMP%]{transition:all .3s ease;border-color:#dc2626;color:#dc2626}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#dc2626;color:#fff;transform:translateY(-2px);box-shadow:0 10px 20px #dc26264d}.form-input[_ngcontent-%COMP%]{transition:all .3s ease}.form-input[_ngcontent-%COMP%]:focus{border-color:#dc2626;box-shadow:0 0 0 3px #dc26261a}.gradient-bg[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#111827)}.gradient-text[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc2626,#991b1b);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.hero-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#111827,#000)}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#dc2626;border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#b91c1c}.text-accent[_ngcontent-%COMP%]{color:#dc2626}.bg-accent[_ngcontent-%COMP%]{background-color:#dc2626}.border-accent[_ngcontent-%COMP%]{border-color:#dc2626}.hover-accent[_ngcontent-%COMP%]:hover{color:#dc2626}@media (max-width: 768px){.hero-title[_ngcontent-%COMP%]{font-size:2.5rem}.section-title[_ngcontent-%COMP%]{font-size:2rem}.mobile-menu[_ngcontent-%COMP%]{display:block}.desktop-menu[_ngcontent-%COMP%]{display:none}}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:-468px 0}to{background-position:468px 0}}.loading-shimmer[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shimmer 1.5s ease-in-out infinite;background:linear-gradient(to right,#f6f7f8,#edeef1 20%,#f6f7f8 40% 100%);background-size:800px 104px}.tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip[_ngcontent-%COMP%]   .tooltiptext[_ngcontent-%COMP%]{visibility:hidden;width:120px;background-color:#1f2937;color:#fff;text-align:center;border-radius:6px;padding:5px 0;position:absolute;z-index:1;bottom:150%;left:50%;margin-left:-60px;opacity:0;transition:opacity .3s}.tooltip[_ngcontent-%COMP%]:hover   .tooltiptext[_ngcontent-%COMP%]{visibility:visible;opacity:1}.card-shadow[_ngcontent-%COMP%]{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.card-shadow-lg[_ngcontent-%COMP%]{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}.card-shadow-xl[_ngcontent-%COMP%]{box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.card-shadow-red[_ngcontent-%COMP%]:hover{box-shadow:0 20px 25px -5px #dc26261a,0 10px 10px -5px #dc26260a}.stat-counter[_ngcontent-%COMP%]{transition:all .3s ease}.stat-counter[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.section-padding[_ngcontent-%COMP%]{padding:5rem 0}@media (max-width: 768px){.section-padding[_ngcontent-%COMP%]{padding:3rem 0}}.image-overlay[_ngcontent-%COMP%]{position:relative;overflow:hidden}.image-overlay[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(45deg,#dc26261a,#b91c1c1a);opacity:0;transition:opacity .3s ease}.image-overlay[_ngcontent-%COMP%]:hover:before{opacity:1}.contact-form[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8fafc)}.contact-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.contact-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#374151;margin-bottom:.5rem;display:block}.contact-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .contact-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:1px solid #d1d5db;border-radius:.5rem;font-size:1rem;transition:all .3s ease}.contact-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .contact-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#dc2626;box-shadow:0 0 0 3px #dc26261a}.footer[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#111827)}.footer-link[_ngcontent-%COMP%]{transition:all .3s ease}.footer-link[_ngcontent-%COMP%]:hover{color:#fca5a5;transform:translate(4px)}.social-btn[_ngcontent-%COMP%]{transition:all .3s ease}.social-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #dc26264d}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.focus-visible[_ngcontent-%COMP%]:focus{outline:2px solid #dc2626;outline-offset:2px}.btn-red[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc2626,#b91c1c);color:#fff;transition:all .3s ease}.btn-red[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#b91c1c,#991b1b);transform:translateY(-2px);box-shadow:0 8px 16px #dc26264d}.btn-red-outline[_ngcontent-%COMP%]{border:2px solid #dc2626;color:#dc2626;background:transparent;transition:all .3s ease}.btn-red-outline[_ngcontent-%COMP%]:hover{background:#dc2626;color:#fff;transform:translateY(-2px)}.dark-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#111827,#000)}.dark-card[_ngcontent-%COMP%]{background:#1f2937cc;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.3)}@media print{.no-print[_ngcontent-%COMP%]{display:none}*[_ngcontent-%COMP%]{-webkit-print-color-adjust:exact!important;color-adjust:exact!important}.card[_ngcontent-%COMP%]{box-shadow:none;border:1px solid #e5e7eb}.text-red-600[_ngcontent-%COMP%], .bg-red-600[_ngcontent-%COMP%]{color:#dc2626!important;background-color:#dc2626!important}}']})};var Wt=a=>[a];function Wi(a,t){if(a&1&&p(0,"i"),a&2){let e=d(2).$implicit;D("flex-shrink-0 w-5 h-5 mr-3 "+e.icono)}}function Gi(a,t){a&1&&(b(),n(0,"svg",55),p(1,"path",56),r())}function Hi(a,t){if(a&1&&(b(),n(0,"svg",57),p(1,"path",58),r()),a&2){let e=d(2).$implicit,i=d();D("w-4 h-4 transition-transform duration-200 module-arrow "+(i.isModuleExpanded(e.id_modulo)?"module-expanded":""))}}function Yi(a,t){if(a&1&&p(0,"i"),a&2){let e=d().$implicit;D("flex-shrink-0 w-4 h-4 mr-3 "+e.icono)}}function Qi(a,t){a&1&&(b(),n(0,"svg",63),p(1,"path",64),r())}function Ji(a,t){if(a&1){let e=C();n(0,"a",61),f("click",function(){u(e);let o=d(4);return g(o.handleNavigation())}),x(1,Yi,1,2,"i",51)(2,Qi,2,0,"svg",62),s(3),r()}if(a&2){let e=t.$implicit;m("routerLink",kt(4,Wt,e.ruta)),l(),m("ngIf",e.icono),l(),m("ngIf",!e.icono),l(),v(" ",e.nombre," ")}}function Zi(a,t){if(a&1&&(n(0,"div",59),x(1,Ji,4,6,"a",60),r()),a&2){let e=d(2).$implicit,i=d();l(),m("ngForOf",i.getFilteredChildren(e))}}function Xi(a,t){if(a&1){let e=C();n(0,"div")(1,"button",50),f("click",function(){u(e);let o=d().$implicit,c=d();return g(c.toggleModule(o.id_modulo))}),x(2,Wi,1,2,"i",51)(3,Gi,2,0,"svg",52),n(4,"span"),s(5),r(),x(6,Hi,2,2,"svg",53),r(),x(7,Zi,2,1,"div",54),r()}if(a&2){let e=d().$implicit,i=d();l(),m("disabled",i.isSidebarCollapsed&&!i.isMobile()),Le("data-tooltip",i.isSidebarCollapsed&&!i.isMobile()?e.nombre:null),l(),m("ngIf",e.icono),l(),m("ngIf",!e.icono),l(),D(i.isSidebarCollapsed&&!i.isMobile()?"hidden":"flex-1 text-left"),l(),w(e.nombre),l(),m("ngIf",!i.isSidebarCollapsed||i.isMobile()),l(),m("ngIf",i.isModuleExpanded(e.id_modulo)&&(!i.isSidebarCollapsed||i.isMobile()))}}function Ki(a,t){if(a&1&&p(0,"i"),a&2){let e=d(2).$implicit;D("flex-shrink-0 w-5 h-5 mr-3 "+e.icono)}}function en(a,t){a&1&&(b(),n(0,"svg",55),p(1,"path",56),r())}function tn(a,t){if(a&1){let e=C();n(0,"a",65),f("click",function(){u(e);let o=d(2);return g(o.handleNavigation())}),x(1,Ki,1,2,"i",51)(2,en,2,0,"svg",52),n(3,"span"),s(4),r()()}if(a&2){let e=d().$implicit,i=d();m("routerLink",kt(7,Wt,e.ruta)),Le("data-tooltip",i.isSidebarCollapsed&&!i.isMobile()?e.nombre:null),l(),m("ngIf",e.icono),l(),m("ngIf",!e.icono),l(),D(i.isSidebarCollapsed&&!i.isMobile()?"hidden":"block"),l(),w(e.nombre)}}function nn(a,t){if(a&1&&(n(0,"div",12),x(1,Xi,8,9,"div",48)(2,tn,5,9,"a",49),r()),a&2){let e=t.$implicit,i=d();l(),m("ngIf",e.es_padre&&i.getFilteredChildren(e).length>0),l(),m("ngIf",!e.es_padre||i.getFilteredChildren(e).length===0)}}function rn(a,t){if(a&1){let e=C();n(0,"img",66),f("error",function(o){return u(e),g(o.target.style.display="none")}),r()}if(a&2){let e=d();m("src",e.getCurrentUserAvatarUrl(),me)("alt",(e.currentUser==null?null:e.currentUser.full_name)||"Avatar")}}function on(a,t){if(a&1&&(n(0,"span",67),s(1),r()),a&2){let e=d();l(),v(" ",e.getUserInitials()," ")}}function an(a,t){a&1&&(n(0,"div",68),p(1,"div",69),r())}function sn(a,t){if(a&1){let e=C();n(0,"button",70),f("click",function(){u(e),d();let o=X(34);return g(o.click())}),b(),n(1,"svg",71),p(2,"path",72)(3,"path",73),r()()}}function ln(a,t){if(a&1){let e=C();n(0,"button",74),f("click",function(){u(e);let o=d();return g(o.toggleDropdown())}),b(),n(1,"svg",75),p(2,"path",76),r()()}}function cn(a,t){if(a&1){let e=C();n(0,"button",77),f("click",function(){u(e);let o=d();return g(o.logout())}),b(),n(1,"svg",75),p(2,"path",45),r()()}}function dn(a,t){if(a&1){let e=C();n(0,"div",78)(1,"button",79),f("click",function(){u(e);let o=d();return g(o.openProfileModal())}),p(2,"i",80),s(3," Mi Perfil "),r(),n(4,"button",79),f("click",function(){u(e);let o=d();return g(o.goToSettings())}),p(5,"i",81),s(6," Configuraci\xF3n "),r(),n(7,"button",79),f("click",function(){u(e);let o=d();return X(34).click(),g(o.showDropdown=!1)}),p(8,"i",82),s(9," Cambiar Foto "),r(),p(10,"hr",83),n(11,"button",84),f("click",function(){u(e);let o=d();return g(o.logout())}),p(12,"i",85),s(13," Cerrar Sesi\xF3n "),r()()}}function mn(a,t){if(a&1){let e=C();n(0,"div",86),f("click",function(){u(e);let o=d();return g(o.closeMobileMenu())}),r()}}function pn(a,t){if(a&1){let e=C();n(0,"button",87),f("click",function(){u(e);let o=d();return g(o.openMobileMenu())}),b(),n(1,"svg",88),p(2,"path",89),r()()}}function un(a,t){if(a&1){let e=C();n(0,"img",66),f("error",function(o){return u(e),g(o.target.style.display="none")}),r()}if(a&2){let e=d();m("src",e.getCurrentUserAvatarUrl(),me)("alt",(e.currentUser==null?null:e.currentUser.full_name)||"Avatar")}}function gn(a,t){if(a&1&&(n(0,"span",90),s(1),r()),a&2){let e=d();l(),v(" ",e.getUserInitials()," ")}}var lt=class a{constructor(t,e,i,o){this.authService=t;this.permissionsService=e;this.supabaseService=i;this.router=o}currentUser=null;menuItems=[];isSidebarCollapsed=!1;isMobileMenuOpen=!1;currentRoute="";expandedModules=new Set;loading=!1;isMobileView=!1;showDropdown=!1;isUploadingAvatar=!1;stats={totalUsers:0,activeProjects:23,pendingTasks:47,totalReports:156};subscriptions=new $e;showPaquetesMenu=!1;onResize(t){this.checkViewportSize()}ngOnInit(){return h(this,null,function*(){if(console.log("Layout inicializado"),this.checkViewportSize(),this.currentUser=this.authService.getCurrentUser(),!this.currentUser){console.log("No hay usuario autenticado, redirigiendo a login"),this.router.navigate(["/login"]);return}yield this.loadUserMenu(),yield this.loadDashboardStats(),this.subscriptions.add(this.router.events.pipe(qe(t=>t instanceof Ze)).subscribe(t=>{this.currentRoute=t.urlAfterRedirects,this.isMobileMenuOpen&&this.closeMobileMenu(),console.log("Ruta actual en layout:",this.currentRoute)})),this.currentRoute=this.router.url})}ngOnDestroy(){this.subscriptions.unsubscribe()}checkViewportSize(){let t=this.isMobileView;this.isMobileView=window.innerWidth<=768,t!==this.isMobileView&&(this.isMobileView?(this.isMobileMenuOpen=!1,this.isSidebarCollapsed=!1):this.isMobileMenuOpen=!1)}isMobile(){return this.isMobileView}getSidebarClasses(){let t="sidebar text-white transition-all duration-300 ease-in-out ";return this.isMobile()?t+=this.isMobileMenuOpen?"sidebar-mobile-open":"":t+=this.isSidebarCollapsed?"sidebar-collapsed":"sidebar-expanded",t}getMainContentClasses(){let t="transition-smooth flex flex-col min-h-screen ";return this.isMobile()||(t+=this.isSidebarCollapsed?"main-content-collapsed":"main-content-expanded"),t}loadUserMenu(){return h(this,null,function*(){try{console.log("Cargando men\xFA del usuario en layout..."),this.menuItems=yield this.permissionsService.loadUserMenu(),(!this.menuItems||this.menuItems.length===0)&&(console.log("No se obtuvo men\xFA de la BD, usando men\xFA por defecto"),this.menuItems=this.createDefaultMenu()),this.updateExpandedModules(),console.log("Men\xFA cargado en layout:",this.menuItems)}catch(t){console.error("Error cargando men\xFA:",t),this.menuItems=this.createDefaultMenu(),this.updateExpandedModules()}})}createDefaultMenu(){return[{id_modulo:1,nombre:"Dashboard",descripcion:"Panel principal",icono:"fas fa-tachometer-alt",ruta:"/dashboard",orden:1,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1},{id_modulo:2,nombre:"Mis Rutinas",descripcion:"Gesti\xF3n de rutinas de entrenamiento",icono:"fas fa-dumbbell",ruta:"/rutinas",orden:2,es_padre:!0,modulo_padre_id:null,permisos:["view"],expanded:!1,children:[{id_modulo:7,nombre:"Ver Rutinas",descripcion:"Ver todas mis rutinas",icono:"fas fa-eye",ruta:"/rutinas/lista",orden:1,es_padre:!1,modulo_padre_id:2,permisos:["view"],expanded:!1},{id_modulo:8,nombre:"Crear Rutina",descripcion:"Crear nueva rutina",icono:"fas fa-plus",ruta:"/rutinas/crear",orden:2,es_padre:!1,modulo_padre_id:2,permisos:["create"],expanded:!1},{id_modulo:9,nombre:"Ejercicios",descripcion:"Biblioteca de ejercicios",icono:"fas fa-list",ruta:"/rutinas/ejercicios",orden:3,es_padre:!1,modulo_padre_id:2,permisos:["view"],expanded:!1}]},{id_modulo:3,nombre:"Usuarios",descripcion:"Gesti\xF3n de usuarios",icono:"fas fa-users",ruta:"/usuarios",orden:3,es_padre:!0,modulo_padre_id:null,permisos:["view"],expanded:!1,children:[{id_modulo:10,nombre:"Lista de Usuarios",descripcion:"Ver todos los usuarios",icono:"fas fa-list",ruta:"/usuarios/lista",orden:1,es_padre:!1,modulo_padre_id:3,permisos:["view"],expanded:!1},{id_modulo:11,nombre:"Crear Usuario",descripcion:"Crear nuevo usuario",icono:"fas fa-user-plus",ruta:"/usuarios/crear",orden:2,es_padre:!1,modulo_padre_id:3,permisos:["create"],expanded:!1}]},{id_modulo:4,nombre:"Reportes",descripcion:"Sistema de reportes",icono:"fas fa-chart-bar",ruta:"/reportes",orden:4,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1},{id_modulo:5,nombre:"Configuraci\xF3n",descripcion:"Configuraci\xF3n del sistema",icono:"fas fa-cog",ruta:"/configuracion",orden:5,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1}]}loadDashboardStats(){return h(this,null,function*(){try{let t=yield this.supabaseService.getData("profiles");this.stats.totalUsers=t?.length||0}catch(t){console.error("Error cargando estad\xEDsticas:",t)}})}updateExpandedModules(){this.menuItems.forEach(t=>{t.expanded===void 0&&(t.expanded=!1),t.children&&t.children.forEach(e=>{e.expanded===void 0&&(e.expanded=!1)})})}toggleSidebar(){this.isMobile()?this.toggleMobileMenu():(this.isSidebarCollapsed=!this.isSidebarCollapsed,console.log("Sidebar colapsado:",this.isSidebarCollapsed),this.isSidebarCollapsed&&(this.expandedModules.clear(),this.menuItems.forEach(t=>{t.expanded=!1})))}toggleMobileMenu(){this.isMobileMenuOpen=!this.isMobileMenuOpen,console.log("Men\xFA m\xF3vil abierto:",this.isMobileMenuOpen),this.isMobileMenuOpen?document.body.style.overflow="hidden":document.body.style.overflow=""}openMobileMenu(){this.isMobile()&&(this.isMobileMenuOpen=!0,document.body.style.overflow="hidden")}closeMobileMenu(){this.isMobileMenuOpen=!1,document.body.style.overflow=""}handleNavigation(){this.isMobile()&&this.isMobileMenuOpen&&this.closeMobileMenu()}toggleModule(t){if(!this.isMobile()&&this.isSidebarCollapsed)return;this.expandedModules.has(t)?this.expandedModules.delete(t):this.expandedModules.add(t);let e=this.menuItems.find(i=>i.id_modulo===t);e&&(e.expanded=this.expandedModules.has(t))}isModuleExpanded(t){return this.expandedModules.has(t)}getFilteredMenuItems(){return this.menuItems.filter(t=>!t.modulo_padre_id)}getFilteredChildren(t){return t.children?t.children:this.menuItems.filter(e=>e.modulo_padre_id===t.id_modulo)}isRouteActive(t){return!t||t==="#"?!1:this.currentRoute===t||this.currentRoute.startsWith(t+"/")}navigateTo(t){t&&t!=="#"&&(console.log("Navegando a:",t),this.router.navigate([t]),this.handleNavigation())}getUserInitials(){if(!this.currentUser?.full_name)return"U";let t=this.currentUser.full_name.split(" ");return t.length>=2?(t[0].charAt(0)+t[1].charAt(0)).toUpperCase():this.currentUser.full_name.charAt(0).toUpperCase()}getUserRole(){switch(this.currentUser?.id_perfil){case 1:return"Administrador";case 2:return"Usuario";case 3:return"Supervisor";case 4:return"Invitado";default:return"Usuario"}}logout(){console.log("Cerrando sesi\xF3n desde layout"),this.permissionsService.clearUserData(),this.currentUser=null,this.menuItems=[],this.expandedModules.clear(),this.isSidebarCollapsed=!1,this.closeMobileMenu(),this.authService.logout()}getPageTitle(){let t={"/dashboard":"Dashboard","/rutinas":"Mis Rutinas","/rutinas/lista":"Ver Rutinas","/rutinas/crear":"Crear Rutina","/rutinas/editar":"Editar Rutina","/rutinas/ejercicios":"Biblioteca de Ejercicios","/usuarios":"Gesti\xF3n de Usuarios","/usuarios/lista":"Lista de Usuarios","/usuarios/crear":"Crear Usuario","/usuarios/editar":"Editar Usuario","/reportes":"Reportes","/configuracion":"Configuraci\xF3n"};if(t[this.currentRoute])return t[this.currentRoute];for(let e in t)if(this.currentRoute.startsWith(e))return t[e];return"Sistema de Gesti\xF3n"}isDashboardRoute(){return this.currentRoute==="/dashboard"}isRutinasRoute(){return this.currentRoute.startsWith("/rutinas")}formatDate(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return"Fecha inv\xE1lida"}}refreshDashboard(){return h(this,null,function*(){this.loading=!0;try{yield this.loadUserMenu(),yield this.loadDashboardStats(),yield this.permissionsService.loadUserPermissions()}catch(t){console.error("Error refrescando dashboard:",t)}finally{this.loading=!1}})}getSidebarState(){return this.isMobile()?this.isMobileMenuOpen?"mobile-open":"mobile-closed":this.isSidebarCollapsed?"collapsed":"expanded"}getTotalRutinas(){return 12}getRutinasCompletadas(){return 8}getEjerciciosFavoritos(){return 25}getModuleIcon(t){return{Dashboard:"fas fa-tachometer-alt","Mis Rutinas":"fas fa-dumbbell",Usuarios:"fas fa-users",Reportes:"fas fa-chart-bar",Configuraci\u00F3n:"fas fa-cog","Ver Rutinas":"fas fa-eye","Crear Rutina":"fas fa-plus",Ejercicios:"fas fa-list"}[t]||"fas fa-circle"}debugSidebarState(){console.log("Debug Sidebar State:",{isMobile:this.isMobile(),isMobileView:this.isMobileView,isSidebarCollapsed:this.isSidebarCollapsed,isMobileMenuOpen:this.isMobileMenuOpen,windowWidth:window.innerWidth,sidebarState:this.getSidebarState()})}closeDropdown(t){t.target.closest(".user-dropdown")||(this.showDropdown=!1)}toggleDropdown(){this.showDropdown=!this.showDropdown}togglePaquetesMenu(){this.showPaquetesMenu=!this.showPaquetesMenu}onAvatarFileSelected(t){let e=t.target;e.files&&e.files[0]&&this.uploadAvatar(e.files[0])}uploadAvatar(t){return h(this,null,function*(){if(this.currentUser){this.isUploadingAvatar=!0;try{let e=yield this.authService.updateUserAvatar(t);e.success&&e.user?(this.currentUser=e.user,console.log(e.message),this.showSuccessNotification("Foto de perfil actualizada correctamente")):(console.error(e.message),this.showErrorNotification(e.message))}catch(e){console.error("Error uploading avatar:",e),this.showErrorNotification("Error al subir la imagen")}finally{this.isUploadingAvatar=!1}}})}getCurrentUserAvatarUrl(){return this.authService.getAvatarUrl(this.currentUser||void 0)}showSuccessNotification(t){console.log("Success:",t)}showErrorNotification(t){console.error("Error:",t),alert(t)}openProfileModal(){this.showDropdown=!1,console.log("Abrir modal de perfil")}goToSettings(){this.showDropdown=!1,this.router.navigate(["/configuracion"])}static \u0275fac=function(e){return new(e||a)(I(j),I(Ke),I(te),I(ue))};static \u0275cmp=A({type:a,selectors:[["app-layout"]],hostBindings:function(e,i){e&1&&f("resize",function(c){return i.onResize(c)},!1,Vt)("click",function(c){return i.closeDropdown(c)},!1,Ft)},standalone:!1,decls:66,vars:29,consts:[["initialsTemplate",""],["fileInput",""],["headerInitialsTemplate",""],[1,"min-h-screen","bg-gray-50"],[1,"sidebar-header","flex","items-center","justify-between","p-4","border-b","border-gray-700"],[1,"text-xl","font-bold"],[1,"text-sm","text-gray-300"],[1,"sidebar-toggle-btn","p-2","rounded-lg","hover:bg-gray-800","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],[1,"nav-scroll-container"],[1,"px-2"],[1,"space-y-1"],["class","space-y-1",4,"ngFor","ngForOf"],[1,"user-section","p-4"],[1,"flex-shrink-0","relative"],[1,"user-avatar","h-10","w-10","rounded-full","overflow-hidden","bg-gradient-to-br","from-blue-500","to-purple-600","flex","items-center","justify-center","shadow-lg","cursor-pointer",3,"click"],["class","w-full h-full object-cover",3,"src","alt","error",4,"ngIf","ngIfElse"],["class","absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center",4,"ngIf"],["class","absolute -bottom-1 -right-1 bg-blue-500 hover:bg-blue-600 text-white rounded-full p-1 shadow-lg transition-all duration-200 transform hover:scale-110","title","Cambiar foto",3,"click",4,"ngIf"],[1,"text-sm","font-medium","text-white","truncate"],[1,"text-xs","text-gray-400","truncate"],[1,"relative"],["class","ml-2 p-1 rounded-lg hover:bg-gray-800 transition-colors duration-200","title","Men\xFA de usuario",3,"click",4,"ngIf"],["class","logout-btn ml-2 p-1 rounded-lg hover:bg-gray-800 transition-colors duration-200","title","Cerrar Sesi\xF3n",3,"click",4,"ngIf"],["class","user-dropdown absolute bottom-full left-0 mb-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-200",4,"ngIf"],["type","file","accept","image/*",1,"hidden",3,"change"],["class","sidebar-overlay show",3,"click",4,"ngIf"],[1,"main-header","bg-white","shadow-sm","border-b","border-gray-200"],[1,"px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","h-16"],[1,"flex","items-center"],["class","mobile-menu-btn mr-3 p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500",3,"click",4,"ngIf"],[1,"text-xl","font-semibold","text-gray-900"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","space-x-3"],[1,"h-8","w-8","rounded-full","overflow-hidden","bg-gradient-to-br","from-blue-500","to-purple-600","flex","items-center","justify-center","shadow-md"],[1,"hidden","md:block"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-gray-100","rounded-lg"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 17h5l-5 5v-5z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 19.5A2.5 2.5 0 01.5 17H4m0 2.5A2.5 2.5 0 006.5 19.5H4m0 2.5V22"],[1,"inline-flex","items-center","px-3","py-2","border","border-transparent","text-sm","leading-4","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"],[1,"hidden","sm:block"],[1,"flex-1","content-area","custom-scrollbar"],[4,"ngIf"],["routerLinkActive","bg-indigo-600 text-white","class","tooltip-collapsed group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 text-gray-300 hover:bg-gray-800 hover:text-white",3,"routerLink","click",4,"ngIf"],[1,"tooltip-collapsed","group","w-full","flex","items-center","px-3","py-2","text-sm","font-medium","text-gray-300","rounded-lg","hover:bg-gray-800","hover:text-white","transition-colors","duration-200",3,"click","disabled"],[3,"class",4,"ngIf"],["class","flex-shrink-0 w-5 h-5 mr-3","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",3,"class",4,"ngIf"],["class","ml-6 space-y-1 submenu-enter submenu-enter-active",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"flex-shrink-0","w-5","h-5","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 00-2 2v2a2 2 0 002 2m0 0h14"],["fill","none","stroke","currentColor","viewBox","0 0 24 24"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"ml-6","space-y-1","submenu-enter","submenu-enter-active"],["routerLinkActive","bg-indigo-600 text-white","class","group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 text-gray-400 hover:bg-gray-800 hover:text-white",3,"routerLink","click",4,"ngFor","ngForOf"],["routerLinkActive","bg-indigo-600 text-white",1,"group","flex","items-center","px-3","py-2","text-sm","font-medium","rounded-lg","transition-colors","duration-200","text-gray-400","hover:bg-gray-800","hover:text-white",3,"click","routerLink"],["class","flex-shrink-0 w-4 h-4 mr-3","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"flex-shrink-0","w-4","h-4","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m3 5.197H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"],["routerLinkActive","bg-indigo-600 text-white",1,"tooltip-collapsed","group","flex","items-center","px-3","py-2","text-sm","font-medium","rounded-lg","transition-colors","duration-200","text-gray-300","hover:bg-gray-800","hover:text-white",3,"click","routerLink"],[1,"w-full","h-full","object-cover",3,"error","src","alt"],[1,"text-sm","font-medium","text-white"],[1,"absolute","inset-0","bg-black","bg-opacity-50","rounded-full","flex","items-center","justify-center"],[1,"animate-spin","rounded-full","h-6","w-6","border-2","border-white","border-t-transparent"],["title","Cambiar foto",1,"absolute","-bottom-1","-right-1","bg-blue-500","hover:bg-blue-600","text-white","rounded-full","p-1","shadow-lg","transition-all","duration-200","transform","hover:scale-110",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 13a3 3 0 11-6 0 3 3 0 016 0z"],["title","Men\xFA de usuario",1,"ml-2","p-1","rounded-lg","hover:bg-gray-800","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["title","Cerrar Sesi\xF3n",1,"logout-btn","ml-2","p-1","rounded-lg","hover:bg-gray-800","transition-colors","duration-200",3,"click"],[1,"user-dropdown","absolute","bottom-full","left-0","mb-2","w-48","bg-white","rounded-md","shadow-lg","py-1","z-50","border","border-gray-200"],[1,"block","w-full","text-left","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100","transition-colors",3,"click"],[1,"fas","fa-user","mr-2"],[1,"fas","fa-cog","mr-2"],[1,"fas","fa-camera","mr-2"],[1,"my-1"],[1,"block","w-full","text-left","px-4","py-2","text-sm","text-red-600","hover:bg-gray-100","transition-colors",3,"click"],[1,"fas","fa-sign-out-alt","mr-2"],[1,"sidebar-overlay","show",3,"click"],[1,"mobile-menu-btn","mr-3","p-2","rounded-md","text-gray-600","hover:text-gray-900","hover:bg-gray-100","focus:outline-none","focus:ring-2","focus:ring-inset","focus:ring-indigo-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],[1,"text-xs","font-medium","text-white"]],template:function(e,i){if(e&1){let o=C();n(0,"div",3)(1,"div")(2,"div",4)(3,"div")(4,"h1",5),s(5,"Rehabimovementgt"),r(),n(6,"p",6),s(7,"Sistema de Gesti\xF3n"),r()(),n(8,"button",7),f("click",function(){return u(o),g(i.toggleSidebar())}),b(),n(9,"svg",8),p(10,"path",9),r()()(),y(),n(11,"div",10)(12,"nav",11)(13,"div",12),x(14,nn,3,2,"div",13),r()()(),n(15,"div",14)(16,"div")(17,"div",15)(18,"div",16),f("click",function(){return u(o),g(!i.isSidebarCollapsed||i.isMobile()?i.toggleDropdown():null)}),x(19,rn,1,2,"img",17)(20,on,2,1,"ng-template",null,0,oe)(22,an,2,0,"div",18),r(),x(23,sn,4,0,"button",19),r(),n(24,"div")(25,"p",20),s(26),r(),n(27,"p",21),s(28),r()(),n(29,"div",22),x(30,ln,3,0,"button",23)(31,cn,3,0,"button",24)(32,dn,14,0,"div",25),r(),n(33,"input",26,1),f("change",function(_){return u(o),g(i.onAvatarFileSelected(_))}),r()()()(),x(35,mn,1,0,"div",27),n(36,"div")(37,"header",28)(38,"div",29)(39,"div",30)(40,"div",31),x(41,pn,3,0,"button",32),n(42,"h1",33),s(43),r()(),n(44,"div",34)(45,"div",35)(46,"div",36),x(47,un,1,2,"img",17)(48,gn,2,1,"ng-template",null,2,oe),r(),n(50,"div",37)(51,"p",38),s(52),r(),n(53,"p",39),s(54),r()()(),n(55,"button",40),b(),n(56,"svg",8),p(57,"path",41)(58,"path",42),r()(),y(),n(59,"button",43),f("click",function(){return u(o),g(i.logout())}),b(),n(60,"svg",44),p(61,"path",45),r(),y(),n(62,"span",46),s(63,"Cerrar Sesi\xF3n"),r()()()()()(),n(64,"main",47),p(65,"router-outlet"),r()()()}if(e&2){let o=X(21),c=X(49);l(),D(i.getSidebarClasses()),l(2),D(i.isSidebarCollapsed&&!i.isMobile()?"hidden":"block"),l(5),Le("title",i.isSidebarCollapsed?"Expandir men\xFA":"Contraer men\xFA"),l(2),Le("d",i.isSidebarCollapsed&&!i.isMobile()?"M9 5l7 7-7 7":i.isMobile()?"M6 18L18 6M6 6l12 12":"M15 19l-7-7 7-7"),l(4),m("ngForOf",i.getFilteredMenuItems()),l(2),D("flex items-center "+(i.isSidebarCollapsed&&!i.isMobile()?"justify-center":"")),l(3),m("ngIf",i.currentUser==null?null:i.currentUser.avatar_url)("ngIfElse",o),l(3),m("ngIf",i.isUploadingAvatar),l(),m("ngIf",(!i.isSidebarCollapsed||i.isMobile())&&!i.isUploadingAvatar),l(),D(i.isSidebarCollapsed&&!i.isMobile()?"hidden":"ml-3 flex-1"),l(2),v(" ",(i.currentUser==null?null:i.currentUser.full_name)||"Usuario"," "),l(2),v(" ",i.getUserRole()," "),l(2),m("ngIf",!i.isSidebarCollapsed||i.isMobile()),l(),m("ngIf",i.isSidebarCollapsed&&!i.isMobile()),l(),m("ngIf",i.showDropdown&&(!i.isSidebarCollapsed||i.isMobile())),l(3),m("ngIf",i.isMobileMenuOpen),l(),D(i.getMainContentClasses()),l(5),m("ngIf",i.isMobile()),l(2),w(i.getPageTitle()),l(4),m("ngIf",i.currentUser==null?null:i.currentUser.avatar_url)("ngIfElse",c),l(5),w(i.currentUser==null?null:i.currentUser.full_name),l(2),w(i.getUserRole())}},dependencies:[N,R,Xe,Bt,$t],styles:['.layout-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#f9fafb}.sidebar[_ngcontent-%COMP%]{position:fixed;top:0;left:0;height:100vh;z-index:1000;background:linear-gradient(135deg,#1f2937,#111827);transition:width .3s ease-in-out;box-shadow:2px 0 10px #0000001a;overflow:hidden;display:flex;flex-direction:column}.sidebar-collapsed[_ngcontent-%COMP%]{width:4rem}.sidebar-expanded[_ngcontent-%COMP%]{width:16rem}@media (max-width: 768px){.sidebar[_ngcontent-%COMP%]{width:16rem!important;transform:translate(-100%);z-index:1050;transition:transform .3s ease-in-out}.sidebar-mobile-open[_ngcontent-%COMP%]{transform:translate(0)}.sidebar-collapsed[_ngcontent-%COMP%], .sidebar-expanded[_ngcontent-%COMP%]{width:16rem!important}}.main-content[_ngcontent-%COMP%]{transition:margin-left .3s ease-in-out;min-height:100vh;background-color:#f9fafb;display:flex;flex-direction:column}.main-content-expanded[_ngcontent-%COMP%]{margin-left:16rem}.main-content-collapsed[_ngcontent-%COMP%]{margin-left:4rem}@media (max-width: 768px){.main-content-expanded[_ngcontent-%COMP%], .main-content-collapsed[_ngcontent-%COMP%]{margin-left:0!important}}.nav-scroll-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding-bottom:1rem;scrollbar-width:thin;scrollbar-color:#4B5563 #1F2937;height:0;min-height:0}.nav-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.nav-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#1f2937;border-radius:3px}.nav-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#4b5563;border-radius:3px}.nav-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6b7280}.sidebar-header[_ngcontent-%COMP%]{height:72px;border-bottom:1px solid #374151;flex-shrink:0}.user-section[_ngcontent-%COMP%]{height:80px;background:#111827f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-top:1px solid rgba(75,85,99,.3);flex-shrink:0}.nav-item[_ngcontent-%COMP%]{transition:all .2s ease-in-out;border-radius:.5rem}.nav-item[_ngcontent-%COMP%]:hover{background-color:#374151b3;transform:translate(2px)}.nav-item.active[_ngcontent-%COMP%]{background-color:#4f46e5;color:#fff}.nav-item.active[_ngcontent-%COMP%]:hover{background-color:#4338ca}.main-header[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid #e5e7eb;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;position:sticky;top:0;z-index:100;flex-shrink:0}.content-area[_ngcontent-%COMP%]{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;min-height:0}.sidebar-toggle-btn[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.sidebar-toggle-btn[_ngcontent-%COMP%]:hover{background-color:#374151cc;transform:scale(1.05)}.user-avatar[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4f46e5,#7c3aed);transition:transform .2s ease-in-out}.user-avatar[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.sidebar-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;z-index:1040;opacity:0;visibility:hidden;transition:opacity .3s ease-in-out,visibility .3s ease-in-out}.sidebar-overlay.show[_ngcontent-%COMP%]{opacity:1;visibility:visible}@media (max-width: 768px){.main-header[_ngcontent-%COMP%]{padding-left:1rem}.mobile-menu-btn[_ngcontent-%COMP%]{display:block}.sidebar-header[_ngcontent-%COMP%]{height:64px}.user-section[_ngcontent-%COMP%]{height:72px}}@media (min-width: 769px){.mobile-menu-btn[_ngcontent-%COMP%]{display:none}}.module-expanded[_ngcontent-%COMP%]   .module-arrow[_ngcontent-%COMP%]{transform:rotate(90deg)}.submenu-enter[_ngcontent-%COMP%]{max-height:0;overflow:hidden;transition:max-height .3s ease-in-out}.submenu-enter-active[_ngcontent-%COMP%]{max-height:500px}.tooltip-collapsed[_ngcontent-%COMP%]{position:relative}@media (min-width: 769px){.tooltip-collapsed[_ngcontent-%COMP%]:hover:after{content:attr(data-tooltip);position:absolute;left:calc(100% + 10px);top:50%;transform:translateY(-50%);background-color:#1f2937;color:#fff;padding:.5rem .75rem;border-radius:.375rem;font-size:.875rem;white-space:nowrap;z-index:1100;box-shadow:0 4px 6px -1px #0000001a;opacity:0;animation:_ngcontent-%COMP%_tooltipFadeIn .2s ease-in-out forwards}.tooltip-collapsed[_ngcontent-%COMP%]:hover:before{content:"";position:absolute;left:calc(100% + 5px);top:50%;transform:translateY(-50%);border-top:5px solid transparent;border-bottom:5px solid transparent;border-right:5px solid #1f2937;z-index:1100;opacity:0;animation:_ngcontent-%COMP%_tooltipFadeIn .2s ease-in-out forwards}}@keyframes _ngcontent-%COMP%_tooltipFadeIn{0%{opacity:0}to{opacity:1}}.dashboard-card[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;transition:all .2s ease-in-out}.dashboard-card[_ngcontent-%COMP%]:hover{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;transform:translateY(-1px)}.stat-icon[_ngcontent-%COMP%]{border-radius:.375rem;padding:.75rem}.stat-number[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#111827}.stat-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.welcome-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4f46e5,#7c3aed);border-radius:.5rem;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}.welcome-icon[_ngcontent-%COMP%]{background:#fff3;border-radius:50%;padding:.75rem}.quick-action-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:.5rem;padding:1.5rem;transition:all .2s ease-in-out;cursor:pointer}.quick-action-card[_ngcontent-%COMP%]:hover{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;transform:translateY(-2px);border-color:#4f46e5}.quick-action-icon[_ngcontent-%COMP%]{border-radius:.5rem;padding:.75rem;margin-bottom:1rem}.logout-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc2626,#b91c1c);transition:all .2s ease-in-out}.logout-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#b91c1c,#991b1b);transform:translateY(-1px);box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.slide-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-out}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translate(-20px)}to{opacity:1;transform:translate(0)}}.loading-spinner[_ngcontent-%COMP%]{width:3rem;height:3rem;border:2px solid #e5e7eb;border-top:2px solid #4f46e5;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.success-message[_ngcontent-%COMP%]{background-color:#d1fae5;border:1px solid #a7f3d0;color:#065f46;padding:1rem;border-radius:.5rem;margin-bottom:1rem}.error-message[_ngcontent-%COMP%]{background-color:#fee2e2;border:1px solid #fecaca;color:#991b1b;padding:1rem;border-radius:.5rem;margin-bottom:1rem}.user-info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}.user-info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.user-info-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#6b7280}.user-info-value[_ngcontent-%COMP%]{font-size:.875rem;color:#111827}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.transition-smooth[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.shadow-subtle[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}.shadow-moderate[_ngcontent-%COMP%]{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.shadow-strong[_ngcontent-%COMP%]{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}.custom-scrollbar[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:4px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:4px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}@media (max-width: 768px){.sidebar[_ngcontent-%COMP%]{-webkit-transform:translateX(-100%);transform:translate(-100%)}.sidebar-mobile-open[_ngcontent-%COMP%]{-webkit-transform:translateX(0);transform:translate(0)}.main-content[_ngcontent-%COMP%]{width:100%;margin-left:0}.nav-scroll-container[_ngcontent-%COMP%]{height:calc(100vh - 136px)}.sidebar-toggle-btn[_ngcontent-%COMP%]{min-width:44px;min-height:44px;display:flex;align-items:center;justify-content:center}.nav-scroll-container[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]{padding:.5rem}.nav-scroll-container[_ngcontent-%COMP%]   .space-y-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:.25rem}.nav-scroll-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .nav-scroll-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-height:44px;display:flex;align-items:center}input[type=text][_ngcontent-%COMP%], input[type=email][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font-size:16px}}@media (max-width: 1024px){.dashboard-stats[_ngcontent-%COMP%], .quick-actions[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 640px){.dashboard-stats[_ngcontent-%COMP%], .quick-actions[_ngcontent-%COMP%], .user-info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.main-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.125rem}.welcome-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}.sidebar-header[_ngcontent-%COMP%], .user-section[_ngcontent-%COMP%], .content-area[_ngcontent-%COMP%]{padding:1rem}}@media (prefers-reduced-motion: reduce){.sidebar[_ngcontent-%COMP%], .main-content[_ngcontent-%COMP%], .sidebar-overlay[_ngcontent-%COMP%], .submenu-enter[_ngcontent-%COMP%], .tooltip-collapsed[_ngcontent-%COMP%]:after, .tooltip-collapsed[_ngcontent-%COMP%]:before{transition:none}.fade-in[_ngcontent-%COMP%], .slide-in[_ngcontent-%COMP%]{animation:none}}.sidebar-toggle-btn[_ngcontent-%COMP%]:focus, .mobile-menu-btn[_ngcontent-%COMP%]:focus, .logout-btn[_ngcontent-%COMP%]:focus{outline:2px solid #4f46e5;outline-offset:2px}.nav-scroll-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus, .nav-scroll-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:2px solid #4f46e5;outline-offset:2px;border-radius:.375rem}@media (prefers-contrast: high){.sidebar[_ngcontent-%COMP%]{background:#000;border-right:2px solid #ffffff}.nav-scroll-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .nav-scroll-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:1px solid #ffffff}.nav-scroll-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .nav-scroll-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#fff;color:#000}}']})};function fn(a,t){if(a&1){let e=C();n(0,"button",34),f("click",function(){u(e);let o=d();return g(o.openCreateModal())}),b(),n(1,"svg",35),p(2,"path",36),r(),s(3," Nueva Rutina "),r()}}function _n(a,t){if(a&1&&(n(0,"div",37)(1,"div",38),b(),n(2,"svg",39),p(3,"path",40),r(),y(),n(4,"div",41)(5,"p",42),s(6),r()()()()),a&2){let e=d();l(6),w(e.error)}}function xn(a,t){a&1&&(n(0,"div",43),p(1,"div",44),r())}function vn(a,t){if(a&1&&(n(0,"span",71),s(1),r()),a&2){let e=t.$implicit;l(),z(" ",e.nombre," (",e.seccion.ejercicios.length,") ")}}function bn(a,t){if(a&1&&(n(0,"div",67)(1,"div",68),s(2,"Secciones:"),r(),n(3,"div",69),x(4,vn,2,2,"span",70),r()()),a&2){let e=d().$implicit,i=d(2);l(4),m("ngForOf",i.getSeccionesConEjercicios(e))}}function hn(a,t){if(a&1&&(n(0,"span",74),s(1),r()),a&2){let e=t.$implicit;l(),v(" #",e," ")}}function Cn(a,t){if(a&1&&(n(0,"div",72)(1,"div",69),x(2,hn,2,1,"span",73),r()()),a&2){let e=d().$implicit;l(2),m("ngForOf",e.tags)}}function wn(a,t){if(a&1){let e=C();n(0,"button",75),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.openViewModal(o))}),b(),n(1,"svg",63),p(2,"path",76)(3,"path",77),r()()}}function yn(a,t){if(a&1){let e=C();n(0,"button",78),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.openEditModal(o))}),b(),n(1,"svg",63),p(2,"path",79),r()()}}function Sn(a,t){if(a&1){let e=C();n(0,"button",80),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.deleteRutina(o))}),b(),n(1,"svg",63),p(2,"path",81),r()()}}function Mn(a,t){if(a&1){let e=C();n(0,"button",82),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.reactivateRutina(o))}),b(),n(1,"svg",63),p(2,"path",83),r()()}}function En(a,t){if(a&1){let e=C();n(0,"div",47)(1,"div")(2,"div",48)(3,"div",49)(4,"h3",50),s(5),r(),n(6,"p",51),s(7),r()(),n(8,"span"),s(9),r()()(),n(10,"div",52)(11,"div",53)(12,"span",54),s(13),r(),n(14,"span",55),s(15),r()(),x(16,bn,5,1,"div",56),n(17,"div",57),s(18),r(),x(19,Cn,3,1,"div",58),n(20,"div",59),x(21,wn,4,0,"button",60)(22,yn,3,0,"button",61),n(23,"button",62),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.exportarRutina(o))}),b(),n(24,"svg",63),p(25,"path",64),r()(),x(26,Sn,3,0,"button",65)(27,Mn,3,0,"button",66),r()()()}if(a&2){let e=t.$implicit,i=d(2);O("opacity-50",e.status===0),l(),D("px-6 py-4 "+(e.status===1?"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-gray-400 to-gray-500")),l(4),w(e.nombre),l(2),w(e.descripcion),l(),D("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+(e.status===1?"bg-green-100 text-green-800":"bg-red-100 text-red-800")),l(),v(" ",e.status===1?"Activo":"Inactivo"," "),l(4),v(" ",e.nivel," "),l(2),w(i.formatDuracion(e.duracion_estimada)),l(),m("ngIf",i.getSeccionesConEjercicios(e).length>0),l(2),v(" Total de ejercicios: ",i.getTotalEjercicios(e)," "),l(),m("ngIf",e.tags&&e.tags.length>0),l(2),m("ngIf",i.canViewRutina()),l(),m("ngIf",e.status===1&&i.canEditRutina()),l(4),m("ngIf",e.status===1&&i.canEditRutina()),l(),m("ngIf",e.status===0&&i.canEditRutina())}}function kn(a,t){if(a&1&&(n(0,"div",45),x(1,En,28,18,"div",46),r()),a&2){let e=d();l(),m("ngForOf",e.filteredRutinas)("ngForTrackBy",e.trackByRutinaId)}}function Tn(a,t){if(a&1){let e=C();n(0,"button",92),f("click",function(){u(e);let o=d(2);return g(o.openCreateModal())}),s(1," Crear primera rutina "),r()}}function Pn(a,t){if(a&1){let e=C();n(0,"button",93),f("click",function(){u(e);let o=d(2);return g(o.clearFilters())}),s(1," Limpiar filtros "),r()}}function In(a,t){if(a&1&&(n(0,"div",84),b(),n(1,"svg",85),p(2,"path",86),r(),y(),n(3,"h3",87),s(4,"No hay rutinas"),r(),n(5,"p",88),s(6),r(),n(7,"div",89),x(8,Tn,2,0,"button",90)(9,Pn,2,0,"button",91),r()()),a&2){let e=d();l(6),v(" ",e.rutinas.length===0?"No se encontraron rutinas en la base de datos.":"No se encontraron rutinas con los filtros aplicados."," "),l(2),m("ngIf",e.rutinas.length===0&&e.canEditRutina()),l(),m("ngIf",e.rutinas.length>0)}}function On(a,t){if(a&1){let e=C();n(0,"label",124)(1,"input",125),f("change",function(){let o=u(e).$implicit,c=d(2);return g(c.toggleSeccion(o.key))}),r(),n(2,"span",126),s(3),r()()}if(a&2){let e=t.$implicit,i=d(2);O("bg-red-50",i.isSeccionActiva(e.key))("border-red-300",i.isSeccionActiva(e.key)),l(),m("checked",i.isSeccionActiva(e.key)),l(2),w(e.nombre)}}function Vn(a,t){if(a&1){let e=C();n(0,"div",72)(1,"label",13),s(2),r(),n(3,"input",136),f("input",function(o){u(e);let c=d().$implicit,_=d(2);return g(_.updateSeccionDescripcion(c.key,o))}),r()()}if(a&2){let e,i=d().$implicit,o=d(2);l(2),v("Descripci\xF3n de ",i.nombre,""),l(),m("value",((e=o.getSeccionData(o.rutinaForm,i.key))==null?null:e.descripcion)||"")}}function Fn(a,t){if(a&1){let e=C();n(0,"div",137)(1,"div")(2,"label",138),s(3,"Tiempo Total"),r(),n(4,"input",139),f("input",function(o){u(e);let c=d().$implicit,_=d(2);return g(_.updateSeccionTiempoTotal(c.key,o))}),r()(),n(5,"div")(6,"label",138),s(7,"Series"),r(),n(8,"input",140),f("input",function(o){u(e);let c=d().$implicit,_=d(2);return g(_.updateSeccionSeries(c.key,o))}),r()(),n(9,"div")(10,"label",138),s(11,"Time Cap"),r(),n(12,"input",141),f("input",function(o){u(e);let c=d().$implicit,_=d(2);return g(_.updateSeccionTimeCap(c.key,o))}),r()()()}if(a&2){let e,i,o,c=d().$implicit,_=d(2);l(4),m("value",((e=_.getSeccionData(_.rutinaForm,c.key))==null?null:e.tiempo_total)||""),l(4),m("value",((i=_.getSeccionData(_.rutinaForm,c.key))==null?null:i.series)||""),l(4),m("value",((o=_.getSeccionData(_.rutinaForm,c.key))==null?null:o.time_cap)||"")}}function Dn(a,t){if(a&1){let e=C();n(0,"div",142)(1,"div",143)(2,"div",144)(3,"label",145),s(4,"Ejercicio"),r(),n(5,"input",146),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.nombre,o)||(c.nombre=o),g(o)}),r()(),n(6,"div")(7,"label",145),s(8,"Tipo"),r(),n(9,"select",147),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.tipo,o)||(c.tipo=o),g(o)}),n(10,"option",148),s(11,"Resistencia Cardiovascular"),r(),n(12,"option",149),s(13,"Fuerza"),r(),n(14,"option",150),s(15,"Funcional"),r(),n(16,"option",151),s(17,"Core"),r(),n(18,"option",152),s(19,"Movilidad"),r(),n(20,"option",153),s(21,"Activaci\xF3n"),r(),n(22,"option",154),s(23,"Equilibrio/Balance"),r(),n(24,"option",155),s(25,"Coordinaci\xF3n"),r()()(),n(26,"div",156)(27,"button",157),f("click",function(){let o=u(e).index,c=d().$implicit,_=d(2);return g(_.removeEjercicio(c.key,o))}),b(),n(28,"svg",158),p(29,"path",81),r()()()(),y(),n(30,"div",159)(31,"div")(32,"label",145),s(33,"Reps"),r(),n(34,"input",160),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.repeticiones,o)||(c.repeticiones=o),g(o)}),r()(),n(35,"div")(36,"label",145),s(37,"Series"),r(),n(38,"input",161),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.series,o)||(c.series=o),g(o)}),r()(),n(39,"div")(40,"label",145),s(41,"Duraci\xF3n"),r(),n(42,"input",162),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.duracion,o)||(c.duracion=o),g(o)}),r()(),n(43,"div")(44,"label",145),s(45,"Distancia"),r(),n(46,"input",163),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.distancia,o)||(c.distancia=o),g(o)}),r()(),n(47,"div")(48,"label",145),s(49,"RPE"),r(),n(50,"input",164),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.rpe,o)||(c.rpe=o),g(o)}),r()(),n(51,"div")(52,"label",145),s(53,"Peso"),r(),n(54,"input",165),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.peso,o)||(c.peso=o),g(o)}),r()()(),n(55,"div",166)(56,"label",145),s(57,"Observaciones"),r(),n(58,"input",167),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.observaciones,o)||(c.observaciones=o),g(o)}),r()()()}if(a&2){let e=t.$implicit;l(5),M("ngModel",e.nombre),l(4),M("ngModel",e.tipo),l(25),M("ngModel",e.repeticiones),l(4),M("ngModel",e.series),l(4),M("ngModel",e.duracion),l(4),M("ngModel",e.distancia),l(4),M("ngModel",e.rpe),l(4),M("ngModel",e.peso),l(4),M("ngModel",e.observaciones)}}function An(a,t){if(a&1){let e=C();n(0,"div",168),b(),n(1,"svg",169),p(2,"path",36),r(),y(),n(3,"p",170),s(4,"No hay ejercicios en esta secci\xF3n"),r(),n(5,"button",171),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.addEjercicio(o.key))}),s(6," Agregar primer ejercicio "),r()()}}function Rn(a,t){if(a&1){let e=C();n(0,"div",127)(1,"h5",128)(2,"span",129),s(3),r(),s(4),r(),x(5,Vn,4,2,"div",58)(6,Fn,13,3,"div",130),n(7,"div",131)(8,"div",132)(9,"h6",68),s(10,"Ejercicios"),r(),n(11,"button",133),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.addEjercicio(o.key))}),s(12," + Agregar Ejercicio "),r()(),x(13,Dn,59,9,"div",134)(14,An,7,0,"div",135),r()()}if(a&2){let e,i,o=t.$implicit,c=d(2);O("hidden",!c.isSeccionActiva(o.key)),l(3),w(o.nombre),l(),v(" ",o.descripcion," "),l(),m("ngIf",c.getSeccionData(c.rutinaForm,o.key)),l(),m("ngIf",c.getSeccionData(c.rutinaForm,o.key)),l(7),m("ngForOf",(e=c.getSeccionData(c.rutinaForm,o.key))==null?null:e.ejercicios)("ngForTrackBy",c.trackByEjercicioOrden),l(),m("ngIf",!((i=(i=c.getSeccionData(c.rutinaForm,o.key))==null||i.ejercicios==null?null:i.ejercicios.length)!==null&&i!==void 0&&i))}}function jn(a,t){if(a&1&&(n(0,"div",172)(1,"div",38),b(),n(2,"svg",39),p(3,"path",40),r(),y(),n(4,"div",41)(5,"p",42),s(6),r()()()()),a&2){let e=d(2);l(6),w(e.error)}}function Un(a,t){a&1&&(n(0,"span",173),p(1,"div",174),r())}function Ln(a,t){if(a&1){let e=C();n(0,"div",94)(1,"div",95)(2,"div",96),f("click",function(){u(e);let o=d();return g(o.closeModal())}),r(),n(3,"div",97)(4,"div",98)(5,"div",99)(6,"div",100),b(),n(7,"svg",101),p(8,"path",86),r()(),y(),n(9,"div",102)(10,"h3",103),s(11),r(),n(12,"div",104)(13,"p",55),s(14),r()()()()(),n(15,"div",105)(16,"div",106)(17,"div")(18,"label",13),s(19," Nombre "),n(20,"span",107),s(21,"*"),r()(),n(22,"input",108),k("ngModelChange",function(o){u(e);let c=d();return E(c.rutinaForm.nombre,o)||(c.rutinaForm.nombre=o),g(o)}),r()(),n(23,"div")(24,"label",13),s(25,"Duraci\xF3n (minutos)"),r(),n(26,"input",109),k("ngModelChange",function(o){u(e);let c=d();return E(c.rutinaForm.duracion_estimada,o)||(c.rutinaForm.duracion_estimada=o),g(o)}),r()(),n(27,"div")(28,"label",13),s(29,"Tipo"),r(),n(30,"select",110),k("ngModelChange",function(o){u(e);let c=d();return E(c.rutinaForm.tipo,o)||(c.rutinaForm.tipo=o),g(o)}),n(31,"option",19),s(32,"Entrenamiento"),r(),n(33,"option",20),s(34,"Recuperaci\xF3n"),r(),n(35,"option",21),s(36,"Evaluaci\xF3n"),r()()(),n(37,"div")(38,"label",13),s(39,"Nivel"),r(),n(40,"select",110),k("ngModelChange",function(o){u(e);let c=d();return E(c.rutinaForm.nivel,o)||(c.rutinaForm.nivel=o),g(o)}),n(41,"option",22),s(42,"Principiante"),r(),n(43,"option",23),s(44,"Intermedio"),r(),n(45,"option",24),s(46,"Avanzado"),r()()(),n(47,"div",12)(48,"label",13),s(49,"Descripci\xF3n"),r(),n(50,"textarea",111),k("ngModelChange",function(o){u(e);let c=d();return E(c.rutinaForm.descripcion,o)||(c.rutinaForm.descripcion=o),g(o)}),r()()(),n(51,"div",112)(52,"h4",113),s(53,"Secciones de la Rutina"),r(),n(54,"div",114),x(55,On,4,6,"label",115),r(),n(56,"div",116),x(57,Rn,15,9,"div",117),r()(),x(58,jn,7,1,"div",118),r(),n(59,"div",119)(60,"div",120)(61,"button",121),f("click",function(){u(e);let o=d();return g(o.saveRutina())}),x(62,Un,2,0,"span",122),s(63),r(),n(64,"button",123),f("click",function(){u(e);let o=d();return g(o.closeModal())}),s(65," Cancelar "),r()()()()()()}if(a&2){let e=d();l(11),v(" ",e.modalMode==="create"?"Crear Nueva Rutina":"Editar Rutina"," "),l(3),v(" ",e.modalMode==="create"?"Complete los datos para crear una nueva rutina.":"Modifique los datos de la rutina seleccionada."," "),l(8),M("ngModel",e.rutinaForm.nombre),l(4),M("ngModel",e.rutinaForm.duracion_estimada),l(4),M("ngModel",e.rutinaForm.tipo),l(10),M("ngModel",e.rutinaForm.nivel),l(10),M("ngModel",e.rutinaForm.descripcion),l(5),m("ngForOf",e.seccionesDisponibles),l(2),m("ngForOf",e.seccionesDisponibles),l(),m("ngIf",e.error),l(3),m("disabled",e.loading),l(),m("ngIf",e.loading),l(),v(" ",e.modalMode==="create"?"Crear Rutina":"Guardar Cambios"," "),l(),m("disabled",e.loading)}}function Nn(a,t){if(a&1){let e=C();n(0,"button",175),f("click",function(){u(e);let o=d();return g(o.openCreateModal())}),b(),n(1,"svg",176),p(2,"path",36),r()()}}function zn(a,t){a&1&&(n(0,"div",202)(1,"div",38),b(),n(2,"svg",203),p(3,"path",83),r(),y(),n(4,"div",41)(5,"p",204),s(6,"\xA1Rutina copiada al portapapeles!"),r()()()())}function Bn(a,t){if(a&1){let e=C();n(0,"div",177)(1,"div",178)(2,"div",96),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),r(),n(3,"div",179)(4,"div",180)(5,"div",99)(6,"div",181),b(),n(7,"svg",182),p(8,"path",76)(9,"path",77),r()(),y(),n(10,"div",102)(11,"h3",103),s(12),r(),n(13,"div",104)(14,"p",55),s(15," Visualizaci\xF3n completa de la rutina de entrenamiento "),r()()(),n(16,"button",183),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),b(),n(17,"svg",184),p(18,"path",185),r()()()(),y(),n(19,"div",186)(20,"div",187)(21,"div",188)(22,"div",5),p(23,"div",189)(24,"div",190)(25,"div",191),r(),n(26,"div",192),s(27),r()(),n(28,"pre",193),s(29),r()(),x(30,zn,7,0,"div",194),n(31,"div",195)(32,"button",196),f("click",function(){u(e);let o=d();return g(o.copyToClipboard(o.getFormattedRutina(o.selectedViewRutina)))}),b(),n(33,"svg",197),p(34,"path",198),r(),s(35," Copiar "),r(),y(),n(36,"button",199),f("click",function(){u(e);let o=d();return g(o.exportarRutina(o.selectedViewRutina))}),b(),n(37,"svg",197),p(38,"path",64),r(),s(39," Descargar "),r()()(),y(),n(40,"div",119)(41,"div",200)(42,"button",201),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),s(43," Cerrar "),r()()()()()()}if(a&2){let e=d();l(12),v(" ",(e.selectedViewRutina==null?null:e.selectedViewRutina.nombre)||"Detalles de la Rutina"," "),l(15),v(" ",e.getFileName(e.selectedViewRutina)," "),l(2),w(e.getFormattedRutina(e.selectedViewRutina)),l(),m("ngIf",e.copySuccess)}}var ct=class a{constructor(t,e){this.supabaseService=t;this.authService=e}rutinas=[];filteredRutinas=[];tiposSeccion=[];loading=!1;error="";showModal=!1;modalMode="create";selectedRutina=null;showViewModal=!1;selectedViewRutina=null;copySuccess=!1;rutinaForm={nombre:"",descripcion:"",tipo:"entrenamiento",nivel:"intermedio",duracion_estimada:60,tags:[],status:1};seccionesDisponibles=[{key:"warm_upg",nombre:"General Warm Up",descripcion:"Calentamiento Calendario"},{key:"warm_up",nombre:"Warm Up",descripcion:"Calentamiento"},{key:"met_con",nombre:"Metcon",descripcion:"Metabolic Conditioning"},{key:"strength",nombre:"Strength",descripcion:"Entrenamiento de Fuerza"},{key:"core",nombre:"Core",descripcion:"Trabajo de Core"},{key:"skill",nombre:"Skill",descripcion:"Skills"},{key:"extra",nombre:"Extra",descripcion:"Trabajo Adicional"}];searchTerm="";tipoFilter="all";nivelFilter="all";statusFilter="active";seccionesActivas=new Set;ngOnInit(){return h(this,null,function*(){yield this.loadTiposSeccion(),yield this.loadRutinas()})}loadTiposSeccion(){return h(this,null,function*(){try{let t=yield this.supabaseService.getData("tipos_seccion");this.tiposSeccion=t?.filter(e=>e.status===1)||[]}catch(t){console.error("Error cargando tipos de secci\xF3n:",t)}})}loadRutinas(){return h(this,null,function*(){this.loading=!0,this.error="";try{let t=yield this.supabaseService.getData("rutinas");this.rutinas=t||[],this.rutinas=this.rutinas.sort((e,i)=>e.nombre.toLowerCase().localeCompare(i.nombre.toLowerCase())),this.filteredRutinas=[...this.rutinas],this.applyFilters(),console.log("Rutinas cargadas:",this.rutinas.length)}catch(t){console.error("Error cargando rutinas:",t),this.error="Error al cargar las rutinas"}finally{this.loading=!1}})}applyFilters(){let t=[...this.rutinas];if(this.statusFilter==="active"?t=t.filter(e=>e.status===1):this.statusFilter==="inactive"&&(t=t.filter(e=>e.status===0)),this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.nombre.toLowerCase().includes(e)||i.descripcion?.toLowerCase().includes(e)||i.tags?.some(o=>o.toLowerCase().includes(e)))}this.tipoFilter!=="all"&&(t=t.filter(e=>e.tipo===this.tipoFilter)),this.nivelFilter!=="all"&&(t=t.filter(e=>e.nivel===this.nivelFilter)),t=t.sort((e,i)=>e.nombre.toLowerCase().localeCompare(i.nombre.toLowerCase())),this.filteredRutinas=t}openCreateModal(){this.modalMode="create",this.rutinaForm={nombre:"",descripcion:"",tipo:"entrenamiento",nivel:"intermedio",duracion_estimada:60,tags:[],status:1},this.seccionesActivas.clear(),this.error="",this.showModal=!0}openEditModal(t){this.modalMode="edit",this.selectedRutina=t,this.rutinaForm=JSON.parse(JSON.stringify(t)),this.seccionesActivas.clear(),this.seccionesDisponibles.forEach(e=>{this.getSeccionData(this.rutinaForm,e.key)&&this.seccionesActivas.add(e.key)}),this.error="",this.showModal=!0}openViewModal(t){console.log("Abriendo modal de vista para rutina:",t.nombre),this.selectedViewRutina=t,this.showViewModal=!0}closeViewModal(){console.log("Cerrando modal de vista"),this.showViewModal=!1,this.selectedViewRutina=null,this.copySuccess=!1}closeModal(){this.showModal=!1,this.selectedRutina=null,this.error="",this.seccionesActivas.clear()}saveRutina(){return h(this,null,function*(){try{if(this.error="",!this.rutinaForm.nombre.trim()){this.error="El nombre es requerido";return}if(this.seccionesActivas.size===0){this.error="Debe activar al menos una secci\xF3n";return}let t=ge({},this.rutinaForm);this.seccionesDisponibles.forEach(e=>{this.seccionesActivas.has(e.key)||delete t[e.key]}),this.modalMode==="create"?(console.log("Creando rutina:",t),yield this.supabaseService.insertData("rutinas",t)):(t.updated_at=new Date().toISOString(),console.log("Actualizando rutina:",t),yield this.supabaseService.updateData("rutinas",this.selectedRutina.id.toString(),t)),yield this.loadRutinas(),this.closeModal()}catch(t){console.error("Error guardando rutina:",t),this.error="Error al guardar la rutina"}})}deleteRutina(t){return h(this,null,function*(){let e=`\xBFEst\xE1 seguro de eliminar la rutina "${t.nombre}"?`;if(confirm(e))try{yield this.supabaseService.updateData("rutinas",t.id.toString(),{status:0}),yield this.loadRutinas()}catch(i){console.error("Error eliminando rutina:",i),this.error="Error al eliminar la rutina"}})}reactivateRutina(t){return h(this,null,function*(){let e=`\xBFEst\xE1 seguro de reactivar la rutina "${t.nombre}"?`;if(confirm(e))try{yield this.supabaseService.updateData("rutinas",t.id.toString(),{status:1}),yield this.loadRutinas()}catch(i){console.error("Error reactivando rutina:",i),this.error="Error al reactivar la rutina"}})}toggleSeccion(t){this.seccionesActivas.has(t)?(this.seccionesActivas.delete(t),this.setSeccionData(this.rutinaForm,t,void 0)):(this.seccionesActivas.add(t),this.setSeccionData(this.rutinaForm,t,{descripcion:"",ejercicios:[]}))}isSeccionActiva(t){return this.seccionesActivas.has(t)}getSeccionData(t,e){return t[e]}setSeccionData(t,e,i){t[e]=i}updateSeccionDescripcion(t,e){let i=this.getSeccionData(this.rutinaForm,t);i&&(i.descripcion=e.target.value)}updateSeccionTiempoTotal(t,e){let i=this.getSeccionData(this.rutinaForm,t);i&&(i.tiempo_total=e.target.value)}updateSeccionSeries(t,e){let i=this.getSeccionData(this.rutinaForm,t);i&&(i.series=parseInt(e.target.value)||void 0)}updateSeccionTimeCap(t,e){let i=this.getSeccionData(this.rutinaForm,t);i&&(i.time_cap=e.target.value)}addEjercicio(t){let e=this.getSeccionData(this.rutinaForm,t);if(e&&e.ejercicios){let i={orden:e.ejercicios.length+1,nombre:"",tipo:"funcional"};e.ejercicios.push(i)}}removeEjercicio(t,e){let i=this.getSeccionData(this.rutinaForm,t);i&&i.ejercicios&&(i.ejercicios.splice(e,1),i.ejercicios.forEach((o,c)=>{o.orden=c+1}))}addTag(t){let e=t.target,i=e.value.trim();i&&t.key==="Enter"&&(this.rutinaForm.tags||(this.rutinaForm.tags=[]),this.rutinaForm.tags.includes(i)||this.rutinaForm.tags.push(i),e.value="",t.preventDefault())}removeTag(t){this.rutinaForm.tags&&this.rutinaForm.tags.splice(t,1)}getSeccionNombre(t){let e=this.seccionesDisponibles.find(i=>i.key===t);return e?e.nombre:t}getSeccionesConEjercicios(t){let e=[];return this.seccionesDisponibles.forEach(i=>{let o=this.getSeccionData(t,i.key);o&&o.ejercicios&&o.ejercicios.length>0&&e.push({key:i.key,nombre:i.nombre,seccion:o})}),e}formatDuracion(t){if(!t)return"N/A";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getTotalEjercicios(t){let e=0;return this.seccionesDisponibles.forEach(i=>{let o=this.getSeccionData(t,i.key);o&&o.ejercicios&&(e+=o.ejercicios.length)}),e}onSearch(){this.applyFilters()}onFilterChange(){this.applyFilters()}clearFilters(){this.searchTerm="",this.tipoFilter="all",this.nivelFilter="all",this.statusFilter="active",this.applyFilters()}refreshRutinas(){return h(this,null,function*(){yield this.loadRutinas()})}trackByRutinaId(t,e){return e.id||t}trackByEjercicioOrden(t,e){return e.orden||t}getFormattedRutina(t){if(!t)return"";let e=`${t.nombre}
`;return e+=`${t.descripcion||"Rutina de entrenamiento"}
`,e+=`Nivel: ${t.nivel} | Duraci\xF3n: ${this.formatDuracion(t.duracion_estimada)}

`,["warm_up","met_con","strength","core","extra"].forEach(o=>{let c=this.seccionesDisponibles.find(S=>S.key===o),_=this.getSeccionData(t,o);if(_&&_.ejercicios&&_.ejercicios.length>0&&c){e+=`${c.nombre.toUpperCase()}
`,_.descripcion&&(e+=`${_.descripcion}
`);let S=[];_.tiempo_total&&S.push(`Tiempo: ${_.tiempo_total}`),_.series&&S.push(`Series: ${_.series}`),_.time_cap&&S.push(`Time Cap: ${_.time_cap}`),S.length>0&&(e+=`${S.join(" | ")}
`),_.ejercicios.forEach(P=>{let T=P.nombre,L=[];P.repeticiones&&L.push(`${P.repeticiones} reps`),P.series&&L.push(`x ${P.series}`),P.duracion&&L.push(`${P.duracion}`),P.distancia&&L.push(`${P.distancia}`),P.peso&&L.push(`${P.peso}`),L.length>0&&(T+=` - ${L.join(" ")}`),P.rpe&&(T+=` (RPE ${P.rpe})`),P.observaciones&&(T+=` - ${P.observaciones}`),e+=`${T}
`}),e+=`
`}}),t.tags&&t.tags.length>0&&(e+=`Tags: ${t.tags.map(o=>`#${o}`).join(" ")}
`),e}copyToClipboard(t){return h(this,null,function*(){try{yield navigator.clipboard.writeText(t),this.copySuccess=!0,console.log("Texto copiado al portapapeles"),setTimeout(()=>{this.copySuccess=!1},2e3)}catch(e){console.error("Error al copiar al portapapeles:",e),this.fallbackCopyTextToClipboard(t)}})}fallbackCopyTextToClipboard(t){let e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")&&(this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3))}catch(i){console.error("Fallback: Error al copiar al portapapeles:",i)}document.body.removeChild(e)}canViewRutina(){return this.authService.isAuthenticated()}canEditRutina(){return this.authService.isAdmin()||this.authService.hasProfile(3)}exportarRutina(t){let e=this.getFormattedRutina(t),i=new Blob([e],{type:"text/plain;charset=utf-8"}),o=window.URL.createObjectURL(i),c=document.createElement("a");c.href=o,c.download=`${t.nombre.replace(/\s+/g,"_")}.txt`,c.click(),window.URL.revokeObjectURL(o),console.log("Rutina exportada:",t.nombre)}getFileName(t){return!t||!t.nombre?"rutina.txt":t.nombre.replace(/\s+/g,"_")+".txt"}static \u0275fac=function(e){return new(e||a)(I(te),I(j))};static \u0275cmp=A({type:a,selectors:[["app-rutinas"]],standalone:!1,decls:64,vars:13,consts:[[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["class","inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4"],[1,"md:col-span-2"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Buscar rutinas...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","input","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","change","ngModel"],["value","all"],["value","active"],["value","inactive"],["value","entrenamiento"],["value","recuperacion"],["value","evaluacion"],["value","principiante"],["value","intermedio"],["value","avanzado"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-red-600","hover:text-red-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","modal-container modal-backdrop",4,"ngIf"],["class","md:hidden fixed bottom-6 right-6 w-14 h-14 bg-red-600 text-white rounded-full shadow-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 floating-action-btn btn-floating","title","Crear nueva rutina",3,"click",4,"ngIf"],["class","modal-view-container modal-backdrop",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-red-600"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300",3,"opacity-50",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-white","rounded-lg","shadow-lg","overflow-hidden","hover:shadow-xl","transition-shadow","duration-300"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"text-xl","font-bold","text-white"],[1,"text-red-100","text-sm"],[1,"p-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-red-100","text-red-800"],[1,"text-sm","text-gray-500"],["class","space-y-2 mb-4",4,"ngIf"],[1,"text-sm","text-gray-600","mb-4"],["class","mb-4",4,"ngIf"],[1,"flex","justify-end","space-x-2"],["class","text-blue-600 hover:text-blue-900 p-2 rounded-full hover:bg-blue-50 transition-colors duration-150","title","Ver rutina completa",3,"click",4,"ngIf"],["class","text-red-600 hover:text-red-900 p-2 rounded-full hover:bg-red-50 transition-colors duration-150","title","Editar rutina",3,"click",4,"ngIf"],["title","Descargar rutina",1,"text-green-600","hover:text-green-900","p-2","rounded-full","hover:bg-green-50","transition-colors","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["class","text-red-600 hover:text-red-900 p-2 rounded-full hover:bg-red-50 transition-colors duration-150","title","Desactivar rutina",3,"click",4,"ngIf"],["class","text-green-600 hover:text-green-900 p-2 rounded-full hover:bg-green-50 transition-colors duration-150","title","Reactivar rutina",3,"click",4,"ngIf"],[1,"space-y-2","mb-4"],[1,"text-sm","font-medium","text-gray-900"],[1,"flex","flex-wrap","gap-1"],["class","inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800",4,"ngFor","ngForOf"],[1,"inline-flex","items-center","px-2","py-1","rounded-md","text-xs","font-medium","bg-gray-100","text-gray-800"],[1,"mb-4"],["class","inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",4,"ngFor","ngForOf"],[1,"inline-flex","items-center","px-2","py-1","rounded-md","text-xs","font-medium","bg-blue-100","text-blue-800"],["title","Ver rutina completa",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Editar rutina",1,"text-red-600","hover:text-red-900","p-2","rounded-full","hover:bg-red-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Desactivar rutina",1,"text-red-600","hover:text-red-900","p-2","rounded-full","hover:bg-red-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],["title","Reactivar rutina",1,"text-green-600","hover:text-green-900","p-2","rounded-full","hover:bg-green-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"modal-container","modal-backdrop"],[1,"flex","items-center","justify-start","min-h-screen"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],[1,"modal-panel","modal-enter","relative"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"modal-body"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"text-red-500"],["type","text","placeholder","Nombre de la rutina",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],["type","number","placeholder","60",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],["rows","3","placeholder","Descripci\xF3n de la rutina",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],[1,"border-t","pt-6"],[1,"text-lg","font-medium","text-gray-900","mb-4"],[1,"grid","grid-cols-2","md:grid-cols-5","gap-2","mb-6"],["class","flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",3,"bg-red-50","border-red-300",4,"ngFor","ngForOf"],[1,"space-y-6"],["class","border border-gray-200 rounded-lg p-4 slide-up",3,"hidden",4,"ngFor","ngForOf"],["class","mt-4 bg-red-50 border border-red-200 rounded-md p-3",4,"ngIf"],[1,"modal-footer"],[1,"flex","flex-col","sm:flex-row-reverse","gap-3"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed","btn-primary",3,"click","disabled"],["class","mr-2",4,"ngIf"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:mt-0","sm:w-auto","sm:text-sm","disabled:opacity-50","btn-secondary",3,"click","disabled"],[1,"flex","items-center","p-3","border","border-gray-300","rounded-lg","cursor-pointer","hover:bg-gray-50","transition-colors"],["type","checkbox",1,"h-4","w-4","text-red-600","focus:ring-red-500","border-gray-300","rounded","checkbox-seccion",3,"change","checked"],[1,"ml-2","text-sm","font-medium","text-gray-900"],[1,"border","border-gray-200","rounded-lg","p-4","slide-up"],[1,"text-md","font-medium","text-gray-900","mb-3","flex","items-center"],[1,"bg-red-100","text-red-800","px-2","py-1","rounded","text-sm","mr-2","tag"],["class","grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",4,"ngIf"],[1,"space-y-3"],[1,"flex","justify-between","items-center"],["type","button",1,"inline-flex","items-center","px-2","py-1","border","border-transparent","text-xs","font-medium","rounded","text-red-700","bg-red-100","hover:bg-red-200","action-btn","transition-all",3,"click"],["class","border border-gray-200 rounded-lg p-3 bg-gray-50 fade-in",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-8 text-gray-500 empty-state",4,"ngIf"],["type","text","placeholder","Ej: AMRAP 20:00, 3 Series, etc.",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"input","value"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","placeholder","20:00",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"input","value"],["type","number","placeholder","3",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"input","value"],["type","text","placeholder","10:00",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"input","value"],[1,"border","border-gray-200","rounded-lg","p-3","bg-gray-50","fade-in"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-3"],[1,"lg:col-span-2"],[1,"block","text-xs","font-medium","text-gray-700","mb-1"],["type","text","placeholder","Nombre del ejercicio",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],[1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],["value","cardio"],["value","fuerza"],["value","funcional"],["value","core"],["value","movilidad"],["value","activacion"],["value","equilibrio"],["value","coordinaci\xF3n"],[1,"flex","items-end"],["type","button","title","Eliminar ejercicio",1,"text-red-600","hover:text-red-800","p-1","action-btn","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],[1,"grid","grid-cols-2","md:grid-cols-4","lg:grid-cols-6","gap-3","mt-3"],["type","number","placeholder","12",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],["type","number","placeholder","3",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","2:00",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","800m",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],["type","number","min","1","max","10","placeholder","7",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","20kg",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],[1,"mt-3"],["type","text","placeholder","Notas adicionales sobre el ejercicio",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500","form-input",3,"ngModelChange","ngModel"],[1,"text-center","py-8","text-gray-500","empty-state"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-8","w-8","text-gray-400","mb-2"],[1,"text-sm"],["type","button",1,"mt-2","text-red-600","hover:text-red-800","text-sm","action-btn",3,"click"],[1,"mt-4","bg-red-50","border","border-red-200","rounded-md","p-3"],[1,"mr-2"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-white"],["title","Crear nueva rutina",1,"md:hidden","fixed","bottom-6","right-6","w-14","h-14","bg-red-600","text-white","rounded-full","shadow-lg","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-500","focus:ring-offset-2","transition-all","duration-200","floating-action-btn","btn-floating",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","mx-auto"],[1,"modal-view-container","modal-backdrop"],[1,"flex","items-center","justify-end","min-h-screen"],[1,"modal-view-panel","modal-view-enter","relative"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4","border-b","border-gray-200"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["type","button",1,"ml-auto","-mt-2","-mr-2","p-2","rounded-full","text-gray-400","hover:text-gray-600","hover:bg-gray-100","focus:outline-none","focus:ring-2","focus:ring-gray-500","action-btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"modal-body","bg-gray-50"],[1,"bg-gray-900","text-green-400","rounded-lg","p-6","font-mono","text-sm","overflow-auto","max-h-96","relative",2,"font-family","'Courier New', monospace","line-height","1.6"],[1,"flex","items-center","justify-between","mb-4","pb-2","border-b","border-gray-700"],[1,"w-3","h-3","bg-red-500","rounded-full"],[1,"w-3","h-3","bg-yellow-500","rounded-full"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-gray-400","text-xs"],[1,"whitespace-pre-wrap","text-white"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3 fade-in",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","action-btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"inline-flex","items-center","px-3","py-2","border","border-transparent","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","action-btn",3,"click"],[1,"flex","flex-col","sm:flex-row","gap-3","justify-end"],["type","button",1,"inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:text-sm","btn-secondary",3,"click"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3","fade-in"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],[1,"text-sm","text-green-700"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),s(5,"Gesti\xF3n de Rutinas"),r(),n(6,"p",4),s(7),r()(),n(8,"div",5)(9,"button",6),f("click",function(){return i.refreshRutinas()}),b(),n(10,"svg",7),p(11,"path",8),r(),s(12," Refrescar "),r(),x(13,fn,4,0,"button",9),r()()(),y(),n(14,"div",10)(15,"div",11)(16,"div",12)(17,"label",13),s(18,"Buscar"),r(),n(19,"input",14),k("ngModelChange",function(c){return E(i.searchTerm,c)||(i.searchTerm=c),c}),f("input",function(){return i.onSearch()}),r()(),n(20,"div")(21,"label",13),s(22,"Estado"),r(),n(23,"select",15),k("ngModelChange",function(c){return E(i.statusFilter,c)||(i.statusFilter=c),c}),f("change",function(){return i.onFilterChange()}),n(24,"option",16),s(25,"Todos"),r(),n(26,"option",17),s(27,"Activos"),r(),n(28,"option",18),s(29,"Inactivos"),r()()(),n(30,"div")(31,"label",13),s(32,"Tipo"),r(),n(33,"select",15),k("ngModelChange",function(c){return E(i.tipoFilter,c)||(i.tipoFilter=c),c}),f("change",function(){return i.onFilterChange()}),n(34,"option",16),s(35,"Todos"),r(),n(36,"option",19),s(37,"Entrenamiento"),r(),n(38,"option",20),s(39,"Recuperaci\xF3n"),r(),n(40,"option",21),s(41,"Evaluaci\xF3n"),r()()(),n(42,"div")(43,"label",13),s(44,"Nivel"),r(),n(45,"select",15),k("ngModelChange",function(c){return E(i.nivelFilter,c)||(i.nivelFilter=c),c}),f("change",function(){return i.onFilterChange()}),n(46,"option",16),s(47,"Todos"),r(),n(48,"option",22),s(49,"Principiante"),r(),n(50,"option",23),s(51,"Intermedio"),r(),n(52,"option",24),s(53,"Avanzado"),r()()()(),n(54,"div",25)(55,"button",26),f("click",function(){return i.clearFilters()}),s(56," Limpiar filtros "),r()()(),x(57,_n,7,1,"div",27)(58,xn,2,0,"div",28)(59,kn,2,2,"div",29)(60,In,10,3,"div",30),r(),x(61,Ln,66,14,"div",31)(62,Nn,3,0,"button",32)(63,Bn,44,4,"div",33)),e&2&&(l(7),v(" Crea y administra rutinas de entrenamiento - Total: ",i.rutinas.length," "),l(6),m("ngIf",i.canEditRutina()),l(6),M("ngModel",i.searchTerm),l(4),M("ngModel",i.statusFilter),l(10),M("ngModel",i.tipoFilter),l(12),M("ngModel",i.nivelFilter),l(12),m("ngIf",i.error&&!i.showModal&&!i.showViewModal),l(),m("ngIf",i.loading),l(),m("ngIf",!i.loading),l(),m("ngIf",!i.loading&&i.filteredRutinas.length===0),l(),m("ngIf",i.showModal),l(),m("ngIf",!i.showModal&&!i.showViewModal&&i.canEditRutina()),l(),m("ngIf",i.showViewModal))},dependencies:[N,R,J,Z,q,Pe,Q,W,Oe,Ie,G],styles:['.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.slide-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.rutina-card[_ngcontent-%COMP%]{transition:all .3s ease}.rutina-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}.btn-floating[_ngcontent-%COMP%]{box-shadow:0 4px 20px #ef444466;transition:all .3s ease}.btn-floating[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 6px 25px #ef444499}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);background-color:#0009;z-index:9998}.modal-container[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;overflow-y:auto;padding:1rem}.modal-panel[_ngcontent-%COMP%]{margin-left:280px;max-width:calc(100vw - 320px);width:100%;background:#fff;border-radius:.5rem;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;transform:translateY(20px);transition:all .3s ease}@media (min-width: 768px){.sidebar-collapsed[_ngcontent-%COMP%]   .modal-panel[_ngcontent-%COMP%]{margin-left:80px;max-width:calc(100vw - 120px)}}.modal-view-container[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;overflow-y:auto;padding:1rem 2rem 1rem 1rem;display:flex;align-items:center;justify-content:flex-end}.modal-view-panel[_ngcontent-%COMP%]{margin-left:300px;max-width:900px;width:100%;background:#fff;border-radius:.5rem;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;max-height:90vh;overflow-y:auto;transform:translate(20px);transition:all .3s ease}@media (max-width: 767px){.modal-panel[_ngcontent-%COMP%], .modal-view-panel[_ngcontent-%COMP%]{margin-left:0;max-width:calc(100vw - 2rem);margin:1rem}.modal-container[_ngcontent-%COMP%], .modal-view-container[_ngcontent-%COMP%]{padding:.5rem}.modal-view-container[_ngcontent-%COMP%]{justify-content:center;padding-right:.5rem}}@media (max-width: 1024px) and (min-width: 768px){.modal-panel[_ngcontent-%COMP%]{margin-left:240px;max-width:calc(100vw - 280px)}.modal-view-panel[_ngcontent-%COMP%]{margin-left:260px;max-width:calc(100vw - 300px)}}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar, .modal-view-panel[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-track, .modal-view-panel[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .modal-view-panel[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#dc2626;border-radius:10px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .modal-view-panel[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#b91c1c}.tag[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tagAppear .2s ease-out}@keyframes _ngcontent-%COMP%_tagAppear{0%{transform:scale(.8);opacity:0}to{transform:scale(1);opacity:1}}.custom-spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #dc2626;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.form-input[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 3px #ef44441a;border-color:#dc2626}.rutinas-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}@media (max-width: 640px){.rutinas-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.checkbox-seccion[_ngcontent-%COMP%]{transform:scale(1.2);transition:transform .2s ease}.checkbox-seccion[_ngcontent-%COMP%]:checked{transform:scale(1.3)}.empty-state[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .5s ease-out}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.gradient-red[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc2626,#b91c1c)}.gradient-gray[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563)}.badge-status[_ngcontent-%COMP%]{position:relative;overflow:hidden}.badge-status[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.badge-status[_ngcontent-%COMP%]:hover:before{left:100%}.action-btn[_ngcontent-%COMP%]{position:relative;overflow:hidden;transition:all .3s ease}.action-btn[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;background-color:#fff3;border-radius:50%;transform:translate(-50%,-50%);transition:width .6s,height .6s}.action-btn[_ngcontent-%COMP%]:hover:before{width:300px;height:300px}.tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip[_ngcontent-%COMP%]   .tooltiptext[_ngcontent-%COMP%]{visibility:hidden;width:120px;background-color:#374151;color:#fff;text-align:center;border-radius:6px;padding:5px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-60px;opacity:0;transition:opacity .3s;font-size:12px}.tooltip[_ngcontent-%COMP%]:hover   .tooltiptext[_ngcontent-%COMP%]{visibility:visible;opacity:1}.floating-action-btn[_ngcontent-%COMP%]{z-index:9997}.main-content.sidebar-expanded[_ngcontent-%COMP%]   .modal-panel[_ngcontent-%COMP%]{margin-left:280px;max-width:calc(100vw - 320px)}.main-content.sidebar-collapsed[_ngcontent-%COMP%]   .modal-panel[_ngcontent-%COMP%]{margin-left:80px;max-width:calc(100vw - 120px)}.main-content.sidebar-expanded[_ngcontent-%COMP%]   .modal-view-panel[_ngcontent-%COMP%]{margin-left:300px;max-width:calc(100vw - 340px)}.main-content.sidebar-collapsed[_ngcontent-%COMP%]   .modal-view-panel[_ngcontent-%COMP%]{margin-left:100px;max-width:calc(100vw - 140px)}.modal-enter[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(30px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-view-enter[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalSlideInRight .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideInRight{0%{opacity:0;transform:translate(30px) scale(.95)}to{opacity:1;transform:translate(0) scale(1)}}@media (max-width: 768px){.modal-content[_ngcontent-%COMP%]{max-height:90vh}.grid-responsive[_ngcontent-%COMP%]{grid-template-columns:1fr}.text-responsive[_ngcontent-%COMP%]{font-size:.875rem}}@media (prefers-color-scheme: dark){.card-dark[_ngcontent-%COMP%]{background-color:#1f2937;border-color:#374151}.text-dark[_ngcontent-%COMP%]{color:#f9fafb}}@media print{.no-print[_ngcontent-%COMP%]{display:none!important}.print-only[_ngcontent-%COMP%]{display:block!important}}.focus-visible[_ngcontent-%COMP%]:focus{outline:2px solid #dc2626;outline-offset:2px}@media (prefers-contrast: high){.btn-primary[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]{border:2px solid #000}}.modal-body[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto;padding:1rem}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb;background-color:#f9fafb;padding:1rem;border-radius:0 0 .5rem .5rem}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#b91c1c;transform:translateY(-1px);box-shadow:0 4px 12px #b91c1c66}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}']})};var $n=(a,t)=>({"bg-green-100 text-green-800":a,"bg-red-100 text-red-800":t});function qn(a,t){if(a&1){let e=C();n(0,"div",32)(1,"div",33),b(),n(2,"svg",34),p(3,"path",35),r(),y(),n(4,"div",36)(5,"p",37),s(6),r()(),n(7,"div",38)(8,"button",39),f("click",function(){u(e);let o=d();return g(o.error="")}),b(),n(9,"svg",40),p(10,"path",41),r()()()()()}if(a&2){let e=d();l(6),w(e.error)}}function Wn(a,t){a&1&&(n(0,"div",42)(1,"div",43),p(2,"div",44),n(3,"p",45),s(4,"Cargando tipos de secci\xF3n..."),r()()())}function Gn(a,t){if(a&1&&p(0,"i"),a&2){let e=d().$implicit;D(e.icono+" text-red-600 text-2xl")}}function Hn(a,t){a&1&&(b(),n(0,"svg",68),p(1,"path",69),r())}function Yn(a,t){if(a&1){let e=C();n(0,"button",70),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.deleteTipo(o))}),b(),n(1,"svg",64),p(2,"path",71),r(),s(3," Desactivar "),r()}}function Qn(a,t){if(a&1){let e=C();n(0,"button",72),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.reactivateTipo(o))}),b(),n(1,"svg",64),p(2,"path",73),r(),s(3," Reactivar "),r()}}function Jn(a,t){if(a&1){let e=C();n(0,"div",49)(1,"div",50)(2,"div",51),x(3,Gn,1,2,"i",52)(4,Hn,2,0,"svg",53),r(),n(5,"h3",54),s(6),r(),n(7,"p",55),s(8),r(),n(9,"div",56)(10,"span",57),b(),n(11,"svg",58),p(12,"circle",59),r(),s(13),r()(),y(),n(14,"p",60),s(15),r()(),n(16,"div",61)(17,"div",62)(18,"button",63),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.openEditModal(o))}),b(),n(19,"svg",64),p(20,"path",65),r(),s(21," Editar "),r(),x(22,Yn,4,0,"button",66)(23,Qn,4,0,"button",67),r()()()}if(a&2){let e=t.$implicit,i=d(2);l(3),m("ngIf",e.icono),l(),m("ngIf",!e.icono),l(2),w(e.descripcion),l(2),w(e.nombre),l(2),m("ngClass",Ce(9,$n,e.status===1,e.status===0)),l(3),v(" ",i.getStatusText(e.status)," "),l(2),v(" Creado: ",i.formatDate(e.created_at)," "),l(7),m("ngIf",e.status===1),l(),m("ngIf",e.status===0)}}function Zn(a,t){if(a&1){let e=C();n(0,"button",81),f("click",function(){u(e);let o=d(3);return g(o.openCreateModal())}),s(1," Crear primer tipo "),r()}}function Xn(a,t){if(a&1){let e=C();n(0,"button",82),f("click",function(){u(e);let o=d(3);return g(o.clearFilters())}),s(1," Limpiar filtros "),r()}}function Kn(a,t){if(a&1&&(n(0,"div",74),b(),n(1,"svg",75),p(2,"path",69),r(),y(),n(3,"h3",76),s(4,"No hay tipos de secci\xF3n"),r(),n(5,"p",77),s(6),r(),n(7,"div",78),x(8,Zn,2,0,"button",79)(9,Xn,2,0,"button",80),r()()),a&2){let e=d(2);l(6),v(" ",e.tiposSecciones.length===0?"No se encontraron tipos de secci\xF3n.":"No se encontraron resultados con los filtros aplicados."," "),l(2),m("ngIf",e.tiposSecciones.length===0),l(),m("ngIf",e.tiposSecciones.length>0)}}function er(a,t){if(a&1&&(n(0,"div",46),x(1,Jn,24,12,"div",47)(2,Kn,10,3,"div",48),r()),a&2){let e=d();l(),m("ngForOf",e.filteredTiposSecciones)("ngForTrackBy",e.trackByTipoId),l(),m("ngIf",e.filteredTiposSecciones.length===0)}}function tr(a,t){if(a&1){let e=C();n(0,"div",116)(1,"div",117),p(2,"i"),n(3,"span",118),s(4),r(),n(5,"button",119),f("click",function(){u(e);let o=d(2);return g(o.clearIcon())}),b(),n(6,"svg",120),p(7,"path",41),r()()()()}if(a&2){let e=d(2);l(2),D(e.tipoForm.icono+" text-red-600 text-2xl mr-3"),l(2),w(e.tipoForm.icono)}}function ir(a,t){if(a&1){let e=C();n(0,"button",121),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.selectIcon(o.clase))}),p(1,"i"),r()}if(a&2){let e=t.$implicit,i=d(2);D(i.getIconButtonClass(e.clase)),m("title",e.nombre),l(),D(e.clase)}}function nr(a,t){if(a&1&&(n(0,"div",122)(1,"div",33),b(),n(2,"svg",34),p(3,"path",35),r(),y(),n(4,"div",36)(5,"p",37),s(6),r()()()()),a&2){let e=d(2);l(6),w(e.error)}}function rr(a,t){if(a&1){let e=C();n(0,"div",83)(1,"div",84)(2,"div",85),f("click",function(){u(e);let o=d();return g(o.closeModal())}),r(),n(3,"span",86),s(4,"\u200B"),r(),n(5,"div",87)(6,"div",88)(7,"div",89)(8,"div",90),b(),n(9,"svg",91),p(10,"path",69),r()(),y(),n(11,"div",92)(12,"h3",93),s(13),r(),n(14,"div",94)(15,"p",95),s(16),r()()()()(),n(17,"div",96)(18,"form",97)(19,"div")(20,"label",98),s(21," Nombre (Identificador) "),n(22,"span",99),s(23,"*"),r()(),n(24,"input",100),k("ngModelChange",function(o){u(e);let c=d();return E(c.tipoForm.nombre,o)||(c.tipoForm.nombre=o),g(o)}),r(),n(25,"p",101),s(26," Se convertir\xE1 autom\xE1ticamente a formato snake_case (ej: warm_up) "),r()(),n(27,"div")(28,"label",102),s(29," Descripci\xF3n "),n(30,"span",99),s(31,"*"),r()(),n(32,"input",103),k("ngModelChange",function(o){u(e);let c=d();return E(c.tipoForm.descripcion,o)||(c.tipoForm.descripcion=o),g(o)}),r()(),n(33,"div")(34,"label",104),s(35," Icono "),r(),x(36,tr,8,3,"div",105),n(37,"div",106),x(38,ir,2,5,"button",107),r(),n(39,"p",101),s(40," Selecciona un icono de la lista o deja vac\xEDo para usar el icono por defecto "),r()(),n(41,"div")(42,"label",108),s(43," Estado "),r(),n(44,"select",109),k("ngModelChange",function(o){u(e);let c=d();return E(c.tipoForm.status,o)||(c.tipoForm.status=o),g(o)}),n(45,"option",110),s(46,"Activo"),r(),n(47,"option",111),s(48,"Inactivo"),r()()()(),x(49,nr,7,1,"div",112),r(),n(50,"div",113)(51,"button",114),f("click",function(){u(e);let o=d();return g(o.saveTipo())}),s(52),r(),n(53,"button",115),f("click",function(){u(e);let o=d();return g(o.closeModal())}),s(54," Cancelar "),r()()()()()}if(a&2){let e=d();l(13),v(" ",e.modalMode==="create"?"Crear Nuevo Tipo de Secci\xF3n":"Editar Tipo de Secci\xF3n"," "),l(3),v(" ",e.modalMode==="create"?"Complete los datos para crear un nuevo tipo de secci\xF3n.":"Modifique los datos del tipo de secci\xF3n seleccionado."," "),l(8),M("ngModel",e.tipoForm.nombre),l(8),M("ngModel",e.tipoForm.descripcion),l(4),m("ngIf",e.tipoForm.icono),l(2),m("ngForOf",e.iconosDisponibles),l(6),M("ngModel",e.tipoForm.status),l(5),m("ngIf",e.error),l(2),m("disabled",!e.isFormValid()),l(),v(" ",e.modalMode==="create"?"Crear Tipo":"Guardar Cambios"," ")}}var dt=class a{constructor(t,e){this.supabaseService=t;this.authService=e}tiposSecciones=[];filteredTiposSecciones=[];loading=!1;error="";showModal=!1;modalMode="create";selectedTipo=null;tipoForm={nombre:"",descripcion:"",icono:"",status:1};searchTerm="";statusFilter="active";iconosDisponibles=[{clase:"fas fa-fire",nombre:"Fuego - Intensidad"},{clase:"fas fa-heartbeat",nombre:"Cardio"},{clase:"fas fa-dumbbell",nombre:"Pesas"},{clase:"fas fa-circle-dot",nombre:"Core"},{clase:"fas fa-plus-circle",nombre:"Extra"},{clase:"fas fa-running",nombre:"Corriendo"},{clase:"fas fa-hand-paper",nombre:"Flexibilidad"},{clase:"fas fa-spa",nombre:"Recuperaci\xF3n"},{clase:"fas fa-bolt",nombre:"Potencia"},{clase:"fas fa-star",nombre:"Destacado"},{clase:"fas fa-shield-alt",nombre:"Resistencia"},{clase:"fas fa-stopwatch",nombre:"Tiempo"},{clase:"fas fa-trophy",nombre:"Competici\xF3n"},{clase:"fas fa-chart-line",nombre:"Progreso"},{clase:"fas fa-weight-hanging",nombre:"Peso"},{clase:"fas fa-bicycle",nombre:"Ciclismo"},{clase:"fas fa-swimming-pool",nombre:"Nataci\xF3n"},{clase:"fas fa-hiking",nombre:"Funcional"},{clase:"fas fa-mountain",nombre:"Resistencia"},{clase:"fas fa-thermometer-half",nombre:"Calentamiento"}];ngOnInit(){return h(this,null,function*(){if(!this.authService.isAdmin()){this.error="No tienes permisos para acceder a esta secci\xF3n";return}yield this.loadTiposSecciones()})}loadTiposSecciones(){return h(this,null,function*(){this.loading=!0,this.error="";try{console.log("Cargando tipos de secci\xF3n...");let t=yield this.supabaseService.getData("tipos_seccion");this.tiposSecciones=t||[],this.filteredTiposSecciones=[...this.tiposSecciones],this.applyFilters(),console.log("Tipos de secci\xF3n cargados:",this.tiposSecciones.length)}catch(t){console.error("Error cargando tipos de secci\xF3n:",t),this.error="Error al cargar los tipos de secci\xF3n. Verifique la conexi\xF3n a la base de datos."}finally{this.loading=!1}})}applyFilters(){let t=[...this.tiposSecciones];if(this.statusFilter==="active"?t=t.filter(e=>e.status===1):this.statusFilter==="inactive"&&(t=t.filter(e=>e.status===0)),this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.nombre.toLowerCase().includes(e)||i.descripcion.toLowerCase().includes(e))}this.filteredTiposSecciones=t}openCreateModal(){this.modalMode="create",this.tipoForm={nombre:"",descripcion:"",icono:"",status:1},this.error="",this.showModal=!0}openEditModal(t){this.modalMode="edit",this.selectedTipo=t,this.tipoForm=ge({},t),this.error="",this.showModal=!0}closeModal(){this.showModal=!1,this.selectedTipo=null,this.error=""}saveTipo(){return h(this,null,function*(){try{if(this.error="",!this.tipoForm.nombre?.trim()){this.error="El nombre es requerido";return}if(!this.tipoForm.descripcion?.trim()){this.error="La descripci\xF3n es requerida";return}if(this.tipoForm.nombre.trim().length>50){this.error="El nombre no puede exceder 50 caracteres";return}if(this.tipoForm.descripcion.trim().length>100){this.error="La descripci\xF3n no puede exceder 100 caracteres";return}let t=this.tipoForm.nombre;if(this.tipoForm.nombre=this.tipoForm.nombre.toLowerCase().trim().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,""),!this.tipoForm.nombre){this.error="El nombre debe contener al menos una letra o n\xFAmero v\xE1lido";return}if(console.log(`Nombre convertido de "${t}" a "${this.tipoForm.nombre}"`),this.tiposSecciones.some(i=>i.nombre.toLowerCase()===this.tipoForm.nombre.toLowerCase()&&(this.modalMode==="create"||i.id!==this.selectedTipo?.id))){this.error="Ya existe un tipo de secci\xF3n con ese nombre";return}this.tipoForm.icono?.trim()||(this.tipoForm.icono=""),this.modalMode==="create"?(console.log("Creando tipo de secci\xF3n:",this.tipoForm),yield this.supabaseService.insertData("tipos_seccion",this.tipoForm),console.log("Tipo de secci\xF3n creado exitosamente")):(console.log("Actualizando tipo de secci\xF3n:",this.tipoForm),yield this.supabaseService.updateData("tipos_seccion",this.selectedTipo.id.toString(),this.tipoForm),console.log("Tipo de secci\xF3n actualizado exitosamente")),yield this.loadTiposSecciones(),this.closeModal()}catch(t){console.error("Error guardando tipo de secci\xF3n:",t),this.error="Error al guardar el tipo de secci\xF3n. Intente nuevamente."}})}deleteTipo(t){return h(this,null,function*(){let e=`\xBFEst\xE1 seguro de desactivar el tipo de secci\xF3n "${t.descripcion}"?`;if(confirm(e))try{console.log("Desactivando tipo de secci\xF3n:",t.nombre),yield this.supabaseService.updateData("tipos_seccion",t.id.toString(),{status:0}),yield this.loadTiposSecciones(),console.log("Tipo de secci\xF3n desactivado exitosamente")}catch(i){console.error("Error desactivando tipo de secci\xF3n:",i),this.error="Error al desactivar el tipo de secci\xF3n",setTimeout(()=>this.error="",5e3)}})}reactivateTipo(t){return h(this,null,function*(){let e=`\xBFEst\xE1 seguro de reactivar el tipo de secci\xF3n "${t.descripcion}"?`;if(confirm(e))try{console.log("Reactivando tipo de secci\xF3n:",t.nombre),yield this.supabaseService.updateData("tipos_seccion",t.id.toString(),{status:1}),yield this.loadTiposSecciones(),console.log("Tipo de secci\xF3n reactivado exitosamente")}catch(i){console.error("Error reactivando tipo de secci\xF3n:",i),this.error="Error al reactivar el tipo de secci\xF3n",setTimeout(()=>this.error="",5e3)}})}getStatusText(t){return t===1?"Activo":"Inactivo"}getStatusColor(t){return t===1?"green":"red"}formatDate(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(e){return console.error("Error formateando fecha:",e),"Fecha inv\xE1lida"}}onSearch(){this.applyFilters()}onFilterChange(){this.applyFilters()}clearFilters(){this.searchTerm="",this.statusFilter="active",this.applyFilters()}refreshTipos(){return h(this,null,function*(){console.log("Refrescando tipos de secci\xF3n"),yield this.loadTiposSecciones()})}selectIcon(t){this.tipoForm.icono=t,console.log("Icono seleccionado:",t)}trackByTipoId(t,e){return e.id||t}isIconSelected(t){return this.tipoForm.icono===t}clearIcon(){this.tipoForm.icono=""}isFormValid(){return!!(this.tipoForm.nombre?.trim()&&this.tipoForm.descripcion?.trim())}getIconButtonClass(t){let e="p-2 rounded-md border transition-colors duration-150 hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-500";return this.isIconSelected(t)?`${e} border-red-500 bg-red-50`:`${e} border-gray-200`}static \u0275fac=function(e){return new(e||a)(I(te),I(j))};static \u0275cmp=A({type:a,selectors:[["app-tipos-seccion"]],standalone:!1,decls:44,vars:7,consts:[[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],["title","Refrescar lista",1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"md:col-span-2"],["for","search",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],["id","search","type","text","placeholder","Buscar por nombre o descripci\xF3n...",1,"block","w-full","pl-10","pr-3","py-2","border","border-gray-300","rounded-md","leading-5","bg-white","placeholder-gray-500","focus:outline-none","focus:placeholder-gray-400","focus:ring-1","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","input","ngModel"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["for","statusFilter",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","statusFilter",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","change","ngModel"],["value","all"],["value","active"],["value","inactive"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-red-600","hover:text-red-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"ml-auto","pl-3"],[1,"text-red-400","hover:text-red-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","justify-center","items-center","h-64"],[1,"text-center"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-red-600","mx-auto"],[1,"mt-4","text-gray-600"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-6"],["class","bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 border border-gray-200",4,"ngFor","ngForOf","ngForTrackBy"],["class","col-span-full text-center py-12",4,"ngIf"],[1,"bg-white","rounded-lg","shadow-md","hover:shadow-lg","transition-shadow","duration-200","border","border-gray-200"],[1,"p-6","text-center"],[1,"mx-auto","h-16","w-16","bg-red-100","rounded-full","flex","items-center","justify-center","mb-4"],[3,"class",4,"ngIf"],["class","h-8 w-8 text-red-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-sm","text-gray-500","mb-3"],[1,"mb-4"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["fill","currentColor","viewBox","0 0 8 8",1,"w-2","h-2","mr-1"],["cx","4","cy","4","r","3"],[1,"text-xs","text-gray-400","mb-4"],[1,"px-6","pb-6"],[1,"flex","justify-center","space-x-2"],["title","Editar tipo",1,"flex-1","inline-flex","items-center","justify-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["class","flex-1 inline-flex items-center justify-center px-3 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-red-50 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500","title","Desactivar",3,"click",4,"ngIf"],["class","flex-1 inline-flex items-center justify-center px-3 py-2 border border-green-300 shadow-sm text-sm font-medium rounded-md text-green-700 bg-green-50 hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500","title","Reactivar",3,"click",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-8","w-8","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 00-2 2v2a2 2 0 002 2m0 0h14"],["title","Desactivar",1,"flex-1","inline-flex","items-center","justify-center","px-3","py-2","border","border-red-300","shadow-sm","text-sm","font-medium","rounded-md","text-red-700","bg-red-50","hover:bg-red-100","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636"],["title","Reactivar",1,"flex-1","inline-flex","items-center","justify-center","px-3","py-2","border","border-green-300","shadow-sm","text-sm","font-medium","rounded-md","text-green-700","bg-green-50","hover:bg-green-100","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-green-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"col-span-full","text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-end","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-2xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"text-sm","text-gray-500"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"space-y-4"],["for","nombre",1,"block","text-sm","font-medium","text-gray-700"],[1,"text-red-500"],["id","nombre","type","text","name","nombre","required","","placeholder","Ej: warm_up, strength, cardio",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-red-500","focus:border-red-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"mt-1","text-xs","text-gray-500"],["for","descripcion",1,"block","text-sm","font-medium","text-gray-700"],["id","descripcion","type","text","name","descripcion","required","","placeholder","Ej: Calentamiento, Entrenamiento de Fuerza, Cardiovascular",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-red-500","focus:border-red-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["class","mb-3 p-3 bg-gray-50 rounded-md",4,"ngIf"],[1,"grid","grid-cols-5","sm:grid-cols-8","gap-2","max-h-48","overflow-y-auto","border","border-gray-200","rounded-md","p-3"],["type","button",3,"class","title","click",4,"ngFor","ngForOf"],["for","status",1,"block","text-sm","font-medium","text-gray-700"],["id","status","name","status",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-red-500","focus:border-red-500","sm:text-sm",3,"ngModelChange","ngModel"],["value","1"],["value","0"],["class","mt-4 bg-red-50 border border-red-200 rounded-md p-3",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:mt-0","sm:ml-3","sm:w-auto","sm:text-sm",3,"click"],[1,"mb-3","p-3","bg-gray-50","rounded-md"],[1,"flex","items-center"],[1,"text-sm","text-gray-700"],["type","button","title","Limpiar icono",1,"ml-auto","text-red-600","hover:text-red-800",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["type","button",3,"click","title"],[1,"mt-4","bg-red-50","border","border-red-200","rounded-md","p-3"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),s(5,"Gesti\xF3n de Tipos de Secci\xF3n"),r(),n(6,"p",4),s(7),r()(),n(8,"div",5)(9,"button",6),f("click",function(){return i.refreshTipos()}),b(),n(10,"svg",7),p(11,"path",8),r(),s(12," Refrescar "),r(),y(),n(13,"button",9),f("click",function(){return i.openCreateModal()}),b(),n(14,"svg",10),p(15,"path",11),r(),s(16," Nuevo Tipo "),r()()()(),y(),n(17,"div",12)(18,"div",13)(19,"div",14)(20,"label",15),s(21," Buscar "),r(),n(22,"div",16)(23,"input",17),k("ngModelChange",function(c){return E(i.searchTerm,c)||(i.searchTerm=c),c}),f("input",function(){return i.onSearch()}),r(),n(24,"div",18),b(),n(25,"svg",19),p(26,"path",20),r()()()(),y(),n(27,"div")(28,"label",21),s(29," Estado "),r(),n(30,"select",22),k("ngModelChange",function(c){return E(i.statusFilter,c)||(i.statusFilter=c),c}),f("change",function(){return i.onFilterChange()}),n(31,"option",23),s(32,"Todos"),r(),n(33,"option",24),s(34,"Activos"),r(),n(35,"option",25),s(36,"Inactivos"),r()()()(),n(37,"div",26)(38,"button",27),f("click",function(){return i.clearFilters()}),s(39," Limpiar filtros "),r()()(),x(40,qn,11,1,"div",28)(41,Wn,5,0,"div",29)(42,er,3,3,"div",30),r(),x(43,rr,55,10,"div",31)),e&2&&(l(7),v(" Administra los tipos de secci\xF3n para entrenamientos - Total: ",i.tiposSecciones.length," "),l(16),M("ngModel",i.searchTerm),l(7),M("ngModel",i.statusFilter),l(10),m("ngIf",i.error),l(),m("ngIf",i.loading),l(),m("ngIf",!i.loading),l(),m("ngIf",i.showModal))},dependencies:[$,N,R,ee,J,Z,q,Q,W,K,ye,G,de],styles:['.tipo-card[_ngcontent-%COMP%]{transition:all .3s ease}.tipo-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.icon-grid[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#e5e7eb #f9fafb}.icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f9fafb;border-radius:3px}.icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#e5e7eb;border-radius:3px}.icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#d1d5db}.icon-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;transition:all .2s ease}.icon-button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.icon-button.selected[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #dc2626}.card-enter[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_cardEnter .3s ease-out}@keyframes _ngcontent-%COMP%_cardEnter{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-weight:500;font-size:.75rem;padding:.25rem .5rem;border-radius:9999px}.status-active[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.status-inactive[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b}.action-button[_ngcontent-%COMP%]{transition:all .2s ease}.action-button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 8px #0000001a}@media (max-width: 768px){.icon-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}.icon-button[_ngcontent-%COMP%]{width:36px;height:36px}}.focus-ring[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 2px #dc2626}.icon-preview[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.75rem;background-color:#f9fafb;border-radius:.375rem;margin-bottom:.75rem}.icon-preview[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.75rem;font-size:1.5rem;color:#dc2626}.error-message[_ngcontent-%COMP%]{background-color:#fef2f2;border:1px solid #fecaca;color:#991b1b;padding:.75rem;border-radius:.375rem;font-size:.875rem;margin-top:1rem}.tooltip[_ngcontent-%COMP%]{position:relative}.tooltip[_ngcontent-%COMP%]:hover:after{content:attr(title);position:absolute;bottom:100%;left:50%;transform:translate(-50%);background-color:#1f2937;color:#fff;padding:.25rem .5rem;border-radius:.25rem;font-size:.75rem;white-space:nowrap;z-index:10;margin-bottom:.25rem}.button-loading[_ngcontent-%COMP%]{opacity:.7;cursor:not-allowed}.button-loading[_ngcontent-%COMP%]:before{content:"";width:1rem;height:1rem;border:2px solid transparent;border-top:2px solid currentColor;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-right:.5rem;display:inline-block}']})};var or=(a,t,e,i,o)=>({"bg-green-100 text-green-800":a,"bg-blue-100 text-blue-800":t,"bg-yellow-100 text-yellow-800":e,"bg-red-100 text-red-800":i,"bg-gray-100 text-gray-600":o}),ar=(a,t,e,i)=>({"bg-gray-100 text-gray-800":a,"bg-yellow-100 text-yellow-800":t,"bg-green-100 text-green-800":e,"bg-red-100 text-red-800":i});function sr(a,t){if(a&1){let e=C();n(0,"button",34),f("click",function(){u(e);let o=d();return g(o.openAsignarModal())}),b(),n(1,"svg",35),p(2,"path",36),r(),s(3," Asignar Rutina "),r()}}function lr(a,t){if(a&1&&(n(0,"option",37),s(1),r()),a&2){let e=t.$implicit;m("value",e.nombre),l(),v(" ",e.nombre," ")}}function cr(a,t){if(a&1&&(n(0,"div",38)(1,"div",39),b(),n(2,"svg",40),p(3,"path",41),r(),y(),n(4,"div",42)(5,"p",43),s(6),r()()()()),a&2){let e=d();l(6),w(e.error)}}function dr(a,t){a&1&&(n(0,"div",44),p(1,"div",45),r())}function mr(a,t){if(a&1&&(n(0,"span",78),s(1),r()),a&2){let e=d(2).$implicit,i=d(2);l(),v(" ",i.getDiasRestantes(e.fecha_fin_programada)," d\xEDas restantes ")}}function pr(a,t){a&1&&(n(0,"span",79),s(1," Vence hoy "),r())}function ur(a,t){if(a&1&&(n(0,"div",75),x(1,mr,2,1,"span",76)(2,pr,2,0,"span",77),r()),a&2){let e=d().$implicit,i=d(2);l(),m("ngIf",i.getDiasRestantes(e.fecha_fin_programada)>0),l(),m("ngIf",i.getDiasRestantes(e.fecha_fin_programada)===0)}}function gr(a,t){a&1&&(n(0,"div",80),s(1," Vencida "),r())}function fr(a,t){if(a&1){let e=C();n(0,"button",81),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.cancelarAsignacion(o.asignacion_id))}),b(),n(1,"svg",73),p(2,"path",82),r()()}}function _r(a,t){if(a&1){let e=C();n(0,"tr",56)(1,"td",57)(2,"div")(3,"div",58),s(4),r(),n(5,"div",59),s(6),r()()(),n(7,"td",57)(8,"div",60),b(),n(9,"svg",61),p(10,"path",62),r(),y(),n(11,"span",58),s(12),r(),n(13,"span",63),s(14,"usuarios"),r()()(),n(15,"td",64)(16,"div")(17,"div"),s(18),r(),n(19,"div",65),s(20),r(),x(21,ur,3,2,"div",66)(22,gr,2,0,"div",67),r()(),n(23,"td",57)(24,"span",68),p(25,"i"),s(26),r()(),n(27,"td",57)(28,"div",69),s(29),r(),n(30,"div",59),s(31),r()(),n(32,"td",70)(33,"div",71)(34,"button",72),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.openVerModal(o))}),b(),n(35,"svg",73),p(36,"path",10)(37,"path",11),r()(),x(38,fr,3,0,"button",74),r()()()}if(a&2){let e=t.$implicit,i=d(2);O("opacity-50",!e.es_activa)("bg-gray-50",!e.es_activa),l(3),O("text-gray-500",!e.es_activa),l(),v(" ",e.rutina_nombre," "),l(2),w(e.rutina_descripcion),l(5),O("text-gray-500",!e.es_activa),l(),v(" ",e.usuarios_count," "),l(4),O("text-gray-500",!e.es_activa),l(2),w(i.formatDate(e.fecha_inicio_programada)),l(2),w(i.formatDate(e.fecha_fin_programada)),l(),m("ngIf",e.es_activa),l(),m("ngIf",!e.es_activa&&i.isVencida(e.fecha_fin_programada)),l(2),m("ngClass",je(30,or,e.estado_asignacion==="activa"&&e.es_activa,e.estado_asignacion==="completada",e.estado_asignacion==="pausada",e.estado_asignacion==="cancelada"||e.estado_asignacion==="expirada",!e.es_activa)),l(),D(i.getEstadoIcon(e.estado_asignacion)+" mr-1"),l(),v(" ",!e.es_activa&&e.estado_asignacion==="activa"?"expirada":e.estado_asignacion," "),l(2),O("text-gray-500",!e.es_activa),l(),v(" ",e.asignado_por_nombre," "),l(2),w(i.formatDate(e.fecha_asignacion)),l(3),O("text-gray-400",!e.es_activa)("hover:text-gray-600",!e.es_activa),l(4),m("ngIf",e.es_activa&&e.estado_asignacion==="activa"&&i.canAssignRoutines())}}function xr(a,t){a&1&&(fe(0),s(1," No se han creado asignaciones a\xFAn. "),_e())}function vr(a,t){a&1&&s(0," No se encontraron asignaciones con los filtros aplicados. ")}function br(a,t){if(a&1){let e=C();n(0,"button",92),f("click",function(){u(e);let o=d(3);return g(o.openAsignarModal())}),s(1," Crear primera asignaci\xF3n "),r()}}function hr(a,t){if(a&1){let e=C();n(0,"button",93),f("click",function(){u(e);let o=d(3);return g(o.clearFilters())}),s(1," Limpiar filtros "),r()}}function Cr(a,t){if(a&1&&(n(0,"div",83),b(),n(1,"svg",84),p(2,"path",85),r(),y(),n(3,"h3",86),s(4,"No hay asignaciones"),r(),n(5,"p",87),x(6,xr,2,0,"ng-container",88)(7,vr,1,0,"ng-template",null,0,oe),r(),n(9,"div",89),x(10,br,2,0,"button",90)(11,hr,2,0,"button",91),r()()),a&2){let e=X(8),i=d(2);l(6),m("ngIf",i.asignaciones.length===0)("ngIfElse",e),l(4),m("ngIf",i.asignaciones.length===0&&i.canAssignRoutines()),l(),m("ngIf",i.asignaciones.length>0)}}function wr(a,t){if(a&1&&(n(0,"div",46)(1,"div",47)(2,"h3",48),s(3),r()(),n(4,"div",49)(5,"table",50)(6,"thead",51)(7,"tr")(8,"th",52),s(9," Rutina "),r(),n(10,"th",52),s(11," Usuarios "),r(),n(12,"th",52),s(13," Fechas / Duraci\xF3n "),r(),n(14,"th",52),s(15," Estado "),r(),n(16,"th",52),s(17," Asignado por "),r(),n(18,"th",52),s(19," Acciones "),r()()(),n(20,"tbody",53),x(21,_r,39,36,"tr",54),r()(),x(22,Cr,12,4,"div",55),r()()),a&2){let e=d();l(3),v(" Asignaciones Realizadas (",e.filteredAsignaciones.length,") "),l(18),m("ngForOf",e.filteredAsignaciones)("ngForTrackBy",e.trackByAsignacionId),l(),m("ngIf",e.filteredAsignaciones.length===0)}}function yr(a,t){if(a&1&&(n(0,"option",37),s(1),r()),a&2){let e=t.$implicit;m("value",e.id),l(),z(" ",e.nombre," - ",e.nivel," ")}}function Sr(a,t){if(a&1&&(n(0,"div",130)(1,"div",60),b(),n(2,"svg",131),p(3,"path",132),r(),y(),n(4,"div",133)(5,"span",134),s(6,"Fecha de finalizaci\xF3n:"),r(),n(7,"span",135),s(8),r()()()()),a&2){let e=d(2);l(8),w(e.formatDate(e.calcularFechaFin(e.asignacionForm.fecha_inicio)))}}function Mr(a,t){if(a&1){let e=C();n(0,"label",136)(1,"input",137),f("change",function(){let o=u(e).$implicit,c=d(2);return g(c.toggleUsuario(o.id))}),r(),n(2,"div",138)(3,"div",58),s(4),r(),n(5,"div",139),s(6),r()()()}if(a&2){let e=t.$implicit,i=d(2);O("bg-red-50",i.isUsuarioSelected(e.id)),l(),m("checked",i.isUsuarioSelected(e.id)),l(3),w(e.full_name),l(2),v("@",e.username,"")}}function Er(a,t){a&1&&(n(0,"span"),s(1," usuario seleccionado"),r())}function kr(a,t){a&1&&s(0," usuarios seleccionados")}function Tr(a,t){if(a&1&&(n(0,"div",140)(1,"div",39),b(),n(2,"svg",40),p(3,"path",41),r(),y(),n(4,"div",42)(5,"p",43),s(6),r()()()()),a&2){let e=d(2);l(6),w(e.error)}}function Pr(a,t){a&1&&(b(),n(0,"svg",141),p(1,"path",12),r())}function Ir(a,t){if(a&1){let e=C();n(0,"div",94)(1,"div",95)(2,"div",96),f("click",function(){u(e);let o=d();return g(o.closeAsignarModal())}),r(),n(3,"span",97),s(4,"\u200B"),r(),n(5,"div",98)(6,"div",99)(7,"div",100)(8,"div",101),b(),n(9,"svg",102),p(10,"path",36),r()(),y(),n(11,"div",103)(12,"h3",48),s(13," Asignar Rutina a Usuarios "),r(),n(14,"div",104)(15,"p",59),s(16," Selecciona una rutina y los usuarios. La asignaci\xF3n durar\xE1 autom\xE1ticamente 1 mes. "),r()()()()(),n(17,"div",105)(18,"form",106)(19,"div")(20,"label",17),s(21," Rutina "),n(22,"span",107),s(23,"*"),r()(),n(24,"select",108),k("ngModelChange",function(o){u(e);let c=d();return E(c.asignacionForm.id_rutina,o)||(c.asignacionForm.id_rutina=o),g(o)}),n(25,"option",109),s(26,"Selecciona una rutina"),r(),x(27,yr,2,3,"option",26),r()(),n(28,"div",110)(29,"div")(30,"label",17),s(31," Fecha de Inicio "),n(32,"span",107),s(33,"*"),r()(),n(34,"input",111),k("ngModelChange",function(o){u(e);let c=d();return E(c.asignacionForm.fecha_inicio,o)||(c.asignacionForm.fecha_inicio=o),g(o)}),r()(),n(35,"div")(36,"label",17),s(37," Duraci\xF3n "),r(),n(38,"div",112),b(),n(39,"svg",113),p(40,"path",114),r(),y(),n(41,"span",115),s(42,"1 mes (autom\xE1tico)"),r()()()(),x(43,Sr,9,1,"div",116),n(44,"div")(45,"label",17),s(46," Notas (Opcional) "),r(),n(47,"textarea",117),k("ngModelChange",function(o){u(e);let c=d();return E(c.asignacionForm.notas,o)||(c.asignacionForm.notas=o),g(o)}),r()(),n(48,"div")(49,"div",118)(50,"label",119),s(51," Usuarios "),n(52,"span",107),s(53,"*"),r()(),n(54,"div",7)(55,"button",120),f("click",function(){u(e);let o=d();return g(o.selectAllUsuarios())}),s(56," Seleccionar todos "),r(),n(57,"button",121),f("click",function(){u(e);let o=d();return g(o.clearAllUsuarios())}),s(58," Limpiar selecci\xF3n "),r()()(),n(59,"div",122)(60,"div",123),x(61,Mr,7,5,"label",124),r()(),n(62,"div",6)(63,"span"),s(64),r(),x(65,Er,2,0,"span",88)(66,kr,1,0,"ng-template",null,1,oe),r()()(),x(68,Tr,7,1,"div",125),r(),n(69,"div",126)(70,"button",127),f("click",function(){u(e);let o=d();return g(o.asignarRutina())}),x(71,Pr,2,0,"svg",128),s(72," Asignar por 1 mes "),r(),n(73,"button",129),f("click",function(){u(e);let o=d();return g(o.closeAsignarModal())}),s(74," Cancelar "),r()()()()()}if(a&2){let e=X(67),i=d();l(24),M("ngModel",i.asignacionForm.id_rutina),l(3),m("ngForOf",i.rutinas)("ngForTrackBy",i.trackByRutinaId),l(7),M("ngModel",i.asignacionForm.fecha_inicio),l(9),m("ngIf",i.asignacionForm.fecha_inicio),l(4),M("ngModel",i.asignacionForm.notas),l(14),m("ngForOf",i.usuarios)("ngForTrackBy",i.trackByUserId),l(3),w(i.asignacionForm.usuarios_seleccionados.length),l(),m("ngIf",i.asignacionForm.usuarios_seleccionados.length===1)("ngIfElse",e),l(3),m("ngIf",i.error),l(2),m("disabled",i.loading||!i.asignacionForm.id_rutina||i.asignacionForm.usuarios_seleccionados.length===0),l(),m("ngIf",i.loading),l(2),m("disabled",i.loading)}}function Or(a,t){a&1&&(n(0,"span",156),s(1," (Asignaci\xF3n vencida) "),r())}function Vr(a,t){if(a&1&&(n(0,"span",78),s(1),r()),a&2){let e=d(3);l(),v(" ",e.getDiasRestantes(e.selectedAsignacion.fecha_fin_programada)," d\xEDas restantes ")}}function Fr(a,t){a&1&&(n(0,"span",79),s(1," Vence hoy "),r())}function Dr(a,t){a&1&&(n(0,"span",158),s(1," Asignaci\xF3n vencida "),r())}function Ar(a,t){if(a&1&&(n(0,"div",75),x(1,Vr,2,1,"span",76)(2,Fr,2,0,"span",77)(3,Dr,2,0,"span",157),r()),a&2){let e=d(2);l(),m("ngIf",e.selectedAsignacion.es_activa&&e.getDiasRestantes(e.selectedAsignacion.fecha_fin_programada)>0),l(),m("ngIf",e.selectedAsignacion.es_activa&&e.getDiasRestantes(e.selectedAsignacion.fecha_fin_programada)===0),l(),m("ngIf",!e.selectedAsignacion.es_activa)}}function Rr(a,t){if(a&1){let e=C();n(0,"div",104)(1,"input",171),f("input",function(o){u(e);let c=d().$implicit,_=d(2);return g(_.actualizarProgreso(c.seguimiento_id,o))}),r()()}if(a&2){let e=d().$implicit;l(),m("value",e.progreso)}}function jr(a,t){a&1&&(n(0,"div",172),s(1," Progreso final "),r())}function Ur(a,t){if(a&1&&(n(0,"div")(1,"strong"),s(2,"Inicio:"),r(),s(3),r()),a&2){let e=d().$implicit,i=d(2);l(3),v(" ",i.formatDate(e.fecha_inicio_real)," ")}}function Lr(a,t){if(a&1&&(n(0,"div")(1,"strong"),s(2,"Fin:"),r(),s(3),r()),a&2){let e=d().$implicit,i=d(2);l(3),v(" ",i.formatDate(e.fecha_fin_real)," ")}}function Nr(a,t){a&1&&(n(0,"div",65),s(1," Sin fechas registradas "),r())}function zr(a,t){if(a&1){let e=C();n(0,"button",173),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.editarNotasIndividuales(o))}),b(),n(1,"svg",73),p(2,"path",174),r()()}}function Br(a,t){a&1&&(n(0,"span",175),s(1," Solo lectura "),r())}function $r(a,t){if(a&1&&(n(0,"tr",56)(1,"td",57)(2,"div",60)(3,"div",159)(4,"span",160),s(5),r()(),n(6,"div")(7,"div",58),s(8),r(),n(9,"div",59),s(10),r()()()(),n(11,"td",57)(12,"div",60)(13,"div",161),p(14,"div",162),r(),n(15,"span",58),s(16),r()(),x(17,Rr,2,1,"div",163)(18,jr,2,0,"div",164),r(),n(19,"td",57)(20,"span",68),s(21),r()(),n(22,"td",64),x(23,Ur,4,1,"div",165)(24,Lr,4,1,"div",165)(25,Nr,2,0,"div",166),r(),n(26,"td",167)(27,"div",168),s(28),r()(),n(29,"td",70)(30,"div",71),x(31,zr,3,0,"button",169)(32,Br,2,0,"span",170),r()()()),a&2){let e=t.$implicit,i=d(2);l(5),v(" ",(e.full_name||"U").charAt(0).toUpperCase()," "),l(3),w(e.full_name),l(2),v("@",e.username,""),l(4),Y("width",e.progreso,"%"),l(2),v("",e.progreso,"%"),l(),m("ngIf",i.canAssignRoutines()&&(i.selectedAsignacion==null?null:i.selectedAsignacion.es_activa)),l(),m("ngIf",!(i.selectedAsignacion!=null&&i.selectedAsignacion.es_activa)),l(2),m("ngClass",ve(16,ar,e.estado_individual==="pendiente",e.estado_individual==="en_progreso",e.estado_individual==="completada",e.estado_individual==="cancelada")),l(),v(" ",e.estado_individual," "),l(2),m("ngIf",e.fecha_inicio_real),l(),m("ngIf",e.fecha_fin_real),l(),m("ngIf",!e.fecha_inicio_real&&!e.fecha_fin_real),l(3),v(" ",e.notas_individuales||"-"," "),l(3),m("ngIf",i.canAssignRoutines()&&(i.selectedAsignacion==null?null:i.selectedAsignacion.es_activa)),l(),m("ngIf",!(i.selectedAsignacion!=null&&i.selectedAsignacion.es_activa))}}function qr(a,t){a&1&&(n(0,"div",176),b(),n(1,"svg",177),p(2,"path",178),r(),y(),n(3,"h3",86),s(4,"Sin seguimiento disponible"),r(),n(5,"p",87),s(6," No se encontraron datos de seguimiento para esta asignaci\xF3n. "),r()())}function Wr(a,t){if(a&1&&(n(0,"div",179)(1,"h4",180),s(2,"Resumen del Progreso"),r(),n(3,"div",181)(4,"div")(5,"div",182),s(6),r(),n(7,"div",139),s(8,"Pendientes"),r()(),n(9,"div")(10,"div",183),s(11),r(),n(12,"div",139),s(13,"En Progreso"),r()(),n(14,"div")(15,"div",184),s(16),r(),n(17,"div",139),s(18,"Completadas"),r()(),n(19,"div")(20,"div",185),s(21),r(),n(22,"div",139),s(23,"Progreso Promedio"),r()()()()),a&2){let e=d(2);l(6),v(" ",e.getEstadisticasProgreso().pendientes," "),l(5),v(" ",e.getEstadisticasProgreso().enProgreso," "),l(5),v(" ",e.getEstadisticasProgreso().completadas," "),l(5),v(" ",e.getEstadisticasProgreso().promedioProgreso,"% ")}}function Gr(a,t){if(a&1){let e=C();n(0,"div",94)(1,"div",95)(2,"div",96),f("click",function(){u(e);let o=d();return g(o.closeVerModal())}),r(),n(3,"span",97),s(4,"\u200B"),r(),n(5,"div",142)(6,"div",99)(7,"div",100)(8,"div",143),b(),n(9,"svg",144),p(10,"path",145),r()(),y(),n(11,"div",103)(12,"h3",48),s(13),r(),n(14,"div",104)(15,"p",59),s(16," Progreso individual de cada usuario asignado "),x(17,Or,2,0,"span",146),r()()()()(),n(18,"div",147)(19,"div",148)(20,"div",149)(21,"div")(22,"span",150),s(23,"Per\xEDodo:"),r(),n(24,"div",151),s(25),r(),x(26,Ar,4,3,"div",66),r(),n(27,"div")(28,"span",150),s(29,"Total usuarios:"),r(),n(30,"div",151),s(31),r()(),n(32,"div")(33,"span",150),s(34,"Asignado por:"),r(),n(35,"div",151),s(36),r()()()(),n(37,"div",49)(38,"table",50)(39,"thead",51)(40,"tr")(41,"th",52),s(42," Usuario "),r(),n(43,"th",52),s(44," Progreso "),r(),n(45,"th",52),s(46," Estado "),r(),n(47,"th",52),s(48," Fechas Reales "),r(),n(49,"th",52),s(50," Notas "),r(),n(51,"th",52),s(52," Acciones "),r()()(),n(53,"tbody",53),x(54,$r,33,21,"tr",152),r()(),x(55,qr,7,0,"div",153),r(),x(56,Wr,24,4,"div",154),r(),n(57,"div",126)(58,"button",155),f("click",function(){u(e);let o=d();return g(o.closeVerModal())}),s(59," Cerrar "),r()()()()()}if(a&2){let e=d();l(13),v(" Seguimiento: ",e.selectedAsignacion==null?null:e.selectedAsignacion.rutina_nombre," "),l(4),m("ngIf",e.selectedAsignacion&&!e.selectedAsignacion.es_activa),l(2),O("bg-red-50",e.selectedAsignacion&&!e.selectedAsignacion.es_activa),l(6),z(" ",e.formatDate((e.selectedAsignacion==null?null:e.selectedAsignacion.fecha_inicio_programada)||"")," - ",e.formatDate((e.selectedAsignacion==null?null:e.selectedAsignacion.fecha_fin_programada)||"")," "),l(),m("ngIf",e.selectedAsignacion),l(5),w(e.selectedAsignacion==null?null:e.selectedAsignacion.usuarios_count),l(5),w(e.selectedAsignacion==null?null:e.selectedAsignacion.asignado_por_nombre),l(18),m("ngForOf",e.seguimientoDetalle)("ngForTrackBy",e.trackByUserId),l(),m("ngIf",e.seguimientoDetalle.length===0),l(),m("ngIf",e.seguimientoDetalle.length>0)}}function Hr(a,t){if(a&1){let e=C();n(0,"button",186),f("click",function(){u(e);let o=d();return g(o.openAsignarModal())}),b(),n(1,"svg",187),p(2,"path",36),r()()}}var mt=class a{constructor(t,e){this.supabaseService=t;this.authService=e}rutinas=[];usuarios=[];asignaciones=[];loading=!1;error="";showAsignarModal=!1;showVerModal=!1;selectedAsignacion=null;seguimientoDetalle=[];asignacionForm={id_rutina:0,usuarios_seleccionados:[],fecha_inicio:"",notas:""};searchTerm="";estadoFilter="all";rutinaFilter="all";mostrarInactivas=!0;ngOnInit(){return h(this,null,function*(){yield this.loadInitialData(),yield this.procesarAsignacionesVencidas()})}loadInitialData(){return h(this,null,function*(){this.loading=!0;try{yield Promise.all([this.loadRutinas(),this.loadUsuarios(),this.loadAsignaciones()])}catch(t){console.error("Error cargando datos iniciales:",t),this.error="Error al cargar los datos"}finally{this.loading=!1}})}loadRutinas(){return h(this,null,function*(){try{let t=yield this.supabaseService.getData("rutinas");this.rutinas=t?.filter(e=>e.status===1)||[]}catch(t){console.error("Error cargando rutinas:",t)}})}loadUsuarios(){return h(this,null,function*(){try{let t=yield this.supabaseService.getData("profiles");this.usuarios=t?.filter(e=>e.status===1)||[]}catch(t){console.error("Error cargando usuarios:",t)}})}loadAsignaciones(){return h(this,null,function*(){try{let t=this.supabaseService.client.from("rutina_asignaciones_masivas").select(`
          id,
          id_rutina,
          usuarios_asignados,
          fecha_inicio,
          fecha_fin,
          estado,
          notas,
          created_at,
          status,
          rutinas(nombre, descripcion),
          profiles!rutina_asignaciones_masivas_asignado_por_fkey(full_name)
        `);this.mostrarInactivas||(t=t.eq("status",1));let{data:e,error:i}=yield t.order("created_at",{ascending:!1});if(i)throw i;this.asignaciones=(e||[]).map(o=>{let c=new Date(o.fecha_fin),_=new Date,S=o.status===1&&c>=_;return{asignacion_id:o.id,rutina_nombre:o.rutinas?.nombre||"Rutina no encontrada",rutina_descripcion:o.rutinas?.descripcion||"",fecha_inicio_programada:o.fecha_inicio,fecha_fin_programada:o.fecha_fin,usuarios_count:o.usuarios_asignados?.length||0,estado_asignacion:o.estado,asignado_por_nombre:o.profiles?.full_name||"Usuario no encontrado",fecha_asignacion:o.created_at,notas_asignacion:o.notas,status:o.status,es_activa:S}})}catch(t){console.error("Error cargando asignaciones:",t),yield this.loadAsignacionesAlternativo()}})}loadAsignacionesAlternativo(){return h(this,null,function*(){try{let[t,e,i]=yield Promise.all([this.supabaseService.getData("rutina_asignaciones_masivas"),this.supabaseService.getData("rutinas"),this.supabaseService.getData("profiles")]),o=t||[];this.mostrarInactivas||(o=o.filter(c=>c.status===1)),this.asignaciones=o.map(c=>{let _=e?.find(V=>V.id===c.id_rutina),S=i?.find(V=>V.id===c.asignado_por),P=new Date(c.fecha_fin),T=new Date,L=c.status===1&&P>=T;return{asignacion_id:c.id,rutina_nombre:_?.nombre||"Rutina no encontrada",rutina_descripcion:_?.descripcion||"",fecha_inicio_programada:c.fecha_inicio,fecha_fin_programada:c.fecha_fin,usuarios_count:c.usuarios_asignados?.length||0,estado_asignacion:c.estado,asignado_por_nombre:S?.full_name||"Usuario no encontrado",fecha_asignacion:c.created_at,notas_asignacion:c.notas,status:c.status,es_activa:L}})}catch(t){console.error("Error en m\xE9todo alternativo:",t),this.asignaciones=[]}})}procesarAsignacionesVencidas(){return h(this,null,function*(){try{let e=new Date().toISOString().split("T")[0],{data:i,error:o}=yield this.supabaseService.client.from("rutina_asignaciones_masivas").select("id").eq("status",1).lt("fecha_fin",e);if(o){console.error("Error buscando asignaciones vencidas:",o);return}if(i&&i.length>0){let c=i.map(S=>S.id),{error:_}=yield this.supabaseService.client.from("rutina_asignaciones_masivas").update({status:0,estado:"expirada",updated_at:new Date().toISOString()}).in("id",c);_?console.error("Error actualizando asignaciones vencidas:",_):console.log(`${c.length} asignaciones marcadas como vencidas`)}}catch(t){console.error("Error procesando asignaciones vencidas:",t)}})}openAsignarModal(){this.asignacionForm={id_rutina:0,usuarios_seleccionados:[],fecha_inicio:this.getTomorrowDate(),notas:""},this.error="",this.showAsignarModal=!0}closeAsignarModal(){this.showAsignarModal=!1,this.error=""}openVerModal(t){return h(this,null,function*(){this.selectedAsignacion=t,yield this.loadSeguimientoDetalle(t.asignacion_id),this.showVerModal=!0})}closeVerModal(){this.showVerModal=!1,this.selectedAsignacion=null,this.seguimientoDetalle=[]}loadSeguimientoDetalle(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.client.from("v_rutinas_asignadas_usuarios").select("*").eq("asignacion_id",t).order("full_name");if(!i&&e){this.seguimientoDetalle=e;return}let{data:o,error:c}=yield this.supabaseService.client.from("rutina_seguimiento_individual").select(`
          id,
          id_asignacion_masiva,
          id_profile,
          progreso,
          estado_individual,
          fecha_inicio_real,
          fecha_fin_real,
          notas_individuales,
          profiles(username, full_name)
        `).eq("id_asignacion_masiva",t);if(c)throw c;this.seguimientoDetalle=(o||[]).map(_=>({seguimiento_id:_.id,asignacion_id:_.id_asignacion_masiva,id_profile:_.id_profile,username:_.profiles?.username||"N/A",full_name:_.profiles?.full_name||"Usuario no encontrado",progreso:_.progreso,estado_individual:_.estado_individual,fecha_inicio_real:_.fecha_inicio_real,fecha_fin_real:_.fecha_fin_real,notas_individuales:_.notas_individuales}))}catch(e){console.error("Error cargando seguimiento detalle:",e),this.seguimientoDetalle=[]}})}toggleUsuario(t){let e=this.asignacionForm.usuarios_seleccionados.indexOf(t);e>-1?this.asignacionForm.usuarios_seleccionados.splice(e,1):this.asignacionForm.usuarios_seleccionados.push(t)}isUsuarioSelected(t){return this.asignacionForm.usuarios_seleccionados.includes(t)}selectAllUsuarios(){this.asignacionForm.usuarios_seleccionados=this.usuarios.map(t=>t.id)}clearAllUsuarios(){this.asignacionForm.usuarios_seleccionados=[]}calcularFechaFin(t){if(!t)return"";let e=new Date(t);return e.setMonth(e.getMonth()+1),e.toISOString().split("T")[0]}asignarRutina(){return h(this,null,function*(){try{if(this.error="",!this.asignacionForm.id_rutina){this.error="Debe seleccionar una rutina";return}if(this.asignacionForm.usuarios_seleccionados.length===0){this.error="Debe seleccionar al menos un usuario";return}if(!this.asignacionForm.fecha_inicio){this.error="Debe especificar la fecha de inicio";return}this.loading=!0;let t=this.authService.getCurrentUser();if(!t?.id)throw new Error("Usuario no autenticado");let e=this.calcularFechaFin(this.asignacionForm.fecha_inicio),i;try{let{data:o,error:c}=yield this.supabaseService.client.rpc("asignar_rutina_a_usuarios",{p_id_rutina:this.asignacionForm.id_rutina,p_usuarios_ids:this.asignacionForm.usuarios_seleccionados,p_asignado_por:t.id,p_fecha_inicio:this.asignacionForm.fecha_inicio,p_fecha_fin:e,p_notas:this.asignacionForm.notas||null});if(c)throw c;i=o}catch{console.log("Funci\xF3n RPC no disponible, usando m\xE9todo manual");let c={id_rutina:this.asignacionForm.id_rutina,usuarios_asignados:this.asignacionForm.usuarios_seleccionados,asignado_por:t.id,fecha_inicio:this.asignacionForm.fecha_inicio,fecha_fin:e,notas:this.asignacionForm.notas||null,estado:"activa"},{data:_,error:S}=yield this.supabaseService.client.from("rutina_asignaciones_masivas").insert(c).select().single();if(S)throw S;i=_.id;let P=this.asignacionForm.usuarios_seleccionados.map(L=>({id_asignacion_masiva:i,id_profile:L,id_rutina:this.asignacionForm.id_rutina,progreso:0,estado_individual:"pendiente"})),{error:T}=yield this.supabaseService.client.from("rutina_seguimiento_individual").insert(P);if(T)throw T}console.log("Rutina asignada exitosamente, ID:",i),yield this.loadAsignaciones(),this.closeAsignarModal(),alert(`Rutina asignada exitosamente a ${this.asignacionForm.usuarios_seleccionados.length} usuarios por 1 mes`)}catch(t){console.error("Error asignando rutina:",t),this.error=t instanceof Error?t.message:"Error al asignar la rutina"}finally{this.loading=!1}})}cancelarAsignacion(t){return h(this,null,function*(){if(confirm("\xBFEst\xE1 seguro de cancelar esta asignaci\xF3n? Esta acci\xF3n afectar\xE1 a todos los usuarios asignados."))try{let{error:i}=yield this.supabaseService.client.from("rutina_asignaciones_masivas").update({estado:"cancelada",status:0,updated_at:new Date().toISOString()}).eq("id",t);if(i)throw i;yield this.loadAsignaciones(),alert("Asignaci\xF3n cancelada exitosamente")}catch(i){console.error("Error cancelando asignaci\xF3n:",i),alert("Error al cancelar la asignaci\xF3n")}})}actualizarProgreso(t,e){return h(this,null,function*(){try{let i=parseInt(e.target?.value||e)||0;if(i<0||i>100){alert("El progreso debe estar entre 0 y 100");return}let o={progreso:i,updated_at:new Date().toISOString()};if(i===0)o.estado_individual="pendiente";else if(i<100){o.estado_individual="en_progreso";let _=this.seguimientoDetalle.find(S=>S.seguimiento_id===t);_&&!_.fecha_inicio_real&&(o.fecha_inicio_real=new Date().toISOString().split("T")[0])}else o.estado_individual="completada",o.fecha_fin_real=new Date().toISOString().split("T")[0];let{error:c}=yield this.supabaseService.client.from("rutina_seguimiento_individual").update(o).eq("id",t);if(c)throw c;this.selectedAsignacion&&(yield this.loadSeguimientoDetalle(this.selectedAsignacion.asignacion_id))}catch(i){console.error("Error actualizando progreso:",i),alert("Error al actualizar el progreso")}})}editarNotasIndividuales(t){return h(this,null,function*(){let e=prompt("Ingrese las notas para este usuario:",t.notas_individuales||"");if(e!==null)try{let{error:i}=yield this.supabaseService.client.from("rutina_seguimiento_individual").update({notas_individuales:e,updated_at:new Date().toISOString()}).eq("id",t.seguimiento_id);if(i)throw i;this.selectedAsignacion&&(yield this.loadSeguimientoDetalle(this.selectedAsignacion.asignacion_id))}catch(i){console.error("Error actualizando notas:",i),alert("Error al actualizar las notas")}})}getEstadisticasProgreso(){if(!this.seguimientoDetalle||this.seguimientoDetalle.length===0)return{pendientes:0,enProgreso:0,completadas:0,promedioProgreso:0};let t=this.seguimientoDetalle.filter(_=>_.estado_individual==="pendiente").length,e=this.seguimientoDetalle.filter(_=>_.estado_individual==="en_progreso").length,i=this.seguimientoDetalle.filter(_=>_.estado_individual==="completada").length,o=this.seguimientoDetalle.reduce((_,S)=>_+(S.progreso||0),0),c=Math.round(o/this.seguimientoDetalle.length);return{pendientes:t,enProgreso:e,completadas:i,promedioProgreso:c}}toggleMostrarInactivas(){return h(this,null,function*(){this.mostrarInactivas=!this.mostrarInactivas,yield this.loadAsignaciones()})}getRutinaNombre(t){return this.rutinas.find(i=>i.id===t)?.nombre||"Rutina no encontrada"}getUserName(t){let e=this.usuarios.find(i=>i.id===t);return e?.full_name||e?.username||"Usuario no encontrado"}getEstadoColor(t,e=!0){if(!e)return"gray";switch(t){case"activa":return"green";case"completada":return"blue";case"pausada":return"yellow";case"cancelada":case"expirada":return"red";default:return"gray"}}getEstadoIcon(t){switch(t){case"activa":return"fas fa-play-circle";case"completada":return"fas fa-check-circle";case"pausada":return"fas fa-pause-circle";case"cancelada":return"fas fa-times-circle";case"expirada":return"fas fa-clock";default:return"fas fa-circle"}}formatDate(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}getTomorrowDate(){let t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}getDiasRestantes(t){let e=new Date(t),i=new Date,o=e.getTime()-i.getTime();return Math.ceil(o/(1e3*60*60*24))}isVencida(t){return this.getDiasRestantes(t)<0}get filteredAsignaciones(){let t=[...this.asignaciones];if(this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.rutina_nombre.toLowerCase().includes(e)||i.asignado_por_nombre.toLowerCase().includes(e))}return this.estadoFilter!=="all"&&(t=t.filter(e=>e.estado_asignacion===this.estadoFilter)),this.rutinaFilter!=="all"&&(t=t.filter(e=>e.rutina_nombre===this.rutinaFilter)),t}clearFilters(){this.searchTerm="",this.estadoFilter="all",this.rutinaFilter="all"}refreshData(){return h(this,null,function*(){yield this.procesarAsignacionesVencidas(),yield this.loadAsignaciones()})}canAssignRoutines(){return this.authService.isAdmin()||this.authService.hasProfile(3)}trackByAsignacionId(t,e){return e.asignacion_id}trackByUserId(t,e){return e.id}trackByRutinaId(t,e){return e.id}static \u0275fac=function(e){return new(e||a)(I(te),I(j))};static \u0275cmp=A({type:a,selectors:[["app-rutinas-usuario"]],standalone:!1,decls:57,vars:16,consts:[["filtrosAplicados",""],["pluralUsuarios",""],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["class","inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"md:col-span-2"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Buscar por rutina o asignador...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["value","all"],["value","activa"],["value","completada"],["value","pausada"],["value","cancelada"],["value","expirada"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-red-600","hover:text-red-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","bg-white shadow overflow-hidden sm:rounded-md",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],["class","md:hidden fixed bottom-6 right-6 w-14 h-14 bg-red-600 text-white rounded-full shadow-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 z-40","title","Asignar rutina",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[3,"value"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-red-600"],[1,"bg-white","shadow","overflow-hidden","sm:rounded-md"],[1,"px-4","py-5","sm:px-6","border-b","border-gray-200"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50",3,"opacity-50","bg-gray-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-12",4,"ngIf"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","text-gray-400","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"text-sm","text-gray-500","ml-1"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"text-gray-500"],["class","text-xs mt-1",4,"ngIf"],["class","text-xs text-red-500 mt-1",4,"ngIf"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","justify-end","space-x-2"],["title","Ver seguimiento",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["class","text-red-600 hover:text-red-900 p-2 rounded-full hover:bg-red-50","title","Cancelar asignaci\xF3n",3,"click",4,"ngIf"],[1,"text-xs","mt-1"],["class","text-green-600",4,"ngIf"],["class","text-yellow-600",4,"ngIf"],[1,"text-green-600"],[1,"text-yellow-600"],[1,"text-xs","text-red-500","mt-1"],["title","Cancelar asignaci\xF3n",1,"text-red-600","hover:text-red-900","p-2","rounded-full","hover:bg-red-50",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[4,"ngIf","ngIfElse"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-4xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"mt-2"],[1,"bg-white","px-4","pb-4","sm:px-6","max-h-96","overflow-y-auto"],[1,"space-y-6"],[1,"text-red-500"],["name","rutina",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["value","0"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["type","date","name","fechaInicio",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"flex","items-center","h-10","px-3","py-2","border","border-gray-200","rounded-md","bg-gray-50"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","text-gray-400","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-gray-600","font-medium"],["class","bg-blue-50 border border-blue-200 rounded-md p-3",4,"ngIf"],["name","notas","rows","3","placeholder","Notas adicionales sobre la asignaci\xF3n...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"flex","justify-between","items-center","mb-3"],[1,"block","text-sm","font-medium","text-gray-700"],["type","button",1,"text-xs","text-red-600","hover:text-red-800",3,"click"],["type","button",1,"text-xs","text-gray-600","hover:text-gray-800",3,"click"],[1,"border","border-gray-300","rounded-md","p-3","max-h-48","overflow-y-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-2"],["class","flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer",3,"bg-red-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","mt-4 bg-red-50 border border-red-200 rounded-md p-3",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","animate-spin -ml-1 mr-3 h-5 w-5 text-white","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:mt-0","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50",3,"click","disabled"],[1,"bg-blue-50","border","border-blue-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-blue-400","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm"],[1,"font-medium","text-blue-800"],[1,"text-blue-700","ml-1"],[1,"flex","items-center","p-2","hover:bg-gray-50","rounded","cursor-pointer"],["type","checkbox",1,"h-4","w-4","text-red-600","focus:ring-red-500","border-gray-300","rounded",3,"change","checked"],[1,"ml-3","flex-1"],[1,"text-xs","text-gray-500"],[1,"mt-4","bg-red-50","border","border-red-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-6xl","sm:w-full"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],["class","text-red-500 font-medium ml-2",4,"ngIf"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900"],["class","hover:bg-gray-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-8",4,"ngIf"],["class","mt-6 bg-gray-50 rounded-lg p-4",4,"ngIf"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"text-red-500","font-medium","ml-2"],["class","text-red-600",4,"ngIf"],[1,"text-red-600"],[1,"h-8","w-8","bg-gray-300","rounded-full","flex","items-center","justify-center","mr-3"],[1,"text-xs","font-medium","text-gray-700"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-3"],[1,"bg-blue-600","h-2","rounded-full"],["class","mt-2",4,"ngIf"],["class","mt-2 text-xs text-gray-500",4,"ngIf"],[4,"ngIf"],["class","text-gray-500",4,"ngIf"],[1,"px-6","py-4"],[1,"text-sm","text-gray-900","max-w-xs"],["class","text-indigo-600 hover:text-indigo-900 p-1 rounded hover:bg-indigo-50","title","Editar notas",3,"click",4,"ngIf"],["class","text-xs text-gray-400 px-2 py-1",4,"ngIf"],["type","range","min","0","max","100",1,"w-full","h-2","bg-gray-200","rounded-lg","appearance-none","cursor-pointer","slider",3,"input","value"],[1,"mt-2","text-xs","text-gray-500"],["title","Editar notas",1,"text-indigo-600","hover:text-indigo-900","p-1","rounded","hover:bg-indigo-50",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"text-xs","text-gray-400","px-2","py-1"],[1,"text-center","py-8"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-8","w-8","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"mt-6","bg-gray-50","rounded-lg","p-4"],[1,"text-sm","font-medium","text-gray-900","mb-3"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4","text-center"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-2xl","font-bold","text-yellow-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-2xl","font-bold","text-blue-600"],["title","Asignar rutina",1,"md:hidden","fixed","bottom-6","right-6","w-14","h-14","bg-red-600","text-white","rounded-full","shadow-lg","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-500","focus:ring-offset-2","transition-all","duration-200","z-40",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","mx-auto"]],template:function(e,i){e&1&&(n(0,"div",2)(1,"div",3)(2,"div",4)(3,"div")(4,"h1",5),s(5,"Asignaci\xF3n de Rutinas a Usuarios"),r(),n(6,"p",6),s(7),r()(),n(8,"div",7)(9,"button",8),f("click",function(){return i.toggleMostrarInactivas()}),b(),n(10,"svg",9),p(11,"path",10)(12,"path",11),r(),s(13),r(),y(),n(14,"button",8),f("click",function(){return i.refreshData()}),b(),n(15,"svg",9),p(16,"path",12),r(),s(17," Refrescar "),r(),x(18,sr,4,0,"button",13),r()()(),y(),n(19,"div",14)(20,"div",15)(21,"div",16)(22,"label",17),s(23,"Buscar"),r(),n(24,"input",18),k("ngModelChange",function(c){return E(i.searchTerm,c)||(i.searchTerm=c),c}),r()(),n(25,"div")(26,"label",17),s(27,"Estado"),r(),n(28,"select",19),k("ngModelChange",function(c){return E(i.estadoFilter,c)||(i.estadoFilter=c),c}),n(29,"option",20),s(30,"Todos los estados"),r(),n(31,"option",21),s(32,"Activa"),r(),n(33,"option",22),s(34,"Completada"),r(),n(35,"option",23),s(36,"Pausada"),r(),n(37,"option",24),s(38,"Cancelada"),r(),n(39,"option",25),s(40,"Expirada"),r()()(),n(41,"div")(42,"label",17),s(43,"Rutina"),r(),n(44,"select",19),k("ngModelChange",function(c){return E(i.rutinaFilter,c)||(i.rutinaFilter=c),c}),n(45,"option",20),s(46,"Todas las rutinas"),r(),x(47,lr,2,2,"option",26),r()()(),n(48,"div",27)(49,"button",28),f("click",function(){return i.clearFilters()}),s(50," Limpiar filtros "),r()()(),x(51,cr,7,1,"div",29)(52,dr,2,0,"div",30)(53,wr,23,4,"div",31),r(),x(54,Ir,75,15,"div",32)(55,Gr,60,13,"div",32)(56,Hr,3,0,"button",33)),e&2&&(l(7),v(" Gestiona las asignaciones masivas de rutinas (duraci\xF3n: 1 mes) - Total: ",i.asignaciones.length," "),l(2),O("bg-gray-200",i.mostrarInactivas),l(4),v(" ",i.mostrarInactivas?"Ocultar":"Mostrar"," vencidas "),l(5),m("ngIf",i.canAssignRoutines()),l(6),M("ngModel",i.searchTerm),l(4),M("ngModel",i.estadoFilter),l(16),M("ngModel",i.rutinaFilter),l(3),m("ngForOf",i.rutinas)("ngForTrackBy",i.trackByRutinaId),l(4),m("ngIf",i.error&&!i.showAsignarModal&&!i.showVerModal),l(),m("ngIf",i.loading&&!i.showAsignarModal&&!i.showVerModal),l(),m("ngIf",!i.loading),l(),m("ngIf",i.showAsignarModal),l(),m("ngIf",i.showVerModal),l(),m("ngIf",!i.showAsignarModal&&!i.showVerModal&&i.canAssignRoutines()))},dependencies:[$,N,R,ee,J,Z,q,Q,W,K,G,de],styles:['.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.modal-panel[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .3s ease-out}.asignacion-card[_ngcontent-%COMP%]{transition:all .3s ease}.asignacion-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000001a}.checkbox-usuario[_ngcontent-%COMP%]{transition:all .2s ease}.checkbox-usuario[_ngcontent-%COMP%]:checked{transform:scale(1.1)}.progress-bar[_ngcontent-%COMP%]{transition:width .8s ease-in-out;background:linear-gradient(90deg,#ef4444,#dc2626)}.progress-container[_ngcontent-%COMP%]{background-color:#f3f4f6;border-radius:9999px;overflow:hidden}.estado-activa[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);color:#fff}.estado-completada[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff}.estado-pausada[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b,#d97706);color:#fff}.estado-cancelada[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff}.btn-action[_ngcontent-%COMP%]{transition:all .2s ease}.btn-action[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}.estado-badge[_ngcontent-%COMP%]{position:relative;overflow:hidden}.estado-badge[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.estado-badge[_ngcontent-%COMP%]:hover:before{left:100%}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@media (max-width: 768px){.tabla-responsive[_ngcontent-%COMP%]{display:block;overflow-x:auto;white-space:nowrap}.tabla-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{min-width:600px}}.input-focus[_ngcontent-%COMP%]:focus{outline:none;ring:2px;ring-color:#ef4444;border-color:#ef4444;box-shadow:0 0 0 3px #ef44441a}.usuario-seleccionado[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef2f2,#fee2e2);border:2px solid #ef4444;transform:scale(1.02)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideInDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.tooltip[_ngcontent-%COMP%]{position:relative}.tooltip[_ngcontent-%COMP%]:hover:after{content:attr(data-tooltip);position:absolute;bottom:100%;left:50%;transform:translate(-50%);background:#1f2937;color:#fff;padding:4px 8px;border-radius:4px;font-size:12px;white-space:nowrap;z-index:1000}.seguimiento-table[_ngcontent-%COMP%]{border-collapse:separate;border-spacing:0}.seguimiento-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .seguimiento-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb}.seguimiento-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.progress-input[_ngcontent-%COMP%]{transition:all .2s ease}.progress-input[_ngcontent-%COMP%]:focus{border-color:#ef4444;box-shadow:0 0 0 3px #ef44441a}.tiempo-vigente[_ngcontent-%COMP%]{color:#059669;font-weight:600}.tiempo-vencido[_ngcontent-%COMP%]{color:#dc2626;font-weight:600}.tiempo-pendiente[_ngcontent-%COMP%]{color:#d97706;font-weight:600}.stat-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8fafc);border:1px solid #e2e8f0;transition:all .3s ease}.stat-card[_ngcontent-%COMP%]:hover{border-color:#ef4444;box-shadow:0 8px 25px #ef44441a}@media (max-width: 640px){.modal-panel[_ngcontent-%COMP%]{margin:0;max-height:100vh;border-radius:0}.grid-responsive[_ngcontent-%COMP%]{grid-template-columns:1fr}.flex-responsive[_ngcontent-%COMP%]{flex-direction:column;gap:8px}}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-out}.slide-in-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .5s ease-out}.slide-in-down[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInDown .5s ease-out}.loading-skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}']})};var pt=class a{constructor(t,e){this.supabaseService=t;this.authService=e}getRutinasUsuarioSimple(){return h(this,null,function*(){try{let t=this.authService.getCurrentUser();if(!t?.id)throw new Error("Usuario no autenticado");let{data:e,error:i}=yield this.supabaseService.client.from("rutina_seguimiento_individual").select(`
          id,
          id_asignacion_masiva,
          id_profile,
          id_rutina,
          progreso,
          estado_individual,
          fecha_inicio_real,
          fecha_fin_real,
          notas_individuales,
          rutina_asignaciones_masivas!inner(
            fecha_inicio,
            fecha_fin,
            estado,
            notas,
            status
          ),
          rutinas!inner(
            id,
            nombre,
            descripcion,
            tipo,
            nivel,
            duracion_estimada,
            warm_up,
            met_con,
            strength,
            core,
            extra,
            tags,
            status
          )
        `).eq("id_profile",t.id).eq("rutina_asignaciones_masivas.status",1).eq("rutinas.status",1).order("id",{ascending:!1});if(i)throw i;return e||[]}catch(t){return console.error("Error obteniendo rutinas del usuario:",t),[]}})}actualizarProgresoSimple(t,e){return h(this,null,function*(){try{let i={progreso:e,updated_at:new Date().toISOString()};if(e===0)i.estado_individual="pendiente";else if(e<100){i.estado_individual="en_progreso";let{data:c}=yield this.supabaseService.client.from("rutina_seguimiento_individual").select("fecha_inicio_real").eq("id",t).single();c&&!c.fecha_inicio_real&&(i.fecha_inicio_real=new Date().toISOString().split("T")[0])}else i.estado_individual="completada",i.fecha_fin_real=new Date().toISOString().split("T")[0];let{error:o}=yield this.supabaseService.client.from("rutina_seguimiento_individual").update(i).eq("id",t);if(o)throw o;return!0}catch(i){return console.error("Error actualizando progreso:",i),!1}})}calcularEstadoTemporal(t,e){let i=new Date,o=new Date(t),c=new Date(e),_;i<o?_="pendiente":i>c?_="vencida":_="vigente";let S=Math.ceil((c.getTime()-i.getTime())/(1e3*3600*24));return{estado:_,diasRestantes:S}}static \u0275fac=function(e){return new(e||a)(he(te),he(j))};static \u0275prov=ke({token:a,factory:a.\u0275fac,providedIn:"root"})};function Qr(a,t){if(a&1&&(n(0,"div",29),s(1),r()),a&2){let e=t.$implicit;l(),v(" ",e," ")}}function Jr(a,t){a&1&&p(0,"div",37)}function Zr(a,t){if(a&1){let e=C();n(0,"div",38),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.onClickRutina(o))}),n(1,"div",3)(2,"span",39),s(3),r(),p(4,"div",40),r(),n(5,"div",41)(6,"span",42),s(7),r()()()}if(a&2){let e=t.$implicit,i=d(2);m("ngClass",i.getColorByTipo(e.tipoEvento))("title",e.seguimiento.rutina_nombre+" - "+e.tipoEvento),l(3),v(" ",e.seguimiento.rutina_nombre," "),l(),m("ngClass",i.getColorByEstado(e.seguimiento.estado_temporal)),l(3),v(" \u{1F4C5} Inicia hoy (",e.seguimiento.progreso,"%) ")}}function Xr(a,t){if(a&1&&(n(0,"div",43),s(1),r()),a&2){let e=d().$implicit;l(),v(" +",e.rutinas.length-3," m\xE1s ")}}function Kr(a,t){if(a&1&&(n(0,"div",30)(1,"div",31)(2,"span",32),s(3),r(),x(4,Jr,1,0,"div",33),r(),n(5,"div",34),x(6,Zr,8,5,"div",35),r(),x(7,Xr,2,1,"div",36),r()),a&2){let e=t.$implicit,i=d();O("bg-gray-50",!e.esMesActual)("bg-blue-50",i.esHoy(e.fecha)),l(2),O("text-gray-400",!e.esMesActual)("text-gray-900",e.esMesActual&&!i.esHoy(e.fecha))("text-blue-600",i.esHoy(e.fecha))("font-bold",i.esHoy(e.fecha)),l(),v(" ",e.fecha.getDate()," "),l(),m("ngIf",i.esHoy(e.fecha)),l(2),m("ngForOf",e.rutinas)("ngForTrackBy",i.trackByRutina),l(),m("ngIf",e.rutinas.length>3)}}function eo(a,t){a&1&&(n(0,"div",44),b(),n(1,"svg",45),p(2,"path",46),r(),y(),n(3,"h3",47),s(4,"No hay rutinas para mostrar"),r(),n(5,"p",48),s(6," No tienes rutinas asignadas para mostrar en el calendario. "),r()())}function to(a,t){a&1&&(n(0,"div",87)(1,"div",88),b(),n(2,"svg",89),p(3,"path",90),r(),y(),n(4,"div",91)(5,"p",92),s(6,"\xA1Rutina copiada al portapapeles!"),r()()()())}function io(a,t){if(a&1){let e=C();n(0,"button",93),f("click",function(){u(e);let o=d(2);return g(o.exportarRutina(o.selectedRutina,o.selectedSeguimiento||void 0))}),b(),n(1,"svg",5),p(2,"path",94),r(),s(3," Descargar "),r()}}function no(a,t){if(a&1){let e=C();n(0,"div",49)(1,"div",50)(2,"div",51),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),r(),n(3,"span",52),s(4,"\u200B"),r(),n(5,"div",53)(6,"div",54)(7,"div",55)(8,"div",56),b(),n(9,"svg",57),p(10,"path",46),r()(),y(),n(11,"div",58)(12,"h3",59),s(13),r(),n(14,"div",60)(15,"p",61),s(16),r()()()()(),n(17,"div",62)(18,"div",63)(19,"div",64)(20,"div")(21,"span",65),s(22,"Mi Progreso:"),r(),n(23,"div",66)(24,"div",67),p(25,"div",68),r(),s(26),r()(),n(27,"div")(28,"span",65),s(29,"Estado:"),r(),n(30,"div",69),s(31),r()(),n(32,"div")(33,"span",65),s(34,"Per\xEDodo:"),r(),n(35,"div",69),s(36),r()(),n(37,"div")(38,"span",65),s(39,"D\xEDas restantes:"),r(),n(40,"div",69),s(41),r()()()(),n(42,"div",70)(43,"div",71),p(44,"img",72),r(),n(45,"div",73)(46,"div",74),p(47,"div",75)(48,"div",76)(49,"div",77),r(),n(50,"div",78),s(51),r()(),n(52,"pre",79),s(53),r()(),x(54,to,7,0,"div",80),n(55,"div",81)(56,"button",82),f("click",function(){u(e);let o=d();return g(o.copyToClipboard(o.getFormattedRutina(o.selectedRutina,o.selectedSeguimiento||void 0)))}),b(),n(57,"svg",5),p(58,"path",83),r(),s(59," Copiar "),r(),x(60,io,4,0,"button",84),r()(),y(),n(61,"div",85)(62,"button",86),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),s(63," Cerrar "),r()()()()()}if(a&2){let e=d();l(13),v(" ",e.selectedRutina==null?null:e.selectedRutina.nombre," "),l(3),v(" Rutina desde calendario - Progreso: ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(9),Y("width",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"%"),l(),v(" ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(5),w(e.selectedSeguimiento==null?null:e.selectedSeguimiento.estado_individual),l(5),z(" ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_inicio_programada)," - ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_fin_programada)," "),l(4),O("text-green-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>7)("text-yellow-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=7&&((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0)("text-red-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=0),l(),v(" ",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0?e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes:"Vencida"," "),l(10),v(" ",e.getFileName()," "),l(2),w(e.getFormattedRutina(e.selectedRutina,e.selectedSeguimiento||void 0)),l(),m("ngIf",e.copySuccess),l(6),m("ngIf",e.selectedRutina)}}var ut=class a{rutinas=[];volverAVista=new Ae;abrirRutina=new Ae;fechaActual=new Date;mesActual=new Date;diasCalendario=[];showViewModal=!1;selectedRutina=null;selectedSeguimiento=null;copySuccess=!1;seccionesDisponibles=[{key:"warm_up",nombre:"Warm Up",descripcion:"Calentamiento"},{key:"met_con",nombre:"Met-Con",descripcion:"Metabolic Conditioning"},{key:"strength",nombre:"Strength",descripcion:"Entrenamiento de Fuerza"},{key:"core",nombre:"Core",descripcion:"Trabajo de Core"},{key:"extra",nombre:"Extra",descripcion:"Trabajo Adicional"}];meses=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];diasSemana=["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"];constructor(){}ngOnInit(){this.generarCalendario()}ngOnChanges(){this.generarCalendario()}generarCalendario(){this.diasCalendario=[];let t=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth(),1),e=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()+1,0),i=t.getDay();for(let c=i-1;c>=0;c--){let _=new Date(t);_.setDate(_.getDate()-(c+1)),this.diasCalendario.push({fecha:new Date(_),esMesActual:!1,rutinas:this.getRutinasDelDia(_)})}for(let c=1;c<=e.getDate();c++){let _=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth(),c);this.diasCalendario.push({fecha:new Date(_),esMesActual:!0,rutinas:this.getRutinasDelDia(_)})}let o=42-this.diasCalendario.length;for(let c=1;c<=o;c++){let _=new Date(e);_.setDate(_.getDate()+c),this.diasCalendario.push({fecha:new Date(_),esMesActual:!1,rutinas:this.getRutinasDelDia(_)})}}getRutinasDelDia(t){let e=[],i=this.formatDateForComparison(t);return console.log(`\u{1F5D3}\uFE0F Verificando rutinas para fecha: ${i}`),this.rutinas.forEach(o=>{let c=new Date(o.fecha_inicio_programada),_=this.formatDateForComparison(c);console.log(`   \u{1F50D} Rutina: ${o.rutina_nombre}, Inicio: ${_}, Comparando con: ${i}`),_===i?(console.log(`   \u2705 COINCIDENCIA! Agregando rutina: ${o.rutina_nombre}`),e.push({seguimiento:o,tipoEvento:"inicio",enRango:!0})):console.log("   \u274C No coincide. Saltando rutina.")}),console.log(`\u{1F4CA} Total rutinas para ${i}: ${e.length}`),e}formatDateForComparison(t){let e=t.getFullYear(),i=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0");return`${e}-${i}-${o}`}mesAnterior(){this.mesActual=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()-1,1),this.generarCalendario()}mesSiguiente(){this.mesActual=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()+1,1),this.generarCalendario()}irAHoy(){this.mesActual=new Date,this.generarCalendario()}onVolverAVista(){this.volverAVista.emit()}onClickRutina(t){this.abrirModalRutina(t.seguimiento)}abrirModalRutina(t){this.selectedSeguimiento=t,this.selectedRutina=t.rutina_completa||null,this.showViewModal=!0}closeViewModal(){this.showViewModal=!1,this.selectedRutina=null,this.selectedSeguimiento=null,this.copySuccess=!1}getSeccionData(t,e){return t[e]}getTotalEjercicios(t){let e=0;return this.seccionesDisponibles.forEach(i=>{let o=this.getSeccionData(t,i.key);o&&o.ejercicios&&(e+=o.ejercicios.length)}),e}esHoy(t){let e=new Date;return t.toDateString()===e.toDateString()}getColorByEstado(t){switch(t){case"vigente":return"bg-green-500";case"pendiente":return"bg-blue-500";case"vencida":return"bg-red-500";default:return"bg-gray-500"}}getColorByTipo(t){return"border-green-500 bg-green-100"}formatDate(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"Fecha inv\xE1lida"}}formatDuracion(t){if(!t)return"N/A";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getFileName(){if(!this.selectedRutina||!this.selectedRutina.nombre)return"rutina_calendario_rehabimovement.txt";let t=this.selectedRutina.nombre.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"_").substring(0,30),e=new Date().toISOString().split("T")[0];return`${t}_calendario_${e}_rehabimovement.txt`}getFormattedRutina(t,e){if(console.log("\u{1F3A8} Formateando rutina CALENDARIO con NUEVO FORMATO:",t?.nombre),!t)return"";let i="";i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+`\u{1F3CB}\uFE0F  ${t.nombre.toUpperCase()}`.padEnd(78)+`\u2551
`,i+="\u255A"+"\u2550".repeat(78)+`\u255D
`,i+=`${t.descripcion||"Rutina de entrenamiento completa"}

`;let o=`Nivel: ${t.nivel.toUpperCase()}`,c=`Duraci\xF3n: ${this.formatDuracion(t.duracion_estimada)}`,_=`Tipo: ${t.tipo.toUpperCase()}`;if(i+=`\u{1F3AF} ${o} | \u23F1\uFE0F  ${c} | \u{1F4CB} ${_}

`,e){i+="\u250C"+"\u2500".repeat(78)+`\u2510
`,i+="\u2502"+"\u{1F4CA} MI PROGRESO".padEnd(78)+`\u2502
`,i+="\u2514"+"\u2500".repeat(78)+`\u2518
`;let V=e.progreso||0,B=40,ie=Math.round(V/100*B),U=B-ie,be="\u2588".repeat(ie)+"\u2591".repeat(U);if(i+=`Estado: ${e.estado_individual.toUpperCase()} (${V}%)
`,i+=`Progreso: [${be}] ${V}%
`,i+=`Per\xEDodo: ${this.formatDate(e.fecha_inicio_programada)} \u2192 ${this.formatDate(e.fecha_fin_programada)}
`,e.estado_temporal==="vigente"){let ne=e.dias_restantes>7?"\u{1F7E2}":e.dias_restantes>0?"\u{1F7E1}":"\u{1F534}";i+=`${ne} D\xEDas restantes: ${e.dias_restantes}
`}e.fecha_inicio_real&&(i+=`\u2705 Iniciado: ${this.formatDate(e.fecha_inicio_real)}
`),e.fecha_fin_real&&(i+=`\u{1F389} Completado: ${this.formatDate(e.fecha_fin_real)}
`),i+=`
`}i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+"\u{1F4AA} PLAN DE ENTRENAMIENTO".padEnd(78)+`\u2551
`,i+="\u255A"+"\u2550".repeat(78)+`\u255D

`;let S={warm_up:"\u{1F525}",met_con:"\u{1F4A8}",strength:"\u{1F3CB}\uFE0F",core:"\u{1F3AF}",extra:"\u2728"},P=["warm_up","met_con","strength","core","extra"],T=0;P.forEach((V,B)=>{let ie=this.seccionesDisponibles.find(be=>be.key===V),U=this.getSeccionData(t,V);if(U&&U.ejercicios&&U.ejercicios.length>0&&ie){T++,console.log(`\u{1F4CB} Procesando secci\xF3n CALENDARIO: ${ie.nombre}`);let be=S[V]||"\u{1F4CB}";i+="\u250C"+"\u2500".repeat(76)+`\u2510
`,i+="\u2502 "+`${be} ${ie.nombre.toUpperCase()}`.padEnd(75)+`\u2502
`,i+="\u2514"+"\u2500".repeat(76)+`\u2518
`,U.descripcion&&(i+=`\u{1F4DD} ${U.descripcion}
`);let ne=[];U.tiempo_total&&ne.push(`\u23F1\uFE0F  Tiempo: ${U.tiempo_total}`),U.series&&ne.push(`\u{1F504} Series: ${U.series}`),U.time_cap&&ne.push(`\u23F0 Time Cap: ${U.time_cap}`);let Me=U;Me.rest_between_exercises&&ne.push(`\u23F8\uFE0F  Descanso: ${Me.rest_between_exercises}`),Me.rest_between_sets&&ne.push(`\u{1F4A4} Descanso series: ${Me.rest_between_sets}`),ne.length>0&&(i+=`${ne.join(" | ")}
`),i+="\u2500".repeat(78)+`
`,U.ejercicios.forEach((F,Ue)=>{i+=`${(Ue+1).toString().padStart(2,"0")}. \u{1F539} ${F.nombre||"Ejercicio"}
`;let se=[];F.repeticiones&&se.push(`\u{1F522} ${F.repeticiones} reps`),F.series&&se.push(`\u{1F504} ${F.series} series`),F.peso&&se.push(`\u2696\uFE0F  ${F.peso}`),F.distancia&&se.push(`\u{1F4CF} ${F.distancia}`),F.tiempo&&se.push(`\u23F1\uFE0F  ${F.tiempo}`),F.duracion&&se.push(`\u23F3 ${F.duracion}`),se.length>0&&(i+=`    \u2514\u2500 ${se.join(" \u2022 ")}
`),F.rpe&&(i+=`    \u{1F4AA} RPE: ${F.rpe}/10
`),F.descanso&&(i+=`    \u23F8\uFE0F  Descanso: ${F.descanso}
`),F.observaciones&&(i+=`    \u{1F4DD} ${F.observaciones}
`),F.notas&&(i+=`    \u{1F4A1} ${F.notas}
`),Ue<U.ejercicios.length-1&&(i+=`
`)}),B<P.length-1&&T>0&&(i+=`
`+"\u2550".repeat(78)+`

`)}}),T===0&&(console.log("\u26A0\uFE0F No se encontraron secciones con ejercicios en CALENDARIO"),i+=`\u250C${"\u2500".repeat(76)}\u2510
`,i+=`\u2502 \u2139\uFE0F  RUTINA EN DESARROLLO${" ".repeat(51)}\u2502
`,i+=`\u2514${"\u2500".repeat(76)}\u2518
`,i+=`Esta rutina est\xE1 siendo desarrollada.
`,i+=`Los ejercicios ser\xE1n agregados pr\xF3ximamente.

`),e?.notas_individuales&&(i+="\u250C"+"\u2500".repeat(78)+`\u2510
`,i+="\u2502"+"\u{1F4DD} MIS NOTAS PERSONALES".padEnd(78)+`\u2502
`,i+="\u2514"+"\u2500".repeat(78)+`\u2518
`,i+=`${e.notas_individuales}

`),t.tags&&t.tags.length>0&&(i+=`\u{1F3F7}\uFE0F  Tags: ${t.tags.map(V=>`#${V}`).join(" ")}

`),i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+"\u{1F4F1} rehabiMovement - Sistema de Entrenamiento".padEnd(78)+`\u2551
`,i+="\u2560"+"\u2550".repeat(78)+`\u2563
`;let L=this.getTotalEjercicios(t);return i+="\u2551"+`\u{1F4C8} RESUMEN: ${L} ejercicios total`.padEnd(78)+`\u2551
`,t.duracion_estimada&&(i+="\u2551"+`\u23F1\uFE0F  Duraci\xF3n estimada: ${this.formatDuracion(t.duracion_estimada)}`.padEnd(78)+`\u2551
`),i+="\u2551"+`\u{1F4C5} Generado: ${this.formatDate(new Date().toISOString())}`.padEnd(78)+`\u2551
`,i+="\u2551"+`\u{1F194} ID Rutina: ${t.id||"N/A"}`.padEnd(78)+`\u2551
`,e&&(i+="\u2551"+`\u{1F464} Atleta: ${e.full_name||e.username||"N/A"}`.padEnd(78)+`\u2551
`),i+="\u255A"+"\u2550".repeat(78)+`\u255D
`,console.log("\u2705 Nuevo formato CALENDARIO aplicado exitosamente!"),i}copyToClipboard(t){return h(this,null,function*(){try{yield navigator.clipboard.writeText(t),this.copySuccess=!0,console.log("Texto copiado al portapapeles desde calendario"),setTimeout(()=>{this.copySuccess=!1},2e3)}catch(e){console.error("Error al copiar al portapapeles:",e),this.fallbackCopyTextToClipboard(t)}})}fallbackCopyTextToClipboard(t){let e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")&&(this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3))}catch(i){console.error("Fallback: Error al copiar al portapapeles:",i)}document.body.removeChild(e)}exportarRutina(t,e){if(!t){console.warn("No hay rutina para exportar desde calendario");return}let i=this.getFormattedRutina(t,e);if(!i){console.warn("No se pudo generar el contenido para exportar");return}let o=new Blob([i],{type:"text/plain;charset=utf-8"}),c=window.URL.createObjectURL(o),_=document.createElement("a");_.href=c,_.download=this.getFileName(),_.click(),window.URL.revokeObjectURL(c),console.log("Rutina exportada desde calendario:",t.nombre)}trackByDate(t,e){return e.fecha.getTime()}trackByRutina(t,e){return e.seguimiento.seguimiento_id}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=A({type:a,selectors:[["app-calendario-rutinas"]],inputs:{rutinas:"rutinas"},outputs:{volverAVista:"volverAVista",abrirRutina:"abrirRutina"},standalone:!1,features:[Ge],decls:44,vars:7,consts:[[1,"max-w-7xl","mx-auto"],[1,"bg-white","rounded-lg","shadow","mb-6"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"flex","items-center","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"flex","items-center","space-x-4"],[1,"p-2","rounded-full","hover:bg-gray-100","focus:outline-none","focus:ring-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-xl","font-semibold","text-gray-900","min-w-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"inline-flex","items-center","px-3","py-2","border","border-red-300","rounded-md","shadow-sm","text-sm","font-medium","text-red-700","bg-red-50","hover:bg-red-100","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],[1,"px-6","py-3","bg-gray-50"],[1,"flex","flex-wrap","items-center","gap-4","text-sm"],[1,"flex","items-center"],[1,"w-3","h-3","bg-green-500","rounded-full","mr-2"],[1,"text-gray-700"],[1,"w-3","h-3","bg-blue-500","rounded-full","mr-2"],[1,"w-3","h-3","bg-red-500","rounded-full","mr-2"],[1,"w-3","h-3","border-2","border-green-500","bg-green-100","rounded","mr-2"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],[1,"grid","grid-cols-7","gap-0","bg-gray-50","border-b","border-gray-200"],["class","px-4 py-3 text-center text-sm font-medium text-gray-700 border-r border-gray-200 last:border-r-0",4,"ngFor","ngForOf"],[1,"grid","grid-cols-7","gap-0"],["class","min-h-32 border-r border-b border-gray-200 last:border-r-0 p-2 relative",3,"bg-gray-50","bg-blue-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-12",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],[1,"px-4","py-3","text-center","text-sm","font-medium","text-gray-700","border-r","border-gray-200","last:border-r-0"],[1,"min-h-32","border-r","border-b","border-gray-200","last:border-r-0","p-2","relative"],[1,"flex","justify-between","items-start","mb-1"],[1,"text-sm","font-medium"],["class","w-2 h-2 bg-blue-600 rounded-full",4,"ngIf"],[1,"space-y-1"],["class","text-xs p-1 rounded border cursor-pointer hover:shadow-sm transition-all duration-150",3,"ngClass","title","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-xs text-gray-500 mt-1 text-center",4,"ngIf"],[1,"w-2","h-2","bg-blue-600","rounded-full"],[1,"text-xs","p-1","rounded","border","cursor-pointer","hover:shadow-sm","transition-all","duration-150",3,"click","ngClass","title"],[1,"truncate","flex-1","font-medium"],[1,"w-2","h-2","rounded-full","ml-1","flex-shrink-0",3,"ngClass"],[1,"text-gray-600","mt-1"],[1,"text-green-700"],[1,"text-xs","text-gray-500","mt-1","text-center"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3a2 2 0 012-2h8a2 2 0 012 2v4m-4 0V3m-4 4h8m-8 0H6a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-2"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-5xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"text-sm","text-gray-500"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900","flex","items-center"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-2"],[1,"bg-blue-600","h-2","rounded-full"],[1,"text-gray-900"],[1,"bg-gray-900","text-green-400","rounded-lg","p-6","font-mono","text-sm","overflow-auto","max-h-96","relative",2,"font-family","'Courier New', monospace","line-height","1.6"],[1,"absolute","inset-15","flex","items-center","justify-center","pointer-events-none","opacity-25"],["src","/rh.png","alt","RehabiMovement",1,"max-w-50","max-h-50","object-contain","transform","rotate-12","select-none"],[1,"flex","items-center","justify-between","mb-4","pb-2","border-b","border-gray-700","relative","z-10"],[1,"flex","space-x-2"],[1,"w-3","h-3","bg-red-500","rounded-full"],[1,"w-3","h-3","bg-yellow-500","rounded-full"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-gray-400","text-xs"],[1,"whitespace-pre-wrap","text-white","relative","z-10"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],["class","inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",3,"click",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-green-700"],[1,"inline-flex","items-center","px-3","py-2","border","border-transparent","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),f("click",function(){return i.onVolverAVista()}),b(),n(5,"svg",5),p(6,"path",6),r(),s(7," Volver a tarjetas "),r(),y(),n(8,"div",7)(9,"button",8),f("click",function(){return i.mesAnterior()}),b(),n(10,"svg",9),p(11,"path",10),r()(),y(),n(12,"h2",11),s(13),r(),n(14,"button",8),f("click",function(){return i.mesSiguiente()}),b(),n(15,"svg",9),p(16,"path",12),r()()(),y(),n(17,"button",13),f("click",function(){return i.irAHoy()}),s(18," Hoy "),r()()(),n(19,"div",14)(20,"div",15)(21,"div",16),p(22,"div",17),n(23,"span",18),s(24,"Rutinas Vigentes"),r()(),n(25,"div",16),p(26,"div",19),n(27,"span",18),s(28,"Rutinas Pendientes"),r()(),n(29,"div",16),p(30,"div",20),n(31,"span",18),s(32,"Rutinas Vencidas"),r()(),n(33,"div",16),p(34,"div",21),n(35,"span",18),s(36,"D\xEDa de Inicio"),r()()()()(),n(37,"div",22)(38,"div",23),x(39,Qr,2,1,"div",24),r(),n(40,"div",25),x(41,Kr,8,17,"div",26),r()(),x(42,eo,7,0,"div",27),r(),x(43,no,64,19,"div",28)),e&2&&(l(13),z(" ",i.meses[i.mesActual.getMonth()]," ",i.mesActual.getFullYear()," "),l(26),m("ngForOf",i.diasSemana),l(2),m("ngForOf",i.diasCalendario)("ngForTrackBy",i.trackByDate),l(),m("ngIf",i.rutinas.length===0),l(),m("ngIf",i.showViewModal))},dependencies:[$,N,R],styles:[".calendar-transition[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.calendar-cell[_ngcontent-%COMP%]{min-height:120px;transition:all .2s ease-in-out}.calendar-cell[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.rutina-item[_ngcontent-%COMP%]{transition:all .15s ease-in-out;transform:scale(1)}.rutina-item[_ngcontent-%COMP%]:hover{transform:scale(1.02);box-shadow:0 2px 8px #0000001a}.evento-inicio[_ngcontent-%COMP%]{border-left:4px solid #10b981;background:linear-gradient(90deg,#d1fae5,#ecfdf5)}.evento-fin[_ngcontent-%COMP%]{border-left:4px solid #ef4444;background:linear-gradient(90deg,#fee2e2,#fef2f2)}.evento-progreso[_ngcontent-%COMP%]{border-left:4px solid #3b82f6;background:linear-gradient(90deg,#dbeafe,#eff6ff)}.dia-actual[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border:2px solid #3b82f6}.indicador-hoy[_ngcontent-%COMP%]{background:#3b82f6;box-shadow:0 0 0 2px #bfdbfe;animation:_ngcontent-%COMP%_pulse-blue 2s infinite}@keyframes _ngcontent-%COMP%_pulse-blue{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}.nav-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.nav-button[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;transform:scale(1.05)}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.terminal[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#111827);box-shadow:inset 0 0 20px #00000080,0 0 20px #0000004d}.terminal-header[_ngcontent-%COMP%]{background:linear-gradient(90deg,#374151,#4b5563)}.terminal-button[_ngcontent-%COMP%]{box-shadow:inset 0 1px #fff3,0 1px 2px #00000080}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#1f2937;border-radius:4px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#4b5563;border-radius:4px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6b7280}.watermark[_ngcontent-%COMP%]{opacity:.1;filter:grayscale(100%) brightness(150%);-webkit-user-select:none;user-select:none;pointer-events:none}.rutina-entrada[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInFromLeft .3s ease-out}@keyframes _ngcontent-%COMP%_slideInFromLeft{0%{transform:translate(-10px);opacity:0}to{transform:translate(0);opacity:1}}@media (max-width: 768px){.calendar-cell[_ngcontent-%COMP%]{min-height:100px;font-size:.875rem}.rutina-item[_ngcontent-%COMP%]{padding:.25rem;font-size:.75rem}.nav-button[_ngcontent-%COMP%]{padding:.5rem}}@media (max-width: 640px){.calendar-cell[_ngcontent-%COMP%]{min-height:80px;padding:.25rem}.rutina-item[_ngcontent-%COMP%]{padding:.125rem;font-size:.625rem}}.leyenda-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.25rem .5rem;border-radius:.375rem;transition:background-color .2s ease-in-out}.leyenda-item[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.estado-vigente[_ngcontent-%COMP%]{background-color:#10b981;box-shadow:0 0 8px #10b9814d}.estado-pendiente[_ngcontent-%COMP%]{background-color:#3b82f6;box-shadow:0 0 8px #3b82f64d}.estado-vencida[_ngcontent-%COMP%]{background-color:#ef4444;box-shadow:0 0 8px #ef44444d}.mes-titulo[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.mes-titulo.changing[_ngcontent-%COMP%]{transform:scale(.95);opacity:.7}.loading-calendario[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInOut 1.5s ease-in-out infinite}@keyframes _ngcontent-%COMP%_fadeInOut{0%,to{opacity:.4}50%{opacity:.8}}"]})};var oo=(a,t,e,i)=>({"bg-gray-100 text-gray-800":a,"bg-yellow-100 text-yellow-800":t,"bg-green-100 text-green-800":e,"bg-red-100 text-red-800":i});function ao(a,t){if(a&1){let e=C();n(0,"div")(1,"app-calendario-rutinas",17),f("volverAVista",function(){u(e);let o=d();return g(o.onVolverDeCalendario())})("abrirRutina",function(o){u(e);let c=d();return g(c.onAbrirRutinaDesdeCalendario(o))}),r()()}if(a&2){let e=d();l(),m("rutinas",e.filteredRutinas)}}function so(a,t){if(a&1&&(n(0,"div",39)(1,"div",40),b(),n(2,"svg",41),p(3,"path",42),r(),y(),n(4,"div",43)(5,"p",44),s(6),r()()()()),a&2){let e=d(2);l(6),w(e.error)}}function lo(a,t){a&1&&(n(0,"div",45),p(1,"div",46),r())}function co(a,t){if(a&1&&(n(0,"span",83),s(1),r()),a&2){let e=t.$implicit;l(),v(" #",e," ")}}function mo(a,t){if(a&1&&(n(0,"div",56)(1,"div",81),x(2,co,2,1,"span",82),r()()),a&2){let e=d().$implicit;l(2),m("ngForOf",e.rutina_tags)}}function po(a,t){if(a&1&&(n(0,"div"),s(1),r()),a&2){let e=d(2).$implicit,i=d(3);l(),v(" Iniciado: ",i.formatDate(e.fecha_inicio_real)," ")}}function uo(a,t){if(a&1&&(n(0,"div"),s(1),r()),a&2){let e=d(2).$implicit,i=d(3);l(),v(" Completado: ",i.formatDate(e.fecha_fin_real)," ")}}function go(a,t){if(a&1&&(n(0,"div",84),x(1,po,2,1,"div",15)(2,uo,2,1,"div",15),r()),a&2){let e=d().$implicit;l(),m("ngIf",e.fecha_inicio_real),l(),m("ngIf",e.fecha_fin_real)}}function fo(a,t){if(a&1&&(n(0,"div",85)(1,"p",86)(2,"strong"),s(3,"Mis notas:"),r(),s(4),r()()),a&2){let e=d().$implicit;l(4),v(" ",e.notas_individuales," ")}}function _o(a,t){if(a&1){let e=C();n(0,"div",49)(1,"div")(2,"div",50)(3,"div",51)(4,"h3",52),s(5),r(),n(6,"p",53),s(7),r()(),n(8,"span",54),s(9),r()()(),n(10,"div",55)(11,"div",56)(12,"div",57)(13,"span",58),s(14,"Mi Progreso"),r(),n(15,"span",59),s(16),r()(),n(17,"div",60),p(18,"div",61),r(),n(19,"div",62)(20,"input",63),f("input",function(o){let c=u(e).$implicit,_=d(3);return g(_.actualizarMiProgreso(c,+o.target.value))}),r()()(),n(21,"div",64)(22,"span",65),s(23),r(),n(24,"span",66),s(25),r()(),n(26,"div",67)(27,"div",68)(28,"span"),s(29,"Inicio:"),r(),n(30,"span"),s(31),r()(),n(32,"div",68)(33,"span"),s(34,"Fin:"),r(),n(35,"span"),s(36),r()(),n(37,"div",69)(38,"span"),s(39,"D\xEDas restantes:"),r(),n(40,"span"),s(41),r()()(),n(42,"div",64)(43,"span",70),s(44),r(),n(45,"span",66),s(46),r()(),x(47,mo,3,1,"div",71)(48,go,3,2,"div",72)(49,fo,5,1,"div",73),n(50,"div",74)(51,"button",75),f("click",function(){let o=u(e).$implicit,c=d(3);return g(c.openViewModal(o))}),b(),n(52,"svg",76),p(53,"path",77)(54,"path",78),r()(),y(),n(55,"button",79),f("click",function(){let o=u(e).$implicit,c=d(3);return g(c.safeExportRutina(o))}),b(),n(56,"svg",76),p(57,"path",80),r()()()()()}if(a&2){let e=t.$implicit,i=d(3);O("border-green-500",e.estado_temporal==="vigente")("border-blue-500",e.estado_temporal==="pendiente")("border-red-500",e.estado_temporal==="vencida"),l(),D("px-6 py-4 "+(e.estado_temporal==="vigente"?"bg-gradient-to-r from-green-500 to-green-600":e.estado_temporal==="pendiente"?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gradient-to-r from-red-500 to-red-600")),l(4),w(e.rutina_nombre),l(2),w(e.rutina_descripcion),l(2),v(" ",e.estado_temporal," "),l(7),v("",e.progreso,"%"),l(2),Y("width",e.progreso,"%"),O("bg-gray-400",e.progreso===0)("bg-red-400",e.progreso>0&&e.progreso<30)("bg-yellow-400",e.progreso>=30&&e.progreso<70)("bg-green-400",e.progreso>=70),l(2),m("value",e.progreso),l(2),m("ngClass",ve(40,oo,e.estado_individual==="pendiente",e.estado_individual==="en_progreso",e.estado_individual==="completada",e.estado_individual==="abandonada")),l(),v(" ",e.estado_individual," "),l(2),w(e.rutina_nivel),l(6),w(i.formatDate(e.fecha_inicio_programada)),l(5),w(i.formatDate(e.fecha_fin_programada)),l(),O("text-green-600",e.dias_restantes>7)("text-yellow-600",e.dias_restantes<=7&&e.dias_restantes>0)("text-red-600",e.dias_restantes<=0),l(4),w(e.dias_restantes>0?e.dias_restantes:"Vencida"),l(3),v(" ",e.rutina_tipo," "),l(2),w(i.formatDuracion(e.rutina_duracion)),l(),m("ngIf",e.rutina_tags&&e.rutina_tags.length>0),l(),m("ngIf",e.fecha_inicio_real||e.fecha_fin_real),l(),m("ngIf",e.notas_individuales)}}function xo(a,t){if(a&1&&(n(0,"div",47),x(1,_o,58,45,"div",48),r()),a&2){let e=d(2);l(),m("ngForOf",e.filteredRutinas)("ngForTrackBy",e.trackByRutinaId)}}function vo(a,t){a&1&&(fe(0),s(1," No tienes rutinas asignadas en este momento. "),_e())}function bo(a,t){a&1&&s(0," No se encontraron rutinas con los filtros aplicados. ")}function ho(a,t){if(a&1){let e=C();n(0,"button",95),f("click",function(){u(e);let o=d(3);return g(o.clearFilters())}),s(1," Limpiar filtros "),r()}}function Co(a,t){if(a&1&&(n(0,"div",87),b(),n(1,"svg",88),p(2,"path",89),r(),y(),n(3,"h3",90),s(4,"No hay rutinas asignadas"),r(),n(5,"p",91),x(6,vo,2,0,"ng-container",92)(7,bo,1,0,"ng-template",null,0,oe),r(),n(9,"div",93),x(10,ho,2,0,"button",94),r()()),a&2){let e=X(8),i=d(2);l(6),m("ngIf",i.misRutinas.length===0)("ngIfElse",e),l(4),m("ngIf",i.misRutinas.length>0)}}function wo(a,t){if(a&1){let e=C();n(0,"div")(1,"div",18)(2,"div",19)(3,"div",20)(4,"label",21),s(5,"Buscar"),r(),n(6,"input",22),k("ngModelChange",function(o){u(e);let c=d();return E(c.searchTerm,o)||(c.searchTerm=o),g(o)}),f("input",function(){u(e);let o=d();return g(o.onSearch())}),r()(),n(7,"div")(8,"label",21),s(9,"Per\xEDodo"),r(),n(10,"select",23),k("ngModelChange",function(o){u(e);let c=d();return E(c.estadoFilter,o)||(c.estadoFilter=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.onFilterChange())}),n(11,"option",24),s(12,"Todos"),r(),n(13,"option",25),s(14,"Vigentes"),r(),n(15,"option",26),s(16,"Pendientes"),r(),n(17,"option",27),s(18,"Vencidas"),r()()(),n(19,"div")(20,"label",21),s(21,"Mi Estado"),r(),n(22,"select",23),k("ngModelChange",function(o){u(e);let c=d();return E(c.estadoIndividualFilter,o)||(c.estadoIndividualFilter=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.onFilterChange())}),n(23,"option",24),s(24,"Todos"),r(),n(25,"option",26),s(26,"Pendiente"),r(),n(27,"option",28),s(28,"En Progreso"),r(),n(29,"option",29),s(30,"Completada"),r(),n(31,"option",30),s(32,"Abandonada"),r()()(),n(33,"div")(34,"label",21),s(35,"Progreso"),r(),n(36,"select",23),k("ngModelChange",function(o){u(e);let c=d();return E(c.progresoFilter,o)||(c.progresoFilter=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.onFilterChange())}),n(37,"option",24),s(38,"Todos"),r(),n(39,"option",31),s(40,"Sin Iniciar (0%)"),r(),n(41,"option",28),s(42,"En Progreso (1-99%)"),r(),n(43,"option",32),s(44,"Completado (100%)"),r()()()(),n(45,"div",33)(46,"button",34),f("click",function(){u(e);let o=d();return g(o.clearFilters())}),s(47," Limpiar filtros "),r()()(),x(48,so,7,1,"div",35)(49,lo,2,0,"div",36)(50,xo,2,2,"div",37)(51,Co,11,3,"div",38),r()}if(a&2){let e=d();l(6),M("ngModel",e.searchTerm),l(4),M("ngModel",e.estadoFilter),l(12),M("ngModel",e.estadoIndividualFilter),l(14),M("ngModel",e.progresoFilter),l(12),m("ngIf",e.error&&!e.showViewModal),l(),m("ngIf",e.loading),l(),m("ngIf",!e.loading),l(),m("ngIf",!e.loading&&e.filteredRutinas.length===0)}}function yo(a,t){a&1&&(n(0,"div",133)(1,"div",40),b(),n(2,"svg",134),p(3,"path",135),r(),y(),n(4,"div",43)(5,"p",136),s(6,"\xA1Rutina copiada al portapapeles!"),r()()()())}function So(a,t){if(a&1){let e=C();n(0,"button",137),f("click",function(){u(e);let o=d(2);return g(o.exportarRutina(o.selectedRutina,o.selectedSeguimiento||void 0))}),b(),n(1,"svg",128),p(2,"path",80),r(),s(3," Descargar "),r()}}function Mo(a,t){if(a&1){let e=C();n(0,"div",96)(1,"div",97)(2,"div",98),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),r(),n(3,"span",99),s(4,"\u200B"),r(),n(5,"div",100)(6,"div",101)(7,"div",102)(8,"div",103),b(),n(9,"svg",104),p(10,"path",77)(11,"path",78),r()(),y(),n(12,"div",105)(13,"h3",106),s(14),r(),n(15,"div",107)(16,"p",66),s(17),r()()()()(),n(18,"div",108)(19,"div",109)(20,"div",110)(21,"div")(22,"span",111),s(23,"Mi Progreso:"),r(),n(24,"div",112)(25,"div",113),p(26,"div",114),r(),s(27),r()(),n(28,"div")(29,"span",111),s(30,"Estado:"),r(),n(31,"div",115),s(32),r()(),n(33,"div")(34,"span",111),s(35,"Per\xEDodo:"),r(),n(36,"div",115),s(37),r()(),n(38,"div")(39,"span",111),s(40,"D\xEDas restantes:"),r(),n(41,"div",115),s(42),r()()()(),n(43,"div",116)(44,"div",117),p(45,"img",118),r(),n(46,"div",119)(47,"div",6),p(48,"div",120)(49,"div",121)(50,"div",122),r(),n(51,"div",123),s(52),r()(),n(53,"pre",124),s(54),r()(),x(55,yo,7,0,"div",125),n(56,"div",126)(57,"button",127),f("click",function(){u(e);let o=d();return g(o.copyToClipboard(o.getFormattedRutina(o.selectedRutina,o.selectedSeguimiento||void 0)))}),b(),n(58,"svg",128),p(59,"path",129),r(),s(60," Copiar "),r(),x(61,So,4,0,"button",130),r()(),y(),n(62,"div",131)(63,"button",132),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),s(64," Cerrar "),r()()()()()}if(a&2){let e=d();l(14),v(" ",e.selectedRutina==null?null:e.selectedRutina.nombre," "),l(3),v(" Mi rutina asignada - Progreso: ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(9),Y("width",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"%"),l(),v(" ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(5),w(e.selectedSeguimiento==null?null:e.selectedSeguimiento.estado_individual),l(5),z(" ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_inicio_programada)," - ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_fin_programada)," "),l(4),O("text-green-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>7)("text-yellow-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=7&&((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0)("text-red-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=0),l(),v(" ",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0?e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes:"Vencida"," "),l(10),v(" ",e.getFileName(e.selectedRutina)," "),l(2),w(e.getFormattedRutina(e.selectedRutina,e.selectedSeguimiento||void 0)),l(),m("ngIf",e.copySuccess),l(6),m("ngIf",e.selectedRutina)}}var gt=class a{constructor(t,e,i){this.supabaseService=t;this.authService=e;this.simpleRutinasService=i}vistaActual="calendario";misRutinas=[];filteredRutinas=[];estadisticasPersonales;loading=!1;error="";showViewModal=!1;selectedRutina=null;selectedSeguimiento=null;copySuccess=!1;searchTerm="";estadoFilter="all";estadoIndividualFilter="all";progresoFilter="all";seccionesDisponibles=[{key:"warm_up",nombre:"Warm Up",descripcion:"Calentamiento"},{key:"met_con",nombre:"Met-Con",descripcion:"Metabolic Conditioning"},{key:"strength",nombre:"Strength",descripcion:"Entrenamiento de Fuerza"},{key:"core",nombre:"Core",descripcion:"Trabajo de Core"},{key:"extra",nombre:"Extra",descripcion:"Trabajo Adicional"}];ngOnInit(){return h(this,null,function*(){yield Promise.all([this.loadMisRutinas(),this.loadEstadisticasPersonales()])})}cambiarVista(t){console.log("Cambiando vista a:",t),this.vistaActual=t}get mostrarVistaTarjetas(){return this.vistaActual==="tarjetas"}get mostrarVistaCalendario(){return this.vistaActual==="calendario"}onVolverDeCalendario(){this.cambiarVista("tarjetas")}onAbrirRutinaDesdeCalendario(t){this.openViewModal(t)}loadMisRutinas(){return h(this,null,function*(){this.loading=!0,this.error="";try{console.log("Cargando rutinas asignadas al usuario...");let t=yield this.simpleRutinasService.getRutinasUsuarioSimple();this.misRutinas=t.map(e=>{let i=e.rutina_asignaciones_masivas,o=e.rutinas,{estado:c,diasRestantes:_}=this.simpleRutinasService.calcularEstadoTemporal(i.fecha_inicio,i.fecha_fin);return{seguimiento_id:e.id,asignacion_id:e.id_asignacion_masiva,id_profile:e.id_profile,username:this.authService.getCurrentUser()?.username||"",full_name:this.authService.getCurrentUser()?.full_name||"",rutina_nombre:o.nombre,rutina_id:o.id,rutina_descripcion:o.descripcion,rutina_tipo:o.tipo,rutina_nivel:o.nivel,rutina_duracion:o.duracion_estimada,rutina_tags:o.tags,rutina_completa:o,progreso:e.progreso,estado_individual:e.estado_individual,fecha_inicio_real:e.fecha_inicio_real,fecha_fin_real:e.fecha_fin_real,fecha_inicio_programada:i.fecha_inicio,fecha_fin_programada:i.fecha_fin,notas_individuales:e.notas_individuales,estado_temporal:c,dias_restantes:_}}),this.filteredRutinas=[...this.misRutinas],this.applyFilters(),console.log("Mis rutinas cargadas:",this.misRutinas.length)}catch(t){console.error("Error cargando mis rutinas:",t),this.error="Error al cargar tus rutinas asignadas",this.misRutinas=[],this.filteredRutinas=[]}finally{this.loading=!1}})}loadEstadisticasPersonales(){return h(this,null,function*(){try{if(this.misRutinas.length===0)return;let t=this.misRutinas.length,e=this.misRutinas.filter(T=>T.estado_temporal==="vigente").length,i=this.misRutinas.filter(T=>T.estado_individual==="completada").length,o=this.misRutinas.filter(T=>T.estado_individual==="en_progreso").length,c=this.misRutinas.filter(T=>T.estado_individual==="pendiente").length,_=this.misRutinas.filter(T=>T.estado_temporal==="vencida").length,S=this.misRutinas.reduce((T,L)=>T+L.progreso,0),P=t>0?Math.round(S/t):0;this.estadisticasPersonales={total_rutinas_asignadas:t,rutinas_vigentes:e,rutinas_completadas:i,rutinas_en_progreso:o,rutinas_pendientes:c,rutinas_vencidas:_,progreso_promedio:P,racha_actual:0,mejor_racha:0}}catch(t){console.error("Error calculando estad\xEDsticas personales:",t)}})}applyFilters(){let t=[...this.misRutinas];if(this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.rutina_nombre.toLowerCase().includes(e)||i.rutina_descripcion?.toLowerCase().includes(e)||i.rutina_tags?.some(o=>o.toLowerCase().includes(e)))}if(this.estadoFilter!=="all"&&(t=t.filter(e=>e.estado_temporal===this.estadoFilter)),this.estadoIndividualFilter!=="all"&&(t=t.filter(e=>e.estado_individual===this.estadoIndividualFilter)),this.progresoFilter!=="all")switch(this.progresoFilter){case"sin_iniciar":t=t.filter(e=>e.progreso===0);break;case"en_progreso":t=t.filter(e=>e.progreso>0&&e.progreso<100);break;case"completado":t=t.filter(e=>e.progreso===100);break}this.filteredRutinas=t}openViewModal(t){return h(this,null,function*(){if(console.log("Abriendo modal para ver rutina:",t.rutina_nombre),this.selectedSeguimiento=t,t.rutina_completa)this.selectedRutina=t.rutina_completa;else try{let{data:e,error:i}=yield this.supabaseService.client.from("rutinas").select("*").eq("id",t.rutina_id).single();if(i)throw i;this.selectedRutina=e}catch(e){console.error("Error cargando rutina completa:",e),this.error="Error al cargar los detalles de la rutina";return}this.showViewModal=!0})}closeViewModal(){console.log("Cerrando modal de vista"),this.showViewModal=!1,this.selectedRutina=null,this.selectedSeguimiento=null,this.copySuccess=!1}actualizarMiProgreso(t,e){return h(this,null,function*(){try{(yield this.simpleRutinasService.actualizarProgresoSimple(t.seguimiento_id,e))&&(t.progreso=e,e===0?t.estado_individual="pendiente":e<100?(t.estado_individual="en_progreso",t.fecha_inicio_real||(t.fecha_inicio_real=new Date().toISOString().split("T")[0])):(t.estado_individual="completada",t.fecha_fin_real=new Date().toISOString().split("T")[0]),yield this.loadEstadisticasPersonales())}catch(i){console.error("Error actualizando progreso:",i),this.error="Error al actualizar el progreso",setTimeout(()=>this.error="",5e3)}})}getSeccionData(t,e){return t[e]}getSeccionesConEjercicios(t){let e=[];return this.seccionesDisponibles.forEach(i=>{let o=this.getSeccionData(t,i.key);o&&o.ejercicios&&o.ejercicios.length>0&&e.push({key:i.key,nombre:i.nombre,seccion:o})}),e}formatDuracion(t){if(!t)return"N/A";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getTotalEjercicios(t){let e=0;return this.seccionesDisponibles.forEach(i=>{let o=this.getSeccionData(t,i.key);o&&o.ejercicios&&(e+=o.ejercicios.length)}),e}getFormattedRutina(t,e){if(console.log("\u{1F3A8} Formateando rutina con NUEVO FORMATO:",t?.nombre),!t)return"";let i="";i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+`\u{1F3CB}\uFE0F  ${t.nombre.toUpperCase()}`.padEnd(78)+`\u2551
`,i+="\u255A"+"\u2550".repeat(78)+`\u255D
`,i+=`${t.descripcion||"Rutina de entrenamiento completa"}

`;let o=`Nivel: ${t.nivel.toUpperCase()}`,c=`Duraci\xF3n: ${this.formatDuracion(t.duracion_estimada)}`,_=`Tipo: ${t.tipo.toUpperCase()}`;if(i+=`\u{1F3AF} ${o} | \u23F1\uFE0F  ${c} | \u{1F4CB} ${_}

`,e){i+="\u250C"+"\u2500".repeat(78)+`\u2510
`,i+="\u2502"+"\u{1F4CA} MI PROGRESO".padEnd(78)+`\u2502
`,i+="\u2514"+"\u2500".repeat(78)+`\u2518
`;let V=e.progreso||0,B=40,ie=Math.round(V/100*B),U=B-ie,be="\u2588".repeat(ie)+"\u2591".repeat(U);if(i+=`Estado: ${e.estado_individual.toUpperCase()} (${V}%)
`,i+=`Progreso: [${be}] ${V}%
`,i+=`Per\xEDodo: ${this.formatDate(e.fecha_inicio_programada)} \u2192 ${this.formatDate(e.fecha_fin_programada)}
`,e.estado_temporal==="vigente"){let ne=e.dias_restantes>7?"\u{1F7E2}":e.dias_restantes>0?"\u{1F7E1}":"\u{1F534}";i+=`${ne} D\xEDas restantes: ${e.dias_restantes}
`}e.fecha_inicio_real&&(i+=`\u2705 Iniciado: ${this.formatDate(e.fecha_inicio_real)}
`),e.fecha_fin_real&&(i+=`\u{1F389} Completado: ${this.formatDate(e.fecha_fin_real)}
`),i+=`
`}i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+"\u{1F4AA} PLAN DE ENTRENAMIENTO".padEnd(78)+`\u2551
`,i+="\u255A"+"\u2550".repeat(78)+`\u255D

`;let S={warm_up:"\u{1F525}",met_con:"\u{1F4A8}",strength:"\u{1F3CB}\uFE0F",core:"\u{1F3AF}",extra:"\u2728"},P=["warm_up","met_con","strength","core","extra"],T=0;P.forEach((V,B)=>{let ie=this.seccionesDisponibles.find(be=>be.key===V),U=this.getSeccionData(t,V);if(U&&U.ejercicios&&U.ejercicios.length>0&&ie){T++,console.log(`\u{1F4CB} Procesando secci\xF3n: ${ie.nombre}`);let be=S[V]||"\u{1F4CB}";i+="\u250C"+"\u2500".repeat(76)+`\u2510
`,i+="\u2502 "+`${be} ${ie.nombre.toUpperCase()}`.padEnd(75)+`\u2502
`,i+="\u2514"+"\u2500".repeat(76)+`\u2518
`,U.descripcion&&(i+=`\u{1F4DD} ${U.descripcion}
`);let ne=[];U.tiempo_total&&ne.push(`\u23F1\uFE0F  Tiempo: ${U.tiempo_total}`),U.series&&ne.push(`\u{1F504} Series: ${U.series}`),U.time_cap&&ne.push(`\u23F0 Time Cap: ${U.time_cap}`);let Me=U;Me.rest_between_exercises&&ne.push(`\u23F8\uFE0F  Descanso: ${Me.rest_between_exercises}`),Me.rest_between_sets&&ne.push(`\u{1F4A4} Descanso series: ${Me.rest_between_sets}`),ne.length>0&&(i+=`${ne.join(" | ")}
`),i+="\u2500".repeat(78)+`
`,U.ejercicios.forEach((F,Ue)=>{i+=`${(Ue+1).toString().padStart(2,"0")}. \u{1F539} ${F.nombre||"Ejercicio"}
`;let se=[];F.repeticiones&&se.push(`\u{1F522} ${F.repeticiones} reps`),F.series&&se.push(`\u{1F504} ${F.series} series`),F.peso&&se.push(`\u2696\uFE0F  ${F.peso}`),F.distancia&&se.push(`\u{1F4CF} ${F.distancia}`),F.tiempo&&se.push(`\u23F1\uFE0F  ${F.tiempo}`),F.duracion&&se.push(`\u23F3 ${F.duracion}`),se.length>0&&(i+=`    \u2514\u2500 ${se.join(" \u2022 ")}
`),F.rpe&&(i+=`    \u{1F4AA} RPE: ${F.rpe}/10
`),F.descanso&&(i+=`    \u23F8\uFE0F  Descanso: ${F.descanso}
`),F.observaciones&&(i+=`    \u{1F4DD} ${F.observaciones}
`),F.notas&&(i+=`    \u{1F4A1} ${F.notas}
`),Ue<U.ejercicios.length-1&&(i+=`
`)}),B<P.length-1&&T>0&&(i+=`
`+"\u2550".repeat(78)+`

`)}}),T===0&&(console.log("\u26A0\uFE0F No se encontraron secciones con ejercicios"),i+=`\u250C${"\u2500".repeat(76)}\u2510
`,i+=`\u2502 \u2139\uFE0F  RUTINA EN DESARROLLO${" ".repeat(51)}\u2502
`,i+=`\u2514${"\u2500".repeat(76)}\u2518
`,i+=`Esta rutina est\xE1 siendo desarrollada.
`,i+=`Los ejercicios ser\xE1n agregados pr\xF3ximamente.

`),e?.notas_individuales&&(i+="\u250C"+"\u2500".repeat(78)+`\u2510
`,i+="\u2502"+"\u{1F4DD} MIS NOTAS PERSONALES".padEnd(78)+`\u2502
`,i+="\u2514"+"\u2500".repeat(78)+`\u2518
`,i+=`${e.notas_individuales}

`),t.tags&&t.tags.length>0&&(i+=`\u{1F3F7}\uFE0F  Tags: ${t.tags.map(V=>`#${V}`).join(" ")}

`),i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+"\u{1F4F1} rehabiMovement - Sistema de Entrenamiento".padEnd(78)+`\u2551
`,i+="\u2560"+"\u2550".repeat(78)+`\u2563
`;let L=this.getTotalEjercicios(t);return i+="\u2551"+`\u{1F4C8} RESUMEN: ${L} ejercicios total`.padEnd(78)+`\u2551
`,t.duracion_estimada&&(i+="\u2551"+`\u23F1\uFE0F  Duraci\xF3n estimada: ${this.formatDuracion(t.duracion_estimada)}`.padEnd(78)+`\u2551
`),i+="\u2551"+`\u{1F4C5} Generado: ${this.formatDate(new Date().toISOString())}`.padEnd(78)+`\u2551
`,i+="\u2551"+`\u{1F194} ID Rutina: ${t.id||"N/A"}`.padEnd(78)+`\u2551
`,e&&(i+="\u2551"+`\u{1F464} Atleta: ${e.full_name||e.username||"N/A"}`.padEnd(78)+`\u2551
`),i+="\u255A"+"\u2550".repeat(78)+`\u255D
`,console.log("\u2705 Nuevo formato aplicado exitosamente!"),i}copyToClipboard(t){return h(this,null,function*(){try{yield navigator.clipboard.writeText(t),this.copySuccess=!0,console.log("Texto copiado al portapapeles"),setTimeout(()=>{this.copySuccess=!1},2e3)}catch(e){console.error("Error al copiar al portapapeles:",e),this.fallbackCopyTextToClipboard(t)}})}fallbackCopyTextToClipboard(t){let e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")&&(this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3))}catch(i){console.error("Fallback: Error al copiar al portapapeles:",i)}document.body.removeChild(e)}safeExportRutina(t){let e=t.rutina_completa||this.selectedRutina;e?this.exportarRutina(e,t):console.warn("No hay rutina disponible para exportar")}safeCopyToClipboard(t){let e=t.rutina_completa||this.selectedRutina;if(e){let i=this.getFormattedRutina(e,t);this.copyToClipboard(i)}else console.warn("No hay rutina disponible para copiar")}exportarRutina(t,e){if(!t){console.warn("No hay rutina para exportar");return}let i=this.getFormattedRutina(t,e);if(!i){console.warn("No se pudo generar el contenido para exportar");return}let o=new Blob([i],{type:"text/plain;charset=utf-8"}),c=window.URL.createObjectURL(o),_=document.createElement("a");_.href=c,_.download=`${t.nombre.replace(/\s+/g,"_")}_mi_rutina.txt`,_.click(),window.URL.revokeObjectURL(c),console.log("Mi rutina exportada:",t.nombre)}onSearch(){this.applyFilters()}onFilterChange(){this.applyFilters()}clearFilters(){this.searchTerm="",this.estadoFilter="all",this.estadoIndividualFilter="all",this.progresoFilter="all",this.applyFilters()}refreshMisRutinas(){return h(this,null,function*(){yield Promise.all([this.loadMisRutinas(),this.loadEstadisticasPersonales()])})}getEstadoTemporalColor(t){switch(t){case"vigente":return"green";case"pendiente":return"blue";case"vencida":return"red";default:return"gray"}}getEstadoIndividualColor(t){switch(t){case"pendiente":return"gray";case"en_progreso":return"yellow";case"completada":return"green";case"abandonada":return"red";default:return"gray"}}getProgresoColor(t){return t===0?"gray":t<30?"red":t<70?"yellow":"green"}formatDate(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"Fecha inv\xE1lida"}}getFileName(t){if(!t||!t.nombre)return"mi_rutina_rehabimovement.txt";let e=t.nombre.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"_").substring(0,30),i=t.tipo?`_${t.tipo}`:"",o=t.nivel?`_${t.nivel}`:"",c=new Date().toISOString().split("T")[0];return`${e}${i}${o}_${c}_rehabimovement.txt`}trackByRutinaId(t,e){return e.seguimiento_id||t}static \u0275fac=function(e){return new(e||a)(I(te),I(j),I(pt))};static \u0275cmp=A({type:a,selectors:[["app-mis-rutinas"]],standalone:!1,decls:25,vars:20,consts:[["filtrosAplicados",""],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],[1,"flex","bg-gray-100","rounded-lg","p-1"],[1,"px-3","py-2","rounded-md","text-sm","font-medium","transition-colors","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1","inline"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3a2 2 0 012-2h8a2 2 0 012 2v4m-4 0V3m-4 4h8m-8 0H6a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-2"],["title","Refrescar lista",1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],[3,"volverAVista","abrirRutina","rutinas"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4"],[1,"md:col-span-2"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Buscar rutinas...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","input","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","change","ngModel"],["value","all"],["value","vigente"],["value","pendiente"],["value","vencida"],["value","en_progreso"],["value","completada"],["value","abandonada"],["value","sin_iniciar"],["value","completado"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-red-600","hover:text-red-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf"],["class","text-center py-12",4,"ngIf"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-red-600"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 border-l-4",3,"border-green-500","border-blue-500","border-red-500",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-white","rounded-lg","shadow-lg","overflow-hidden","hover:shadow-xl","transition-shadow","duration-300","border-l-4"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"text-xl","font-bold","text-white"],[1,"text-white","text-opacity-90","text-sm"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-white","bg-opacity-20","text-white"],[1,"p-6"],[1,"mb-4"],[1,"flex","justify-between","items-center","mb-2"],[1,"text-sm","font-medium","text-gray-700"],[1,"text-sm","font-bold","text-gray-900"],[1,"w-full","bg-gray-200","rounded-full","h-3"],[1,"h-3","rounded-full","transition-all","duration-300"],[1,"mt-3"],["type","range","min","0","max","100","step","5","title","Desliza para actualizar tu progreso",1,"w-full","h-2","bg-gray-200","rounded-lg","appearance-none","cursor-pointer","slider",3,"input","value"],[1,"flex","justify-between","items-center","mb-4"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-600","mb-4"],[1,"flex","justify-between"],[1,"flex","justify-between","font-medium"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-red-100","text-red-800"],["class","mb-4",4,"ngIf"],["class","text-xs text-gray-500 mb-4",4,"ngIf"],["class","mb-4 p-3 bg-gray-50 rounded-md",4,"ngIf"],[1,"flex","justify-end","space-x-2"],["title","Ver rutina completa",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50","transition-colors","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Descargar mi rutina",1,"text-green-600","hover:text-green-900","p-2","rounded-full","hover:bg-green-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"flex","flex-wrap","gap-1"],["class","inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",4,"ngFor","ngForOf"],[1,"inline-flex","items-center","px-2","py-1","rounded-md","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"text-xs","text-gray-500","mb-4"],[1,"mb-4","p-3","bg-gray-50","rounded-md"],[1,"text-sm","text-gray-700"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[4,"ngIf","ngIfElse"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-5xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900","flex","items-center"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-2"],[1,"bg-blue-600","h-2","rounded-full"],[1,"text-gray-900"],[1,"bg-gray-900","text-green-400","rounded-lg","p-6","font-mono","text-sm","overflow-auto","max-h-96","relative",2,"font-family","'Courier New', monospace","line-height","1.6"],[1,"absolute","inset-15","flex","items-center","justify-center","pointer-events-none","opacity-25"],["src","/rh.png","alt","RehabiMovement",1,"max-w-50","max-h-50","object-contain","transform","rotate-12","select-none"],[1,"flex","items-center","justify-between","mb-4","pb-2","border-b","border-gray-700","relative","z-10"],[1,"w-3","h-3","bg-red-500","rounded-full"],[1,"w-3","h-3","bg-yellow-500","rounded-full"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-gray-400","text-xs"],[1,"whitespace-pre-wrap","text-white","relative","z-10"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],["class","inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",3,"click",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-green-700"],[1,"inline-flex","items-center","px-3","py-2","border","border-transparent","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"]],template:function(e,i){e&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"h1",4),s(5,"Mis Rutinas Asignadas"),r(),n(6,"p",5),s(7),r()(),n(8,"div",6)(9,"div",7)(10,"button",8),f("click",function(){return i.cambiarVista("tarjetas")}),b(),n(11,"svg",9),p(12,"path",10),r(),s(13," Tarjetas "),r(),y(),n(14,"button",8),f("click",function(){return i.cambiarVista("calendario")}),b(),n(15,"svg",9),p(16,"path",11),r(),s(17," Calendario "),r()(),y(),n(18,"button",12),f("click",function(){return i.refreshMisRutinas()}),b(),n(19,"svg",13),p(20,"path",14),r(),s(21," Refrescar "),r()()()(),x(22,ao,2,1,"div",15)(23,wo,52,8,"div",15),r(),x(24,Mo,65,19,"div",16)),e&2&&(l(7),v(" Rutinas que me han sido asignadas - Total: ",i.misRutinas.length," "),l(3),O("bg-white",i.mostrarVistaTarjetas)("text-gray-900",i.mostrarVistaTarjetas)("shadow-sm",i.mostrarVistaTarjetas)("text-gray-500",!i.mostrarVistaTarjetas),l(4),O("bg-white",i.mostrarVistaCalendario)("text-gray-900",i.mostrarVistaCalendario)("shadow-sm",i.mostrarVistaCalendario)("text-gray-500",!i.mostrarVistaCalendario),l(8),m("ngIf",i.mostrarVistaCalendario),l(),m("ngIf",i.mostrarVistaTarjetas),l(),m("ngIf",i.showViewModal))},dependencies:[$,N,R,J,Z,q,Q,W,G,ut],styles:[".slider[_ngcontent-%COMP%]{-webkit-appearance:none;appearance:none;background:linear-gradient(to right,#ef4444,#f59e0b,#10b981);outline:none;opacity:.7;transition:opacity .2s}.slider[_ngcontent-%COMP%]:hover{opacity:1}.slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;border-radius:50%;background:#fff;border:2px solid #ef4444;cursor:pointer;box-shadow:0 2px 4px #0003}.slider[_ngcontent-%COMP%]::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:#fff;border:2px solid #ef4444;cursor:pointer;box-shadow:0 2px 4px #0003}.rutina-card[_ngcontent-%COMP%]{transition:all .3s ease}.rutina-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.rutina-card.vigente[_ngcontent-%COMP%]{border-left:4px solid #10b981}.rutina-card.pendiente[_ngcontent-%COMP%]{border-left:4px solid #3b82f6}.rutina-card.vencida[_ngcontent-%COMP%]{border-left:4px solid #ef4444}.progress-bar[_ngcontent-%COMP%]{transition:width .5s ease-in-out}.estado-vigente[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669)}.estado-pendiente[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb)}.estado-vencida[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626)}@media (max-width: 768px){.grid-cols-3[_ngcontent-%COMP%], .md\\:grid-cols-2[_ngcontent-%COMP%]{grid-template-columns:repeat(1,minmax(0,1fr))}}.terminal[_ngcontent-%COMP%]{font-family:Courier New,Monaco,Menlo,monospace;background-color:#1a1a1a;color:#0f0;border-radius:8px;padding:1rem;max-height:400px;overflow-y:auto}.terminal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid #333}.terminal-dots[_ngcontent-%COMP%]{display:flex;gap:.5rem}.terminal-dot[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%}.terminal-dot.red[_ngcontent-%COMP%]{background-color:#ff5f56}.terminal-dot.yellow[_ngcontent-%COMP%]{background-color:#ffbd2e}.terminal-dot.green[_ngcontent-%COMP%]{background-color:#27ca3f}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#777}.action-button[_ngcontent-%COMP%]{transition:all .2s ease}.action-button[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.badge-pendiente[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151}.badge-en-progreso[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.badge-completada[_ngcontent-%COMP%]{background-color:#d1fae5;color:#065f46}.badge-abandonada[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b}.progress-circle[_ngcontent-%COMP%]{transform:rotate(-90deg)}.progress-circle[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{fill:none;stroke-width:8;stroke-linecap:round}.progress-circle[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]{stroke:#e5e7eb}.progress-circle[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{stroke:#10b981;stroke-dasharray:251.2;stroke-dashoffset:251.2;transition:stroke-dashoffset .5s ease}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.notas-box[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#e2e8f0);border-left:4px solid #3b82f6}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.dias-restantes-ok[_ngcontent-%COMP%]{color:#10b981;font-weight:600}.dias-restantes-warning[_ngcontent-%COMP%]{color:#f59e0b;font-weight:600}.dias-restantes-danger[_ngcontent-%COMP%]{color:#ef4444;font-weight:600}@media (min-width: 768px) and (max-width: 1024px){.grid-cols-3[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}.modal-overlay[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-panel[_ngcontent-%COMP%]{max-height:90vh;overflow-y:auto}.tag[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .5rem;border-radius:.375rem;font-size:.75rem;font-weight:500;background-color:#dbeafe;color:#1e40af}.modal-panel[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.modal-panel[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.modal-panel[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.modal-panel[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}"]})};var Ve=class a{constructor(t){this.supabaseService=t}getTerapias(){return h(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("terapias").select("*").eq("status",1).order("created_at",{ascending:!1});if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener terapias:",t),t}})}getTerapiaById(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapias").select("*").eq("id",t).eq("status",1).single();if(i)throw i;return e}catch(e){throw console.error("Error al obtener terapia:",e),e}})}createTerapia(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapias").insert([t]).select().single();if(i)throw i;return e}catch(e){throw console.error("Error al crear terapia:",e),e}})}updateTerapia(t,e){return h(this,null,function*(){try{let{data:i,error:o}=yield this.supabaseService.supabase.from("terapias").update(Fe(ge({},e),{updated_at:new Date().toISOString()})).eq("id",t).select().single();if(o)throw o;return i}catch(i){throw console.error("Error al actualizar terapia:",i),i}})}deleteTerapia(t){return h(this,null,function*(){try{let{error:e}=yield this.supabaseService.supabase.from("terapias").update({status:0}).eq("id",t);if(e)throw e}catch(e){throw console.error("Error al eliminar terapia:",e),e}})}getTiposEjerciciosTerapeuticos(){return h(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("tipos_ejercicios_terapeuticos").select("*").eq("status",1).order("nombre");if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener tipos de ejercicios:",t),t}})}getInformacionMedicaUsuario(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").select("*").eq("usuario_id",t).single();if(i&&i.code!=="PGRST116")throw i;return e}catch(e){throw console.error("Error al obtener informaci\xF3n m\xE9dica:",e),e}})}createOrUpdateInformacionMedica(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").upsert(t,{onConflict:"usuario_id"}).select().single();if(i)throw i;return e}catch(e){throw console.error("Error al guardar informaci\xF3n m\xE9dica:",e),e}})}asignarTerapiaAUsuarios(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.rpc("asignar_terapia_a_usuarios",{p_id_terapia:t.id_terapia,p_usuarios_ids:t.usuarios_ids,p_asignado_por:yield this.getCurrentUserId(),p_fecha_inicio:t.fecha_inicio.toISOString().split("T")[0],p_fecha_fin:t.fecha_fin.toISOString().split("T")[0],p_terapeuta_responsable:t.terapeuta_responsable||null,p_sesiones_por_semana:t.sesiones_por_semana,p_duracion_sesion:t.duracion_sesion,p_tipo_asignacion:t.tipo_asignacion,p_notas:t.notas||null,p_objetivos_grupales:t.objetivos_grupales||null});if(i)throw i;return e}catch(e){throw console.error("Error al asignar terapia:",e),e}})}getTerapiasAsignadasUsuarios(){return h(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").order("fecha_asignacion",{ascending:!1});if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener terapias asignadas:",t),t}})}getTerapiasUsuario(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.rpc("get_terapias_usuario",{p_user_id:t});if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener terapias del usuario:",e),e}})}actualizarProgresoTerapia(t,e){return h(this,null,function*(){try{let{data:i,error:o}=yield this.supabaseService.supabase.rpc("actualizar_progreso_terapia",{p_seguimiento_id:t,p_progreso:e.progreso||null,p_estado_individual:e.estado_individual||null,p_sesiones_completadas:e.sesiones_completadas||null,p_adherencia_porcentaje:e.adherencia_porcentaje||null,p_nivel_dolor_actual:e.nivel_dolor_actual||null,p_nivel_funcionalidad_actual:e.nivel_funcionalidad_actual||null,p_notas_individuales:e.notas_individuales||null,p_objetivos_individuales:e.objetivos_individuales||null});if(o)throw o;return i}catch(i){throw console.error("Error al actualizar progreso:",i),i}})}registrarSesionTerapia(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.rpc("registrar_sesion_terapia",{p_seguimiento_id:t.seguimiento_id,p_numero_sesion:t.numero_sesion,p_fecha_sesion:t.fecha_sesion.toISOString().split("T")[0],p_estado_sesion:t.estado_sesion||"completada",p_hora_inicio:t.hora_inicio||null,p_hora_fin:t.hora_fin||null,p_terapeuta_id:t.terapeuta_id||null,p_ejercicios_realizados:t.ejercicios_realizados||null,p_dolor_inicio:t.dolor_inicio||null,p_dolor_fin:t.dolor_fin||null,p_nivel_fatiga:t.nivel_fatiga||null,p_nivel_esfuerzo:t.nivel_esfuerzo||null,p_adherencia_sesion:t.adherencia_sesion||null,p_observaciones_usuario:t.observaciones_usuario||null,p_observaciones_terapeuta:t.observaciones_terapeuta||null});if(i)throw i;return e}catch(e){throw console.error("Error al registrar sesi\xF3n:",e),e}})}getSesionesUsuario(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapia_registro_sesiones").select(`
          *,
          terapeuta:terapeuta_id(full_name)
        `).eq("id_seguimiento",t).order("numero_sesion");if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener sesiones:",e),e}})}getEstadisticasTerapias(){return h(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.rpc("get_estadisticas_terapias_asignadas");if(e)throw e;return t[0]||{total_asignaciones:0,asignaciones_activas:0,asignaciones_grupales:0,asignaciones_individuales:0,usuarios_con_terapias:0,terapias_mas_asignadas:0,promedio_progreso:0,promedio_adherencia:0,sesiones_totales_completadas:0,sesiones_totales_programadas:0}}catch(t){throw console.error("Error al obtener estad\xEDsticas:",t),t}})}getUsuarios(){return h(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("profiles").select("id, username, full_name, email, id_perfil").eq("status",1).order("full_name");if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener usuarios:",t),t}})}getTerapeutas(){return h(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("profiles").select("id, username, full_name, email").eq("id_perfil",3).eq("status",1).order("full_name");if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener terapeutas:",t),t}})}updatePerfilCompleto(t,e){return h(this,null,function*(){try{let i={full_name:e.full_name,username:e.username,email:e.email},{error:o}=yield this.supabaseService.supabase.from("profiles").update(i).eq("id",t);if(o)throw o;let c={usuario_id:t,fecha_nacimiento:e.fecha_nacimiento,genero:e.genero,telefono:e.telefono,direccion:e.direccion,diagnostico_principal:e.diagnostico_principal,diagnosticos_secundarios:e.diagnosticos_secundarios,historial_medico:e.historial_medico,medicamentos_actuales:e.medicamentos_actuales,alergias:e.alergias,limitaciones_fisicas:e.limitaciones_fisicas,observaciones_generales:e.observaciones_generales,contacto_emergencia_nombre:e.contacto_emergencia_nombre,contacto_emergencia_telefono:e.contacto_emergencia_telefono,contacto_emergencia_relacion:e.contacto_emergencia_relacion,peso:e.peso,altura:e.altura,imc:e.peso&&e.altura?e.peso/(e.altura/100)**2:void 0,nivel_dolor_inicial:e.nivel_dolor_inicial,nivel_funcionalidad_inicial:e.nivel_funcionalidad_inicial,objetivos_paciente:e.objetivos_paciente,updated_at:new Date().toISOString()};yield this.createOrUpdateInformacionMedica(c)}catch(i){throw console.error("Error al actualizar perfil completo:",i),i}})}getPerfilCompleto(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("profiles").select("username, full_name, email").eq("id",t).single();if(i)throw i;let o=yield this.getInformacionMedicaUsuario(t);return{username:e.username,full_name:e.full_name,email:e.email,fecha_nacimiento:o?.fecha_nacimiento,genero:o?.genero,telefono:o?.telefono,direccion:o?.direccion,diagnostico_principal:o?.diagnostico_principal,diagnosticos_secundarios:o?.diagnosticos_secundarios,historial_medico:o?.historial_medico,medicamentos_actuales:o?.medicamentos_actuales,alergias:o?.alergias,limitaciones_fisicas:o?.limitaciones_fisicas,observaciones_generales:o?.observaciones_generales,contacto_emergencia_nombre:o?.contacto_emergencia_nombre,contacto_emergencia_telefono:o?.contacto_emergencia_telefono,contacto_emergencia_relacion:o?.contacto_emergencia_relacion,peso:o?.peso,altura:o?.altura,nivel_dolor_inicial:o?.nivel_dolor_inicial,nivel_funcionalidad_inicial:o?.nivel_funcionalidad_inicial,objetivos_paciente:o?.objetivos_paciente}}catch(e){throw console.error("Error al obtener perfil completo:",e),e}})}getTerapiasByTipo(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapias").select("*").eq("tipo",t).eq("status",1).order("nombre");if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener terapias por tipo:",e),e}})}getTerapiasByArea(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapias").select("*").eq("area_especializacion",t).eq("status",1).order("nombre");if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener terapias por \xE1rea:",e),e}})}duplicarTerapia(t,e){return h(this,null,function*(){try{let i=yield this.getTerapiaById(t);if(!i)throw new Error("Terapia no encontrada");let o=Fe(ge({},i),{id:void 0,nombre:e,created_at:void 0,updated_at:void 0});return yield this.createTerapia(o)}catch(i){throw console.error("Error al duplicar terapia:",i),i}})}buscarTerapias(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapias").select("*").or(`nombre.ilike.%${t}%,descripcion.ilike.%${t}%,area_especializacion.ilike.%${t}%`).eq("status",1).order("nombre");if(i)throw i;return e||[]}catch(e){throw console.error("Error al buscar terapias:",e),e}})}getSeguimientoDetalladoUsuario(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapia_seguimiento_individual").select(`
          *,
          terapia:id_terapia(*),
          asignacion:id_asignacion_masiva(*),
          profile:id_profile(*)
        `).eq("id_profile",t);if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener seguimiento detallado:",e),e}})}getAsignacionesPorTerapeuta(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").eq("terapeuta_responsable",t).order("fecha_asignacion",{ascending:!1});if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener asignaciones por terapeuta:",e),e}})}getProximasSesionesTeruapeuta(t,e=7){return h(this,null,function*(){try{let i=new Date().toISOString().split("T")[0],o=new Date(Date.now()+e*24*60*60*1e3).toISOString().split("T")[0],{data:c,error:_}=yield this.supabaseService.supabase.rpc("get_proximas_sesiones_terapeuta",{p_terapeuta_id:t,p_fecha_inicio:i,p_dias:e});if(_)throw _;return c||[]}catch(i){throw console.error("Error al obtener pr\xF3ximas sesiones:",i),i}})}calcularAdherenciaUsuario(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.rpc("calcular_adherencia_usuario",{p_usuario_id:t});if(i)throw i;return e[0]||null}catch(e){throw console.error("Error al calcular adherencia:",e),e}})}getReporteProgresoPorArea(){return h(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("v_progreso_por_area").select("*");if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener reporte por \xE1rea:",t),t}})}getDashboardTerapeuta(t){return h(this,null,function*(){try{let e=this.supabaseService.supabase.from("v_dashboard_terapeutas").select("*");t&&(e=e.eq("terapeuta_id",t));let{data:i,error:o}=yield e;if(o)throw o;return i||[]}catch(e){throw console.error("Error al obtener dashboard de terapeuta:",e),e}})}getUsuariosQueNecesitanSeguimiento(){return h(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").eq("estado_individual","en_progreso").or("adherencia_porcentaje.lt.70,progreso.lt.30").order("ultima_actualizacion",{ascending:!0}).limit(10);if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener usuarios que necesitan seguimiento:",t),t}})}validarAsignacionTerapia(t,e){return h(this,null,function*(){try{let{data:i,error:o}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").eq("id_profile",t).eq("id_terapia",e).in("estado_individual",["pendiente","en_progreso"]);if(o)throw o;return i&&i.length>0?{valido:!1,mensaje:"El usuario ya tiene esta terapia asignada y activa"}:(yield this.getInformacionMedicaUsuario(t))?{valido:!0}:{valido:!1,mensaje:"El usuario no tiene informaci\xF3n m\xE9dica registrada"}}catch(i){return console.error("Error validando asignaci\xF3n:",i),{valido:!1,mensaje:"Error al validar la asignaci\xF3n"}}})}getHistorialCambiosEstado(t){return h(this,null,function*(){try{return[]}catch(e){throw console.error("Error al obtener historial de cambios:",e),e}})}exportarSeguimientoCSV(t){let e=["Usuario","Terapia","Estado","Progreso","Adherencia","Sesiones Completadas","Sesiones Programadas","Terapeuta","Fecha Inicio","Fecha Fin","\xDAltima Actualizaci\xF3n"],i=t.map(c=>[c.full_name,c.terapia_nombre,c.estado_individual,`${c.progreso}%`,`${c.adherencia_porcentaje}%`,c.sesiones_completadas,c.sesiones_programadas,c.terapeuta_nombre||"Sin asignar",this.formatearFecha(c.fecha_inicio_programada),this.formatearFecha(c.fecha_fin_programada),this.formatearFecha(c.ultima_actualizacion)]);return[e,...i].map(c=>c.map(_=>`"${_}"`).join(",")).join(`
`)}formatearFecha(t){return new Date(t).toLocaleDateString("es-ES")}generarReportePDF(t){return h(this,null,function*(){return new Blob(["Reporte PDF no implementado"],{type:"application/pdf"})})}getAlertasTerapeuta(t){return h(this,null,function*(){try{let e=[],{data:i}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").eq("terapeuta_responsable",t).lt("adherencia_porcentaje",70).eq("estado_individual","en_progreso");i&&i.forEach(c=>{e.push({tipo:"baja_adherencia",mensaje:`${c.full_name} tiene baja adherencia (${c.adherencia_porcentaje}%) en ${c.terapia_nombre}`,prioridad:"alta",asignacion:c})});let{data:o}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").eq("terapeuta_responsable",t).lte("dias_restantes",7).eq("estado_individual","en_progreso");return o&&o.forEach(c=>{e.push({tipo:"proxima_vencer",mensaje:`La terapia de ${c.full_name} vence en ${c.dias_restantes} d\xEDas`,prioridad:"media",asignacion:c})}),e}catch(e){return console.error("Error al obtener alertas:",e),[]}})}marcarAlertaLeida(t){return h(this,null,function*(){console.log(`Alerta ${t} marcada como le\xEDda`)})}getCurrentUserId(){return h(this,null,function*(){try{let{data:{user:t}}=yield this.supabaseService.supabase.auth.getUser();if(!t)throw new Error("Usuario no autenticado");let{data:e,error:i}=yield this.supabaseService.supabase.from("profiles").select("id").eq("user_id",t.id).single();if(i)throw i;return e.id}catch(t){throw console.error("Error al obtener ID del usuario actual:",t),t}})}calcularIMC(t,e){if(!t||!e)return 0;let i=e/100;return Math.round(t/i**2*100)/100}formatearDuracion(t){if(t<60)return`${t} min`;{let e=Math.floor(t/60),i=t%60;return i>0?`${e}h ${i}min`:`${e}h`}}getColorNivelDolor(t){return t<=2?"text-green-600":t<=4?"text-yellow-600":t<=6?"text-orange-600":"text-red-600"}getColorProgreso(t){return t>=80?"text-green-600":t>=60?"text-blue-600":t>=40?"text-yellow-600":"text-red-600"}getColorAdherencia(t){return t>=90?"text-green-600":t>=70?"text-blue-600":t>=50?"text-yellow-600":"text-red-600"}formatearFechaLegible(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}formatearFechaCorta(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}calcularDiasEntre(t,e){let i=new Date(t),c=new Date(e).getTime()-i.getTime();return Math.ceil(c/(1e3*60*60*24))}calcularProgresoTemporal(t,e){let i=new Date(t),o=new Date(e),c=new Date;if(c<i)return 0;if(c>o)return 100;let _=this.calcularDiasEntre(i,o),S=this.calcularDiasEntre(i,c);return Math.round(S/_*100)}validarEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}validarTelefono(t){return/^[\+]?[0-9\s\-\(\)]{8,20}$/.test(t)}generarCodigoAleatorio(t=6){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i="";for(let o=0;o<t;o++)i+=e.charAt(Math.floor(Math.random()*e.length));return i}limpiarTexto(t){return t.trim().replace(/\s+/g," ")}toTitleCase(t){return t.toLowerCase().replace(/\b\w/g,e=>e.toUpperCase())}truncarTexto(t,e){return t.length<=e?t:t.substring(0,e)+"..."}obtenerIniciales(t){return t.split(" ").map(e=>e.charAt(0).toUpperCase()).join("").substring(0,2)}generarColorAvatar(t){let e=["bg-red-500","bg-blue-500","bg-green-500","bg-yellow-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-gray-500"],i=0;for(let o=0;o<t.length;o++)i=t.charCodeAt(o)+((i<<5)-i);return e[Math.abs(i)%e.length]}descargarCSV(t,e){let i=new Blob([t],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");if(o.download!==void 0){let c=URL.createObjectURL(i);o.setAttribute("href",c),o.setAttribute("download",e),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}descargarJSON(t,e){let i=JSON.stringify(t,null,2),o=new Blob([i],{type:"application/json;charset=utf-8;"}),c=document.createElement("a");if(c.download!==void 0){let _=URL.createObjectURL(o);c.setAttribute("href",_),c.setAttribute("download",e),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}}mostrarExito(t){console.log("\xC9xito:",t)}mostrarError(t){console.error("Error:",t)}mostrarInfo(t){console.info("Info:",t)}debug(){console.log("=== TerapiasService Debug ==="),console.log("Supabase conectado:",!!this.supabaseService.supabase),console.log("============================")}static \u0275fac=function(e){return new(e||a)(he(te))};static \u0275prov=ke({token:a,factory:a.\u0275fac,providedIn:"root"})};var Eo=(a,t,e,i,o)=>({"bg-blue-100 text-blue-800":a,"bg-green-100 text-green-800":t,"bg-purple-100 text-purple-800":e,"bg-yellow-100 text-yellow-800":i,"bg-red-100 text-red-800":o});function ko(a,t){if(a&1){let e=C();n(0,"button",31),f("click",function(){u(e);let o=d();return g(o.openCreateModal())}),b(),n(1,"svg",32),p(2,"path",33),r(),s(3," Nueva Terapia "),r()}}function To(a,t){if(a&1&&(n(0,"div",34)(1,"div",35),b(),n(2,"svg",36),p(3,"path",37),r(),y(),n(4,"div",38)(5,"p",39),s(6),r()()()()),a&2){let e=d();l(6),w(e.error)}}function Po(a,t){if(a&1&&(n(0,"option",40),s(1),r()),a&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function Io(a,t){if(a&1&&(n(0,"option",40),s(1),ce(2,"titlecase"),r()),a&2){let e=t.$implicit;m("value",e),l(),v(" ",pe(2,2,e)," ")}}function Oo(a,t){if(a&1&&(n(0,"option",40),s(1),r()),a&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function Vo(a,t){a&1&&(n(0,"div",41),p(1,"div",42),n(2,"p",23),s(3,"Cargando terapias..."),r()())}function Fo(a,t){if(a&1&&(n(0,"p",66),s(1),r()),a&2){let e=d().$implicit;l(),v(" ",e.descripcion," ")}}function Do(a,t){if(a&1&&(n(0,"span",57),s(1),ce(2,"titlecase"),r()),a&2){let e=d().$implicit;l(),v(" ",pe(2,1,e.area_especializacion)," ")}}function Ao(a,t){if(a&1&&(n(0,"span",57),s(1),r()),a&2){let e=d().$implicit,i=d(2);l(),v(" ",i.getTotalEjercicios(e)," ejercicios ")}}function Ro(a,t){if(a&1&&(n(0,"span",69),s(1),r()),a&2){let e=t.$implicit;l(),v(" #",e," ")}}function jo(a,t){if(a&1&&(n(0,"div",67),x(1,Ro,2,1,"span",68),r()),a&2){let e=d().$implicit;l(),m("ngForOf",e.tags)}}function Uo(a,t){if(a&1){let e=C();n(0,"button",70),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.openEditModal(o))}),b(),n(1,"svg",61),p(2,"path",71),r()()}}function Lo(a,t){if(a&1){let e=C();n(0,"button",72),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.deleteTerapia(o))}),b(),n(1,"svg",61),p(2,"path",73),r()()}}function No(a,t){if(a&1){let e=C();n(0,"li",45)(1,"div",46)(2,"div",47)(3,"div",48)(4,"div",49)(5,"div",50)(6,"p",51),s(7),r(),x(8,Fo,2,1,"p",52),n(9,"div",53)(10,"span",54),s(11),r(),x(12,Do,3,3,"span",55),n(13,"span",56),s(14),r(),n(15,"span",57),s(16),r(),x(17,Ao,2,1,"span",55),r(),x(18,jo,2,1,"div",58),r()()(),n(19,"div",59)(20,"button",60),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.openViewModal(o))}),b(),n(21,"svg",61),p(22,"path",62)(23,"path",63),r()(),x(24,Uo,3,0,"button",64)(25,Lo,3,0,"button",65),r()()()()}if(a&2){let e=t.$implicit,i=d(2);l(7),v(" ",e.nombre," "),l(),m("ngIf",e.descripcion),l(2),m("ngClass",je(11,Eo,e.tipo==="fisica",e.tipo==="ocupacional",e.tipo==="respiratoria",e.tipo==="neurologica",e.tipo==="cardiaca")),l(),v(" ",i.getTipoLabel(e.tipo)," "),l(),m("ngIf",e.area_especializacion),l(2),w(e.nivel),l(2),w(i.formatDuracion(e.duracion_estimada)),l(),m("ngIf",i.hasEjercicios(e)),l(),m("ngIf",e.tags&&e.tags.length>0),l(6),m("ngIf",i.canEditTerapia()),l(),m("ngIf",i.canEditTerapia())}}function zo(a,t){if(a&1&&(n(0,"ul",43),x(1,No,26,17,"li",44),r()),a&2){let e=d();l(),m("ngForOf",e.filteredTerapias)}}function Bo(a,t){if(a&1){let e=C();n(0,"button",82),f("click",function(){u(e);let o=d(2);return g(o.openCreateModal())}),s(1," Crear primera terapia "),r()}}function $o(a,t){if(a&1){let e=C();n(0,"button",83),f("click",function(){u(e);let o=d(2);return g(o.clearFilters())}),s(1," Limpiar filtros "),r()}}function qo(a,t){if(a&1&&(n(0,"div",74),b(),n(1,"svg",75),p(2,"path",76),r(),y(),n(3,"h3",77),s(4,"No hay terapias"),r(),n(5,"p",78),s(6),r(),n(7,"div",79),x(8,Bo,2,0,"button",80)(9,$o,2,0,"button",81),r()()),a&2){let e=d();l(6),v(" ",e.terapias.length===0?"No se encontraron terapias en la base de datos.":"No se encontraron terapias con los filtros aplicados."," "),l(2),m("ngIf",e.terapias.length===0&&e.canEditTerapia()),l(),m("ngIf",e.terapias.length>0)}}function Wo(a,t){if(a&1&&(n(0,"option",40),s(1),r()),a&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function Go(a,t){if(a&1&&(n(0,"option",40),s(1),ce(2,"titlecase"),r()),a&2){let e=t.$implicit;m("value",e),l(),v(" ",pe(2,2,e)," ")}}function Ho(a,t){if(a&1&&(n(0,"option",40),s(1),r()),a&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function Yo(a,t){if(a&1){let e=C();n(0,"span",133),s(1),n(2,"button",134),f("click",function(){let o=u(e).index,c=d(3);return g(c.removeTag(o))}),b(),n(3,"svg",135),p(4,"path",136),r()()()}if(a&2){let e=t.$implicit;l(),v(" #",e," ")}}function Qo(a,t){if(a&1&&(n(0,"div",131),x(1,Yo,5,1,"span",132),r()),a&2){let e=d(2);l(),m("ngForOf",e.terapiaForm.tags)}}function Jo(a,t){if(a&1){let e=C();n(0,"div",137)(1,"label",138)(2,"input",139),f("change",function(){let o=u(e).$implicit,c=d(2);return g(c.toggleSeccion(o.key))}),r(),n(3,"div",38)(4,"div",140),s(5),r(),n(6,"div",23),s(7),r()()()()}if(a&2){let e=t.$implicit,i=d(2);l(2),m("checked",i.seccionesActivas.has(e.key)),l(3),w(e.nombre),l(2),w(e.descripcion)}}function Zo(a,t){if(a&1&&(n(0,"option",40),s(1),r()),a&2){let e=t.$implicit;m("value",e.nombre),l(),v(" ",e.nombre," ")}}function Xo(a,t){if(a&1&&(n(0,"option",40),s(1),r()),a&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function Ko(a,t){if(a&1){let e=C();n(0,"div",155)(1,"div",156)(2,"span",157),s(3),r(),n(4,"div",158)(5,"button",159),f("click",function(){let o=u(e).index,c=d(3).$implicit,_=d(2);return g(_.moveEjercicio(c,o,o-1))}),b(),n(6,"svg",160),p(7,"path",161),r()(),y(),n(8,"button",162),f("click",function(){let o=u(e).index,c=d(3).$implicit,_=d(2);return g(_.moveEjercicio(c,o,o+1))}),b(),n(9,"svg",160),p(10,"path",163),r()(),y(),n(11,"button",164),f("click",function(){let o=u(e).index,c=d(3).$implicit,_=d(2);return g(_.removeEjercicio(c,o))}),b(),n(12,"svg",160),p(13,"path",73),r()()()(),y(),n(14,"div",165)(15,"div",98)(16,"label",166),s(17,"Nombre *"),r(),n(18,"input",167),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.nombre,o)||(c.nombre=o),g(o)}),r()(),n(19,"div")(20,"label",166),s(21,"Tipo"),r(),n(22,"select",168),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.tipo,o)||(c.tipo=o),g(o)}),x(23,Zo,2,2,"option",16),r()(),n(24,"div")(25,"label",166),s(26,"Intensidad"),r(),n(27,"select",168),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.intensidad,o)||(c.intensidad=o),g(o)}),x(28,Xo,2,2,"option",16),r()(),n(29,"div")(30,"label",166),s(31,"Repeticiones"),r(),n(32,"input",169),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.repeticiones,o)||(c.repeticiones=o),g(o)}),r()(),n(33,"div")(34,"label",166),s(35,"Series"),r(),n(36,"input",169),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.series,o)||(c.series=o),g(o)}),r()(),n(37,"div")(38,"label",166),s(39,"Duraci\xF3n"),r(),n(40,"input",170),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.duracion,o)||(c.duracion=o),g(o)}),r()(),n(41,"div",98)(42,"label",166),s(43,"Descripci\xF3n"),r(),n(44,"textarea",171),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.descripcion,o)||(c.descripcion=o),g(o)}),r()(),n(45,"div",98)(46,"label",166),s(47,"Precauciones"),r(),n(48,"textarea",172),k("ngModelChange",function(o){let c=u(e).$implicit;return E(c.precauciones,o)||(c.precauciones=o),g(o)}),r()()()()}if(a&2){let e=t.$implicit,i=t.index,o=d(2).ngIf,c=d().$implicit,_=d(2);l(3),v("Ejercicio ",i+1,""),l(2),m("disabled",i===0),l(3),m("disabled",i===o.ejercicios.length-1),l(10),M("ngModel",e.nombre),m("name","ejercicio_nombre_"+c+"_"+i),l(4),M("ngModel",e.tipo),m("name","ejercicio_tipo_"+c+"_"+i),l(),m("ngForOf",_.tiposEjercicios),l(4),M("ngModel",e.intensidad),m("name","ejercicio_intensidad_"+c+"_"+i),l(),m("ngForOf",_.intensidadesDisponibles),l(4),M("ngModel",e.repeticiones),m("name","ejercicio_repeticiones_"+c+"_"+i),l(4),M("ngModel",e.series),m("name","ejercicio_series_"+c+"_"+i),l(4),M("ngModel",e.duracion),m("name","ejercicio_duracion_"+c+"_"+i),l(4),M("ngModel",e.descripcion),m("name","ejercicio_descripcion_"+c+"_"+i),l(4),M("ngModel",e.precauciones),m("name","ejercicio_precauciones_"+c+"_"+i)}}function ea(a,t){if(a&1&&(n(0,"div",153),x(1,Ko,49,21,"div",154),r()),a&2){let e=d().ngIf;l(),m("ngForOf",e.ejercicios)}}function ta(a,t){if(a&1){let e=C();n(0,"div",173)(1,"p",23),s(2,"No hay ejercicios en esta secci\xF3n"),r(),n(3,"button",174),f("click",function(){u(e);let o=d(2).$implicit,c=d(2);return g(c.addEjercicio(o))}),s(4," Agregar primer ejercicio "),r()()}}function ia(a,t){if(a&1){let e=C();fe(0),n(1,"h5",143),s(2),r(),n(3,"div",144)(4,"div")(5,"label",145),s(6,"Descripci\xF3n"),r(),n(7,"textarea",146),k("ngModelChange",function(o){let c=u(e).ngIf;return E(c.descripcion,o)||(c.descripcion=o),g(o)}),r()(),n(8,"div")(9,"label",145),s(10,"Tiempo Total"),r(),n(11,"input",147),k("ngModelChange",function(o){let c=u(e).ngIf;return E(c.tiempo_total,o)||(c.tiempo_total=o),g(o)}),r()(),n(12,"div")(13,"div",148)(14,"label",145),s(15,"Ejercicios"),r(),n(16,"button",149),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.addEjercicio(o))}),b(),n(17,"svg",150),p(18,"path",33),r(),s(19," Agregar Ejercicio "),r()(),x(20,ea,2,1,"div",151)(21,ta,5,0,"div",152),r()(),_e()}if(a&2){let e=t.ngIf,i=d().$implicit,o=d(2);l(2),v(" ",o.getSeccionNombre(i)," "),l(5),M("ngModel",e.descripcion),m("name","descripcion_"+i),l(4),M("ngModel",e.tiempo_total),m("name","tiempo_"+i),l(9),m("ngIf",e.ejercicios&&e.ejercicios.length>0),l(),m("ngIf",!e.ejercicios||e.ejercicios.length===0)}}function na(a,t){if(a&1&&(n(0,"div",141),x(1,ia,22,7,"ng-container",142),r()),a&2){let e=t.$implicit,i=d(2);l(),m("ngIf",i.getSeccionData(e))}}function ra(a,t){a&1&&(n(0,"span",175),p(1,"div",176),r())}function oa(a,t){if(a&1){let e=C();n(0,"div",84)(1,"div",85)(2,"div",86),f("click",function(){u(e);let o=d();return g(o.closeModal())}),r(),n(3,"div",87)(4,"div",88)(5,"div",89)(6,"div",90),b(),n(7,"svg",91),p(8,"path",76),r()(),y(),n(9,"div",92)(10,"h3",93),s(11),r(),n(12,"div",67)(13,"p",23),s(14),r()()()()(),n(15,"div",94)(16,"form",95),f("ngSubmit",function(){u(e);let o=d();return g(o.saveTerapia())}),n(17,"div",96)(18,"div",97)(19,"div",98)(20,"label",99),s(21," Nombre de la Terapia * "),r(),n(22,"input",100),k("ngModelChange",function(o){u(e);let c=d();return E(c.terapiaForm.nombre,o)||(c.terapiaForm.nombre=o),g(o)}),r()(),n(23,"div",98)(24,"label",101),s(25," Descripci\xF3n "),r(),n(26,"textarea",102),k("ngModelChange",function(o){u(e);let c=d();return E(c.terapiaForm.descripcion,o)||(c.terapiaForm.descripcion=o),g(o)}),r()(),n(27,"div")(28,"label",103),s(29," Tipo de Terapia * "),r(),n(30,"select",104),k("ngModelChange",function(o){u(e);let c=d();return E(c.terapiaForm.tipo,o)||(c.terapiaForm.tipo=o),g(o)}),x(31,Wo,2,2,"option",16),r()(),n(32,"div")(33,"label",105),s(34," \xC1rea de Especializaci\xF3n "),r(),n(35,"select",106),k("ngModelChange",function(o){u(e);let c=d();return E(c.terapiaForm.area_especializacion,o)||(c.terapiaForm.area_especializacion=o),g(o)}),n(36,"option",107),s(37,"Seleccionar \xE1rea"),r(),x(38,Go,3,4,"option",16),r()(),n(39,"div")(40,"label",108),s(41," Nivel * "),r(),n(42,"select",109),k("ngModelChange",function(o){u(e);let c=d();return E(c.terapiaForm.nivel,o)||(c.terapiaForm.nivel=o),g(o)}),x(43,Ho,2,2,"option",16),r()(),n(44,"div")(45,"label",110),s(46," Duraci\xF3n Estimada (minutos) "),r(),n(47,"input",111),k("ngModelChange",function(o){u(e);let c=d();return E(c.terapiaForm.duracion_estimada,o)||(c.terapiaForm.duracion_estimada=o),g(o)}),r()()(),n(48,"div")(49,"label",112),s(50," Objetivo Principal "),r(),n(51,"textarea",113),k("ngModelChange",function(o){u(e);let c=d();return E(c.terapiaForm.objetivo_principal,o)||(c.terapiaForm.objetivo_principal=o),g(o)}),r()(),n(52,"div")(53,"label",114),s(54," Contraindicaciones "),r(),n(55,"textarea",115),k("ngModelChange",function(o){u(e);let c=d();return E(c.terapiaForm.contraindicaciones,o)||(c.terapiaForm.contraindicaciones=o),g(o)}),r()(),n(56,"div")(57,"label",116),s(58," Criterios de Progresi\xF3n "),r(),n(59,"textarea",117),k("ngModelChange",function(o){u(e);let c=d();return E(c.terapiaForm.criterios_progresion,o)||(c.terapiaForm.criterios_progresion=o),g(o)}),r()(),n(60,"div")(61,"label",118),s(62," Tags "),r(),n(63,"div",119)(64,"input",120),f("keydown.enter",function(o){return u(e),d().addTag(o),g(o.preventDefault())}),r(),x(65,Qo,2,1,"div",121),r()(),n(66,"div")(67,"h4",122),s(68,"Secciones de Ejercicios"),r(),n(69,"div",123),x(70,Jo,8,3,"div",124),r(),x(71,na,2,1,"div",125),r()()()(),n(72,"div",126)(73,"div",127)(74,"button",128),f("click",function(){u(e);let o=d();return g(o.saveTerapia())}),x(75,ra,2,0,"span",129),s(76),r(),n(77,"button",130),f("click",function(){u(e);let o=d();return g(o.closeModal())}),s(78," Cancelar "),r()()()()()()}if(a&2){let e=d();l(11),v(" ",e.modalMode==="create"?"Crear Terapia":"Editar Terapia"," "),l(3),v(" ",e.modalMode==="create"?"Complete la informaci\xF3n para crear una nueva terapia de rehabilitaci\xF3n.":"Modifique la informaci\xF3n de la terapia seleccionada."," "),l(8),M("ngModel",e.terapiaForm.nombre),l(4),M("ngModel",e.terapiaForm.descripcion),l(4),M("ngModel",e.terapiaForm.tipo),l(),m("ngForOf",e.tiposDisponibles),l(4),M("ngModel",e.terapiaForm.area_especializacion),l(3),m("ngForOf",e.areasEspecializacion),l(4),M("ngModel",e.terapiaForm.nivel),l(),m("ngForOf",e.nivelesDisponibles),l(4),M("ngModel",e.terapiaForm.duracion_estimada),l(4),M("ngModel",e.terapiaForm.objetivo_principal),l(4),M("ngModel",e.terapiaForm.contraindicaciones),l(4),M("ngModel",e.terapiaForm.criterios_progresion),l(6),m("ngIf",e.terapiaForm.tags&&e.terapiaForm.tags.length>0),l(5),m("ngForOf",e.seccionesDisponibles),l(),m("ngForOf",e.Array.from(e.seccionesActivas)),l(3),m("disabled",e.loading),l(),m("ngIf",e.loading),l(),v(" ",e.modalMode==="create"?"Crear Terapia":"Guardar Cambios"," "),l(),m("disabled",e.loading)}}function aa(a,t){if(a&1){let e=C();n(0,"button",177),f("click",function(){u(e);let o=d();return g(o.openCreateModal())}),b(),n(1,"svg",178),p(2,"path",33),r()()}}function sa(a,t){a&1&&(n(0,"button",199),b(),n(1,"svg",191),p(2,"path",200),r()())}function la(a,t){a&1&&(n(0,"div",214)(1,"div",35),b(),n(2,"svg",215),p(3,"path",216),r(),y(),n(4,"div",38)(5,"p",217),s(6,"\xA1Terapia copiada al portapapeles!"),r()()()())}function ca(a,t){if(a&1){let e=C();n(0,"div")(1,"div",201)(2,"div",202)(3,"div",203),p(4,"div",204)(5,"div",205)(6,"div",206),r(),n(7,"div",207),s(8),r()(),n(9,"pre",208),s(10),r()(),x(11,la,7,0,"div",209),n(12,"div",210)(13,"button",211),f("click",function(){u(e);let o=d(2);return g(o.copyToClipboard())}),b(),n(14,"svg",32),p(15,"path",192),r(),s(16," Copiar "),r(),y(),n(17,"button",212),f("click",function(){u(e);let o=d(2);return g(o.exportarTerapia(o.selectedViewTerapia))}),b(),n(18,"svg",32),p(19,"path",213),r(),s(20," Descargar "),r()()()}if(a&2){let e=d(2);l(8),v(" ",e.getFileNameSafe(e.selectedViewTerapia.nombre),".txt "),l(2),w(e.getFormattedTerapia(e.selectedViewTerapia)),l(),m("ngIf",e.copySuccess)}}function da(a,t){if(a&1){let e=C();n(0,"div",179)(1,"div",180)(2,"div",86),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),r(),n(3,"div",181)(4,"div",182)(5,"div",89)(6,"div",183),b(),n(7,"svg",184),p(8,"path",185),r()(),y(),n(9,"div",186)(10,"h3",93),s(11),r(),n(12,"div",187)(13,"p",23),s(14," Vista previa de la terapia de rehabilitaci\xF3n "),r(),n(15,"div",188),x(16,sa,3,0,"button",189),n(17,"button",190),f("click",function(){u(e);let o=d();return g(o.copyToClipboard())}),b(),n(18,"svg",191),p(19,"path",192),r()()()()(),y(),n(20,"button",193),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),b(),n(21,"svg",194),p(22,"path",195),r()()()(),y(),n(23,"div",196),x(24,ca,21,3,"div",142),r(),n(25,"div",126)(26,"div",197)(27,"button",198),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),s(28," Cerrar "),r()()()()()()}if(a&2){let e=d();l(11),v(" ",(e.selectedViewTerapia==null?null:e.selectedViewTerapia.nombre)||"Detalles de la Terapia"," "),l(5),m("ngIf",e.copySuccess),l(8),m("ngIf",e.selectedViewTerapia)}}var ft=class a{constructor(t,e){this.terapiasService=t;this.authService=e}terapias=[];filteredTerapias=[];tiposEjercicios=[];loading=!1;error="";showModal=!1;showViewModal=!1;modalMode="create";selectedTerapia=null;selectedViewTerapia=null;copySuccess=!1;Array=Array;terapiaForm={nombre:"",descripcion:"",tipo:"fisica",area_especializacion:"",nivel:"principiante",duracion_estimada:60,objetivo_principal:"",contraindicaciones:"",criterios_progresion:"",tags:[],status:1,ejercicios:{}};seccionesDisponibles=[{key:"calentamiento",nombre:"Calentamiento",descripcion:"Ejercicios de preparaci\xF3n y movilizaci\xF3n"},{key:"fortalecimiento",nombre:"Fortalecimiento",descripcion:"Ejercicios de fortalecimiento muscular"},{key:"equilibrio",nombre:"Equilibrio",descripcion:"Ejercicios de equilibrio y propiocepci\xF3n"},{key:"coordinacion",nombre:"Coordinaci\xF3n",descripcion:"Ejercicios de coordinaci\xF3n motora"},{key:"estiramiento",nombre:"Estiramiento",descripcion:"Ejercicios de flexibilidad y relajaci\xF3n"},{key:"respiracion",nombre:"Respiraci\xF3n",descripcion:"Ejercicios respiratorios y relajaci\xF3n"}];searchTerm="";tipoFilter="all";areaFilter="all";nivelFilter="all";statusFilter="active";seccionesActivas=new Set;tiposDisponibles=[{value:"fisica",label:"Fisioterapia"},{value:"ocupacional",label:"Terapia Ocupacional"},{value:"respiratoria",label:"Respiratoria"},{value:"neurologica",label:"Neurol\xF3gica"},{value:"cardiaca",label:"Card\xEDaca"}];nivelesDisponibles=[{value:"principiante",label:"Principiante"},{value:"intermedio",label:"Intermedio"},{value:"avanzado",label:"Avanzado"}];areasEspecializacion=["hombro","codo","mu\xF1eca","cadera","rodilla","tobillo","columna_cervical","columna_lumbar","core","respiratoria","neurologica","cardiaca","pediatrica","geriatrica"];intensidadesDisponibles=[{value:"muy_baja",label:"Muy Baja"},{value:"baja",label:"Baja"},{value:"moderada",label:"Moderada"},{value:"alta",label:"Alta"},{value:"muy_alta",label:"Muy Alta"}];ngOnInit(){return h(this,null,function*(){yield this.loadTiposEjercicios(),yield this.loadTerapias()})}loadTiposEjercicios(){return h(this,null,function*(){try{this.tiposEjercicios=yield this.terapiasService.getTiposEjerciciosTerapeuticos()}catch(t){console.error("Error cargando tipos de ejercicios:",t),this.tiposEjercicios=[]}})}loadTerapias(){return h(this,null,function*(){try{this.loading=!0,this.terapias=yield this.terapiasService.getTerapias(),this.applyFilters()}catch(t){console.error("Error cargando terapias:",t),this.error="Error al cargar las terapias",this.terapias=[]}finally{this.loading=!1}})}applyFilters(){this.filteredTerapias=this.terapias.filter(t=>{let e=!this.searchTerm||t.nombre.toLowerCase().includes(this.searchTerm.toLowerCase())||t.descripcion?.toLowerCase().includes(this.searchTerm.toLowerCase())||t.area_especializacion?.toLowerCase().includes(this.searchTerm.toLowerCase()),i=this.tipoFilter==="all"||t.tipo===this.tipoFilter,o=this.areaFilter==="all"||t.area_especializacion===this.areaFilter,c=this.nivelFilter==="all"||t.nivel===this.nivelFilter,_=this.statusFilter==="all"||this.statusFilter==="active"&&t.status===1||this.statusFilter==="inactive"&&t.status===0;return e&&i&&o&&c&&_})}clearFilters(){this.searchTerm="",this.tipoFilter="all",this.areaFilter="all",this.nivelFilter="all",this.statusFilter="active",this.applyFilters()}getTipoLabel(t){let e=this.tiposDisponibles.find(i=>i.value===t);return e?e.label:t}getSeccionNombre(t){let e=this.seccionesDisponibles.find(i=>i.key===t);return e?e.nombre:t}getTipoEjercicioNombre(t){let e=this.tiposEjercicios.find(i=>i.nombre===t);return e?e.nombre:t}getIntensidadLabel(t){let e=this.intensidadesDisponibles.find(i=>i.value===t);return e?e.label:t}exportarTerapia(t){let e=this.getFormattedTerapia(t),i=new Blob([e],{type:"text/plain;charset=utf-8"}),o=window.URL.createObjectURL(i),c=document.createElement("a");c.href=o,c.download=`${this.getFileNameSafe(t.nombre)}.txt`,c.click(),window.URL.revokeObjectURL(o),console.log("Terapia exportada:",t.nombre)}openCreateModal(){this.modalMode="create",this.selectedTerapia=null,this.resetForm(),this.showModal=!0}openEditModal(t){this.modalMode="edit",this.selectedTerapia=t,this.terapiaForm=JSON.parse(JSON.stringify(t)),this.seccionesActivas.clear(),this.terapiaForm.ejercicios&&this.seccionesDisponibles.forEach(e=>{this.terapiaForm.ejercicios[e.key]&&this.seccionesActivas.add(e.key)}),this.error="",this.showModal=!0}openViewModal(t){console.log("Abriendo modal de vista para terapia:",t.nombre),this.selectedViewTerapia=t,this.showViewModal=!0}closeModal(){this.showModal=!1,this.selectedTerapia=null,this.error="",this.resetForm()}closeViewModal(){console.log("Cerrando modal de vista"),this.showViewModal=!1,this.selectedViewTerapia=null,this.copySuccess=!1}resetForm(){this.terapiaForm={nombre:"",descripcion:"",tipo:"fisica",area_especializacion:"",nivel:"principiante",duracion_estimada:60,objetivo_principal:"",contraindicaciones:"",criterios_progresion:"",tags:[],status:1,ejercicios:{}},this.seccionesActivas.clear()}toggleSeccion(t){this.seccionesActivas.has(t)?(this.seccionesActivas.delete(t),this.terapiaForm.ejercicios&&delete this.terapiaForm.ejercicios[t]):(this.seccionesActivas.add(t),this.terapiaForm.ejercicios||(this.terapiaForm.ejercicios={}),this.terapiaForm.ejercicios[t]||(this.terapiaForm.ejercicios[t]={descripcion:"",tiempo_total:"",objetivos:[],ejercicios:[]}))}getSeccionData(t){return!this.terapiaForm.ejercicios||!this.terapiaForm.ejercicios[t]?this.seccionesActivas.has(t)?(this.terapiaForm.ejercicios||(this.terapiaForm.ejercicios={}),this.terapiaForm.ejercicios[t]={descripcion:"",tiempo_total:"",objetivos:[],ejercicios:[]},this.terapiaForm.ejercicios[t]):null:this.terapiaForm.ejercicios[t]}updateSeccionData(t,e){this.terapiaForm.ejercicios||(this.terapiaForm.ejercicios={}),this.terapiaForm.ejercicios[t]=e}addEjercicio(t){let e=this.getSeccionData(t);if(!e)return;let i={orden:e.ejercicios.length+1,nombre:"",tipo:"movilidad",repeticiones:10,series:2,duracion:"2:00",descripcion:"",intensidad:"moderada",precauciones:""};e.ejercicios.push(i),this.updateSeccionData(t,e)}removeEjercicio(t,e){let i=this.getSeccionData(t);i&&(i.ejercicios.splice(e,1),i.ejercicios.forEach((o,c)=>{o.orden=c+1}),this.updateSeccionData(t,i))}moveEjercicio(t,e,i){let o=this.getSeccionData(t);if(!o||i<0||i>=o.ejercicios.length)return;let c=o.ejercicios.splice(e,1)[0];o.ejercicios.splice(i,0,c),o.ejercicios.forEach((_,S)=>{_.orden=S+1}),this.updateSeccionData(t,o)}saveTerapia(){return h(this,null,function*(){try{if(this.error="",this.loading=!0,!this.terapiaForm.nombre.trim()){this.error="El nombre es requerido";return}if(this.seccionesActivas.size===0){this.error="Debe activar al menos una secci\xF3n con ejercicios";return}let t=!1;for(let o of this.seccionesActivas){let c=this.getSeccionData(o);if(c&&c.ejercicios.length>0){t=!0;break}}if(!t){this.error="Debe agregar al menos un ejercicio en alguna secci\xF3n";return}let e=ge({},this.terapiaForm),i={};this.seccionesActivas.forEach(o=>{let c=this.getSeccionData(o);c&&c.ejercicios.length>0&&(i[o]=c)}),e.ejercicios=i,this.modalMode==="create"?yield this.terapiasService.createTerapia(e):yield this.terapiasService.updateTerapia(this.selectedTerapia.id,e),yield this.loadTerapias(),this.closeModal()}catch(t){console.error("Error guardando terapia:",t),this.error="Error al guardar la terapia. Intente nuevamente."}finally{this.loading=!1}})}deleteTerapia(t){return h(this,null,function*(){if(confirm(`\xBFEst\xE1 seguro de eliminar la terapia "${t.nombre}"?`))try{this.loading=!0,yield this.terapiasService.deleteTerapia(t.id),yield this.loadTerapias()}catch(e){console.error("Error eliminando terapia:",e),this.error="Error al eliminar la terapia"}finally{this.loading=!1}})}canEditTerapia(){return this.authService.isAdmin()||this.authService.hasProfile(3)}formatDuracion(t){if(!t)return"Sin especificar";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getAreasUnicas(){let t=new Set;return this.terapias.forEach(e=>{e.area_especializacion&&t.add(e.area_especializacion)}),Array.from(t).sort()}getFileNameSafe(t){return t?t.replace(/\s+/g,"_"):"terapia"}copyToClipboard(){return h(this,null,function*(){if(this.selectedViewTerapia)try{let t=this.getFormattedTerapia(this.selectedViewTerapia);yield navigator.clipboard.writeText(t),this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3)}catch(t){console.error("Error al copiar:",t);let e=document.createElement("textarea");e.value=this.getFormattedTerapia(this.selectedViewTerapia),document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy"),this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3)}catch(i){console.error("Error en fallback de copia:",i)}document.body.removeChild(e)}})}getFormattedTerapia(t){if(!t)return"";let e=`${t.nombre}
`;return e+=`${t.descripcion||"Terapia de rehabilitaci\xF3n"}
`,e+=`Nivel: ${t.nivel||"No especificado"} | Duraci\xF3n: ${this.formatDuracion(t.duracion_estimada)}

`,t.objetivo_principal&&(e+=`Objetivo: ${t.objetivo_principal}
`),t.area_especializacion&&(e+=`\xC1rea: ${t.area_especializacion}
`),e+=`
`,this.hasEjercicios(t)?this.getSeccionesConEjercicios(t).forEach(o=>{let c=t.ejercicios[o];if(c&&c.ejercicios&&c.ejercicios.length>0){let _=this.getNombreSeccion(o);e+=`${_.toUpperCase()}
`,c.descripcion&&(e+=`${c.descripcion}
`),c.ejercicios.forEach((S,P)=>{e+=`${P+1}. ${S?.nombre||"Ejercicio sin nombre"}
`,S?.descripcion&&(e+=`   ${S.descripcion}
`),S?.repeticiones&&S?.series&&(e+=`   ${S.series} series x ${S.repeticiones} repeticiones
`),S?.duracion&&(e+=`   Duraci\xF3n: ${S.duracion}
`),S?.precauciones&&(e+=`   \u26A0\uFE0F ${S.precauciones}
`),e+=`
`})}}):e+=`No se han definido ejercicios para esta terapia

`,t.contraindicaciones&&(e+=`CONTRAINDICACIONES
${t.contraindicaciones}

`),t.criterios_progresion&&(e+=`CRITERIOS DE PROGRESI\xD3N
${t.criterios_progresion}
`),e}getNombreSeccion(t){return{calentamiento:"Calentamiento",fortalecimiento:"Fortalecimiento",equilibrio:"Equilibrio",coordinacion:"Coordinaci\xF3n",estiramiento:"Estiramiento",respiracion:"Respiraci\xF3n"}[t]||t.charAt(0).toUpperCase()+t.slice(1)}hasEjercicios(t){return!t||!t.ejercicios?!1:Object.keys(t.ejercicios).some(e=>{let i=t.ejercicios[e];return i&&i.ejercicios&&Array.isArray(i.ejercicios)&&i.ejercicios.length>0})}getTotalEjercicios(t){if(!t||!t.ejercicios)return 0;let e=0;return Object.keys(t.ejercicios).forEach(i=>{let o=t.ejercicios[i];o&&o.ejercicios&&Array.isArray(o.ejercicios)&&(e+=o.ejercicios.length)}),e}getSeccionesConEjercicios(t){return!t||!t.ejercicios?[]:Object.keys(t.ejercicios).filter(e=>{let i=t.ejercicios[e];return i&&i.ejercicios&&Array.isArray(i.ejercicios)&&i.ejercicios.length>0})}addTag(t){let e=t.target.value.trim();e&&!this.terapiaForm.tags?.includes(e)&&(this.terapiaForm.tags||(this.terapiaForm.tags=[]),this.terapiaForm.tags.push(e),t.target.value="")}removeTag(t){this.terapiaForm.tags&&this.terapiaForm.tags.splice(t,1)}static \u0275fac=function(e){return new(e||a)(I(Ve),I(j))};static \u0275cmp=A({type:a,selectors:[["app-terapias"]],standalone:!1,decls:50,vars:17,consts:[[1,"container","mx-auto","px-4","py-6"],[1,"mb-6"],[1,"sm:flex","sm:items-center","sm:justify-between"],[1,"text-2xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-700"],[1,"mt-4","sm:mt-0"],["class","hidden md:inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],["class","mb-6 bg-red-50 border border-red-200 rounded-md p-4 fade-in",4,"ngIf"],[1,"mb-6","bg-white","shadow","rounded-lg","p-4"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-2","lg:grid-cols-5"],[1,"lg:col-span-2"],["for","search",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","search","placeholder","Nombre, descripci\xF3n o \xE1rea...",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","input","ngModel"],["for","tipo-filter",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","tipo-filter",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","change","ngModel"],["value","all"],[3,"value",4,"ngFor","ngForOf"],["for","area-filter",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","area-filter",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","change","ngModel"],["for","nivel-filter",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","nivel-filter",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","change","ngModel"],[1,"mt-4","flex","justify-between","items-center"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","action-btn",3,"click"],[1,"text-sm","text-gray-500"],[1,"bg-white","shadow","overflow-hidden","sm:rounded-md"],["class","p-8 text-center",4,"ngIf"],["class","divide-y divide-gray-200",4,"ngIf"],["class","text-center py-12 empty-state",4,"ngIf"],["class","modal-container modal-backdrop",4,"ngIf"],["class","md:hidden fixed bottom-6 right-6 w-14 h-14 bg-red-600 text-white rounded-full shadow-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 floating-action-btn btn-floating","title","Crear nueva terapia",3,"click",4,"ngIf"],["class","modal-view-container modal-backdrop",4,"ngIf"],[1,"hidden","md:inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"mb-6","bg-red-50","border","border-red-200","rounded-md","p-4","fade-in"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[3,"value"],[1,"p-8","text-center"],[1,"custom-spinner","mx-auto","mb-4"],[1,"divide-y","divide-gray-200"],["class","hover:bg-gray-50 transition-colors duration-150",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50","transition-colors","duration-150"],[1,"px-4","py-4","sm:px-6"],[1,"flex","items-center","justify-between"],[1,"flex-1","min-w-0"],[1,"flex","items-center","space-x-3"],[1,"flex-1"],[1,"text-lg","font-medium","text-gray-900","truncate"],["class","text-sm text-gray-500 mt-1",4,"ngIf"],[1,"mt-2","flex","items-center","space-x-4","text-sm","text-gray-500"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","tag",3,"ngClass"],["class","tag",4,"ngIf"],[1,"capitalize","tag"],[1,"tag"],["class","mt-2",4,"ngIf"],[1,"ml-4","flex-shrink-0","flex","items-center","space-x-2"],["title","Ver terapia",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50","transition-colors","duration-150","action-btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["class","text-indigo-600 hover:text-indigo-900 p-2 rounded-full hover:bg-indigo-50 transition-colors duration-150 action-btn","title","Editar terapia",3,"click",4,"ngIf"],["class","text-red-600 hover:text-red-900 p-2 rounded-full hover:bg-red-50 transition-colors duration-150 action-btn","title","Eliminar terapia",3,"click",4,"ngIf"],[1,"text-sm","text-gray-500","mt-1"],[1,"mt-2"],["class","inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded mr-1 tag",4,"ngFor","ngForOf"],[1,"inline-block","bg-gray-100","text-gray-800","text-xs","px-2","py-1","rounded","mr-1","tag"],["title","Editar terapia",1,"text-indigo-600","hover:text-indigo-900","p-2","rounded-full","hover:bg-indigo-50","transition-colors","duration-150","action-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Eliminar terapia",1,"text-red-600","hover:text-red-900","p-2","rounded-full","hover:bg-red-50","transition-colors","duration-150","action-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-center","py-12","empty-state"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 btn-primary",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 btn-secondary",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700","btn-primary",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","btn-secondary",3,"click"],[1,"modal-container","modal-backdrop"],[1,"flex","items-center","justify-start","min-h-screen"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],[1,"modal-panel","modal-enter","relative"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"modal-body"],[3,"ngSubmit"],[1,"space-y-6"],[1,"grid","grid-cols-1","gap-6","sm:grid-cols-2"],[1,"sm:col-span-2"],["for","nombre",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","nombre","name","nombre","required","","placeholder","Ej: Rehabilitaci\xF3n de hombro post-cirug\xEDa",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","ngModel"],["for","descripcion",1,"block","text-sm","font-medium","text-gray-700"],["id","descripcion","name","descripcion","rows","3","placeholder","Descripci\xF3n detallada de la terapia...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","ngModel"],["for","tipo",1,"block","text-sm","font-medium","text-gray-700"],["id","tipo","name","tipo","required","",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","ngModel"],["for","area_especializacion",1,"block","text-sm","font-medium","text-gray-700"],["id","area_especializacion","name","area_especializacion",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","ngModel"],["value",""],["for","nivel",1,"block","text-sm","font-medium","text-gray-700"],["id","nivel","name","nivel","required","",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","ngModel"],["for","duracion_estimada",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","duracion_estimada","name","duracion_estimada","min","1","max","300",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","ngModel"],["for","objetivo_principal",1,"block","text-sm","font-medium","text-gray-700"],["id","objetivo_principal","name","objetivo_principal","rows","2","placeholder","Objetivo principal de la terapia...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","ngModel"],["for","contraindicaciones",1,"block","text-sm","font-medium","text-gray-700"],["id","contraindicaciones","name","contraindicaciones","rows","2","placeholder","Contraindicaciones y precauciones...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","ngModel"],["for","criterios_progresion",1,"block","text-sm","font-medium","text-gray-700"],["id","criterios_progresion","name","criterios_progresion","rows","2","placeholder","Criterios para avanzar en la terapia...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","ngModel"],["for","tags",1,"block","text-sm","font-medium","text-gray-700"],[1,"mt-1"],["type","text","id","tags","placeholder","Presione Enter para agregar tags...",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"keydown.enter"],["class","mt-2 flex flex-wrap gap-2",4,"ngIf"],[1,"text-lg","font-medium","text-gray-900","mb-4"],[1,"grid","grid-cols-1","gap-4","sm:grid-cols-2","lg:grid-cols-3","mb-6"],["class","relative",4,"ngFor","ngForOf"],["class","bg-gray-50 rounded-lg p-4 mb-4 slide-up",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"flex","flex-col","sm:flex-row-reverse","gap-3"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed","btn-primary",3,"click","disabled"],["class","mr-2",4,"ngIf"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:mt-0","sm:w-auto","sm:text-sm","disabled:opacity-50","btn-secondary",3,"click","disabled"],[1,"mt-2","flex","flex-wrap","gap-2"],["class","inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 tag",4,"ngFor","ngForOf"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-800","tag"],["type","button",1,"flex-shrink-0","ml-1","h-4","w-4","rounded-full","inline-flex","items-center","justify-center","text-gray-400","hover:bg-gray-200","hover:text-gray-500","action-btn",3,"click"],["stroke","currentColor","fill","none","viewBox","0 0 8 8",1,"h-2","w-2"],["stroke-linecap","round","d","m1 1 6 6m0-6-6 6"],[1,"relative"],[1,"flex","items-start","cursor-pointer","hover:bg-gray-50","p-2","rounded","transition-colors"],["type","checkbox",1,"mt-1","h-4","w-4","text-red-600","focus:ring-red-500","border-gray-300","rounded","checkbox-seccion",3,"change","checked"],[1,"text-sm","font-medium","text-gray-900"],[1,"bg-gray-50","rounded-lg","p-4","mb-4","slide-up"],[4,"ngIf"],[1,"text-md","font-medium","text-gray-900","mb-3"],[1,"space-y-4"],[1,"block","text-sm","font-medium","text-gray-700"],["rows","2","placeholder","Descripci\xF3n de esta secci\xF3n...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","ngModel","name"],["type","text","placeholder","Ej: 15:00, 10-15 min",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm","form-input",3,"ngModelChange","ngModel","name"],[1,"flex","justify-between","items-center","mb-3"],["type","button",1,"inline-flex","items-center","px-2","py-1","border","border-transparent","text-xs","font-medium","rounded","text-red-700","bg-red-100","hover:bg-red-200","action-btn","transition-all",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-3","w-3","mr-1"],["class","space-y-3",4,"ngIf"],["class","text-center py-4 bg-gray-100 rounded-lg empty-state",4,"ngIf"],[1,"space-y-3"],["class","bg-white border border-gray-200 rounded-lg p-3 fade-in",4,"ngFor","ngForOf"],[1,"bg-white","border","border-gray-200","rounded-lg","p-3","fade-in"],[1,"flex","justify-between","items-start","mb-3"],[1,"text-sm","font-medium","text-gray-500"],[1,"flex","space-x-1"],["type","button","title","Mover arriba",1,"text-gray-400","hover:text-gray-600","disabled:opacity-30","action-btn",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 15l7-7 7 7"],["type","button","title","Mover abajo",1,"text-gray-400","hover:text-gray-600","disabled:opacity-30","action-btn",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["type","button","title","Eliminar ejercicio",1,"text-red-400","hover:text-red-600","action-btn",3,"click"],[1,"grid","grid-cols-1","gap-3","sm:grid-cols-2"],[1,"block","text-xs","font-medium","text-gray-700"],["type","text","required","","placeholder","Nombre del ejercicio",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm","form-input",3,"ngModelChange","ngModel","name"],[1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm","form-input",3,"ngModelChange","ngModel","name"],["type","number","min","1",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm","form-input",3,"ngModelChange","ngModel","name"],["type","text","placeholder","Ej: 2:00, 30 seg",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm","form-input",3,"ngModelChange","ngModel","name"],["rows","2","placeholder","Descripci\xF3n del ejercicio...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm","form-input",3,"ngModelChange","ngModel","name"],["rows","2","placeholder","Precauciones espec\xEDficas...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm","form-input",3,"ngModelChange","ngModel","name"],[1,"text-center","py-4","bg-gray-100","rounded-lg","empty-state"],["type","button",1,"mt-2","text-red-600","hover:text-red-800","text-sm","font-medium","action-btn",3,"click"],[1,"mr-2"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-white"],["title","Crear nueva terapia",1,"md:hidden","fixed","bottom-6","right-6","w-14","h-14","bg-red-600","text-white","rounded-full","shadow-lg","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-500","focus:ring-offset-2","transition-all","duration-200","floating-action-btn","btn-floating",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","mx-auto"],[1,"modal-view-container","modal-backdrop"],[1,"flex","items-center","justify-end","min-h-screen"],[1,"modal-view-panel","modal-view-enter","relative"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4","border-b","border-gray-200"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","flex-1"],[1,"mt-1","flex","items-center","justify-between"],[1,"flex","items-center","space-x-2"],["class","text-green-500","title","\xA1Copiado!",4,"ngIf"],["title","Copiar terapia",1,"text-gray-400","hover:text-gray-600","action-btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],["type","button",1,"ml-auto","-mt-2","-mr-2","p-2","rounded-full","text-gray-400","hover:text-gray-600","hover:bg-gray-100","focus:outline-none","focus:ring-2","focus:ring-gray-500","action-btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"modal-body","bg-gray-50"],[1,"flex","flex-col","sm:flex-row","gap-3","justify-end"],["type","button",1,"inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:text-sm","btn-secondary",3,"click"],["title","\xA1Copiado!",1,"text-green-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"bg-gray-900","text-green-400","rounded-lg","p-6","font-mono","text-sm","overflow-auto","max-h-96","relative",2,"font-family","'Courier New', monospace","line-height","1.6"],[1,"flex","items-center","justify-between","mb-4","pb-2","border-b","border-gray-700"],[1,"flex","space-x-2"],[1,"w-3","h-3","bg-red-500","rounded-full"],[1,"w-3","h-3","bg-yellow-500","rounded-full"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-gray-400","text-xs"],[1,"whitespace-pre-wrap","text-white"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3 fade-in",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","action-btn",3,"click"],[1,"inline-flex","items-center","px-3","py-2","border","border-transparent","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","action-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3","fade-in"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-green-700"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),s(5,"Gesti\xF3n de Terapias"),r(),n(6,"p",4),s(7," Administra las terapias de rehabilitaci\xF3n disponibles en el sistema. "),r()(),n(8,"div",5),x(9,ko,4,0,"button",6),r()()(),x(10,To,7,1,"div",7),n(11,"div",8)(12,"div",9)(13,"div",10)(14,"label",11),s(15,"Buscar"),r(),n(16,"input",12),k("ngModelChange",function(c){return E(i.searchTerm,c)||(i.searchTerm=c),c}),f("input",function(){return i.applyFilters()}),r()(),n(17,"div")(18,"label",13),s(19,"Tipo"),r(),n(20,"select",14),k("ngModelChange",function(c){return E(i.tipoFilter,c)||(i.tipoFilter=c),c}),f("change",function(){return i.applyFilters()}),n(21,"option",15),s(22,"Todos los tipos"),r(),x(23,Po,2,2,"option",16),r()(),n(24,"div")(25,"label",17),s(26,"\xC1rea"),r(),n(27,"select",18),k("ngModelChange",function(c){return E(i.areaFilter,c)||(i.areaFilter=c),c}),f("change",function(){return i.applyFilters()}),n(28,"option",15),s(29,"Todas las \xE1reas"),r(),x(30,Io,3,4,"option",16),r()(),n(31,"div")(32,"label",19),s(33,"Nivel"),r(),n(34,"select",20),k("ngModelChange",function(c){return E(i.nivelFilter,c)||(i.nivelFilter=c),c}),f("change",function(){return i.applyFilters()}),n(35,"option",15),s(36,"Todos los niveles"),r(),x(37,Oo,2,2,"option",16),r()()(),n(38,"div",21)(39,"button",22),f("click",function(){return i.clearFilters()}),s(40," Limpiar filtros "),r(),n(41,"span",23),s(42),r()()(),n(43,"div",24),x(44,Vo,4,0,"div",25)(45,zo,2,1,"ul",26)(46,qo,10,3,"div",27),r()(),x(47,oa,79,21,"div",28)(48,aa,3,0,"button",29)(49,da,29,3,"div",30)),e&2&&(l(9),m("ngIf",i.canEditTerapia()),l(),m("ngIf",i.error),l(6),M("ngModel",i.searchTerm),l(4),M("ngModel",i.tipoFilter),l(3),m("ngForOf",i.tiposDisponibles),l(4),M("ngModel",i.areaFilter),l(3),m("ngForOf",i.getAreasUnicas()),l(4),M("ngModel",i.nivelFilter),l(3),m("ngForOf",i.nivelesDisponibles),l(5),z(" ",i.filteredTerapias.length," de ",i.terapias.length," terapias "),l(2),m("ngIf",i.loading),l(),m("ngIf",!i.loading&&i.filteredTerapias.length>0),l(),m("ngIf",!i.loading&&i.filteredTerapias.length===0),l(),m("ngIf",i.showModal),l(),m("ngIf",!i.showModal&&!i.showViewModal&&i.canEditTerapia()),l(),m("ngIf",i.showViewModal))},dependencies:[$,N,R,ee,J,Z,q,Pe,Q,W,K,ye,Oe,Ie,G,de,Te],styles:['.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.slide-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.rutina-card[_ngcontent-%COMP%]{transition:all .3s ease}.rutina-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}.btn-floating[_ngcontent-%COMP%]{box-shadow:0 4px 20px #ef444466;transition:all .3s ease}.btn-floating[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 6px 25px #ef444499}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);background-color:#0009;z-index:9998}.modal-container[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;overflow-y:auto;padding:1rem}.modal-panel[_ngcontent-%COMP%]{margin-left:280px;max-width:calc(100vw - 320px);width:100%;background:#fff;border-radius:.5rem;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;transform:translateY(20px);transition:all .3s ease}@media (min-width: 768px){.sidebar-collapsed[_ngcontent-%COMP%]   .modal-panel[_ngcontent-%COMP%]{margin-left:80px;max-width:calc(100vw - 120px)}}.modal-view-container[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;overflow-y:auto;padding:1rem 2rem 1rem 1rem;display:flex;align-items:center;justify-content:flex-end}.modal-view-panel[_ngcontent-%COMP%]{margin-left:300px;max-width:900px;width:100%;background:#fff;border-radius:.5rem;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;max-height:90vh;overflow-y:auto;transform:translate(20px);transition:all .3s ease}@media (max-width: 767px){.modal-panel[_ngcontent-%COMP%], .modal-view-panel[_ngcontent-%COMP%]{margin-left:0;max-width:calc(100vw - 2rem);margin:1rem}.modal-container[_ngcontent-%COMP%], .modal-view-container[_ngcontent-%COMP%]{padding:.5rem}.modal-view-container[_ngcontent-%COMP%]{justify-content:center;padding-right:.5rem}}@media (max-width: 1024px) and (min-width: 768px){.modal-panel[_ngcontent-%COMP%]{margin-left:240px;max-width:calc(100vw - 280px)}.modal-view-panel[_ngcontent-%COMP%]{margin-left:260px;max-width:calc(100vw - 300px)}}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar, .modal-view-panel[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-track, .modal-view-panel[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .modal-view-panel[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#dc2626;border-radius:10px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .modal-view-panel[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#b91c1c}.tag[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tagAppear .2s ease-out}@keyframes _ngcontent-%COMP%_tagAppear{0%{transform:scale(.8);opacity:0}to{transform:scale(1);opacity:1}}.custom-spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #dc2626;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.form-input[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 3px #ef44441a;border-color:#dc2626}.rutinas-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}@media (max-width: 640px){.rutinas-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.checkbox-seccion[_ngcontent-%COMP%]{transform:scale(1.2);transition:transform .2s ease}.checkbox-seccion[_ngcontent-%COMP%]:checked{transform:scale(1.3)}.empty-state[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .5s ease-out}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.gradient-red[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc2626,#b91c1c)}.gradient-gray[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563)}.badge-status[_ngcontent-%COMP%]{position:relative;overflow:hidden}.badge-status[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.badge-status[_ngcontent-%COMP%]:hover:before{left:100%}.action-btn[_ngcontent-%COMP%]{position:relative;overflow:hidden;transition:all .3s ease}.action-btn[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;background-color:#fff3;border-radius:50%;transform:translate(-50%,-50%);transition:width .6s,height .6s}.action-btn[_ngcontent-%COMP%]:hover:before{width:300px;height:300px}.tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip[_ngcontent-%COMP%]   .tooltiptext[_ngcontent-%COMP%]{visibility:hidden;width:120px;background-color:#374151;color:#fff;text-align:center;border-radius:6px;padding:5px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-60px;opacity:0;transition:opacity .3s;font-size:12px}.tooltip[_ngcontent-%COMP%]:hover   .tooltiptext[_ngcontent-%COMP%]{visibility:visible;opacity:1}.floating-action-btn[_ngcontent-%COMP%]{z-index:9997}.main-content.sidebar-expanded[_ngcontent-%COMP%]   .modal-panel[_ngcontent-%COMP%]{margin-left:280px;max-width:calc(100vw - 320px)}.main-content.sidebar-collapsed[_ngcontent-%COMP%]   .modal-panel[_ngcontent-%COMP%]{margin-left:80px;max-width:calc(100vw - 120px)}.main-content.sidebar-expanded[_ngcontent-%COMP%]   .modal-view-panel[_ngcontent-%COMP%]{margin-left:300px;max-width:calc(100vw - 340px)}.main-content.sidebar-collapsed[_ngcontent-%COMP%]   .modal-view-panel[_ngcontent-%COMP%]{margin-left:100px;max-width:calc(100vw - 140px)}.modal-enter[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(30px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-view-enter[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalSlideInRight .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideInRight{0%{opacity:0;transform:translate(30px) scale(.95)}to{opacity:1;transform:translate(0) scale(1)}}@media (max-width: 768px){.modal-content[_ngcontent-%COMP%]{max-height:90vh}.grid-responsive[_ngcontent-%COMP%]{grid-template-columns:1fr}.text-responsive[_ngcontent-%COMP%]{font-size:.875rem}}@media (prefers-color-scheme: dark){.card-dark[_ngcontent-%COMP%]{background-color:#1f2937;border-color:#374151}.text-dark[_ngcontent-%COMP%]{color:#f9fafb}}@media print{.no-print[_ngcontent-%COMP%]{display:none!important}.print-only[_ngcontent-%COMP%]{display:block!important}}.focus-visible[_ngcontent-%COMP%]:focus{outline:2px solid #dc2626;outline-offset:2px}@media (prefers-contrast: high){.btn-primary[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]{border:2px solid #000}}.modal-body[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto;padding:1rem}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb;background-color:#f9fafb;padding:1rem;border-radius:0 0 .5rem .5rem}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#b91c1c;transform:translateY(-1px);box-shadow:0 4px 12px #b91c1c66}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}']})};var ma=(a,t,e,i)=>({"bg-green-100 text-green-800":a,"bg-blue-100 text-blue-800":t,"bg-yellow-100 text-yellow-800":e,"bg-red-100 text-red-800":i}),pa=(a,t,e,i,o)=>({"bg-gray-100 text-gray-800":a,"bg-yellow-100 text-yellow-800":t,"bg-green-100 text-green-800":e,"bg-red-100 text-red-800":i,"bg-purple-100 text-purple-800":o});function ua(a,t){if(a&1){let e=C();n(0,"button",32),f("click",function(){u(e);let o=d();return g(o.openAsignarModal())}),b(),n(1,"svg",33),p(2,"path",34),r(),s(3," Asignar Terapia "),r()}}function ga(a,t){if(a&1&&(n(0,"div",35)(1,"div",36),b(),n(2,"svg",37),p(3,"path",38),r(),y(),n(4,"div",39)(5,"p",40),s(6),r()()()()),a&2){let e=d();l(6),w(e.error)}}function fa(a,t){a&1&&(n(0,"div",41),p(1,"div",42),r())}function _a(a,t){if(a&1&&(n(0,"div",75),s(1),r()),a&2){let e=d().$implicit;l(),v(" ",e.area_especializacion," ")}}function xa(a,t){if(a&1&&(n(0,"div",62),s(1),r()),a&2){let e=d().$implicit;l(),v(" ",e.terapeuta_nombre," ")}}function va(a,t){if(a&1){let e=C();n(0,"button",76),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.cancelarAsignacion(o.asignacion_id))}),b(),n(1,"svg",71),p(2,"path",77),r()()}}function ba(a,t){if(a&1){let e=C();n(0,"tr",53)(1,"td",54)(2,"div")(3,"div",55),s(4),r(),n(5,"div",56),s(6),ce(7,"titlecase"),r(),x(8,_a,2,1,"div",57),r()(),n(9,"td",54)(10,"div",58),b(),n(11,"svg",59),p(12,"path",60),r(),y(),n(13,"span",55),s(14),r(),n(15,"span",61),s(16,"usuarios"),r()(),n(17,"div",62),s(18),ce(19,"titlecase"),r()(),n(20,"td",63)(21,"div"),s(22),r(),n(23,"div",64),s(24),r()(),n(25,"td",63)(26,"div"),s(27),r(),n(28,"div",64),s(29),r(),x(30,xa,2,1,"div",65),r(),n(31,"td",54)(32,"span",66),p(33,"i"),s(34),r()(),n(35,"td",54)(36,"div",67),s(37),r(),n(38,"div",56),s(39),r()(),n(40,"td",68)(41,"div",69)(42,"button",70),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.openVerModal(o))}),b(),n(43,"svg",71),p(44,"path",72)(45,"path",73),r()(),x(46,va,3,0,"button",74),r()()()}if(a&2){let e=t.$implicit,i=d(2);l(4),w(e.terapia_nombre),l(2),w(pe(7,17,e.terapia_tipo)),l(2),m("ngIf",e.area_especializacion),l(6),w(e.usuarios_count),l(4),v(" ",pe(19,19,e.tipo_asignacion)," "),l(4),w(i.formatDate(e.fecha_inicio_programada)),l(2),w(i.formatDate(e.fecha_fin_programada)),l(3),v("",e.sesiones_por_semana,"/semana"),l(2),v("",i.formatDuracion(e.duracion_sesion),"/sesi\xF3n"),l(),m("ngIf",e.terapeuta_nombre),l(2),m("ngClass",ve(21,ma,e.estado_asignacion==="activa",e.estado_asignacion==="completada",e.estado_asignacion==="pausada",e.estado_asignacion==="cancelada")),l(),D(i.getEstadoIcon(e.estado_asignacion)+" mr-1"),l(),v(" ",e.estado_asignacion," "),l(3),w(e.asignado_por_nombre),l(2),w(i.formatDate(e.fecha_asignacion)),l(7),m("ngIf",e.estado_asignacion==="activa"&&i.canAssignTerapias())}}function ha(a,t){a&1&&(fe(0),s(1," No se han creado asignaciones a\xFAn. "),_e())}function Ca(a,t){a&1&&s(0," No se encontraron asignaciones con los filtros aplicados. ")}function wa(a,t){if(a&1){let e=C();n(0,"button",87),f("click",function(){u(e);let o=d(3);return g(o.openAsignarModal())}),s(1," Crear primera asignaci\xF3n "),r()}}function ya(a,t){if(a&1){let e=C();n(0,"button",88),f("click",function(){u(e);let o=d(3);return g(o.clearFilters())}),s(1," Limpiar filtros "),r()}}function Sa(a,t){if(a&1&&(n(0,"div",78),b(),n(1,"svg",79),p(2,"path",80),r(),y(),n(3,"h3",81),s(4,"No hay asignaciones"),r(),n(5,"p",82),x(6,ha,2,0,"ng-container",83)(7,Ca,1,0,"ng-template",null,0,oe),r(),n(9,"div",84),x(10,wa,2,0,"button",85)(11,ya,2,0,"button",86),r()()),a&2){let e=X(8),i=d(2);l(6),m("ngIf",i.asignaciones.length===0)("ngIfElse",e),l(4),m("ngIf",i.asignaciones.length===0&&i.canAssignTerapias()),l(),m("ngIf",i.asignaciones.length>0)}}function Ma(a,t){if(a&1&&(n(0,"div",43)(1,"div",44)(2,"h3",45),s(3),r()(),n(4,"div",46)(5,"table",47)(6,"thead",48)(7,"tr")(8,"th",49),s(9," Terapia "),r(),n(10,"th",49),s(11," Usuarios "),r(),n(12,"th",49),s(13," Fechas "),r(),n(14,"th",49),s(15," Configuraci\xF3n "),r(),n(16,"th",49),s(17," Estado "),r(),n(18,"th",49),s(19," Asignado por "),r(),n(20,"th",49),s(21," Acciones "),r()()(),n(22,"tbody",50),x(23,ba,47,26,"tr",51),r()(),x(24,Sa,12,4,"div",52),r()()),a&2){let e=d();l(3),v(" Asignaciones Realizadas (",e.filteredAsignaciones.length,") "),l(20),m("ngForOf",e.filteredAsignaciones)("ngForTrackBy",e.trackByAsignacionId),l(),m("ngIf",e.filteredAsignaciones.length===0)}}function Ea(a,t){if(a&1&&(n(0,"option",109),s(1),ce(2,"titlecase"),r()),a&2){let e=t.$implicit;m("value",e.id),l(),Re(" ",e.nombre," - ",pe(2,4,e.tipo)," (",e.nivel,") ")}}function ka(a,t){if(a&1&&(n(0,"option",109),s(1),r()),a&2){let e=t.$implicit;m("value",e.id),l(),v(" ",e.full_name," ")}}function Ta(a,t){if(a&1){let e=C();n(0,"div")(1,"label",15),s(2," Objetivos Grupales "),r(),n(3,"textarea",129),k("ngModelChange",function(o){u(e);let c=d(2);return E(c.asignacionForm.objetivos_grupales,o)||(c.asignacionForm.objetivos_grupales=o),g(o)}),r()()}if(a&2){let e=d(2);l(3),M("ngModel",e.asignacionForm.objetivos_grupales)}}function Pa(a,t){if(a&1){let e=C();n(0,"label",130)(1,"input",131),f("change",function(){let o=u(e).$implicit,c=d(2);return g(c.toggleUsuario(o.id))}),r(),n(2,"div",132)(3,"div",55),s(4),r(),n(5,"div",133),s(6),r()()()}if(a&2){let e=t.$implicit,i=d(2);O("bg-red-50",i.isUsuarioSelected(e.id)),l(),m("checked",i.isUsuarioSelected(e.id)),l(3),w(e.full_name),l(2),v("@",e.username,"")}}function Ia(a,t){a&1&&(n(0,"span"),s(1," usuario seleccionado"),r())}function Oa(a,t){a&1&&s(0," usuarios seleccionados")}function Va(a,t){if(a&1&&(n(0,"div",134)(1,"div",36),b(),n(2,"svg",37),p(3,"path",38),r(),y(),n(4,"div",39)(5,"p",40),s(6),r()()()()),a&2){let e=d(2);l(6),w(e.error)}}function Fa(a,t){a&1&&(b(),n(0,"svg",135),p(1,"path",10),r())}function Da(a,t){if(a&1){let e=C();n(0,"div",89)(1,"div",90)(2,"div",91),f("click",function(){u(e);let o=d();return g(o.closeAsignarModal())}),r(),n(3,"span",92),s(4,"\u200B"),r(),n(5,"div",93)(6,"div",94)(7,"div",95)(8,"div",96),b(),n(9,"svg",97),p(10,"path",80),r()(),y(),n(11,"div",98)(12,"h3",45),s(13," Asignar Terapia a Usuarios "),r(),n(14,"div",99)(15,"p",56),s(16," Selecciona una terapia y los usuarios a los que deseas asignarla. "),r()()()()(),n(17,"div",100)(18,"form",101)(19,"div")(20,"label",15),s(21," Terapia "),n(22,"span",102),s(23,"*"),r()(),n(24,"select",103),k("ngModelChange",function(o){u(e);let c=d();return E(c.asignacionForm.id_terapia,o)||(c.asignacionForm.id_terapia=o),g(o)}),n(25,"option",104),s(26,"Selecciona una terapia"),r(),x(27,Ea,3,6,"option",105),r()(),n(28,"div",106)(29,"div")(30,"label",15),s(31," Tipo de Asignaci\xF3n "),r(),n(32,"select",107),k("ngModelChange",function(o){u(e);let c=d();return E(c.asignacionForm.tipo_asignacion,o)||(c.asignacionForm.tipo_asignacion=o),g(o)}),n(33,"option",23),s(34,"Individual"),r(),n(35,"option",24),s(36,"Grupal"),r()()(),n(37,"div")(38,"label",15),s(39," Terapeuta Responsable "),r(),n(40,"select",108),k("ngModelChange",function(o){u(e);let c=d();return E(c.asignacionForm.terapeuta_responsable,o)||(c.asignacionForm.terapeuta_responsable=o),g(o)}),n(41,"option",109),s(42,"Sin asignar"),r(),x(43,ka,2,2,"option",110),r()()(),n(44,"div",106)(45,"div")(46,"label",15),s(47," Fecha de Inicio "),n(48,"span",102),s(49,"*"),r()(),n(50,"input",111),k("ngModelChange",function(o){u(e);let c=d();return E(c.asignacionForm.fecha_inicio,o)||(c.asignacionForm.fecha_inicio=o),g(o)}),r()(),n(51,"div")(52,"label",15),s(53," Fecha de Fin "),n(54,"span",102),s(55,"*"),r()(),n(56,"input",112),k("ngModelChange",function(o){u(e);let c=d();return E(c.asignacionForm.fecha_fin,o)||(c.asignacionForm.fecha_fin=o),g(o)}),r()()(),n(57,"div",106)(58,"div")(59,"label",15),s(60," Sesiones por Semana "),r(),n(61,"input",113),k("ngModelChange",function(o){u(e);let c=d();return E(c.asignacionForm.sesiones_por_semana,o)||(c.asignacionForm.sesiones_por_semana=o),g(o)}),r()(),n(62,"div")(63,"label",15),s(64," Duraci\xF3n por Sesi\xF3n (minutos) "),r(),n(65,"input",114),k("ngModelChange",function(o){u(e);let c=d();return E(c.asignacionForm.duracion_sesion,o)||(c.asignacionForm.duracion_sesion=o),g(o)}),r()()(),n(66,"div")(67,"label",15),s(68," Notas (Opcional) "),r(),n(69,"textarea",115),k("ngModelChange",function(o){u(e);let c=d();return E(c.asignacionForm.notas,o)||(c.asignacionForm.notas=o),g(o)}),r()(),x(70,Ta,4,1,"div",116),n(71,"div")(72,"div",117)(73,"label",118),s(74," Usuarios "),n(75,"span",102),s(76,"*"),r()(),n(77,"div",7)(78,"button",119),f("click",function(){u(e);let o=d();return g(o.selectAllUsuarios())}),s(79," Seleccionar todos "),r(),n(80,"button",120),f("click",function(){u(e);let o=d();return g(o.clearAllUsuarios())}),s(81," Limpiar selecci\xF3n "),r()()(),n(82,"div",121)(83,"div",122),x(84,Pa,7,5,"label",123),r()(),n(85,"div",6)(86,"span"),s(87),r(),x(88,Ia,2,0,"span",83)(89,Oa,1,0,"ng-template",null,1,oe),r()()(),x(91,Va,7,1,"div",124),r(),n(92,"div",125)(93,"button",126),f("click",function(){u(e);let o=d();return g(o.asignarTerapia())}),x(94,Fa,2,0,"svg",127),s(95," Asignar Terapia "),r(),n(96,"button",128),f("click",function(){u(e);let o=d();return g(o.closeAsignarModal())}),s(97," Cancelar "),r()()()()()}if(a&2){let e=X(90),i=d();l(24),M("ngModel",i.asignacionForm.id_terapia),l(3),m("ngForOf",i.terapias)("ngForTrackBy",i.trackByTerapiaId),l(5),M("ngModel",i.asignacionForm.tipo_asignacion),l(8),M("ngModel",i.asignacionForm.terapeuta_responsable),l(),m("value",void 0),l(2),m("ngForOf",i.terapeutas),l(7),M("ngModel",i.asignacionForm.fecha_inicio),l(6),M("ngModel",i.asignacionForm.fecha_fin),l(5),M("ngModel",i.asignacionForm.sesiones_por_semana),l(4),M("ngModel",i.asignacionForm.duracion_sesion),l(4),M("ngModel",i.asignacionForm.notas),l(),m("ngIf",i.asignacionForm.tipo_asignacion==="grupal"),l(14),m("ngForOf",i.usuarios)("ngForTrackBy",i.trackByUserId),l(3),w(i.asignacionForm.usuarios_seleccionados.length),l(),m("ngIf",i.asignacionForm.usuarios_seleccionados.length===1)("ngIfElse",e),l(3),m("ngIf",i.error),l(2),m("disabled",i.loading||!i.asignacionForm.id_terapia||i.asignacionForm.usuarios_seleccionados.length===0),l(),m("ngIf",i.loading),l(2),m("disabled",i.loading)}}function Aa(a,t){if(a&1&&(n(0,"div",133),s(1),r()),a&2){let e=d(2);l(),v(" Terapeuta: ",e.selectedAsignacion==null?null:e.selectedAsignacion.terapeuta_nombre," ")}}function Ra(a,t){if(a&1){let e=C();n(0,"div",99)(1,"input",160),f("input",function(o){u(e);let c=d().$implicit,_=d(2);return g(_.actualizarProgreso(c.seguimiento_id,o))}),r()()}if(a&2){let e=d().$implicit;l(),m("value",e.progreso)}}function ja(a,t){if(a&1&&(n(0,"div")(1,"strong"),s(2,"Inicio:"),r(),s(3),r()),a&2){let e=d().$implicit,i=d(2);l(3),v(" ",i.formatDate(e.fecha_inicio_real)," ")}}function Ua(a,t){if(a&1&&(n(0,"div")(1,"strong"),s(2,"Fin:"),r(),s(3),r()),a&2){let e=d().$implicit,i=d(2);l(3),v(" ",i.formatDate(e.fecha_fin_real)," ")}}function La(a,t){a&1&&(n(0,"div",64),s(1," Sin fechas registradas "),r())}function Na(a,t){if(a&1){let e=C();n(0,"button",161),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.editarNotasIndividuales(o))}),b(),n(1,"svg",71),p(2,"path",162),r()()}}function za(a,t){if(a&1&&(n(0,"tr",53)(1,"td",54)(2,"div",58)(3,"div",149)(4,"span",150),s(5),r()(),n(6,"div")(7,"div",55),s(8),r(),n(9,"div",56),s(10),r()()()(),n(11,"td",54)(12,"div",58)(13,"div",151),p(14,"div",152),r(),n(15,"span",55),s(16),r()(),x(17,Ra,2,1,"div",153),r(),n(18,"td",54)(19,"span",66),s(20),r()(),n(21,"td",63)(22,"div"),s(23),r(),n(24,"div",133),s(25),r()(),n(26,"td",54)(27,"div",58)(28,"div",154),p(29,"div",155),r(),n(30,"span",55),s(31),r()()(),n(32,"td",63),x(33,ja,4,1,"div",116)(34,Ua,4,1,"div",116)(35,La,2,0,"div",156),r(),n(36,"td",157)(37,"div",158),s(38),r()(),n(39,"td",68)(40,"div",69),x(41,Na,3,0,"button",159),r()()()),a&2){let e=t.$implicit,i=d(2);l(5),v(" ",(e.full_name||"U").charAt(0).toUpperCase()," "),l(3),w(e.full_name),l(2),v("@",e.username,""),l(4),Y("width",e.progreso,"%"),l(2),v("",e.progreso,"%"),l(),m("ngIf",i.canAssignTerapias()),l(2),m("ngClass",je(20,pa,e.estado_individual==="pendiente",e.estado_individual==="en_progreso",e.estado_individual==="completada",e.estado_individual==="cancelada"||e.estado_individual==="abandonada",e.estado_individual==="pausada")),l(),v(" ",e.estado_individual," "),l(3),z("",e.sesiones_completadas||0," / ",e.sesiones_programadas||0,""),l(2),v(" ",e.sesiones_programadas>0?i.Math.round((e.sesiones_completadas||0)/e.sesiones_programadas*100):0,"% completado "),l(4),Y("width",e.adherencia_porcentaje||0,"%"),l(2),v("",e.adherencia_porcentaje||0,"%"),l(2),m("ngIf",e.fecha_inicio_real),l(),m("ngIf",e.fecha_fin_real),l(),m("ngIf",!e.fecha_inicio_real&&!e.fecha_fin_real),l(3),v(" ",e.notas_individuales||"-"," "),l(3),m("ngIf",i.canAssignTerapias())}}function Ba(a,t){a&1&&(n(0,"div",163),b(),n(1,"svg",164),p(2,"path",165),r(),y(),n(3,"h3",81),s(4,"Sin seguimiento disponible"),r(),n(5,"p",82),s(6," No se encontraron datos de seguimiento para esta asignaci\xF3n. "),r()())}function $a(a,t){if(a&1&&(n(0,"div",166)(1,"h4",167),s(2,"Resumen del Progreso"),r(),n(3,"div",168)(4,"div")(5,"div",169),s(6),r(),n(7,"div",133),s(8,"Pendientes"),r()(),n(9,"div")(10,"div",170),s(11),r(),n(12,"div",133),s(13,"En Progreso"),r()(),n(14,"div")(15,"div",171),s(16),r(),n(17,"div",133),s(18,"Completadas"),r()(),n(19,"div")(20,"div",172),s(21),r(),n(22,"div",133),s(23,"Progreso Promedio"),r()(),n(24,"div")(25,"div",173),s(26),r(),n(27,"div",133),s(28,"Adherencia Promedio"),r()()()()),a&2){let e=d(2);l(6),v(" ",e.getEstadisticasProgreso().pendientes," "),l(5),v(" ",e.getEstadisticasProgreso().enProgreso," "),l(5),v(" ",e.getEstadisticasProgreso().completadas," "),l(5),v(" ",e.getEstadisticasProgreso().promedioProgreso,"% "),l(5),v(" ",e.getEstadisticasProgreso().promedioAdherencia,"% ")}}function qa(a,t){if(a&1){let e=C();n(0,"div",89)(1,"div",90)(2,"div",91),f("click",function(){u(e);let o=d();return g(o.closeVerModal())}),r(),n(3,"span",92),s(4,"\u200B"),r(),n(5,"div",136)(6,"div",94)(7,"div",95)(8,"div",137),b(),n(9,"svg",138),p(10,"path",139),r()(),y(),n(11,"div",98)(12,"h3",45),s(13),r(),n(14,"div",99)(15,"p",56),s(16," Progreso individual de cada usuario asignado "),r()()()()(),n(17,"div",140)(18,"div",141)(19,"div",142)(20,"div")(21,"span",143),s(22,"Per\xEDodo:"),r(),n(23,"div",144),s(24),r()(),n(25,"div")(26,"span",143),s(27,"Total usuarios:"),r(),n(28,"div",144),s(29),r()(),n(30,"div")(31,"span",143),s(32,"Configuraci\xF3n:"),r(),n(33,"div",144),s(34),r()(),n(35,"div")(36,"span",143),s(37,"Asignado por:"),r(),n(38,"div",144),s(39),r(),x(40,Aa,2,1,"div",145),r()()(),n(41,"div",46)(42,"table",47)(43,"thead",48)(44,"tr")(45,"th",49),s(46," Usuario "),r(),n(47,"th",49),s(48," Progreso "),r(),n(49,"th",49),s(50," Estado "),r(),n(51,"th",49),s(52," Sesiones "),r(),n(53,"th",49),s(54," Adherencia "),r(),n(55,"th",49),s(56," Fechas Reales "),r(),n(57,"th",49),s(58," Notas "),r(),n(59,"th",49),s(60," Acciones "),r()()(),n(61,"tbody",50),x(62,za,42,26,"tr",51),r()(),x(63,Ba,7,0,"div",146),r(),x(64,$a,29,5,"div",147),r(),n(65,"div",125)(66,"button",148),f("click",function(){u(e);let o=d();return g(o.closeVerModal())}),s(67," Cerrar "),r()()()()()}if(a&2){let e=d();l(13),v(" Seguimiento: ",e.selectedAsignacion==null?null:e.selectedAsignacion.terapia_nombre," "),l(11),z(" ",e.formatDate((e.selectedAsignacion==null?null:e.selectedAsignacion.fecha_inicio_programada)||"")," - ",e.formatDate((e.selectedAsignacion==null?null:e.selectedAsignacion.fecha_fin_programada)||"")," "),l(5),w(e.selectedAsignacion==null?null:e.selectedAsignacion.usuarios_count),l(5),z(" ",e.selectedAsignacion==null?null:e.selectedAsignacion.sesiones_por_semana,"/sem - ",e.formatDuracion(e.selectedAsignacion==null?null:e.selectedAsignacion.duracion_sesion)," "),l(5),w(e.selectedAsignacion==null?null:e.selectedAsignacion.asignado_por_nombre),l(),m("ngIf",e.selectedAsignacion==null?null:e.selectedAsignacion.terapeuta_nombre),l(22),m("ngForOf",e.seguimientoDetalle)("ngForTrackBy",e.trackByUserId),l(),m("ngIf",e.seguimientoDetalle.length===0),l(),m("ngIf",e.seguimientoDetalle.length>0)}}function Wa(a,t){if(a&1){let e=C();n(0,"button",174),f("click",function(){u(e);let o=d();return g(o.openAsignarModal())}),b(),n(1,"svg",175),p(2,"path",34),r()()}}var _t=class a{constructor(t,e){this.supabaseService=t;this.authService=e}terapias=[];usuarios=[];terapeutas=[];asignaciones=[];loading=!1;error="";showAsignarModal=!1;showVerModal=!1;selectedAsignacion=null;seguimientoDetalle=[];asignacionForm={id_terapia:0,usuarios_seleccionados:[],terapeuta_responsable:void 0,fecha_inicio:"",fecha_fin:"",sesiones_por_semana:3,duracion_sesion:60,tipo_asignacion:"individual",notas:"",objetivos_grupales:""};searchTerm="";estadoFilter="all";terapiaFilter="all";tipoFilter="all";Math;ngOnInit(){return h(this,null,function*(){yield this.loadInitialData()})}loadInitialData(){return h(this,null,function*(){this.loading=!0;try{yield Promise.all([this.loadTerapias(),this.loadUsuarios(),this.loadTerapeutas(),this.loadAsignaciones()])}catch(t){console.error("Error cargando datos iniciales:",t),this.error="Error al cargar los datos"}finally{this.loading=!1}})}loadTerapias(){return h(this,null,function*(){try{let t=yield this.supabaseService.getData("terapias");this.terapias=t?.filter(e=>e.status===1)||[]}catch(t){console.error("Error cargando terapias:",t)}})}loadUsuarios(){return h(this,null,function*(){try{let t=yield this.supabaseService.getData("profiles");this.usuarios=t?.filter(e=>e.status===1&&(e.id_perfil===1||e.id_perfil===2))||[]}catch(t){console.error("Error cargando usuarios:",t)}})}loadTerapeutas(){return h(this,null,function*(){try{let t=yield this.supabaseService.getData("profiles");this.terapeutas=t?.filter(e=>e.status===1&&(e.id_perfil===2||e.id_perfil===3))||[]}catch(t){console.error("Error cargando terapeutas:",t)}})}loadAsignaciones(){return h(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.client.from("terapia_asignaciones_masivas").select(`
          id,
          id_terapia,
          usuarios_asignados,
          fecha_inicio,
          fecha_fin,
          sesiones_por_semana,
          duracion_sesion,
          tipo_asignacion,
          estado,
          notas,
          objetivos_grupales,
          terapeuta_responsable,
          created_at,
          terapias(nombre, descripcion, tipo, area_especializacion),
          profiles!terapia_asignaciones_masivas_asignado_por_fkey(full_name),
          terapeuta:profiles!terapia_asignaciones_masivas_terapeuta_responsable_fkey(full_name)
        `).eq("status",1).order("created_at",{ascending:!1});if(e)throw e;this.asignaciones=(t||[]).map(i=>({asignacion_id:i.id,terapia_nombre:i.terapias?.nombre||"Terapia no encontrada",terapia_descripcion:i.terapias?.descripcion||"",terapia_tipo:i.terapias?.tipo||"",area_especializacion:i.terapias?.area_especializacion||"",fecha_inicio_programada:i.fecha_inicio,fecha_fin_programada:i.fecha_fin,usuarios_count:i.usuarios_asignados?.length||0,estado_asignacion:i.estado,asignado_por_nombre:i.profiles?.full_name||"Usuario no encontrado",terapeuta_nombre:i.terapeuta?.full_name||null,fecha_asignacion:i.created_at,notas_asignacion:i.notas,sesiones_por_semana:i.sesiones_por_semana,duracion_sesion:i.duracion_sesion,tipo_asignacion:i.tipo_asignacion}))}catch(t){console.error("Error cargando asignaciones:",t),yield this.loadAsignacionesAlternativo()}})}loadAsignacionesAlternativo(){return h(this,null,function*(){try{let[t,e,i]=yield Promise.all([this.supabaseService.getData("terapia_asignaciones_masivas"),this.supabaseService.getData("terapias"),this.supabaseService.getData("profiles")]),o=t?.filter(c=>c.status===1)||[];this.asignaciones=o.map(c=>{let _=e?.find(T=>T.id===c.id_terapia),S=i?.find(T=>T.id===c.asignado_por),P=i?.find(T=>T.id===c.terapeuta_responsable);return{asignacion_id:c.id,terapia_nombre:_?.nombre||"Terapia no encontrada",terapia_descripcion:_?.descripcion||"",terapia_tipo:_?.tipo||"",area_especializacion:_?.area_especializacion||"",fecha_inicio_programada:c.fecha_inicio,fecha_fin_programada:c.fecha_fin,usuarios_count:c.usuarios_asignados?.length||0,estado_asignacion:c.estado,asignado_por_nombre:S?.full_name||"Usuario no encontrado",terapeuta_nombre:P?.full_name||null,fecha_asignacion:c.created_at,notas_asignacion:c.notas,sesiones_por_semana:c.sesiones_por_semana,duracion_sesion:c.duracion_sesion,tipo_asignacion:c.tipo_asignacion}})}catch(t){console.error("Error en m\xE9todo alternativo:",t),this.asignaciones=[]}})}openAsignarModal(){this.asignacionForm={id_terapia:0,usuarios_seleccionados:[],terapeuta_responsable:void 0,fecha_inicio:this.getTomorrowDate(),fecha_fin:this.getNextWeekDate(),sesiones_por_semana:3,duracion_sesion:60,tipo_asignacion:"individual",notas:"",objetivos_grupales:""},this.error="",this.showAsignarModal=!0}closeAsignarModal(){this.showAsignarModal=!1,this.error=""}openVerModal(t){return h(this,null,function*(){this.selectedAsignacion=t,yield this.loadSeguimientoDetalle(t.asignacion_id),this.showVerModal=!0})}closeVerModal(){this.showVerModal=!1,this.selectedAsignacion=null,this.seguimientoDetalle=[]}loadSeguimientoDetalle(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.client.from("v_terapias_asignadas_usuarios").select("*").eq("asignacion_id",t).order("full_name");if(!i&&e){this.seguimientoDetalle=e;return}let{data:o,error:c}=yield this.supabaseService.client.from("terapia_seguimiento_individual").select(`
          id,
          id_asignacion_masiva,
          id_profile,
          progreso,
          estado_individual,
          fecha_inicio_real,
          fecha_fin_real,
          sesiones_completadas,
          sesiones_programadas,
          notas_individuales,
          adherencia_porcentaje,
          profiles(username, full_name)
        `).eq("id_asignacion_masiva",t);if(c)throw c;this.seguimientoDetalle=(o||[]).map(_=>({seguimiento_id:_.id,asignacion_id:_.id_asignacion_masiva,id_profile:_.id_profile,username:_.profiles?.username||"N/A",full_name:_.profiles?.full_name||"Usuario no encontrado",progreso:_.progreso,estado_individual:_.estado_individual,fecha_inicio_real:_.fecha_inicio_real,fecha_fin_real:_.fecha_fin_real,sesiones_completadas:_.sesiones_completadas||0,sesiones_programadas:_.sesiones_programadas||0,notas_individuales:_.notas_individuales,adherencia_porcentaje:_.adherencia_porcentaje||0}))}catch(e){console.error("Error cargando seguimiento detalle:",e),this.seguimientoDetalle=[]}})}toggleUsuario(t){let e=this.asignacionForm.usuarios_seleccionados.indexOf(t);e>-1?this.asignacionForm.usuarios_seleccionados.splice(e,1):this.asignacionForm.usuarios_seleccionados.push(t)}isUsuarioSelected(t){return this.asignacionForm.usuarios_seleccionados.includes(t)}selectAllUsuarios(){this.asignacionForm.usuarios_seleccionados=this.usuarios.map(t=>t.id)}clearAllUsuarios(){this.asignacionForm.usuarios_seleccionados=[]}asignarTerapia(){return h(this,null,function*(){try{if(this.error="",!this.asignacionForm.id_terapia){this.error="Debe seleccionar una terapia";return}if(this.asignacionForm.usuarios_seleccionados.length===0){this.error="Debe seleccionar al menos un usuario";return}if(!this.asignacionForm.fecha_inicio||!this.asignacionForm.fecha_fin){this.error="Debe especificar fechas de inicio y fin";return}if(new Date(this.asignacionForm.fecha_fin)<=new Date(this.asignacionForm.fecha_inicio)){this.error="La fecha de fin debe ser posterior a la fecha de inicio";return}this.loading=!0;let t=this.authService.getCurrentUser();if(!t?.id)throw new Error("Usuario no autenticado");let e;try{let{data:i,error:o}=yield this.supabaseService.client.rpc("asignar_terapia_a_usuarios",{p_id_terapia:this.asignacionForm.id_terapia,p_usuarios_ids:this.asignacionForm.usuarios_seleccionados,p_asignado_por:t.id,p_fecha_inicio:this.asignacionForm.fecha_inicio,p_fecha_fin:this.asignacionForm.fecha_fin,p_terapeuta_responsable:this.asignacionForm.terapeuta_responsable||null,p_sesiones_por_semana:this.asignacionForm.sesiones_por_semana,p_duracion_sesion:this.asignacionForm.duracion_sesion,p_tipo_asignacion:this.asignacionForm.tipo_asignacion,p_notas:this.asignacionForm.notas||null,p_objetivos_grupales:this.asignacionForm.objetivos_grupales||null});if(o)throw o;e=i}catch{console.log("Funci\xF3n RPC no disponible, usando m\xE9todo manual");let o={id_terapia:this.asignacionForm.id_terapia,usuarios_asignados:this.asignacionForm.usuarios_seleccionados,asignado_por:t.id,terapeuta_responsable:this.asignacionForm.terapeuta_responsable||null,fecha_inicio:this.asignacionForm.fecha_inicio,fecha_fin:this.asignacionForm.fecha_fin,sesiones_por_semana:this.asignacionForm.sesiones_por_semana,duracion_sesion:this.asignacionForm.duracion_sesion,tipo_asignacion:this.asignacionForm.tipo_asignacion,notas:this.asignacionForm.notas||null,objetivos_grupales:this.asignacionForm.objetivos_grupales||null,estado:"activa"},{data:c,error:_}=yield this.supabaseService.client.from("terapia_asignaciones_masivas").insert(o).select().single();if(_)throw _;e=c.id;let S=this.asignacionForm.usuarios_seleccionados.map(T=>({id_asignacion_masiva:e,id_profile:T,id_terapia:this.asignacionForm.id_terapia,progreso:0,estado_individual:"pendiente",sesiones_completadas:0,sesiones_programadas:this.calcularSesionesProgramadas(),adherencia_porcentaje:0})),{error:P}=yield this.supabaseService.client.from("terapia_seguimiento_individual").insert(S);if(P)throw P}console.log("Terapia asignada exitosamente, ID:",e),yield this.loadAsignaciones(),this.closeAsignarModal(),alert(`Terapia asignada exitosamente a ${this.asignacionForm.usuarios_seleccionados.length} usuarios`)}catch(t){console.error("Error asignando terapia:",t),this.error=t instanceof Error?t.message:"Error al asignar la terapia"}finally{this.loading=!1}})}calcularSesionesProgramadas(){let t=new Date(this.asignacionForm.fecha_inicio),e=new Date(this.asignacionForm.fecha_fin),i=Math.abs(e.getTime()-t.getTime()),o=Math.ceil(i/(1e3*60*60*24));return Math.ceil(o/7)*this.asignacionForm.sesiones_por_semana}cancelarAsignacion(t){return h(this,null,function*(){if(confirm("\xBFEst\xE1 seguro de cancelar esta asignaci\xF3n? Esta acci\xF3n afectar\xE1 a todos los usuarios asignados."))try{let{error:i}=yield this.supabaseService.client.from("terapia_asignaciones_masivas").update({estado:"cancelada",updated_at:new Date().toISOString()}).eq("id",t);if(i)throw i;yield this.loadAsignaciones(),alert("Asignaci\xF3n cancelada exitosamente")}catch(i){console.error("Error cancelando asignaci\xF3n:",i),alert("Error al cancelar la asignaci\xF3n")}})}actualizarProgreso(t,e){return h(this,null,function*(){try{let i=parseInt(e.target?.value||e)||0;if(i<0||i>100){alert("El progreso debe estar entre 0 y 100");return}let o={progreso:i,updated_at:new Date().toISOString()};if(i===0)o.estado_individual="pendiente";else if(i<100){o.estado_individual="en_progreso";let _=this.seguimientoDetalle.find(S=>S.seguimiento_id===t);_&&!_.fecha_inicio_real&&(o.fecha_inicio_real=new Date().toISOString().split("T")[0])}else o.estado_individual="completada",o.fecha_fin_real=new Date().toISOString().split("T")[0];let{error:c}=yield this.supabaseService.client.from("terapia_seguimiento_individual").update(o).eq("id",t);if(c)throw c;this.selectedAsignacion&&(yield this.loadSeguimientoDetalle(this.selectedAsignacion.asignacion_id))}catch(i){console.error("Error actualizando progreso:",i),alert("Error al actualizar el progreso")}})}editarNotasIndividuales(t){return h(this,null,function*(){let e=prompt("Ingrese las notas para este usuario:",t.notas_individuales||"");if(e!==null)try{let{error:i}=yield this.supabaseService.client.from("terapia_seguimiento_individual").update({notas_individuales:e,updated_at:new Date().toISOString()}).eq("id",t.seguimiento_id);if(i)throw i;this.selectedAsignacion&&(yield this.loadSeguimientoDetalle(this.selectedAsignacion.asignacion_id))}catch(i){console.error("Error actualizando notas:",i),alert("Error al actualizar las notas")}})}getEstadisticasProgreso(){if(!this.seguimientoDetalle||this.seguimientoDetalle.length===0)return{pendientes:0,enProgreso:0,completadas:0,promedioProgreso:0,promedioAdherencia:0};let t=this.seguimientoDetalle.filter(P=>P.estado_individual==="pendiente").length,e=this.seguimientoDetalle.filter(P=>P.estado_individual==="en_progreso").length,i=this.seguimientoDetalle.filter(P=>P.estado_individual==="completada").length,o=this.seguimientoDetalle.reduce((P,T)=>P+(T.progreso||0),0),c=Math.round(o/this.seguimientoDetalle.length),_=this.seguimientoDetalle.reduce((P,T)=>P+(T.adherencia_porcentaje||0),0),S=Math.round(_/this.seguimientoDetalle.length);return{pendientes:t,enProgreso:e,completadas:i,promedioProgreso:c,promedioAdherencia:S}}getTerapiaNombre(t){return this.terapias.find(i=>i.id===t)?.nombre||"Terapia no encontrada"}getUserName(t){let e=this.usuarios.find(i=>i.id===t);return e?.full_name||e?.username||"Usuario no encontrado"}getTerapeutaNombre(t){return t?this.terapeutas.find(i=>i.id===t)?.full_name||"Terapeuta no encontrado":"Sin asignar"}getEstadoColor(t){switch(t){case"activa":return"green";case"completada":return"blue";case"pausada":return"yellow";case"cancelada":return"red";default:return"gray"}}getEstadoIcon(t){switch(t){case"activa":return"fas fa-play-circle";case"completada":return"fas fa-check-circle";case"pausada":return"fas fa-pause-circle";case"cancelada":return"fas fa-times-circle";default:return"fas fa-circle"}}formatDate(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}formatDuracion(t){if(!t)return"Sin especificar";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getTomorrowDate(){let t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}getNextWeekDate(){let t=new Date;return t.setDate(t.getDate()+7),t.toISOString().split("T")[0]}get filteredAsignaciones(){let t=[...this.asignaciones];if(this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.terapia_nombre.toLowerCase().includes(e)||i.asignado_por_nombre.toLowerCase().includes(e)||i.terapeuta_nombre?.toLowerCase().includes(e)||i.area_especializacion?.toLowerCase().includes(e))}return this.estadoFilter!=="all"&&(t=t.filter(e=>e.estado_asignacion===this.estadoFilter)),this.terapiaFilter!=="all"&&(t=t.filter(e=>e.terapia_nombre===this.terapiaFilter)),this.tipoFilter!=="all"&&(t=t.filter(e=>e.tipo_asignacion===this.tipoFilter)),t}clearFilters(){this.searchTerm="",this.estadoFilter="all",this.terapiaFilter="all",this.tipoFilter="all"}refreshData(){return h(this,null,function*(){yield this.loadAsignaciones()})}canAssignTerapias(){return this.authService.isAdmin()||this.authService.hasProfile(3)}trackByAsignacionId(t,e){return e.asignacion_id}trackByUserId(t,e){return e.id}trackByTerapiaId(t,e){return e.id}static \u0275fac=function(e){return new(e||a)(I(te),I(j))};static \u0275cmp=A({type:a,selectors:[["app-terapias-usuario"]],standalone:!1,decls:53,vars:11,consts:[["filtrosAplicados",""],["pluralUsuarios",""],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["class","inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"md:col-span-2"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Buscar por terapia, asignador o terapeuta...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["value","all"],["value","activa"],["value","completada"],["value","pausada"],["value","cancelada"],["value","individual"],["value","grupal"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-red-600","hover:text-red-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","bg-white shadow overflow-hidden sm:rounded-md",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],["class","md:hidden fixed bottom-6 right-6 w-14 h-14 bg-red-600 text-white rounded-full shadow-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 z-40","title","Asignar terapia",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-red-600"],[1,"bg-white","shadow","overflow-hidden","sm:rounded-md"],[1,"px-4","py-5","sm:px-6","border-b","border-gray-200"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-12",4,"ngIf"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],["class","text-xs text-gray-400",4,"ngIf"],[1,"flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","text-gray-400","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"text-sm","text-gray-500","ml-1"],[1,"text-xs","text-gray-400","mt-1"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"text-gray-500"],["class","text-xs text-gray-400 mt-1",4,"ngIf"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","justify-end","space-x-2"],["title","Ver seguimiento",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["class","text-red-600 hover:text-red-900 p-2 rounded-full hover:bg-red-50","title","Cancelar asignaci\xF3n",3,"click",4,"ngIf"],[1,"text-xs","text-gray-400"],["title","Cancelar asignaci\xF3n",1,"text-red-600","hover:text-red-900","p-2","rounded-full","hover:bg-red-50",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[4,"ngIf","ngIfElse"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-4xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"mt-2"],[1,"bg-white","px-4","pb-4","sm:px-6","max-h-96","overflow-y-auto"],[1,"space-y-6"],[1,"text-red-500"],["name","terapia",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["value","0"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["name","tipoAsignacion",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["name","terapeuta",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["type","date","name","fechaInicio",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","date","name","fechaFin",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","number","name","sesionesSemana","min","1","max","7",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","number","name","duracionSesion","min","15","max","180","step","15",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["name","notas","rows","3","placeholder","Notas adicionales sobre la asignaci\xF3n...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[4,"ngIf"],[1,"flex","justify-between","items-center","mb-3"],[1,"block","text-sm","font-medium","text-gray-700"],["type","button",1,"text-xs","text-red-600","hover:text-red-800",3,"click"],["type","button",1,"text-xs","text-gray-600","hover:text-gray-800",3,"click"],[1,"border","border-gray-300","rounded-md","p-3","max-h-48","overflow-y-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-2"],["class","flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer",3,"bg-red-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","mt-4 bg-red-50 border border-red-200 rounded-md p-3",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","animate-spin -ml-1 mr-3 h-5 w-5 text-white","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:mt-0","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50",3,"click","disabled"],["name","objetivosGrupales","rows","3","placeholder","Objetivos espec\xEDficos para la terapia grupal...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"flex","items-center","p-2","hover:bg-gray-50","rounded","cursor-pointer"],["type","checkbox",1,"h-4","w-4","text-red-600","focus:ring-red-500","border-gray-300","rounded",3,"change","checked"],[1,"ml-3","flex-1"],[1,"text-xs","text-gray-500"],[1,"mt-4","bg-red-50","border","border-red-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-6xl","sm:w-full"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900"],["class","text-xs text-gray-500",4,"ngIf"],["class","text-center py-8",4,"ngIf"],["class","mt-6 bg-gray-50 rounded-lg p-4",4,"ngIf"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"h-8","w-8","bg-gray-300","rounded-full","flex","items-center","justify-center","mr-3"],[1,"text-xs","font-medium","text-gray-700"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-3"],[1,"bg-blue-600","h-2","rounded-full"],["class","mt-2",4,"ngIf"],[1,"w-12","bg-gray-200","rounded-full","h-2","mr-2"],[1,"bg-purple-600","h-2","rounded-full"],["class","text-gray-500",4,"ngIf"],[1,"px-6","py-4"],[1,"text-sm","text-gray-900","max-w-xs"],["class","text-indigo-600 hover:text-indigo-900 p-1 rounded hover:bg-indigo-50","title","Editar notas",3,"click",4,"ngIf"],["type","range","min","0","max","100",1,"w-full","h-2","bg-gray-200","rounded-lg","appearance-none","cursor-pointer","slider",3,"input","value"],["title","Editar notas",1,"text-indigo-600","hover:text-indigo-900","p-1","rounded","hover:bg-indigo-50",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"text-center","py-8"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-8","w-8","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"mt-6","bg-gray-50","rounded-lg","p-4"],[1,"text-sm","font-medium","text-gray-900","mb-3"],[1,"grid","grid-cols-2","md:grid-cols-5","gap-4","text-center"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-2xl","font-bold","text-yellow-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-2xl","font-bold","text-blue-600"],[1,"text-2xl","font-bold","text-purple-600"],["title","Asignar terapia",1,"md:hidden","fixed","bottom-6","right-6","w-14","h-14","bg-red-600","text-white","rounded-full","shadow-lg","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-500","focus:ring-offset-2","transition-all","duration-200","z-40",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","mx-auto"]],template:function(e,i){e&1&&(n(0,"div",2)(1,"div",3)(2,"div",4)(3,"div")(4,"h1",5),s(5,"Asignaci\xF3n de Terapias a Usuarios"),r(),n(6,"p",6),s(7),r()(),n(8,"div",7)(9,"button",8),f("click",function(){return i.refreshData()}),b(),n(10,"svg",9),p(11,"path",10),r(),s(12," Refrescar "),r(),x(13,ua,4,0,"button",11),r()()(),y(),n(14,"div",12)(15,"div",13)(16,"div",14)(17,"label",15),s(18,"Buscar"),r(),n(19,"input",16),k("ngModelChange",function(c){return E(i.searchTerm,c)||(i.searchTerm=c),c}),r()(),n(20,"div")(21,"label",15),s(22,"Estado"),r(),n(23,"select",17),k("ngModelChange",function(c){return E(i.estadoFilter,c)||(i.estadoFilter=c),c}),n(24,"option",18),s(25,"Todos los estados"),r(),n(26,"option",19),s(27,"Activa"),r(),n(28,"option",20),s(29,"Completada"),r(),n(30,"option",21),s(31,"Pausada"),r(),n(32,"option",22),s(33,"Cancelada"),r()()(),n(34,"div")(35,"label",15),s(36,"Tipo"),r(),n(37,"select",17),k("ngModelChange",function(c){return E(i.tipoFilter,c)||(i.tipoFilter=c),c}),n(38,"option",18),s(39,"Todos los tipos"),r(),n(40,"option",23),s(41,"Individual"),r(),n(42,"option",24),s(43,"Grupal"),r()()()(),n(44,"div",25)(45,"button",26),f("click",function(){return i.clearFilters()}),s(46," Limpiar filtros "),r()()(),x(47,ga,7,1,"div",27)(48,fa,2,0,"div",28)(49,Ma,25,4,"div",29),r(),x(50,Da,98,22,"div",30)(51,qa,68,12,"div",30)(52,Wa,3,0,"button",31)),e&2&&(l(7),v(" Gestiona las asignaciones masivas de terapias - Total: ",i.asignaciones.length," "),l(6),m("ngIf",i.canAssignTerapias()),l(6),M("ngModel",i.searchTerm),l(4),M("ngModel",i.estadoFilter),l(14),M("ngModel",i.tipoFilter),l(10),m("ngIf",i.error&&!i.showAsignarModal&&!i.showVerModal),l(),m("ngIf",i.loading&&!i.showAsignarModal&&!i.showVerModal),l(),m("ngIf",!i.loading),l(),m("ngIf",i.showAsignarModal),l(),m("ngIf",i.showVerModal),l(),m("ngIf",!i.showAsignarModal&&!i.showVerModal&&i.canAssignTerapias()))},dependencies:[$,N,R,ee,J,Z,q,Pe,Q,W,K,Oe,Ie,G,de,Te],styles:[".container[_ngcontent-%COMP%]{max-width:100%;margin:0 auto;padding:0 1rem}.modal-enter[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalEnter .3s ease-out}@keyframes _ngcontent-%COMP%_modalEnter{0%{opacity:0;transform:scale(.95) translateY(-10px)}to{opacity:1;transform:scale(1) translateY(0)}}.modal-backdrop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_backdropEnter .3s ease-out}@keyframes _ngcontent-%COMP%_backdropEnter{0%{opacity:0}to{opacity:.75}}.terminal-container[_ngcontent-%COMP%]{background-color:#000;color:#0f0;font-family:Courier New,Monaco,Menlo,monospace;position:relative;border-radius:8px;overflow:hidden}.terminal-header[_ngcontent-%COMP%]{background-color:#1a1a1a;padding:.75rem 1rem;border-bottom:1px solid #333;display:flex;align-items:center;justify-content:space-between}.terminal-controls[_ngcontent-%COMP%]{display:flex;gap:.5rem}.terminal-control[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%}.terminal-control.close[_ngcontent-%COMP%]{background-color:#ff5f56}.terminal-control.minimize[_ngcontent-%COMP%]{background-color:#ffbd2e}.terminal-control.maximize[_ngcontent-%COMP%]{background-color:#27ca3f}.terminal-content[_ngcontent-%COMP%]{padding:1.5rem;font-size:.875rem;line-height:1.5;min-height:400px}.watermark[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(15deg);font-size:8rem;font-weight:700;color:#ffffff0d;pointer-events:none;-webkit-user-select:none;user-select:none;z-index:1}.terminal-text[_ngcontent-%COMP%]{position:relative;z-index:10}.therapy-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a;transition:all .2s ease-in-out;border:1px solid #e5e7eb}.therapy-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px #0000001a;transform:translateY(-1px)}.therapy-card-header[_ngcontent-%COMP%]{padding:1.25rem;border-bottom:1px solid #f3f4f6}.therapy-card-body[_ngcontent-%COMP%]{padding:1.25rem}.therapy-card-footer[_ngcontent-%COMP%]{padding:1rem 1.25rem;background-color:#f9fafb;border-top:1px solid #f3f4f6;border-radius:0 0 12px 12px}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .625rem;border-radius:9999px;font-size:.75rem;font-weight:500;text-transform:capitalize}.badge-fisica[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af}.badge-respiratoria[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.badge-neurologica[_ngcontent-%COMP%]{background-color:#f3e8ff;color:#7c3aed}.badge-ocupacional[_ngcontent-%COMP%]{background-color:#fed7aa;color:#ea580c}.badge-cardiaca[_ngcontent-%COMP%]{background-color:#fecaca;color:#dc2626}.status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .5rem;border-radius:.375rem;font-size:.75rem;font-weight:500}.status-activa[_ngcontent-%COMP%]{background-color:#d1fae5;color:#065f46}.status-completada[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af}.status-pausada[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.status-cancelada[_ngcontent-%COMP%]{background-color:#fecaca;color:#991b1b}.status-pendiente[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151}.status-en-progreso[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1d4ed8}.status-abandonada[_ngcontent-%COMP%]{background-color:#fee2e2;color:#dc2626}.progress-bar[_ngcontent-%COMP%]{width:100%;height:.5rem;background-color:#e5e7eb;border-radius:.25rem;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s ease-in-out;border-radius:.25rem}.progress-green[_ngcontent-%COMP%]{background-color:#10b981}.progress-blue[_ngcontent-%COMP%]{background-color:#3b82f6}.progress-yellow[_ngcontent-%COMP%]{background-color:#f59e0b}.progress-red[_ngcontent-%COMP%]{background-color:#ef4444}.form-section[_ngcontent-%COMP%]{background-color:#f9fafb;border:1px solid #e5e7eb;border-radius:.5rem;padding:1rem;margin-bottom:1rem}.form-section.active[_ngcontent-%COMP%]{border-color:#dc2626;background-color:#fef2f2}.section-selector[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1.5rem}.section-card[_ngcontent-%COMP%]{padding:1rem;border:2px solid #e5e7eb;border-radius:.5rem;cursor:pointer;transition:all .2s ease-in-out;text-align:center}.section-card[_ngcontent-%COMP%]:hover, .section-card.selected[_ngcontent-%COMP%]{border-color:#dc2626;background-color:#fef2f2}.section-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600;color:#374151;margin-bottom:.25rem}.section-card.selected[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#dc2626}.section-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.exercise-card[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #e5e7eb;border-radius:.5rem;padding:1rem;margin-bottom:.75rem}.exercise-header[_ngcontent-%COMP%]{display:flex;justify-content:between;align-items:center;margin-bottom:.75rem;padding-bottom:.5rem;border-bottom:1px solid #f3f4f6}.exercise-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.exercise-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.25rem;border:none;background:none;cursor:pointer;border-radius:.25rem;transition:background-color .2s ease-in-out}.exercise-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.exercise-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:.75rem}.fab[_ngcontent-%COMP%]{position:fixed;bottom:1.5rem;right:1.5rem;width:3.5rem;height:3.5rem;background-color:#dc2626;color:#fff;border:none;border-radius:50%;box-shadow:0 4px 6px #0000001a;cursor:pointer;transition:all .2s ease-in-out;z-index:1000}.fab[_ngcontent-%COMP%]:hover{background-color:#b91c1c;transform:scale(1.05);box-shadow:0 6px 8px #00000026}.fab[_ngcontent-%COMP%]:active{transform:scale(.95)}@media (min-width: 768px){.fab[_ngcontent-%COMP%]{display:none}}.loading-spinner[_ngcontent-%COMP%]{display:inline-block;width:2rem;height:2rem;border:3px solid #f3f4f6;border-radius:50%;border-top-color:#dc2626;animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}.tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip[_ngcontent-%COMP%]   .tooltip-text[_ngcontent-%COMP%]{visibility:hidden;width:120px;background-color:#374151;color:#fff;text-align:center;border-radius:6px;padding:5px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-60px;opacity:0;transition:opacity .3s;font-size:.75rem}.tooltip[_ngcontent-%COMP%]:hover   .tooltip-text[_ngcontent-%COMP%]{visibility:visible;opacity:1}@media (max-width: 640px){.container[_ngcontent-%COMP%]{padding:0 .5rem}.therapy-card[_ngcontent-%COMP%]{margin-bottom:1rem}.section-selector[_ngcontent-%COMP%], .exercise-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 768px){.terminal-content[_ngcontent-%COMP%]{padding:1rem;font-size:.75rem}.watermark[_ngcontent-%COMP%]{font-size:4rem}}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.focus-visible[_ngcontent-%COMP%]:focus{outline:2px solid #dc2626;outline-offset:2px}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;text-align:left;border-bottom:1px solid #e5e7eb}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f9fafb;font-weight:600;color:#374151}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.slide-in-right[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInRight .3s ease-out}@keyframes _ngcontent-%COMP%_slideInRight{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}.bounce[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce .5s ease-in-out}@keyframes _ngcontent-%COMP%_bounce{0%,20%,53%,80%,to{transform:translateZ(0)}40%,43%{transform:translate3d(0,-5px,0)}70%{transform:translate3d(0,-2px,0)}90%{transform:translate3d(0,-1px,0)}}"]})};function Ga(a,t){if(a&1&&(n(0,"div",31),s(1),r()),a&2){let e=t.$implicit;l(),v(" ",e," ")}}function Ha(a,t){a&1&&p(0,"div",39)}function Ya(a,t){if(a&1&&(n(0,"span"),s(1),r()),a&2){let e=d(2).$implicit,i=d(2);l(),v(" ",i.getDiasRestantesTexto(e.seguimiento.dias_restantes)," ")}}function Qa(a,t){if(a&1&&(n(0,"div",42)(1,"div",33)(2,"div",43)(3,"span",44),s(4),r(),n(5,"span",45),s(6),r()(),n(7,"span",46),s(8),r()(),n(9,"div",47),s(10),r(),n(11,"div",48)(12,"div",3)(13,"span"),s(14),r(),x(15,Ya,2,1,"span",49),r(),n(16,"div",50),p(17,"div",51),r()()()),a&2){let e=d().$implicit,i=d(2);m("ngClass",i.getColorTerapia(e.seguimiento)),l(4),v(" ",i.getIconoEstado(e.seguimiento)," "),l(2),v(" ",i.getTipoTerapiaCorto(e.seguimiento.terapia_tipo)," "),l(2),v(" ",i.formatearProgreso(e.seguimiento.progreso)," "),l(),m("title",e.seguimiento.terapia_nombre),l(),v(" ",e.seguimiento.terapia_nombre," "),l(4),w(e.seguimiento.terapia_nivel),l(),m("ngIf",e.seguimiento.dias_restantes!==void 0),l(2),Y("width",e.seguimiento.progreso,"%")}}function Ja(a,t){if(a&1){let e=C();n(0,"div",40),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.onClickTerapia(o))}),x(1,Qa,18,10,"div",41),r()}if(a&2){let e=t.$implicit;l(),m("ngIf",e.tipoEvento==="inicio")}}function Za(a,t){if(a&1&&(n(0,"div",52),s(1),r()),a&2){let e=d().$implicit;l(),v(" +",e.terapias.length-3," m\xE1s... ")}}function Xa(a,t){if(a&1&&(n(0,"div",32)(1,"div",33)(2,"span",34),s(3),r(),x(4,Ha,1,0,"div",35),r(),n(5,"div",36),x(6,Ja,2,1,"div",37),r(),x(7,Za,2,1,"div",38),r()),a&2){let e=t.$implicit,i=d();O("bg-gray-50",!e.esMesActual)("bg-blue-50",i.esHoy(e.fecha)),l(2),O("text-gray-400",!e.esMesActual)("text-gray-900",e.esMesActual&&!i.esHoy(e.fecha))("text-blue-600",i.esHoy(e.fecha))("font-bold",i.esHoy(e.fecha)),l(),v(" ",e.fecha.getDate()," "),l(),m("ngIf",i.esHoy(e.fecha)),l(2),m("ngForOf",e.terapias)("ngForTrackBy",i.trackByTerapia),l(),m("ngIf",e.terapias.length>3)}}function Ka(a,t){a&1&&(n(0,"div",92)(1,"div",93),b(),n(2,"svg",94),p(3,"path",95),r(),y(),n(4,"div",96)(5,"p",97),s(6,"\xA1Terapia copiada al portapapeles!"),r()()()())}function es(a,t){if(a&1){let e=C();n(0,"div",53)(1,"div",54)(2,"div",55),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),r(),n(3,"span",56),s(4,"\u200B"),r(),n(5,"div",57)(6,"div",58)(7,"div",59)(8,"div",60),b(),n(9,"svg",61),p(10,"path",62),r()(),y(),n(11,"div",63)(12,"h3",64),s(13),r(),n(14,"div",65)(15,"p",66),s(16),r()()()()(),n(17,"div",67)(18,"div",68)(19,"div",69)(20,"div")(21,"span",70),s(22,"Mi Progreso:"),r(),n(23,"div",71)(24,"div",72),p(25,"div",73),r(),s(26),r()(),n(27,"div")(28,"span",70),s(29,"Estado:"),r(),n(30,"div",74),s(31),r()(),n(32,"div")(33,"span",70),s(34,"Per\xEDodo:"),r(),n(35,"div",74),s(36),r()(),n(37,"div")(38,"span",70),s(39,"D\xEDas restantes:"),r(),n(40,"div",74),s(41),r()()()(),n(42,"div",75)(43,"div",76),p(44,"img",77),r(),n(45,"div",78)(46,"div",79),p(47,"div",80)(48,"div",81)(49,"div",82),r(),n(50,"div",83),s(51),r()(),n(52,"pre",84),s(53),r()(),x(54,Ka,7,0,"div",85),n(55,"div",86)(56,"button",87),f("click",function(){let o;u(e);let c=d();return g(c.copyToClipboard(c.getFormattedTerapia(c.selectedTerapia,(o=c.selectedSeguimiento)!==null&&o!==void 0?o:void 0)))}),b(),n(57,"svg",5),p(58,"path",88),r(),s(59," Copiar "),r(),y(),n(60,"button",87),f("click",function(){let o;u(e);let c=d();return g(c.copyToClipboard(c.getFormattedTerapia(c.selectedTerapia,(o=c.selectedSeguimiento)!==null&&o!==void 0?o:void 0)))}),b(),n(61,"svg",5),p(62,"path",89),r(),s(63," Descargar "),r()()(),y(),n(64,"div",90)(65,"button",91),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),s(66," Cerrar "),r()()()()()}if(a&2){let e=d();l(13),v(" ",(e.selectedTerapia==null?null:e.selectedTerapia.nombre)||(e.selectedSeguimiento==null?null:e.selectedSeguimiento.terapia_nombre)," "),l(3),v(" Mi terapia asignada - Progreso: ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(9),Y("width",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"%"),l(),v(" ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(5),w(e.getEstadoIndividualText((e.selectedSeguimiento==null?null:e.selectedSeguimiento.estado_individual)||"")),l(5),z(" ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_inicio_programada)," - ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_fin_programada)," "),l(4),O("text-green-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>7)("text-yellow-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=7&&((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0)("text-red-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=0),l(),v(" ",e.formatDiasRestantes((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)," "),l(10),v(" ",e.getFileName(e.selectedTerapia)," "),l(2),w(e.getFormattedTerapia(e.selectedTerapia,e.selectedSeguimiento||void 0)),l(),m("ngIf",e.copySuccess)}}var xt=class a{constructor(t){this.terapiasService=t}terapias=[];volverAVista=new Ae;abrirTerapia=new Ae;fechaActual=new Date;mesActual=new Date;diasCalendario=[];showViewModal=!1;selectedTerapia=null;selectedSeguimiento=null;copySuccess=!1;meses=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];diasSemana=["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"];ngOnInit(){this.generarCalendario()}ngOnChanges(){this.generarCalendario()}generarCalendario(){this.diasCalendario=[];let t=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth(),1),e=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()+1,0),i=t.getDay();for(let c=i-1;c>=0;c--){let _=new Date(t);_.setDate(_.getDate()-(c+1)),this.diasCalendario.push({fecha:new Date(_),esMesActual:!1,terapias:this.getTerapiasDelDia(_)})}for(let c=1;c<=e.getDate();c++){let _=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth(),c);this.diasCalendario.push({fecha:new Date(_),esMesActual:!0,terapias:this.getTerapiasDelDia(_)})}let o=42-this.diasCalendario.length;for(let c=1;c<=o;c++){let _=new Date(e);_.setDate(_.getDate()+c),this.diasCalendario.push({fecha:new Date(_),esMesActual:!1,terapias:this.getTerapiasDelDia(_)})}}getTerapiasDelDia(t){let e=[],i=this.formatDateForComparison(t);return console.log(`\u{1F5D3}\uFE0F Verificando terapias para fecha: ${i}`),this.terapias.forEach(o=>{let c=new Date(o.fecha_inicio_programada),_=this.formatDateForComparison(c);console.log(`   \u{1F50D} Terapia: ${o.terapia_nombre}, Inicio: ${_}, Comparando con: ${i}`),_===i?(console.log(`   \u2705 COINCIDENCIA! Agregando terapia: ${o.terapia_nombre}`),e.push({seguimiento:o,tipoEvento:"inicio",enRango:!0})):console.log("   \u274C No coincide. Saltando terapia.")}),console.log(`\u{1F4CA} Total terapias para ${i}: ${e.length}`),e}formatDateForComparison(t){let e=t.getFullYear(),i=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0");return`${e}-${i}-${o}`}mesAnterior(){this.mesActual=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()-1,1),this.generarCalendario()}mesSiguiente(){this.mesActual=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()+1,1),this.generarCalendario()}irAHoy(){this.mesActual=new Date,this.generarCalendario()}onVolverAVista(){this.volverAVista.emit()}onClickTerapia(t){console.log("Click en terapia desde calendario:",t.seguimiento.terapia_nombre),this.abrirModalTerapia(t.seguimiento)}abrirModalTerapia(t){return h(this,null,function*(){console.log("Abriendo modal del calendario para:",t.terapia_nombre),this.selectedSeguimiento=t;try{console.log("\u{1F50D} Cargando terapia completa desde BD para ID:",t.terapia_id);let e=yield this.terapiasService.getTerapiaById(t.terapia_id);e?(console.log("\u2705 Terapia completa cargada desde BD:",e),this.selectedTerapia=e):(console.warn("\u26A0\uFE0F No se encontr\xF3 terapia en BD, usando informaci\xF3n b\xE1sica"),this.selectedTerapia=this.crearTerapiaBasica(t))}catch(e){console.error("\u274C Error cargando terapia completa desde BD:",e),this.selectedTerapia=this.crearTerapiaBasica(t)}this.showViewModal=!0})}closeViewModal(){console.log("Cerrando modal del calendario"),this.showViewModal=!1,this.selectedTerapia=null,this.selectedSeguimiento=null,this.copySuccess=!1}esHoy(t){let e=new Date;return t.toDateString()===e.toDateString()}getColorByEstado(t){switch(t){case"vigente":return"bg-green-500";case"pendiente":return"bg-blue-500";case"vencida":return"bg-red-500";default:return"bg-gray-500"}}getColorByTipo(t){return"border-green-500 bg-green-100"}formatDate(t){if(!t)return"N/A";try{let e;return t instanceof Date?e=t:e=new Date(t),isNaN(e.getTime())?"Fecha inv\xE1lida":e.toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"Fecha inv\xE1lida"}}formatDuracion(t){if(!t)return"N/A";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getEstadoTemporalText(t){switch(t){case"vigente":return"Vigente";case"pendiente":return"Pendiente";case"vencida":return"Vencida";default:return"Desconocido"}}getEstadoIndividualText(t){if(!t)return"Desconocido";switch(t){case"completada":return"Completada";case"en_progreso":return"En Progreso";case"pendiente":return"Sin Iniciar";case"abandonada":return"Abandonada";default:return"Desconocido"}}getFormattedTerapia(t,e){if(console.log("\u{1F5A8}\uFE0F Formateando terapia desde calendario:",{terapia:t,seguimiento:e}),!t&&!e)return console.warn("No hay datos de terapia ni seguimiento"),"No hay informaci\xF3n disponible para mostrar.";!t&&e&&(t=this.crearTerapiaBasica(e));let i=`${t.nombre||e?.terapia_nombre||"Terapia sin nombre"}
`;if(i+=`${t.descripcion||e?.terapia_descripcion||"Informaci\xF3n detallada disponible con el terapeuta"}
`,i+=`Tipo: ${t.tipo||e?.terapia_tipo||"No especificado"} | Nivel: ${t.nivel||e?.terapia_nivel||"No especificado"}
`,t.area_especializacion&&(i+=`\xC1rea: ${t.area_especializacion}
`),i+=`Duraci\xF3n estimada: ${this.formatDuracion(t.duracion_estimada||e?.duracion_estimada)}

`,e&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                          MI PROGRESO
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`Estado: ${this.getEstadoIndividualText(e.estado_individual)} (${e.progreso}%)
`,i+=`Per\xEDodo: ${this.formatDate(e.fecha_inicio_programada)} - ${this.formatDate(e.fecha_fin_programada)}
`,e.estado_temporal==="vigente"&&e.dias_restantes!==void 0&&(i+=`D\xEDas restantes: ${this.formatDiasRestantes(e.dias_restantes)}
`),e.fecha_inicio_real&&(i+=`Iniciado: ${this.formatDate(e.fecha_inicio_real)}
`),e.sesiones_completadas!==void 0&&e.sesiones_programadas!==void 0&&(i+=`Sesiones completadas: ${e.sesiones_completadas} / ${e.sesiones_programadas}
`),e.adherencia_porcentaje!==void 0&&(i+=`Adherencia: ${e.adherencia_porcentaje}%
`),i+=`
`),t.objetivo_principal&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      OBJETIVO PRINCIPAL
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.objetivo_principal}

`),t.ejercicios&&typeof t.ejercicios=="object"&&Object.keys(t.ejercicios).length>0){console.log("\u{1F4CB} Procesando ejercicios desde BD:",t.ejercicios),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      PLAN DE EJERCICIOS
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`;let o=["calentamiento","fortalecimiento","equilibrio","coordinacion","estiramiento","respiracion","flexibilidad","movilidad","resistencia"],c=0;o.forEach(_=>{let S=t.ejercicios[_];if(S&&S.ejercicios&&Array.isArray(S.ejercicios)&&S.ejercicios.length>0){c++,i+=`${_.toUpperCase()}
`,i+=`${"\u2500".repeat(_.length)}
`,S.descripcion&&(i+=`${S.descripcion}
`);let P=[];S.tiempo_total&&P.push(`Tiempo: ${S.tiempo_total}`),S.objetivos&&Array.isArray(S.objetivos)&&S.objetivos.length>0&&P.push(`Objetivos: ${S.objetivos.join(", ")}`),P.length>0&&(i+=`${P.join(" | ")}
`),i+=`
`,S.ejercicios.forEach((T,L)=>{i+=`${L+1}. ${T.nombre||"Ejercicio sin nombre"}
`,T.descripcion&&(i+=`   ${T.descripcion}
`);let V=[];T.series&&V.push(`${T.series} series`),T.repeticiones&&V.push(`${T.repeticiones} reps`),T.duracion&&V.push(`${T.duracion}`),T.resistencia&&V.push(`Resistencia: ${T.resistencia}`),T.equipamiento&&Array.isArray(T.equipamiento)&&T.equipamiento.length>0&&V.push(`Equipo: ${T.equipamiento.join(", ")}`),V.length>0&&(i+=`   ${V.join(" | ")}
`),T.ejecucion&&(i+=`   Ejecuci\xF3n: ${T.ejecucion}
`),T.precauciones&&(i+=`   \u26A0\uFE0F  ${T.precauciones}
`),T.modificaciones&&(T.modificaciones.principiante&&(i+=`   \u{1F4A1} Principiante: ${T.modificaciones.principiante}
`),T.modificaciones.limitaciones&&(i+=`   \u{1F527} Limitaciones: ${T.modificaciones.limitaciones}
`)),T.observaciones&&(i+=`   \u{1F4DD} ${T.observaciones}
`),i+=`
`}),i+=`
`}}),c===0&&(console.log("\u{1F50D} No se encontraron secciones organizadas, buscando ejercicios directos..."),Array.isArray(t.ejercicios)?(i+=`EJERCICIOS
`,i+=`\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500

`,t.ejercicios.forEach((_,S)=>{i+=`${S+1}. ${_.nombre||"Ejercicio sin nombre"}
`,_.descripcion&&(i+=`   ${_.descripcion}
`);let P=[];_.series&&P.push(`${_.series} series`),_.repeticiones&&P.push(`${_.repeticiones} reps`),_.duracion&&P.push(`${_.duracion}`),P.length>0&&(i+=`   ${P.join(" | ")}
`),_.observaciones&&(i+=`   \u{1F4DD} ${_.observaciones}
`),i+=`
`})):(console.log("\u26A0\uFE0F Estructura de ejercicios no reconocida:",typeof t.ejercicios),i+=`INFORMACI\xD3N DE EJERCICIOS
`,i+=`\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500

`,i+=`Los ejercicios est\xE1n disponibles en la base de datos.
`,i+=`Consulte con su terapeuta para obtener el plan de ejercicios detallado.

`))}else console.log("\u2139\uFE0F No hay ejercicios en BD o estructura vac\xEDa"),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                    PLAN DE EJERCICIOS
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`El plan de ejercicios detallado est\xE1 disponible con su terapeuta.
`,i+=`Consulte directamente para obtener las instrucciones espec\xEDficas.

`;return t.contraindicaciones&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                     CONTRAINDICACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.contraindicaciones}

`),t.criterios_progresion&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                   CRITERIOS DE PROGRESI\xD3N
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.criterios_progresion}

`),t.recomendaciones&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      RECOMENDACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.recomendaciones}

`),t.observaciones&&t.observaciones!=="Para informaci\xF3n detallada de ejercicios y contraindicaciones, consulte con su terapeuta"&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      OBSERVACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.observaciones}

`),e?.notas_individuales&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                   MIS NOTAS PERSONALES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${e.notas_individuales}

`),e&&(e.nivel_dolor_actual!==void 0||e.nivel_funcionalidad_actual!==void 0)&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                     EVALUACI\xD3N ACTUAL
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,e.nivel_dolor_actual!==void 0&&e.nivel_dolor_actual>0&&(i+=`Nivel de dolor: ${e.nivel_dolor_actual}/10
`),e.nivel_funcionalidad_actual!==void 0&&e.nivel_funcionalidad_actual>0&&(i+=`Funcionalidad: ${e.nivel_funcionalidad_actual}%
`),i+=`
`),t.tags&&Array.isArray(t.tags)&&t.tags.length>0&&(i+=`Tags: ${t.tags.map(o=>`#${o}`).join(" ")}

`),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`\xDAltima actualizaci\xF3n: ${this.formatDate(new Date().toISOString())}
`,i+=`Generado por: rehabiMovement - Sistema de Rehabilitaci\xF3n
`,i+=`ID de Terapia: ${t.id||e?.terapia_id||"N/A"}
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,console.log("\u2705 Texto generado con datos reales de BD"),i}crearTerapiaBasica(t){return{id:t.terapia_id,nombre:t.terapia_nombre,descripcion:t.terapia_descripcion||"Informaci\xF3n detallada disponible con el terapeuta",tipo:t.terapia_tipo,nivel:t.terapia_nivel,duracion_estimada:t.duracion_estimada,area_especializacion:this.obtenerAreaEspecializacion(t.terapia_tipo),ejercicios:null,objetivo_principal:null,contraindicaciones:null,criterios_progresion:null,recomendaciones:null,observaciones:"Para informaci\xF3n detallada de ejercicios y contraindicaciones, consulte con su terapeuta"}}obtenerAreaEspecializacion(t){switch(t.toLowerCase()){case"fisica":return"Fisioterapia";case"ocupacional":return"Terapia Ocupacional";case"respiratoria":return"Fisioterapia Respiratoria";case"neurologica":return"Neurorehabilitaci\xF3n";default:return"Rehabilitaci\xF3n General"}}formatDiasRestantes(t){return t==null?"No disponible":t<0?`Vencida hace ${Math.abs(t)} d\xEDa${Math.abs(t)!==1?"s":""}`:t===0?"Vence hoy":t===1?"Vence ma\xF1ana":`${t} d\xEDas restantes`}getFileName(t){return!t||!t.nombre?"mi_terapia.txt":t.nombre.replace(/\s+/g,"_")+"_mi_terapia.txt"}copyToClipboard(t){return h(this,null,function*(){try{yield navigator.clipboard.writeText(t),this.copySuccess=!0,console.log("Texto copiado al portapapeles"),setTimeout(()=>{this.copySuccess=!1},2e3)}catch(e){console.error("Error al copiar al portapapeles:",e),this.fallbackCopyTextToClipboard(t)}})}fallbackCopyTextToClipboard(t){let e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")&&(this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3))}catch(i){console.error("Fallback: Error al copiar al portapapeles:",i)}document.body.removeChild(e)}trackByDate(t,e){return e.fecha.toISOString()}trackByTerapia(t,e){return e.seguimiento.seguimiento_id||t}getColorTerapia(t){switch(t.estado_temporal){case"vigente":return"bg-green-500 border-green-600";case"pendiente":return"bg-blue-500 border-blue-600";case"vencida":return"bg-red-500 border-red-600";default:return"bg-gray-500 border-gray-600"}}getColorTextoTerapia(t){switch(t.estado_temporal){case"vigente":return"text-green-700";case"pendiente":return"text-blue-700";case"vencida":return"text-red-700";default:return"text-gray-700"}}getIconoEstado(t){switch(t.estado_individual){case"completada":return"\u2713";case"en_progreso":return"\u23F3";case"pendiente":return"\u25CB";case"abandonada":return"\u2717";default:return"\u25CB"}}formatearProgreso(t){return`${t}%`}getTipoTerapiaCorto(t){switch(t.toLowerCase()){case"fisica":return"FIS";case"ocupacional":return"OCP";case"respiratoria":return"RSP";case"neurologica":return"NEU";default:return t.substring(0,3).toUpperCase()}}getDiasRestantesTexto(t){return t<0?`Vencida hace ${Math.abs(t)} d\xEDas`:t===0?"Vence hoy":t===1?"Vence ma\xF1ana":`${t} d\xEDas restantes`}exportarTerapia(t,e){if(!t){console.warn("No hay terapia para exportar");return}let i=this.getFormattedTerapia(t,e);if(!i){console.warn("No se pudo generar el contenido para exportar");return}let o=new Blob([i],{type:"text/plain;charset=utf-8"}),c=window.URL.createObjectURL(o),_=document.createElement("a");_.href=c,_.download=`${t.nombre.replace(/\s+/g,"_")}_mi_terapia.txt`,_.click(),window.URL.revokeObjectURL(c),console.log("Mi terapia exportada desde calendario:",t.nombre),this.mostrarNotificacionExito("Terapia exportada correctamente")}mostrarNotificacionExito(t){this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3)}getEstadoColorClass(t){return this.getColorByEstado(t)}getEstadoTextColorClass(t){switch(t){case"vigente":return"text-green-600";case"pendiente":return"text-blue-600";case"vencida":return"text-red-600";default:return"text-gray-600"}}esFechaSeleccionada(t){return!1}formatearFecha(t){return t.toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}debugTerapias(){console.log("\u{1F50D} DEBUG: Informaci\xF3n del calendario de terapias"),console.log("Total de terapias:",this.terapias.length),console.log("Mes actual:",this.meses[this.mesActual.getMonth()],this.mesActual.getFullYear()),console.log("D\xEDas con terapias:",this.diasCalendario.filter(t=>t.terapias.length>0).length),this.terapias.forEach((t,e)=>{console.log(`Terapia ${e+1}:`,{nombre:t.terapia_nombre,tipo:t.terapia_tipo,estado:t.estado_temporal,progreso:t.progreso,inicio:t.fecha_inicio_programada,fin:t.fecha_fin_programada})})}hayTerapiasEnRango(t,e){return this.terapias.some(i=>{let o=new Date(i.fecha_inicio_programada),c=new Date(i.fecha_fin_programada);return o>=t&&o<=e||c>=t&&c<=e||o<=t&&c>=e})}static \u0275fac=function(e){return new(e||a)(I(Ve))};static \u0275cmp=A({type:a,selectors:[["app-calendario-terapias"]],inputs:{terapias:"terapias"},outputs:{volverAVista:"volverAVista",abrirTerapia:"abrirTerapia"},standalone:!1,features:[Ge],decls:100,vars:9,consts:[[1,"max-w-7xl","mx-auto"],[1,"bg-white","rounded-lg","shadow","mb-6"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"flex","items-center","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"flex","items-center","space-x-4"],[1,"p-2","rounded-full","hover:bg-gray-100","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-xl","font-semibold","text-gray-900","min-w-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3a2 2 0 012-2h8a2 2 0 012 2v4m-4 0V3m-4 4h8m-8 0H6a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-2"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],[1,"grid","grid-cols-7","bg-gray-50","border-b","border-gray-200"],["class","px-4 py-3 text-center text-sm font-medium text-gray-700 border-r border-gray-200 last:border-r-0",4,"ngFor","ngForOf"],[1,"grid","grid-cols-7"],["class","min-h-[120px] border-r border-b border-gray-200 last:border-r-0 p-2 relative",3,"bg-gray-50","bg-blue-50",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-6","bg-white","rounded-lg","shadow","p-4"],[1,"text-sm","font-medium","text-gray-900","mb-3"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-xs","font-medium","text-gray-700","mb-2"],[1,"space-y-1","text-xs"],[1,"flex","items-center","space-x-2"],[1,"w-3","h-3","bg-green-500","rounded","border","border-green-600"],[1,"w-3","h-3","bg-blue-500","rounded","border","border-blue-600"],[1,"w-3","h-3","bg-red-500","rounded","border","border-red-600"],[1,"font-medium"],[1,"mt-4","text-center","text-sm","text-gray-500"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],[1,"px-4","py-3","text-center","text-sm","font-medium","text-gray-700","border-r","border-gray-200","last:border-r-0"],[1,"min-h-[120px]","border-r","border-b","border-gray-200","last:border-r-0","p-2","relative"],[1,"flex","items-center","justify-between","mb-1"],[1,"text-sm","font-medium"],["class","w-2 h-2 bg-blue-500 rounded-full",4,"ngIf"],[1,"space-y-1"],["class","group cursor-pointer",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-xs text-gray-500 text-center mt-1",4,"ngIf"],[1,"w-2","h-2","bg-blue-500","rounded-full"],[1,"group","cursor-pointer",3,"click"],["class","text-xs rounded-lg p-2 border-l-4 hover:shadow-md transition-all duration-200 transform hover:-translate-y-0.5",3,"ngClass",4,"ngIf"],[1,"text-xs","rounded-lg","p-2","border-l-4","hover:shadow-md","transition-all","duration-200","transform","hover:-translate-y-0.5",3,"ngClass"],[1,"flex","items-center","space-x-1"],[1,"font-medium","text-white"],[1,"font-medium","text-white","text-xs"],[1,"text-white","text-xs","font-medium"],[1,"text-white","font-medium","mb-1","line-clamp-2",3,"title"],[1,"text-white","text-xs","opacity-90","space-y-0.5"],[4,"ngIf"],[1,"w-full","bg-white","bg-opacity-20","rounded-full","h-1","mt-1"],[1,"bg-white","h-1","rounded-full","transition-all","duration-300"],[1,"text-xs","text-gray-500","text-center","mt-1"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-5xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"text-sm","text-gray-500"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900","flex","items-center"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-2"],[1,"bg-blue-600","h-2","rounded-full"],[1,"text-gray-900"],[1,"bg-gray-900","text-green-400","rounded-lg","p-6","font-mono","text-sm","overflow-auto","max-h-96","relative",2,"font-family","'Courier New', monospace","line-height","1.6"],[1,"absolute","inset-15","flex","items-center","justify-center","pointer-events-none","opacity-25"],["src","/rh.png","alt","RehabiMovement",1,"max-w-50","max-h-50","object-contain","transform","rotate-12","select-none"],[1,"flex","items-center","justify-between","mb-4","pb-2","border-b","border-gray-700","relative","z-10"],[1,"flex","space-x-2"],[1,"w-3","h-3","bg-red-500","rounded-full"],[1,"w-3","h-3","bg-yellow-500","rounded-full"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-gray-400","text-xs"],[1,"whitespace-pre-wrap","text-white","relative","z-10"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-green-700"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),f("click",function(){return i.onVolverAVista()}),b(),n(5,"svg",5),p(6,"path",6),r(),s(7," Volver a tarjetas "),r(),y(),n(8,"div",7)(9,"button",8),f("click",function(){return i.mesAnterior()}),b(),n(10,"svg",9),p(11,"path",10),r()(),y(),n(12,"h2",11),s(13),r(),n(14,"button",8),f("click",function(){return i.mesSiguiente()}),b(),n(15,"svg",9),p(16,"path",12),r()()(),y(),n(17,"button",4),f("click",function(){return i.irAHoy()}),b(),n(18,"svg",5),p(19,"path",13),r(),s(20," Hoy "),r()()()(),y(),n(21,"div",14)(22,"div",15),x(23,Ga,2,1,"div",16),r(),n(24,"div",17),x(25,Xa,8,17,"div",18),r()(),n(26,"div",19)(27,"h3",20),s(28,"Leyenda"),r(),n(29,"div",21)(30,"div")(31,"h4",22),s(32,"Estado Temporal:"),r(),n(33,"div",23)(34,"div",24),p(35,"div",25),n(36,"span"),s(37,"Vigente"),r()(),n(38,"div",24),p(39,"div",26),n(40,"span"),s(41,"Pendiente"),r()(),n(42,"div",24),p(43,"div",27),n(44,"span"),s(45,"Vencida"),r()()()(),n(46,"div")(47,"h4",22),s(48,"Estado Individual:"),r(),n(49,"div",23)(50,"div",24)(51,"span",28),s(52,"\u2713"),r(),n(53,"span"),s(54,"Completada"),r()(),n(55,"div",24)(56,"span",28),s(57,"\u23F3"),r(),n(58,"span"),s(59,"En Progreso"),r()(),n(60,"div",24)(61,"span",28),s(62,"\u25CB"),r(),n(63,"span"),s(64,"Sin Iniciar"),r()(),n(65,"div",24)(66,"span",28),s(67,"\u2717"),r(),n(68,"span"),s(69,"Abandonada"),r()()()(),n(70,"div")(71,"h4",22),s(72,"Tipos de Terapia:"),r(),n(73,"div",23)(74,"div",24)(75,"span",28),s(76,"FIS"),r(),n(77,"span"),s(78,"F\xEDsica"),r()(),n(79,"div",24)(80,"span",28),s(81,"OCP"),r(),n(82,"span"),s(83,"Ocupacional"),r()(),n(84,"div",24)(85,"span",28),s(86,"RSP"),r(),n(87,"span"),s(88,"Respiratoria"),r()(),n(89,"div",24)(90,"span",28),s(91,"NEU"),r(),n(92,"span"),s(93,"Neurol\xF3gica"),r()()()()()(),n(94,"div",29)(95,"p")(96,"strong"),s(97),r(),s(98),r()()(),x(99,es,67,18,"div",30)),e&2&&(l(13),z(" ",i.meses[i.mesActual.getMonth()]," ",i.mesActual.getFullYear()," "),l(10),m("ngForOf",i.diasSemana),l(2),m("ngForOf",i.diasCalendario)("ngForTrackBy",i.trackByDate),l(72),w(i.terapias.length),l(),z(" terapia",i.terapias.length!==1?"s":""," asignada",i.terapias.length!==1?"s":""," \u2022 Haz clic en una terapia para ver los detalles completos "),l(),m("ngIf",i.showViewModal))},dependencies:[$,N,R],styles:[".calendario-container[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.celda-calendario[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.celda-calendario[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.terapia-evento[_ngcontent-%COMP%]{font-size:.75rem;line-height:1.2;border-radius:.25rem;transition:all .15s ease-in-out}.terapia-evento[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.terapia-vigente[_ngcontent-%COMP%]{border-left:3px solid #10b981;background-color:#ecfdf5}.terapia-pendiente[_ngcontent-%COMP%]{border-left:3px solid #3b82f6;background-color:#eff6ff}.terapia-vencida[_ngcontent-%COMP%]{border-left:3px solid #ef4444;background-color:#fef2f2}.dia-actual[_ngcontent-%COMP%]{background-color:#dbeafe!important;border:2px solid #3b82f6}.dia-actual[_ngcontent-%COMP%]   .numero-dia[_ngcontent-%COMP%]{color:#1d4ed8;font-weight:700}.nav-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.nav-button[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;transform:scale(1.05)}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.terminal-display[_ngcontent-%COMP%]{font-family:Courier New,Consolas,Monaco,monospace;background:linear-gradient(135deg,#1f2937,#111827)}.terminal-display[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{white-space:pre-wrap;word-wrap:break-word}.terminal-display[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.terminal-display[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#374151;border-radius:4px}.terminal-display[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#6b7280;border-radius:4px}.terminal-display[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}@media (max-width: 768px){.terapia-evento[_ngcontent-%COMP%]{font-size:.65rem;padding:.25rem}.celda-calendario[_ngcontent-%COMP%]{min-height:6rem}}@media print{.nav-button[_ngcontent-%COMP%], .modal-backdrop[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]{display:none!important}.calendario-container[_ngcontent-%COMP%]{margin:0;box-shadow:none}}.terapia-evento[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}.nav-button[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}.loading-skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}.watermark[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;user-select:none;opacity:.1;filter:grayscale(100%)}",".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}"]})};var is=(a,t,e,i)=>({"bg-gray-100 text-gray-800":a,"bg-yellow-100 text-yellow-800":t,"bg-green-100 text-green-800":e,"bg-red-100 text-red-800":i});function ns(a,t){if(a&1){let e=C();n(0,"div")(1,"app-calendario-terapias",18),f("volverAVista",function(){u(e);let o=d();return g(o.onVolverDeCalendario())})("abrirTerapia",function(o){u(e);let c=d();return g(c.onAbrirTerapiaDesdeCalendario(o))}),r()()}if(a&2){let e=d();l(),m("terapias",e.filteredTerapias)}}function rs(a,t){if(a&1&&(n(0,"div",40)(1,"div",41),b(),n(2,"svg",42),p(3,"path",43),r(),y(),n(4,"div",44)(5,"p",45),s(6),r()()()()),a&2){let e=d(2);l(6),w(e.error)}}function os(a,t){a&1&&(n(0,"div",46),p(1,"div",47),r())}function as(a,t){if(a&1&&(n(0,"div",69)(1,"span"),s(2,"Adherencia:"),r(),n(3,"span"),s(4),r()()),a&2){let e=d(2).$implicit;l(4),v("",e.adherencia_porcentaje,"%")}}function ss(a,t){if(a&1&&(n(0,"div",68)(1,"div",69)(2,"span"),s(3,"Sesiones:"),r(),n(4,"span"),s(5),r()(),x(6,as,5,1,"div",82),r()),a&2){let e=d().$implicit;l(5),z("",e.sesiones_completadas," / ",e.sesiones_programadas,""),l(),m("ngIf",e.adherencia_porcentaje!==void 0)}}function ls(a,t){if(a&1&&(n(0,"div"),s(1),r()),a&2){let e=d(2).$implicit,i=d(3);l(),v(" Iniciado: ",i.formatDate(e.fecha_inicio_real)," ")}}function cs(a,t){if(a&1&&(n(0,"div"),s(1),r()),a&2){let e=d(2).$implicit,i=d(3);l(),v(" Completado: ",i.formatDate(e.fecha_fin_real)," ")}}function ds(a,t){if(a&1&&(n(0,"div",83),x(1,ls,2,1,"div",15)(2,cs,2,1,"div",15),r()),a&2){let e=d().$implicit;l(),m("ngIf",e.fecha_inicio_real),l(),m("ngIf",e.fecha_fin_real)}}function ms(a,t){if(a&1&&(n(0,"div",84)(1,"p",85)(2,"strong"),s(3,"Mis notas:"),r(),s(4),r()()),a&2){let e=d().$implicit;l(4),v(" ",e.notas_individuales," ")}}function ps(a,t){if(a&1){let e=C();n(0,"div",50)(1,"div")(2,"div",51)(3,"div",52)(4,"h3",53),s(5),r(),n(6,"p",54),s(7),r()(),n(8,"span",55),s(9),r()()(),n(10,"div",56)(11,"div",57)(12,"div",58)(13,"span",59),s(14,"Mi Progreso"),r(),n(15,"span",60),s(16),r()(),n(17,"div",61),p(18,"div",62),r(),n(19,"div",63)(20,"input",64),f("input",function(o){let c=u(e).$implicit,_=d(3);return g(_.actualizarMiProgreso(c,+o.target.value))}),r()()(),n(21,"div",65)(22,"span",66),s(23),r(),n(24,"span",67),s(25),r()(),n(26,"div",68)(27,"div",69)(28,"span"),s(29,"Inicio:"),r(),n(30,"span"),s(31),r()(),n(32,"div",69)(33,"span"),s(34,"Fin:"),r(),n(35,"span"),s(36),r()(),n(37,"div",70)(38,"span"),s(39,"D\xEDas restantes:"),r(),n(40,"span"),s(41),r()()(),n(42,"div",65)(43,"span",71),s(44),r(),n(45,"span",67),s(46),r()(),x(47,ss,7,3,"div",72)(48,ds,3,2,"div",73)(49,ms,5,1,"div",74),n(50,"div",75)(51,"button",76),f("click",function(){let o=u(e).$implicit,c=d(3);return g(c.openViewModal(o))}),b(),n(52,"svg",77),p(53,"path",78)(54,"path",79),r()(),y(),n(55,"button",80),f("click",function(){let o=u(e).$implicit,c=d(3);return g(c.safeExportTerapia(o))}),b(),n(56,"svg",77),p(57,"path",81),r()()()()()}if(a&2){let e=t.$implicit,i=d(3);O("border-green-500",e.estado_temporal==="vigente")("border-blue-500",e.estado_temporal==="pendiente")("border-red-500",e.estado_temporal==="vencida"),l(),D("px-6 py-4 "+(e.estado_temporal==="vigente"?"bg-gradient-to-r from-green-500 to-green-600":e.estado_temporal==="pendiente"?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gradient-to-r from-red-500 to-red-600")),l(4),w(e.terapia_nombre),l(2),w(e.terapia_descripcion),l(2),v(" ",i.getEstadoTemporalText(e.estado_temporal)," "),l(7),v("",e.progreso,"%"),l(2),Y("width",e.progreso,"%"),O("bg-gray-400",e.progreso===0)("bg-red-400",e.progreso>0&&e.progreso<30)("bg-yellow-400",e.progreso>=30&&e.progreso<70)("bg-green-400",e.progreso>=70),l(2),m("value",e.progreso),l(2),m("ngClass",ve(40,is,e.estado_individual==="pendiente",e.estado_individual==="en_progreso",e.estado_individual==="completada",e.estado_individual==="abandonada")),l(),v(" ",i.getEstadoIndividualText(e.estado_individual)," "),l(2),w(e.terapia_nivel),l(6),w(i.formatDate(e.fecha_inicio_programada)),l(5),w(i.formatDate(e.fecha_fin_programada)),l(),O("text-green-600",e.dias_restantes>7)("text-yellow-600",e.dias_restantes<=7&&e.dias_restantes>0)("text-red-600",e.dias_restantes<=0),l(4),w(i.formatDiasRestantes(e.dias_restantes)),l(3),v(" ",e.terapia_tipo," "),l(2),w(i.formatDuracion(e.duracion_estimada)),l(),m("ngIf",e.sesiones_completadas!==void 0&&e.sesiones_programadas!==void 0),l(),m("ngIf",e.fecha_inicio_real||e.fecha_fin_real),l(),m("ngIf",e.notas_individuales)}}function us(a,t){if(a&1&&(n(0,"div",48),x(1,ps,58,45,"div",49),r()),a&2){let e=d(2);l(),m("ngForOf",e.filteredTerapias)("ngForTrackBy",e.trackByTerapiaId)}}function gs(a,t){a&1&&(fe(0),s(1," No tienes terapias asignadas en este momento. "),_e())}function fs(a,t){a&1&&s(0," No se encontraron terapias con los filtros aplicados. ")}function _s(a,t){if(a&1){let e=C();n(0,"button",94),f("click",function(){u(e);let o=d(3);return g(o.clearFilters())}),s(1," Limpiar filtros "),r()}}function xs(a,t){if(a&1&&(n(0,"div",86),b(),n(1,"svg",87),p(2,"path",88),r(),y(),n(3,"h3",89),s(4,"No hay terapias asignadas"),r(),n(5,"p",90),x(6,gs,2,0,"ng-container",91)(7,fs,1,0,"ng-template",null,0,oe),r(),n(9,"div",92),x(10,_s,2,0,"button",93),r()()),a&2){let e=X(8),i=d(2);l(6),m("ngIf",i.misTerapias.length===0)("ngIfElse",e),l(4),m("ngIf",i.misTerapias.length>0)}}function vs(a,t){if(a&1){let e=C();n(0,"div")(1,"div",19)(2,"div",20)(3,"div",21)(4,"label",22),s(5,"Buscar"),r(),n(6,"input",23),k("ngModelChange",function(o){u(e);let c=d();return E(c.searchTerm,o)||(c.searchTerm=o),g(o)}),f("input",function(){u(e);let o=d();return g(o.onSearch())}),r()(),n(7,"div")(8,"label",22),s(9,"Per\xEDodo"),r(),n(10,"select",24),k("ngModelChange",function(o){u(e);let c=d();return E(c.estadoFilter,o)||(c.estadoFilter=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.onFilterChange())}),n(11,"option",25),s(12,"Todos"),r(),n(13,"option",26),s(14,"Vigentes"),r(),n(15,"option",27),s(16,"Pendientes"),r(),n(17,"option",28),s(18,"Vencidas"),r()()(),n(19,"div")(20,"label",22),s(21,"Mi Estado"),r(),n(22,"select",24),k("ngModelChange",function(o){u(e);let c=d();return E(c.estadoIndividualFilter,o)||(c.estadoIndividualFilter=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.onFilterChange())}),n(23,"option",25),s(24,"Todos"),r(),n(25,"option",27),s(26,"Pendiente"),r(),n(27,"option",29),s(28,"En Progreso"),r(),n(29,"option",30),s(30,"Completada"),r(),n(31,"option",31),s(32,"Abandonada"),r()()(),n(33,"div")(34,"label",22),s(35,"Progreso"),r(),n(36,"select",24),k("ngModelChange",function(o){u(e);let c=d();return E(c.progresoFilter,o)||(c.progresoFilter=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.onFilterChange())}),n(37,"option",25),s(38,"Todos"),r(),n(39,"option",32),s(40,"Sin Iniciar (0%)"),r(),n(41,"option",29),s(42,"En Progreso (1-99%)"),r(),n(43,"option",33),s(44,"Completado (100%)"),r()()()(),n(45,"div",34)(46,"button",35),f("click",function(){u(e);let o=d();return g(o.clearFilters())}),s(47," Limpiar filtros "),r()()(),x(48,rs,7,1,"div",36)(49,os,2,0,"div",37)(50,us,2,2,"div",38)(51,xs,11,3,"div",39),r()}if(a&2){let e=d();l(6),M("ngModel",e.searchTerm),l(4),M("ngModel",e.estadoFilter),l(12),M("ngModel",e.estadoIndividualFilter),l(14),M("ngModel",e.progresoFilter),l(12),m("ngIf",e.error&&!e.showViewModal),l(),m("ngIf",e.loading),l(),m("ngIf",!e.loading),l(),m("ngIf",!e.loading&&e.filteredTerapias.length===0)}}function bs(a,t){a&1&&(n(0,"div",130)(1,"div",41),b(),n(2,"svg",131),p(3,"path",132),r(),y(),n(4,"div",44)(5,"p",133),s(6,"\xA1Terapia copiada al portapapeles!"),r()()()())}function hs(a,t){if(a&1){let e=C();n(0,"div",95)(1,"div",96)(2,"div",97),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),r(),n(3,"span",98),s(4,"\u200B"),r(),n(5,"div",99)(6,"div",100)(7,"div",101)(8,"div",102),b(),n(9,"svg",103),p(10,"path",88),r()(),y(),n(11,"div",104)(12,"h3",105),s(13),r(),n(14,"div",106)(15,"p",67),s(16),r()()()()(),n(17,"div",107)(18,"div",108)(19,"div",109)(20,"div")(21,"span",110),s(22,"Mi Progreso:"),r(),n(23,"div",111)(24,"div",112),p(25,"div",113),r(),s(26),r()(),n(27,"div")(28,"span",110),s(29,"Estado:"),r(),n(30,"div",114),s(31),r()(),n(32,"div")(33,"span",110),s(34,"Per\xEDodo:"),r(),n(35,"div",114),s(36),r()(),n(37,"div")(38,"span",110),s(39,"D\xEDas restantes:"),r(),n(40,"div",114),s(41),r()()()(),n(42,"div",115)(43,"div",116),p(44,"img",117),r(),n(45,"div",118)(46,"div",6),p(47,"div",119)(48,"div",120)(49,"div",121),r(),n(50,"div",122),s(51),r()(),n(52,"pre",123),s(53),r()(),x(54,bs,7,0,"div",124),n(55,"div",125)(56,"button",126),f("click",function(){let o;u(e);let c=d();return g(c.copyToClipboard(c.getFormattedTerapia(c.selectedTerapia,(o=c.selectedSeguimiento)!==null&&o!==void 0?o:void 0)))}),b(),n(57,"svg",127),p(58,"path",81),r(),s(59," Descargar "),r()()(),y(),n(60,"div",128)(61,"button",129),f("click",function(){u(e);let o=d();return g(o.closeViewModal())}),s(62," Cerrar "),r()()()()()}if(a&2){let e=d();l(13),v(" ",e.selectedTerapia==null?null:e.selectedTerapia.nombre," "),l(3),v(" Mi terapia asignada - Progreso: ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(9),Y("width",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"%"),l(),v(" ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(5),w(e.getEstadoIndividualText((e.selectedSeguimiento==null?null:e.selectedSeguimiento.estado_individual)||"")),l(5),z(" ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_inicio_programada)," - ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_fin_programada)," "),l(4),O("text-green-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>7)("text-yellow-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=7&&((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0)("text-red-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=0),l(),v(" ",e.formatDiasRestantes((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)," "),l(10),v(" ",e.getFileName(e.selectedTerapia)," "),l(2),w(e.getFormattedTerapia(e.selectedTerapia,e.selectedSeguimiento||void 0)),l(),m("ngIf",e.copySuccess)}}function Cs(a,t){a&1&&(b(),n(0,"svg",145),p(1,"path",132),r())}function ws(a,t){a&1&&(b(),n(0,"svg",145),p(1,"path",144),r())}function ys(a,t){a&1&&(b(),n(0,"svg",145),p(1,"path",146),r())}function Ss(a,t){a&1&&(b(),n(0,"svg",145),p(1,"path",147),r())}function Ms(a,t){if(a&1){let e=C();n(0,"div")(1,"div",134)(2,"div",135)(3,"div",136)(4,"div",137),x(5,Cs,2,0,"svg",138)(6,ws,2,0,"svg",138)(7,ys,2,0,"svg",138)(8,Ss,2,0,"svg",138),r(),n(9,"div",139)(10,"p",140),s(11),r()(),n(12,"div",141)(13,"button",142),f("click",function(){u(e);let o=d();return g(o.cerrarNotificacion())}),b(),n(14,"svg",143),p(15,"path",144),r()()()()()()()}if(a&2){let e=d();D("fixed top-4 right-4 z-50 max-w-sm w-full shadow-lg rounded-lg pointer-events-auto "+(e.tipoMensaje==="success"?"bg-green-500":e.tipoMensaje==="error"?"bg-red-500":e.tipoMensaje==="warning"?"bg-yellow-500":"bg-blue-500")),l(5),m("ngIf",e.tipoMensaje==="success"),l(),m("ngIf",e.tipoMensaje==="error"),l(),m("ngIf",e.tipoMensaje==="info"),l(),m("ngIf",e.tipoMensaje==="warning"),l(3),w(e.mensaje)}}var vt=class a{constructor(t,e){this.terapiasService=t;this.authService=e}vistaActual="calendario";misTerapias=[];filteredTerapias=[];estadisticasPersonales;loading=!1;error="";showViewModal=!1;selectedTerapia=null;selectedSeguimiento=null;copySuccess=!1;mensaje="";tipoMensaje="info";mostrarMensaje=!1;searchTerm="";estadoFilter="all";estadoIndividualFilter="all";progresoFilter="all";ngOnInit(){return h(this,null,function*(){yield Promise.all([this.loadMisTerapias(),this.loadEstadisticasPersonales()])})}get mostrarVistaTarjetas(){return this.vistaActual==="tarjetas"}get mostrarVistaCalendario(){return this.vistaActual==="calendario"}onCambiarACalendario(){console.log("Cambiando a vista de calendario"),this.vistaActual="calendario"}onCambiarATarjetas(){console.log("Cambiando a vista de tarjetas"),this.vistaActual="tarjetas"}onVolverDeCalendario(){console.log("Volviendo de calendario a tarjetas"),this.vistaActual="tarjetas"}onAbrirTerapiaDesdeCalendario(t){console.log("Abriendo terapia desde calendario:",t.terapia_nombre),this.vistaActual="tarjetas",setTimeout(()=>{this.openViewModal(t)},100)}loadMisTerapias(){return h(this,null,function*(){this.loading=!0,this.error="";try{console.log("Cargando terapias asignadas al usuario...");let t=this.authService.getCurrentUser();if(!t?.id)throw new Error("No se pudo obtener el usuario actual");console.log("Usuario actual:",t.id);let e=[];try{e=(yield this.terapiasService.getTerapiasAsignadasUsuarios()).filter(o=>o.id_profile===t.id),console.log("Terapias filtradas para el usuario:",e.length)}catch(i){console.warn("Error con el servicio principal, intentando m\xE9todo alternativo:",i),e=[]}this.misTerapias=e.map(i=>{let o=this.convertirFechaAString(i.fecha_inicio_programada),c=this.convertirFechaAString(i.fecha_fin_programada),{estado:_,diasRestantes:S}=this.calcularEstadoTemporal(o,c);return{seguimiento_id:i.seguimiento_id,asignacion_id:i.asignacion_id,id_profile:i.id_profile,username:i.username||t.username||"",full_name:i.full_name||t.full_name||"",terapia_nombre:i.terapia_nombre,terapia_id:i.id_terapia||0,terapia_descripcion:i.terapia_descripcion,terapia_tipo:i.terapia_tipo,terapia_nivel:i.terapia_nivel,duracion_estimada:i.duracion_estimada,progreso:i.progreso||0,estado_individual:i.estado_individual||"pendiente",fecha_inicio_real:this.convertirFechaAString(i.fecha_inicio_real),fecha_fin_real:this.convertirFechaAString(i.fecha_fin_real),fecha_inicio_programada:o,fecha_fin_programada:c,notas_individuales:i.notas_individuales,estado_temporal:_,dias_restantes:S,sesiones_completadas:i.sesiones_completadas||0,sesiones_programadas:i.sesiones_programadas||0,adherencia_porcentaje:i.adherencia_porcentaje||0,nivel_dolor_actual:i.nivel_dolor_actual||0,nivel_funcionalidad_actual:i.nivel_funcionalidad_actual||0}}),this.filteredTerapias=[...this.misTerapias],this.applyFilters(),console.log("Mis terapias cargadas:",this.misTerapias.length)}catch(t){console.error("Error cargando mis terapias:",t),this.error="Error al cargar tus terapias asignadas",this.misTerapias=[],this.filteredTerapias=[]}finally{this.loading=!1}})}loadEstadisticasPersonales(){return h(this,null,function*(){try{if(this.misTerapias.length===0)return;let t=this.misTerapias.length,e=this.misTerapias.filter(B=>B.estado_temporal==="vigente").length,i=this.misTerapias.filter(B=>B.estado_individual==="completada").length,o=this.misTerapias.filter(B=>B.estado_individual==="en_progreso").length,c=this.misTerapias.filter(B=>B.estado_individual==="pendiente").length,_=this.misTerapias.filter(B=>B.estado_temporal==="vencida").length,S=this.misTerapias.reduce((B,ie)=>B+ie.progreso,0),P=t>0?Math.round(S/t):0,T=this.misTerapias.reduce((B,ie)=>B+(ie.adherencia_porcentaje||0),0),L=t>0?Math.round(T/t):0,V=this.misTerapias.reduce((B,ie)=>B+(ie.sesiones_completadas||0),0);this.estadisticasPersonales={total_terapias_asignadas:t,terapias_vigentes:e,terapias_completadas:i,terapias_en_progreso:o,terapias_pendientes:c,terapias_vencidas:_,progreso_promedio:P,adherencia_promedio:L,sesiones_completadas_total:V}}catch(t){console.error("Error calculando estad\xEDsticas personales:",t)}})}applyFilters(){let t=[...this.misTerapias];if(this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.terapia_nombre.toLowerCase().includes(e)||i.terapia_descripcion?.toLowerCase().includes(e)||i.terapia_tipo.toLowerCase().includes(e))}if(this.estadoFilter!=="all"&&(t=t.filter(e=>e.estado_temporal===this.estadoFilter)),this.estadoIndividualFilter!=="all"&&(t=t.filter(e=>e.estado_individual===this.estadoIndividualFilter)),this.progresoFilter!=="all")switch(this.progresoFilter){case"sin_iniciar":t=t.filter(e=>e.progreso===0);break;case"en_progreso":t=t.filter(e=>e.progreso>0&&e.progreso<100);break;case"completado":t=t.filter(e=>e.progreso===100);break}this.filteredTerapias=t}openViewModal(t){return h(this,null,function*(){console.log("Abriendo modal para ver terapia:",t.terapia_nombre),this.selectedSeguimiento=t;try{console.log("Cargando terapia completa desde BD para ID:",t.terapia_id);let e=yield this.terapiasService.getTerapiaById(t.terapia_id);e?(console.log("\u2705 Terapia completa cargada desde BD:",e),this.selectedTerapia=e):(console.warn("\u26A0\uFE0F No se encontr\xF3 terapia en BD, usando informaci\xF3n b\xE1sica"),this.selectedTerapia=this.crearTerapiaBasica(t))}catch(e){console.error("\u274C Error cargando terapia completa desde BD:",e),this.selectedTerapia=this.crearTerapiaBasica(t)}this.showViewModal=!0})}crearTerapiaBasica(t){return{id:t.terapia_id,nombre:t.terapia_nombre,descripcion:t.terapia_descripcion||"Informaci\xF3n detallada disponible con el terapeuta",tipo:t.terapia_tipo,nivel:t.terapia_nivel,duracion_estimada:t.duracion_estimada,area_especializacion:this.obtenerAreaEspecializacion(t.terapia_tipo),ejercicios:null,objetivo_principal:null,contraindicaciones:null,criterios_progresion:null,recomendaciones:null,observaciones:"Para informaci\xF3n detallada de ejercicios y contraindicaciones, consulte con su terapeuta"}}obtenerAreaEspecializacion(t){switch(t.toLowerCase()){case"fisica":return"Fisioterapia";case"ocupacional":return"Terapia Ocupacional";case"respiratoria":return"Fisioterapia Respiratoria";case"neurologica":return"Neurorehabilitaci\xF3n";default:return"Rehabilitaci\xF3n General"}}closeViewModal(){console.log("Cerrando modal de vista"),this.showViewModal=!1,this.selectedTerapia=null,this.selectedSeguimiento=null,this.copySuccess=!1}actualizarMiProgreso(t,e){return h(this,null,function*(){try{(yield this.terapiasService.actualizarProgresoTerapia(t.seguimiento_id,{progreso:e,estado_individual:this.determinarEstadoPorProgreso(e),sesiones_completadas:t.sesiones_completadas||0,adherencia_porcentaje:t.adherencia_porcentaje||0,nivel_dolor_actual:t.nivel_dolor_actual||0,nivel_funcionalidad_actual:t.nivel_funcionalidad_actual||0,notas_individuales:t.notas_individuales||""}))&&(t.progreso=e,t.estado_individual=this.determinarEstadoPorProgreso(e),e>0&&!t.fecha_inicio_real&&(t.fecha_inicio_real=new Date().toISOString().split("T")[0]),e===100&&(t.fecha_fin_real=new Date().toISOString().split("T")[0]),yield this.loadEstadisticasPersonales(),this.mostrarNotificacion("Progreso actualizado correctamente","success"))}catch(i){console.error("Error actualizando progreso:",i),this.error="Error al actualizar el progreso",this.mostrarNotificacion("Error al actualizar el progreso","error"),setTimeout(()=>this.error="",5e3)}})}convertirFechaAString(t){return t?t instanceof Date?t.toISOString().split("T")[0]:t:""}calcularEstadoTemporal(t,e){let i=new Date,o=new Date(t),c=new Date(e);i.setHours(0,0,0,0),o.setHours(0,0,0,0),c.setHours(0,0,0,0);let _=Math.ceil((c.getTime()-i.getTime())/(1e3*60*60*24)),S;return i<o?S="pendiente":i<=c?S="vigente":S="vencida",{estado:S,diasRestantes:_}}determinarEstadoPorProgreso(t){return t===0?"pendiente":t===100?"completada":"en_progreso"}getFormattedTerapia(t,e){if(console.log("\u{1F5A8}\uFE0F Formateando terapia desde BD:",{terapia:t,seguimiento:e}),!t&&!e)return console.warn("No hay datos de terapia ni seguimiento"),"No hay informaci\xF3n disponible para mostrar.";!t&&e&&(t=this.crearTerapiaBasica(e));let i=`${t.nombre||e?.terapia_nombre||"Terapia sin nombre"}
`;if(i+=`${t.descripcion||e?.terapia_descripcion||"Informaci\xF3n detallada disponible con el terapeuta"}
`,i+=`Tipo: ${t.tipo||e?.terapia_tipo||"No especificado"} | Nivel: ${t.nivel||e?.terapia_nivel||"No especificado"}
`,t.area_especializacion&&(i+=`\xC1rea: ${t.area_especializacion}
`),i+=`Duraci\xF3n estimada: ${this.formatDuracion(t.duracion_estimada||e?.duracion_estimada)}

`,e&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                          MI PROGRESO
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`Estado: ${this.getEstadoIndividualText(e.estado_individual)} (${e.progreso}%)
`,i+=`Per\xEDodo: ${this.formatDate(e.fecha_inicio_programada)} - ${this.formatDate(e.fecha_fin_programada)}
`,e.estado_temporal==="vigente"&&e.dias_restantes!==void 0&&(i+=`D\xEDas restantes: ${this.formatDiasRestantes(e.dias_restantes)}
`),e.fecha_inicio_real&&(i+=`Iniciado: ${this.formatDate(e.fecha_inicio_real)}
`),e.sesiones_completadas!==void 0&&e.sesiones_programadas!==void 0&&(i+=`Sesiones completadas: ${e.sesiones_completadas} / ${e.sesiones_programadas}
`),e.adherencia_porcentaje!==void 0&&(i+=`Adherencia: ${e.adherencia_porcentaje}%
`),i+=`
`),t.objetivo_principal&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      OBJETIVO PRINCIPAL
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.objetivo_principal}

`),t.ejercicios&&typeof t.ejercicios=="object"&&Object.keys(t.ejercicios).length>0){console.log("\u{1F4CB} Procesando ejercicios desde BD:",t.ejercicios),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      PLAN DE EJERCICIOS
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`;let o=["calentamiento","fortalecimiento","equilibrio","coordinacion","estiramiento","respiracion","flexibilidad","movilidad","resistencia"],c=0;o.forEach(_=>{let S=t.ejercicios[_];if(S&&S.ejercicios&&Array.isArray(S.ejercicios)&&S.ejercicios.length>0){c++,i+=`${_.toUpperCase()}
`,i+=`${"\u2500".repeat(_.length)}
`,S.descripcion&&(i+=`${S.descripcion}
`);let P=[];S.tiempo_total&&P.push(`Tiempo: ${S.tiempo_total}`),S.objetivos&&Array.isArray(S.objetivos)&&S.objetivos.length>0&&P.push(`Objetivos: ${S.objetivos.join(", ")}`),P.length>0&&(i+=`${P.join(" | ")}
`),i+=`
`,S.ejercicios.forEach((T,L)=>{i+=`${L+1}. ${T.nombre||"Ejercicio sin nombre"}
`,T.descripcion&&(i+=`   ${T.descripcion}
`);let V=[];T.series&&V.push(`${T.series} series`),T.repeticiones&&V.push(`${T.repeticiones} reps`),T.duracion&&V.push(`${T.duracion}`),T.resistencia&&V.push(`Resistencia: ${T.resistencia}`),T.equipamiento&&Array.isArray(T.equipamiento)&&T.equipamiento.length>0&&V.push(`Equipo: ${T.equipamiento.join(", ")}`),V.length>0&&(i+=`   ${V.join(" | ")}
`),T.ejecucion&&(i+=`   Ejecuci\xF3n: ${T.ejecucion}
`),T.precauciones&&(i+=`   \u26A0\uFE0F  ${T.precauciones}
`),T.modificaciones&&(T.modificaciones.principiante&&(i+=`   \u{1F4A1} Principiante: ${T.modificaciones.principiante}
`),T.modificaciones.limitaciones&&(i+=`   \u{1F527} Limitaciones: ${T.modificaciones.limitaciones}
`)),T.observaciones&&(i+=`   \u{1F4DD} ${T.observaciones}
`),i+=`
`}),i+=`
`}}),c===0&&(console.log("\u{1F50D} No se encontraron secciones organizadas, buscando ejercicios directos..."),Array.isArray(t.ejercicios)?(i+=`EJERCICIOS
`,i+=`\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500

`,t.ejercicios.forEach((_,S)=>{i+=`${S+1}. ${_.nombre||"Ejercicio sin nombre"}
`,_.descripcion&&(i+=`   ${_.descripcion}
`);let P=[];_.series&&P.push(`${_.series} series`),_.repeticiones&&P.push(`${_.repeticiones} reps`),_.duracion&&P.push(`${_.duracion}`),P.length>0&&(i+=`   ${P.join(" | ")}
`),_.observaciones&&(i+=`   \u{1F4DD} ${_.observaciones}
`),i+=`
`})):(console.log("\u26A0\uFE0F Estructura de ejercicios no reconocida:",typeof t.ejercicios),i+=`INFORMACI\xD3N DE EJERCICIOS
`,i+=`\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500

`,i+=`Los ejercicios est\xE1n disponibles en la base de datos.
`,i+=`Consulte con su terapeuta para obtener el plan de ejercicios detallado.

`))}else console.log("\u2139\uFE0F No hay ejercicios en BD o estructura vac\xEDa"),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                    PLAN DE EJERCICIOS
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`El plan de ejercicios detallado est\xE1 disponible con su terapeuta.
`,i+=`Consulte directamente para obtener las instrucciones espec\xEDficas.

`;return t.contraindicaciones&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                     CONTRAINDICACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.contraindicaciones}

`),t.criterios_progresion&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                   CRITERIOS DE PROGRESI\xD3N
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.criterios_progresion}

`),t.recomendaciones&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      RECOMENDACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.recomendaciones}

`),t.observaciones&&t.observaciones!=="Para informaci\xF3n detallada de ejercicios y contraindicaciones, consulte con su terapeuta"&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      OBSERVACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.observaciones}

`),e?.notas_individuales&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                   MIS NOTAS PERSONALES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${e.notas_individuales}

`),e&&(e.nivel_dolor_actual!==void 0||e.nivel_funcionalidad_actual!==void 0)&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                     EVALUACI\xD3N ACTUAL
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,e.nivel_dolor_actual!==void 0&&e.nivel_dolor_actual>0&&(i+=`Nivel de dolor: ${e.nivel_dolor_actual}/10
`),e.nivel_funcionalidad_actual!==void 0&&e.nivel_funcionalidad_actual>0&&(i+=`Funcionalidad: ${e.nivel_funcionalidad_actual}%
`),i+=`
`),t.tags&&Array.isArray(t.tags)&&t.tags.length>0&&(i+=`Tags: ${t.tags.map(o=>`#${o}`).join(" ")}

`),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`\xDAltima actualizaci\xF3n: ${this.formatDate(new Date().toISOString())}
`,i+=`Generado por: rehabiMovement - Sistema de Rehabilitaci\xF3n
`,i+=`ID de Terapia: ${t.id||e?.terapia_id||"N/A"}
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,console.log("\u2705 Texto generado con datos reales de BD"),i}getFileName(t){return!t||!t.nombre?"mi_terapia.txt":t.nombre.replace(/\s+/g,"_")+"_mi_terapia.txt"}safeExportTerapia(t){let e=t.terapia_completa||this.selectedTerapia||{nombre:t.terapia_nombre,descripcion:t.terapia_descripcion,tipo:t.terapia_tipo,nivel:t.terapia_nivel,duracion_estimada:t.duracion_estimada};e?this.exportarTerapia(e,t):console.warn("No hay terapia disponible para exportar")}exportarTerapia(t,e){if(!t){console.warn("No hay terapia para exportar");return}let i=this.getFormattedTerapia(t,e);if(!i){console.warn("No se pudo generar el contenido para exportar");return}let o=new Blob([i],{type:"text/plain;charset=utf-8"}),c=window.URL.createObjectURL(o),_=document.createElement("a");_.href=c,_.download=`${t.nombre.replace(/\s+/g,"_")}_mi_terapia.txt`,_.click(),window.URL.revokeObjectURL(c),console.log("Mi terapia exportada:",t.nombre),this.mostrarNotificacion("Terapia exportada correctamente","success")}onSearch(){this.applyFilters()}onFilterChange(){this.applyFilters()}clearFilters(){this.searchTerm="",this.estadoFilter="all",this.estadoIndividualFilter="all",this.progresoFilter="all",this.applyFilters()}refreshMisTerapias(){return h(this,null,function*(){yield Promise.all([this.loadMisTerapias(),this.loadEstadisticasPersonales()]),this.mostrarNotificacion("Terapias actualizadas","success")})}mostrarNotificacion(t,e="info"){this.mensaje=t,this.tipoMensaje=e,this.mostrarMensaje=!0,setTimeout(()=>{this.mostrarMensaje=!1},3e3)}cerrarNotificacion(){this.mostrarMensaje=!1}formatDuracion(t){if(!t)return"N/A";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}formatDate(t){if(!t)return"N/A";try{let e;return t instanceof Date?e=t:e=new Date(t),isNaN(e.getTime())?"Fecha inv\xE1lida":e.toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"Fecha inv\xE1lida"}}formatDiasRestantes(t){return t==null?"No disponible":t<0?`Vencida hace ${Math.abs(t)} d\xEDa${Math.abs(t)!==1?"s":""}`:t===0?"Vence hoy":t===1?"Vence ma\xF1ana":`${t} d\xEDas restantes`}getEstadoTemporalText(t){switch(t){case"vigente":return"Vigente";case"pendiente":return"Pendiente";case"vencida":return"Vencida";default:return"Desconocido"}}getEstadoIndividualText(t){if(!t)return"Desconocido";switch(t){case"completada":return"Completada";case"en_progreso":return"En Progreso";case"pendiente":return"Sin Iniciar";case"abandonada":return"Abandonada";default:return"Desconocido"}}getEstadoTemporalColor(t){switch(t){case"vigente":return"green";case"pendiente":return"blue";case"vencida":return"red";default:return"gray"}}getEstadoIndividualColor(t){switch(t){case"pendiente":return"gray";case"en_progreso":return"yellow";case"completada":return"green";case"abandonada":return"red";default:return"gray"}}getProgresoColor(t){return t===0?"gray":t<30?"red":t<70?"yellow":"green"}copyToClipboard(t){return h(this,null,function*(){try{yield navigator.clipboard.writeText(t),this.copySuccess=!0,console.log("Texto copiado al portapapeles"),setTimeout(()=>{this.copySuccess=!1},2e3)}catch(e){console.error("Error al copiar al portapapeles:",e),this.fallbackCopyTextToClipboard(t)}})}fallbackCopyTextToClipboard(t){let e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")&&(this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3))}catch(i){console.error("Fallback: Error al copiar al portapapeles:",i)}document.body.removeChild(e)}trackByTerapiaId(t,e){return e.seguimiento_id||t}static \u0275fac=function(e){return new(e||a)(I(Ve),I(j))};static \u0275cmp=A({type:a,selectors:[["app-mis-terapias"]],standalone:!1,decls:26,vars:9,consts:[["filtrosAplicados",""],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],[1,"flex","bg-gray-100","rounded-lg","p-1"],[3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1","inline"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3a2 2 0 012-2h8a2 2 0 012 2v4m-4 0V3m-4 4h8m-8 0H6a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"],["title","Refrescar lista",1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],[3,"class",4,"ngIf"],[3,"volverAVista","abrirTerapia","terapias"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4"],[1,"md:col-span-2"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Buscar terapias...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","input","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","change","ngModel"],["value","all"],["value","vigente"],["value","pendiente"],["value","vencida"],["value","en_progreso"],["value","completada"],["value","abandonada"],["value","sin_iniciar"],["value","completado"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-blue-600","hover:text-blue-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf"],["class","text-center py-12",4,"ngIf"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 border-l-4",3,"border-green-500","border-blue-500","border-red-500",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-white","rounded-lg","shadow-lg","overflow-hidden","hover:shadow-xl","transition-shadow","duration-300","border-l-4"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"text-xl","font-bold","text-white"],[1,"text-white","text-opacity-90","text-sm"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-white","bg-opacity-20","text-white"],[1,"p-6"],[1,"mb-4"],[1,"flex","justify-between","items-center","mb-2"],[1,"text-sm","font-medium","text-gray-700"],[1,"text-sm","font-bold","text-gray-900"],[1,"w-full","bg-gray-200","rounded-full","h-3"],[1,"h-3","rounded-full","transition-all","duration-300"],[1,"mt-3"],["type","range","min","0","max","100","step","5","title","Desliza para actualizar tu progreso",1,"w-full","h-2","bg-gray-200","rounded-lg","appearance-none","cursor-pointer","slider",3,"input","value"],[1,"flex","justify-between","items-center","mb-4"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-600","mb-4"],[1,"flex","justify-between"],[1,"flex","justify-between","font-medium"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],["class","text-sm text-gray-600 mb-4",4,"ngIf"],["class","text-xs text-gray-500 mb-4",4,"ngIf"],["class","mb-4 p-3 bg-gray-50 rounded-md",4,"ngIf"],[1,"flex","justify-end","space-x-2"],["title","Ver terapia completa",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50","transition-colors","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Descargar mi terapia",1,"text-purple-600","hover:text-purple-900","p-2","rounded-full","hover:bg-purple-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["class","flex justify-between",4,"ngIf"],[1,"text-xs","text-gray-500","mb-4"],[1,"mb-4","p-3","bg-gray-50","rounded-md"],[1,"text-sm","text-gray-700"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[4,"ngIf","ngIfElse"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-5xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900","flex","items-center"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-2"],[1,"bg-blue-600","h-2","rounded-full"],[1,"text-gray-900"],[1,"bg-gray-900","text-green-400","rounded-lg","p-6","font-mono","text-sm","overflow-auto","max-h-96","relative",2,"font-family","'Courier New', monospace","line-height","1.6"],[1,"absolute","inset-15","flex","items-center","justify-center","pointer-events-none","opacity-25"],["src","/rh.png","alt","RehabiMovement",1,"max-w-50","max-h-50","object-contain","transform","rotate-12","select-none"],[1,"flex","items-center","justify-between","mb-4","pb-2","border-b","border-gray-700","relative","z-10"],[1,"w-3","h-3","bg-red-500","rounded-full"],[1,"w-3","h-3","bg-yellow-500","rounded-full"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-gray-400","text-xs"],[1,"whitespace-pre-wrap","text-white","relative","z-10"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-green-700"],[1,"rounded-lg","shadow-xs","overflow-hidden"],[1,"p-4"],[1,"flex","items-start"],[1,"flex-shrink-0"],["class","h-6 w-6 text-white","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"ml-3","w-0","flex-1","pt-0.5"],[1,"text-sm","leading-5","font-medium","text-white"],[1,"ml-4","flex-shrink-0","flex"],[1,"inline-flex","text-white","hover:text-gray-200","focus:outline-none","focus:text-gray-200","transition","ease-in-out","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z"]],template:function(e,i){e&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"h1",4),s(5,"Mis Terapias Asignadas"),r(),n(6,"p",5),s(7),r()(),n(8,"div",6)(9,"div",7)(10,"button",8),f("click",function(){return i.onCambiarACalendario()}),b(),n(11,"svg",9),p(12,"path",10),r(),s(13," Calendario "),r(),y(),n(14,"button",8),f("click",function(){return i.onCambiarATarjetas()}),b(),n(15,"svg",9),p(16,"path",11),r(),s(17," Tarjetas "),r()(),y(),n(18,"button",12),f("click",function(){return i.refreshMisTerapias()}),b(),n(19,"svg",13),p(20,"path",14),r(),s(21," Refrescar "),r()()()(),x(22,ns,2,1,"div",15)(23,vs,52,8,"div",15),r(),x(24,hs,63,18,"div",16)(25,Ms,16,7,"div",17)),e&2&&(l(7),v(" Terapias que me han sido asignadas - Total: ",i.misTerapias.length," "),l(3),D("px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 "+(i.vistaActual==="calendario"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900")),l(4),D("px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 "+(i.vistaActual==="tarjetas"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900")),l(8),m("ngIf",i.mostrarVistaCalendario),l(),m("ngIf",i.mostrarVistaTarjetas),l(),m("ngIf",i.showViewModal),l(),m("ngIf",i.mostrarMensaje))},dependencies:[$,N,R,J,Z,q,Q,W,G,xt],styles:['.mis-terapias-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#f9fafb}.terapia-card[_ngcontent-%COMP%]{transition:all .3s ease;border:1px solid #e5e7eb}.terapia-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000001a}.terapia-header-vigente[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#1d4ed8)}.terapia-header-vencida[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626)}.terapia-header-pendiente[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563)}.progress-bar-container[_ngcontent-%COMP%]{position:relative;overflow:hidden}.progress-bar[_ngcontent-%COMP%]{transition:width .6s ease-in-out;position:relative}.progress-bar[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);animation:_ngcontent-%COMP%_shimmer 2s infinite}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.badge-terapia-tipo[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#1e40af);color:#fff;font-weight:500;text-shadow:0 1px 2px rgba(0,0,0,.1)}.badge-nivel[_ngcontent-%COMP%]{background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:#fff;font-weight:500;text-shadow:0 1px 2px rgba(0,0,0,.1)}.badge-tag[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);color:#fff;font-weight:500;transition:all .2s ease}.badge-tag[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.estado-punto[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;display:inline-block;box-shadow:0 0 0 2px #ffffff4d;animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.7}}.terminal-display[_ngcontent-%COMP%]{font-family:Monaco,Menlo,Ubuntu Mono,monospace;background:#1a1a1a;color:#0f0;border-radius:8px;padding:20px;position:relative;overflow:auto;max-height:400px}.terminal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;padding-bottom:8px;border-bottom:1px solid #333}.terminal-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.terminal-button[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%}.terminal-button.red[_ngcontent-%COMP%]{background:#ff5f56}.terminal-button.yellow[_ngcontent-%COMP%]{background:#ffbd2e}.terminal-button.green[_ngcontent-%COMP%]{background:#27ca3f}.terminal-title[_ngcontent-%COMP%]{color:#666;font-size:12px}.terminal-content[_ngcontent-%COMP%]{line-height:1.6}.terminal-prompt[_ngcontent-%COMP%]{color:#ff0}.terminal-command[_ngcontent-%COMP%]{color:#0ff}.terminal-output[_ngcontent-%COMP%]{color:#fff;margin-left:16px}.terminal-separator[_ngcontent-%COMP%]{color:#09f;margin:8px 0}.progress-slider[_ngcontent-%COMP%]{width:100%;height:8px;border-radius:4px;background:#e5e7eb;outline:none;-webkit-appearance:none;appearance:none}.progress-slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;border-radius:50%;background:#3b82f6;cursor:pointer;box-shadow:0 2px 4px #0003;transition:all .2s ease}.progress-slider[_ngcontent-%COMP%]::-webkit-slider-thumb:hover{background:#1d4ed8;transform:scale(1.1)}.progress-slider[_ngcontent-%COMP%]::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:#3b82f6;cursor:pointer;border:none;box-shadow:0 2px 4px #0003}.stats-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;box-shadow:0 2px 4px #0000001a;border:1px solid #e5e7eb;transition:all .3s ease}.stats-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.stats-number[_ngcontent-%COMP%]{font-size:24px;font-weight:700;line-height:1}.stats-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500;text-transform:uppercase;letter-spacing:.05em}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.slide-in-left[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInLeft .5s ease-out}@keyframes _ngcontent-%COMP%_slideInLeft{0%{opacity:0;transform:translate(-30px)}to{opacity:1;transform:translate(0)}}@media (max-width: 768px){.stats-card[_ngcontent-%COMP%]{padding:12px}.stats-number[_ngcontent-%COMP%]{font-size:20px}.terapia-card[_ngcontent-%COMP%]{margin-bottom:16px}.terminal-display[_ngcontent-%COMP%]{font-size:12px;padding:16px}}@media (max-width: 640px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:8px}.filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.terapia-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px}}.loading-spinner[_ngcontent-%COMP%]{display:inline-block;width:20px;height:20px;border:3px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#fff;animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.nota-paciente[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);border-left:4px solid #f59e0b;padding:12px;border-radius:6px;margin:12px 0}.nota-paciente[_ngcontent-%COMP%]   .nota-titulo[_ngcontent-%COMP%]{color:#92400e;font-weight:600;font-size:14px}.nota-paciente[_ngcontent-%COMP%]   .nota-contenido[_ngcontent-%COMP%]{color:#78350f;font-size:13px;line-height:1.5;margin-top:4px}.btn-terapia[_ngcontent-%COMP%]{transition:all .2s ease;font-weight:500;position:relative;overflow:hidden}.btn-terapia[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.btn-terapia[_ngcontent-%COMP%]:hover:before{left:100%}.btn-primary-terapia[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#1e40af);color:#fff}.btn-primary-terapia[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#1e40af,#1e3a8a);transform:translateY(-1px)}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:48px 24px;color:#6b7280}.empty-state-icon[_ngcontent-%COMP%]{width:64px;height:64px;margin:0 auto 16px;opacity:.5}.empty-state-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#374151;margin-bottom:8px}.empty-state-description[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;line-height:1.5}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.focus\\:ring-terapia[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px;box-shadow:0 0 0 3px #3b82f680}.tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip[_ngcontent-%COMP%]   .tooltiptext[_ngcontent-%COMP%]{visibility:hidden;width:200px;background-color:#1f2937;color:#fff;text-align:center;border-radius:6px;padding:8px;font-size:12px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-100px;opacity:0;transition:opacity .3s}.tooltip[_ngcontent-%COMP%]:hover   .tooltiptext[_ngcontent-%COMP%]{visibility:visible;opacity:1}']})};var bt=class a{constructor(t,e){this.supabaseService=t;this.authService=e}getInformacionMedicaConPermisos(t){return h(this,null,function*(){try{let e=this.authService.getCurrentUser();if(!e||!e.id)throw new Error("Usuario no autenticado");if(e.id_perfil===1)return yield this.getAllUsuariosConInformacionMedica();{if(t&&t!==e.id)throw new Error("No tienes permisos para ver la informaci\xF3n de este usuario");let o=yield this.getUsuarioConInformacionMedica(e.id);return o?[o]:[]}}catch(e){throw console.error("Error al obtener informaci\xF3n m\xE9dica con permisos:",e),e}})}getAllUsuariosConInformacionMedica(){return h(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("profiles").select("id, username, full_name, id_perfil").eq("status",1).order("full_name",{ascending:!0});if(e)throw e;if(!t||t.length===0)return[];let{data:i,error:o}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").select("*");o&&console.warn("Error al obtener informaci\xF3n m\xE9dica:",o);let c=t.map(_=>{let S=i?.find(P=>P.usuario_id===_.id)||null;return{id:_.id,username:_.username||"",full_name:_.full_name||"",id_perfil:_.id_perfil||2,informacion_medica:S}});return console.log("Usuarios cargados:",c),c}catch(t){throw console.error("Error al obtener todos los usuarios:",t),t}})}getUsuarioConInformacionMedica(t){return h(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("profiles").select("id, username, full_name, id_perfil").eq("id",t).eq("status",1).single();if(i)return console.error("Error al obtener usuario:",i),null;if(!e)return null;let{data:o,error:c}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").select("*").eq("usuario_id",t).single();return c&&c.code!=="PGRST116"&&console.warn("Error al obtener informaci\xF3n m\xE9dica:",c),{id:e.id,username:e.username||"",full_name:e.full_name||"",id_perfil:e.id_perfil||2,informacion_medica:o||null}}catch(e){return console.error("Error al obtener usuario con informaci\xF3n m\xE9dica:",e),null}})}saveInformacionMedica(t){return h(this,null,function*(){try{let e=this.authService.getCurrentUser();if(!e||!e.id)throw new Error("Usuario no autenticado");let i=e.id_perfil===1,o=t.usuario_id===e.id;if(!i&&!o)throw new Error("No tienes permisos para editar la informaci\xF3n de este usuario");let c=null;t.peso&&t.altura&&(c=t.peso/Math.pow(t.altura/100,2));let _={usuario_id:t.usuario_id,fecha_nacimiento:t.fecha_nacimiento||null,genero:t.genero||null,telefono:t.telefono||null,direccion:t.direccion||null,diagnostico_principal:t.diagnostico_principal||null,diagnosticos_secundarios:t.diagnosticos_secundarios||null,historial_medico:t.historial_medico||null,medicamentos_actuales:t.medicamentos_actuales||null,alergias:t.alergias||null,limitaciones_fisicas:t.limitaciones_fisicas||null,observaciones_generales:t.observaciones_generales||null,contacto_emergencia_nombre:t.contacto_emergencia_nombre||null,contacto_emergencia_telefono:t.contacto_emergencia_telefono||null,contacto_emergencia_relacion:t.contacto_emergencia_relacion||null,peso:t.peso||null,altura:t.altura||null,imc:c,updated_at:new Date().toISOString()};console.log("Datos a guardar:",_);let{data:S,error:P}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").upsert(_,{onConflict:"usuario_id",ignoreDuplicates:!1}).select().single();if(P)throw console.error("Error en upsert:",P),P;return console.log("Datos guardados exitosamente:",S),S}catch(e){throw console.error("Error al guardar informaci\xF3n m\xE9dica:",e),e}})}canEditUser(t){let e=this.authService.getCurrentUser();if(!e||!e.id)return!1;let i=e.id_perfil===1,o=t===e.id;return i||o}canViewUser(t){let e=this.authService.getCurrentUser();if(!e||!e.id)return!1;let i=e.id_perfil===1,o=t===e.id;return i||o}getInformacionMedicaUsuario(t){return h(this,null,function*(){try{if(!this.canViewUser(t))throw new Error("No tienes permisos para ver la informaci\xF3n de este usuario");let{data:e,error:i}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").select("*").eq("usuario_id",t).single();if(i&&i.code!=="PGRST116")throw i;return e}catch(e){throw console.error("Error al obtener informaci\xF3n m\xE9dica:",e),e}})}getEstadisticasInformacionMedica(){return h(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.rpc("get_estadisticas_informacion_medica");if(e)throw e;return t}catch(t){return console.error("Error al obtener estad\xEDsticas:",t),null}})}static \u0275fac=function(e){return new(e||a)(he(te),he(j))};static \u0275prov=ke({token:a,factory:a.\u0275fac,providedIn:"root"})};var ks=(a,t)=>({"border-blue-500 ring-2 ring-blue-100 shadow-lg":a,"border-gray-200 hover:border-blue-300":t}),Ts=(a,t)=>({"bg-green-500":a,"bg-yellow-500":t}),Ps=(a,t)=>({"bg-green-100 text-green-800":a,"bg-yellow-100 text-yellow-800":t}),Is=(a,t)=>({"bg-blue-500":a,"bg-gray-300":t}),Os=(a,t)=>({"bg-green-400":a,"bg-yellow-400":t});function Vs(a,t){a&1&&(n(0,"span"),s(1,"Gestiona la informaci\xF3n m\xE9dica de todos los usuarios del sistema"),r())}function Fs(a,t){a&1&&(n(0,"span"),s(1,"Visualiza y edita tu informaci\xF3n m\xE9dica personal"),r())}function Ds(a,t){if(a&1){let e=C();n(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"div",15),b(),n(5,"svg",16),p(6,"path",17),r()(),y(),n(7,"input",18),k("ngModelChange",function(o){u(e);let c=d();return E(c.searchTerm,o)||(c.searchTerm=o),g(o)}),f("input",function(){u(e);let o=d();return g(o.filterUsuarios())}),r()()()()()}if(a&2){let e=d();l(7),M("ngModel",e.searchTerm)}}function As(a,t){a&1&&(n(0,"div",19)(1,"div",20),p(2,"div",21),r(),n(3,"p",22),s(4,"Cargando informaci\xF3n..."),r()())}function Rs(a,t){if(a&1){let e=C();n(0,"div",19)(1,"div",23)(2,"div",24),b(),n(3,"svg",25),p(4,"path",26),r()(),y(),n(5,"h3",27),s(6,"Error al cargar datos"),r(),n(7,"p",28),s(8),r(),n(9,"button",29),f("click",function(){u(e);let o=d();return g(o.reloadData())}),b(),n(10,"svg",30),p(11,"path",31),r(),s(12," Reintentar "),r()()()}if(a&2){let e=d();l(8),w(e.errorMessage)}}function js(a,t){if(a&1&&(n(0,"div",55)(1,"p",47),s(2,"Diagn\xF3stico principal:"),r(),n(3,"p",56),s(4),r()()),a&2){let e=d().$implicit;l(4),v(" ",e.informacion_medica==null?null:e.informacion_medica.diagnostico_principal," ")}}function Us(a,t){if(a&1&&(n(0,"div",47)(1,"span",57),b(),n(2,"svg",58),p(3,"path",59),r(),s(4),r()()),a&2){let e,i=d().$implicit,o=d(2);l(4),v(" ",o.getAge((e=i.informacion_medica==null?null:i.informacion_medica.fecha_nacimiento)!==null&&e!==void 0?e:"")," a\xF1os ")}}function Ls(a,t){if(a&1){let e=C();n(0,"div",37),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.selectUsuario(o))}),n(1,"div",13)(2,"div",38)(3,"div",14)(4,"div",39)(5,"span",40),s(6),r()(),p(7,"div",41),r(),n(8,"div",42)(9,"h3",43),s(10),r(),n(11,"p",44),s(12),r()()(),n(13,"div",45)(14,"div",46)(15,"span",47),s(16,"Estado m\xE9dico:"),r(),n(17,"span",48),s(18),r()(),x(19,js,5,1,"div",49)(20,Us,5,1,"div",50),r(),n(21,"div",51)(22,"span",52),s(23," Ver ficha m\xE9dica "),b(),n(24,"svg",53),p(25,"path",54),r()()()()()}if(a&2){let e=t.$implicit,i=d(2);m("ngClass",Ce(9,ks,(i.selectedUsuario==null?null:i.selectedUsuario.id)===e.id,(i.selectedUsuario==null?null:i.selectedUsuario.id)!==e.id)),l(6),v(" ",(e.full_name||e.username).charAt(0).toUpperCase()," "),l(),m("ngClass",Ce(12,Ts,e.informacion_medica,!e.informacion_medica)),l(3),v(" ",e.full_name||e.username," "),l(2),v(" ",e.email||e.username," "),l(5),m("ngClass",Ce(15,Ps,e.informacion_medica,!e.informacion_medica)),l(),v(" ",e.informacion_medica?"Completo":"Pendiente"," "),l(),m("ngIf",e.informacion_medica==null?null:e.informacion_medica.diagnostico_principal),l(),m("ngIf",e.informacion_medica==null?null:e.informacion_medica.fecha_nacimiento)}}function Ns(a,t){if(a&1&&p(0,"div",60),a&2){let e=t.index,i=d(2);m("ngClass",Ce(1,Is,e===i.currentScrollPage,e!==i.currentScrollPage))}}function zs(a,t){if(a&1&&(n(0,"div",11)(1,"div",32)(2,"div",33),x(3,Ls,26,18,"div",34),r()(),n(4,"div",35),x(5,Ns,1,4,"div",36),r()()),a&2){let e=d();l(3),m("ngForOf",e.filteredUsuarios),l(2),m("ngForOf",e.getScrollPages())}}function Bs(a,t){if(a&1&&(n(0,"div",61)(1,"div",62)(2,"div",63),b(),n(3,"svg",64),p(4,"path",17),r()(),y(),n(5,"h3",65),s(6,"No se encontraron usuarios"),r(),n(7,"p",66),s(8),r()()()),a&2){let e=d();l(8),v('No hay usuarios que coincidan con tu b\xFAsqueda "',e.searchTerm,'"')}}function $s(a,t){a&1&&(n(0,"div",61)(1,"div",67)(2,"div",68),b(),n(3,"svg",69),p(4,"path",70),r()(),y(),n(5,"h3",71),s(6,"Selecciona un usuario"),r(),n(7,"p",72),s(8,"Elige un usuario de las tarjetas de arriba para ver o editar su informaci\xF3n m\xE9dica completa"),r()()())}function qs(a,t){if(a&1&&(n(0,"span",149),s(1),r()),a&2){let e,i=d(3);l(),v(" ",i.getAge((e=i.selectedUsuario.informacion_medica==null?null:i.selectedUsuario.informacion_medica.fecha_nacimiento)!==null&&e!==void 0?e:"")," a\xF1os ")}}function Ws(a,t){if(a&1){let e=C();n(0,"div",150)(1,"button",151),f("click",function(){u(e);let o=d(3);return g(o.selectedUsuario=null)}),b(),n(2,"svg",152),p(3,"path",153),r()()()}}function Gs(a,t){if(a&1&&(n(0,"div",136)(1,"div",137)(2,"div",138)(3,"div",139)(4,"span",140),s(5),r()(),n(6,"div",141)(7,"h2",142),s(8),r(),n(9,"p",143),s(10),r(),n(11,"div",144)(12,"span",145),p(13,"div",146),s(14),r(),x(15,qs,2,1,"span",147),r()(),x(16,Ws,4,0,"div",148),r()()()),a&2){let e=d(2);l(5),v(" ",(e.selectedUsuario.full_name||e.selectedUsuario.username).charAt(0).toUpperCase()," "),l(3),v(" ",e.selectedUsuario.full_name||e.selectedUsuario.username," "),l(2),w(e.selectedUsuario.email||e.selectedUsuario.username),l(3),m("ngClass",Ce(7,Os,e.selectedUsuario.informacion_medica,!e.selectedUsuario.informacion_medica)),l(),v(" ",e.selectedUsuario.informacion_medica?"Informaci\xF3n Completa":"Informaci\xF3n Pendiente"," "),l(),m("ngIf",e.selectedUsuario.informacion_medica==null?null:e.selectedUsuario.informacion_medica.fecha_nacimiento),l(),m("ngIf",e.isAdmin)}}function Hs(a,t){if(a&1){let e=C();n(0,"div",154)(1,"div",57),b(),n(2,"svg",155),p(3,"path",156),r(),y(),n(4,"p",157),s(5),r(),n(6,"button",158),f("click",function(){u(e);let o=d(2);return g(o.errorMessage="")}),b(),n(7,"svg",159),p(8,"path",153),r()()()()}if(a&2){let e=d(2);l(5),w(e.errorMessage)}}function Ys(a,t){if(a&1){let e=C();n(0,"div",160)(1,"div",57),b(),n(2,"svg",161),p(3,"path",162),r(),y(),n(4,"p",163),s(5),r(),n(6,"button",164),f("click",function(){u(e);let o=d(2);return g(o.successMessage="")}),b(),n(7,"svg",159),p(8,"path",153),r()()()()}if(a&2){let e=d(2);l(5),w(e.successMessage)}}function Qs(a,t){if(a&1&&(n(0,"div",165)(1,"div",166),s(2),ce(3,"number"),r(),n(4,"div",47),s(5),r()()),a&2){let e=d(2);l(),m("ngClass",e.getIMCColor()),l(),v(" ",At(3,3,e.getIMC(),"1.1-1")," "),l(3),v(" ",e.getIMCClassification()," ")}}function Js(a,t){a&1&&(n(0,"div",167),s(1," Ingrese peso y altura "),r())}function Zs(a,t){a&1&&(n(0,"span",57),b(),n(1,"svg",172),p(2,"path",173),r(),s(3," Guardar Informaci\xF3n "),r())}function Xs(a,t){a&1&&(n(0,"span",57),b(),n(1,"svg",174),p(2,"circle",175)(3,"path",176),r(),s(4," Guardando... "),r())}function Ks(a,t){if(a&1){let e=C();n(0,"div",168)(1,"button",169),f("click",function(){u(e);let o=d(2);return g(o.resetForm())}),s(2," Cancelar "),r(),n(3,"button",170),x(4,Zs,4,0,"span",171)(5,Xs,5,0,"span",171),r()()}if(a&2){let e=d(2);l(3),m("disabled",e.saving||e.informacionMedicaForm.invalid),l(),m("ngIf",!e.saving),l(),m("ngIf",e.saving)}}function el(a,t){a&1&&(n(0,"div",177)(1,"div",57)(2,"div",178),b(),n(3,"svg",179),p(4,"path",26),r()(),y(),n(5,"div",180)(6,"h3",181),s(7,"Solo lectura"),r(),n(8,"p",182),s(9," Solo puedes visualizar esta informaci\xF3n. No tienes permisos para editarla. "),r()()()())}function tl(a,t){if(a&1){let e=C();n(0,"div",73),x(1,Gs,17,10,"div",74)(2,Hs,9,1,"div",75)(3,Ys,9,1,"div",76),n(4,"div",77)(5,"form",78),f("ngSubmit",function(){u(e);let o=d();return g(o.saveInformacionMedica())}),n(6,"div",79)(7,"div",80)(8,"div",81),b(),n(9,"svg",82),p(10,"path",83),r()(),y(),n(11,"h3",84),s(12,"Informaci\xF3n Personal"),r()(),n(13,"div",85)(14,"div",45)(15,"label",86),s(16,"Fecha de Nacimiento"),r(),p(17,"input",87),r(),n(18,"div",45)(19,"label",86),s(20,"G\xE9nero"),r(),n(21,"select",88)(22,"option",89),s(23,"Seleccionar"),r(),n(24,"option",90),s(25,"Masculino"),r(),n(26,"option",91),s(27,"Femenino"),r(),n(28,"option",92),s(29,"Otro"),r()()(),n(30,"div",45)(31,"label",86),s(32,"Tel\xE9fono"),r(),p(33,"input",93),r(),n(34,"div",94)(35,"label",86),s(36,"Direcci\xF3n"),r(),p(37,"textarea",95),r()()(),n(38,"div",79)(39,"div",80)(40,"div",96),b(),n(41,"svg",97),p(42,"path",98),r()(),y(),n(43,"h3",84),s(44,"Informaci\xF3n M\xE9dica"),r()(),n(45,"div",99)(46,"div",100)(47,"div",45)(48,"label",86),s(49,"Diagn\xF3stico Principal"),r(),p(50,"input",101),r(),n(51,"div",45)(52,"label",86),s(53,"Diagn\xF3sticos Secundarios"),r(),n(54,"input",102),f("input",function(o){u(e);let c=d();return g(c.setDiagnosticosFromString(o.target.value))}),r(),n(55,"p",103),s(56,"Separar m\xFAltiples diagn\xF3sticos con comas"),r()()(),n(57,"div",45)(58,"label",86),s(59,"Historial M\xE9dico"),r(),p(60,"textarea",104),r(),n(61,"div",100)(62,"div",45)(63,"label",86),s(64,"Medicamentos Actuales"),r(),p(65,"textarea",105),r(),n(66,"div",45)(67,"label",86),s(68,"Alergias"),r(),p(69,"textarea",106),r()(),n(70,"div",45)(71,"label",86),s(72,"Limitaciones F\xEDsicas"),r(),p(73,"textarea",107),r(),n(74,"div",45)(75,"label",86),s(76,"Observaciones Generales"),r(),p(77,"textarea",108),r()()(),n(78,"div",79)(79,"div",80)(80,"div",109),b(),n(81,"svg",110),p(82,"path",111),r()(),y(),n(83,"h3",84),s(84,"Informaci\xF3n F\xEDsica"),r()(),n(85,"div",112)(86,"div",45)(87,"label",86),s(88,"Peso (kg)"),r(),n(89,"input",113),f("input",function(){u(e);let o=d();return g(o.calculateIMC())}),r()(),n(90,"div",45)(91,"label",86),s(92,"Altura (cm)"),r(),n(93,"input",114),f("input",function(){u(e);let o=d();return g(o.calculateIMC())}),r()(),n(94,"div",45)(95,"label",86),s(96,"IMC"),r(),n(97,"div",115),x(98,Qs,6,6,"div",116)(99,Js,2,0,"div",117),r()()()(),n(100,"div",79)(101,"div",80)(102,"div",118),b(),n(103,"svg",119),p(104,"path",120),r()(),y(),n(105,"h3",84),s(106,"Contacto de Emergencia"),r()(),n(107,"div",112)(108,"div",45)(109,"label",86),s(110,"Nombre Completo"),r(),p(111,"input",121),r(),n(112,"div",45)(113,"label",86),s(114,"Tel\xE9fono"),r(),p(115,"input",122),r(),n(116,"div",45)(117,"label",86),s(118,"Relaci\xF3n"),r(),n(119,"select",123)(120,"option",89),s(121,"Seleccionar"),r(),n(122,"option",124),s(123,"Padre"),r(),n(124,"option",125),s(125,"Madre"),r(),n(126,"option",126),s(127,"Esposo"),r(),n(128,"option",127),s(129,"Esposa"),r(),n(130,"option",128),s(131,"Hijo"),r(),n(132,"option",129),s(133,"Hija"),r(),n(134,"option",130),s(135,"Hermano"),r(),n(136,"option",131),s(137,"Hermana"),r(),n(138,"option",132),s(139,"Amigo"),r(),n(140,"option",92),s(141,"Otro"),r()()()()(),n(142,"div",133),x(143,Ks,6,3,"div",134)(144,el,10,0,"div",135),r()()()()}if(a&2){let e=d();l(),m("ngIf",e.selectedUsuario),l(),m("ngIf",e.errorMessage),l(),m("ngIf",e.successMessage),l(2),m("formGroup",e.informacionMedicaForm),l(12),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(12),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(13),m("disabled",!e.canEditCurrentUser()),l(4),m("value",e.getDiagnosticosAsString())("disabled",!e.canEditCurrentUser()),l(6),m("disabled",!e.canEditCurrentUser()),l(5),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(12),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(5),m("ngIf",e.getIMC()),l(),m("ngIf",!e.getIMC()),l(12),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(24),m("ngIf",e.canEditCurrentUser()),l(),m("ngIf",!e.canEditCurrentUser())}}var ht=class a{constructor(t,e,i){this.fb=t;this.informacionMedicaService=e;this.authService=i;this.informacionMedicaForm=this.createForm()}usuarios=[];filteredUsuarios=[];selectedUsuario=null;informacionMedicaForm;loading=!1;saving=!1;isAdmin=!1;currentUserId=null;showModal=!1;errorMessage="";successMessage="";searchTerm="";currentScrollPage=0;itemsPerPage=4;ngOnInit(){this.initializeComponent(),this.loadUsuarios()}initializeComponent(){let t=this.authService.getCurrentUser();t&&(this.isAdmin=t.id_perfil===1,this.currentUserId=t.id||null)}createForm(){return this.fb.group({usuario_id:[null,we.required],fecha_nacimiento:[""],genero:[""],telefono:["",[we.pattern(/^\+?[\d\s\-\(\)]+$/)]],direccion:[""],diagnostico_principal:[""],diagnosticos_secundarios:[[]],historial_medico:[""],medicamentos_actuales:[""],alergias:[""],limitaciones_fisicas:[""],observaciones_generales:[""],contacto_emergencia_nombre:[""],contacto_emergencia_telefono:["",[we.pattern(/^\+?[\d\s\-\(\)]+$/)]],contacto_emergencia_relacion:[""],peso:[null,[we.min(1),we.max(300)]],altura:[null,[we.min(50),we.max(250)]]})}loadUsuarios(){return h(this,null,function*(){this.loading=!0,this.errorMessage="";try{if(this.usuarios=yield this.informacionMedicaService.getInformacionMedicaConPermisos(),this.filteredUsuarios=[...this.usuarios],!this.isAdmin&&this.usuarios.length===1)this.selectUsuario(this.usuarios[0]);else if(!this.isAdmin&&this.usuarios.length===0&&this.currentUserId){let t=this.authService.getCurrentUser();if(t&&t.id){let e={id:t.id,username:t.username||"",full_name:t.full_name||"",email:"",id_perfil:t.id_perfil||2,informacion_medica:null};this.usuarios=[e],this.filteredUsuarios=[e],this.selectUsuario(e)}}}catch(t){console.error("Error al cargar usuarios:",t),this.errorMessage=t?.message||"Error al cargar la informaci\xF3n de usuarios"}finally{this.loading=!1}})}filterUsuarios(){if(!this.searchTerm.trim()){this.filteredUsuarios=[...this.usuarios],this.currentScrollPage=0;return}let t=this.searchTerm.toLowerCase().trim();this.filteredUsuarios=this.usuarios.filter(e=>{let i=(e.full_name||"").toLowerCase().includes(t),o=(e.username||"").toLowerCase().includes(t),c=(e.email||"").toLowerCase().includes(t),_=!1;if(e.informacion_medica){let S=e.informacion_medica;_=(S.diagnostico_principal||"").toLowerCase().includes(t)||(S.historial_medico||"").toLowerCase().includes(t)||(S.medicamentos_actuales||"").toLowerCase().includes(t)||(S.alergias||"").toLowerCase().includes(t)||(S.limitaciones_fisicas||"").toLowerCase().includes(t)||(S.observaciones_generales||"").toLowerCase().includes(t)||(S.diagnosticos_secundarios||[]).some(P=>P.toLowerCase().includes(t))}return i||o||c||_}),this.currentScrollPage=0}selectUsuario(t){this.selectedUsuario=t,this.loadInformacionMedica(t),this.clearMessages()}loadInformacionMedica(t){let e=t.informacion_medica;if(console.log("Cargando informaci\xF3n para usuario:",t.username,"Info:",e),this.informacionMedicaForm.reset(),this.informacionMedicaForm.patchValue({usuario_id:t.id}),e){let i="";if(e.fecha_nacimiento)try{let c=new Date(e.fecha_nacimiento);isNaN(c.getTime())||(i=c.toISOString().split("T")[0])}catch(c){console.warn("Error al procesar fecha:",c)}let o={usuario_id:t.id,fecha_nacimiento:i,genero:e.genero||"",telefono:e.telefono||"",direccion:e.direccion||"",diagnostico_principal:e.diagnostico_principal||"",diagnosticos_secundarios:e.diagnosticos_secundarios||[],historial_medico:e.historial_medico||"",medicamentos_actuales:e.medicamentos_actuales||"",alergias:e.alergias||"",limitaciones_fisicas:e.limitaciones_fisicas||"",observaciones_generales:e.observaciones_generales||"",contacto_emergencia_nombre:e.contacto_emergencia_nombre||"",contacto_emergencia_telefono:e.contacto_emergencia_telefono||"",contacto_emergencia_relacion:e.contacto_emergencia_relacion||"",peso:e.peso||null,altura:e.altura||null};console.log("Datos del formulario a cargar:",o),this.informacionMedicaForm.patchValue(o),this.informacionMedicaForm.markAsPristine()}this.calculateIMC()}calculateIMC(){let t=this.informacionMedicaForm.get("peso")?.value,e=this.informacionMedicaForm.get("altura")?.value;if(t&&e&&e>0){let i=e/100,o=t/(i*i)}}saveInformacionMedica(){return h(this,null,function*(){if(this.informacionMedicaForm.invalid){this.markFormGroupTouched(),this.errorMessage="Por favor complete los campos requeridos correctamente";return}this.saving=!0,this.errorMessage="",this.successMessage="";try{let t=this.informacionMedicaForm.value,e=null;if(t.peso&&t.altura){let o=t.altura/100;e=t.peso/(o*o)}let i={usuario_id:t.usuario_id,fecha_nacimiento:t.fecha_nacimiento||null,genero:t.genero||null,telefono:t.telefono||null,direccion:t.direccion||null,diagnostico_principal:t.diagnostico_principal||null,historial_medico:t.historial_medico||null,medicamentos_actuales:t.medicamentos_actuales||null,alergias:t.alergias||null,limitaciones_fisicas:t.limitaciones_fisicas||null,observaciones_generales:t.observaciones_generales||null,contacto_emergencia_nombre:t.contacto_emergencia_nombre||null,contacto_emergencia_telefono:t.contacto_emergencia_telefono||null,contacto_emergencia_relacion:t.contacto_emergencia_relacion||null,peso:t.peso||null,altura:t.altura||null,imc:e,diagnosticos_secundarios:this.processDiagnosticosSecundarios(t.diagnosticos_secundarios)};if(yield this.informacionMedicaService.saveInformacionMedica(i),this.successMessage="Informaci\xF3n m\xE9dica guardada exitosamente",yield this.loadUsuarios(),this.selectedUsuario){let o=this.usuarios.find(c=>c.id===this.selectedUsuario.id);o&&this.selectUsuario(o)}setTimeout(()=>{this.successMessage=""},3e3)}catch(t){console.error("Error al guardar informaci\xF3n m\xE9dica:",t),this.errorMessage=t?.message||"Error al guardar la informaci\xF3n m\xE9dica"}finally{this.saving=!1}})}processDiagnosticosSecundarios(t){return t?Array.isArray(t)?t.filter(e=>e&&e.trim().length>0):typeof t=="string"?t.split(",").map(e=>e.trim()).filter(e=>e.length>0):null:null}markFormGroupTouched(){Object.keys(this.informacionMedicaForm.controls).forEach(t=>{this.informacionMedicaForm.get(t)?.markAsTouched()})}canEditCurrentUser(){return this.selectedUsuario?this.informacionMedicaService.canEditUser(this.selectedUsuario.id):!1}openModal(){this.showModal=!0}closeModal(){this.showModal=!1}getIMC(){let t=this.informacionMedicaForm.get("peso")?.value,e=this.informacionMedicaForm.get("altura")?.value;if(t&&e&&e>0){let i=e/100;return t/(i*i)}return null}getIMCClassification(){let t=this.getIMC();return t?t<18.5?"Bajo peso":t<25?"Peso normal":t<30?"Sobrepeso":"Obesidad":""}getIMCColor(){let t=this.getIMC();return t?t<18.5?"text-blue-600":t<25?"text-green-600":t<30?"text-yellow-600":"text-red-600":"text-gray-500"}getDiagnosticosAsString(){let t=this.informacionMedicaForm.get("diagnosticos_secundarios")?.value;return Array.isArray(t)?t.join(", "):t||""}setDiagnosticosFromString(t){let e=t.split(",").map(i=>i.trim()).filter(i=>i.length>0);this.informacionMedicaForm.patchValue({diagnosticos_secundarios:e})}getAge(t){if(!t)return 0;let e=new Date,i=new Date(t);if(isNaN(i.getTime()))return 0;let o=e.getFullYear()-i.getFullYear(),c=e.getMonth()-i.getMonth();return(c<0||c===0&&e.getDate()<i.getDate())&&o--,o}clearMessages(){this.errorMessage="",this.successMessage=""}reloadData(){return h(this,null,function*(){this.clearMessages(),this.searchTerm="",yield this.loadUsuarios()})}resetForm(){this.selectedUsuario?this.loadInformacionMedica(this.selectedUsuario):this.informacionMedicaForm.reset(),this.clearMessages()}hasFormChanges(){return this.informacionMedicaForm.dirty}getUserDisplayName(t){return t.full_name||t.username||t.email||"Usuario"}hasFieldError(t){let e=this.informacionMedicaForm.get(t);return!!(e&&e.invalid&&e.touched)}getFieldError(t){let e=this.informacionMedicaForm.get(t);return!e||!e.errors||!e.touched?"":e.errors.required?"Este campo es requerido":e.errors.pattern?"Formato inv\xE1lido":e.errors.min?`Valor m\xEDnimo: ${e.errors.min.min}`:e.errors.max?`Valor m\xE1ximo: ${e.errors.max.max}`:"Campo inv\xE1lido"}getShortDiagnosis(t){return t?t.length>50?t.substring(0,50)+"...":t:""}isProfileComplete(t){let e=t.informacion_medica;return e?!!(e.fecha_nacimiento&&e.genero&&e.telefono&&e.contacto_emergencia_nombre&&e.contacto_emergencia_telefono):!1}getProfileCompleteness(t){let e=t.informacion_medica;if(!e)return 0;let i=["fecha_nacimiento","genero","telefono","direccion","diagnostico_principal","historial_medico","contacto_emergencia_nombre","contacto_emergencia_telefono","contacto_emergencia_relacion","peso","altura"],o=0;return i.forEach(c=>{e[c]&&o++}),Math.round(o/i.length*100)}getScrollPages(){let t=this.filteredUsuarios.length,e=Math.ceil(t/this.itemsPerPage);return Array.from({length:e},(i,o)=>o)}getCurrentPageItems(){let t=this.currentScrollPage*this.itemsPerPage,e=t+this.itemsPerPage;return this.filteredUsuarios.slice(t,e)}nextScrollPage(){let t=Math.ceil(this.filteredUsuarios.length/this.itemsPerPage);this.currentScrollPage<t-1&&this.currentScrollPage++}prevScrollPage(){this.currentScrollPage>0&&this.currentScrollPage--}goToScrollPage(t){let e=Math.ceil(this.filteredUsuarios.length/this.itemsPerPage);t>=0&&t<e&&(this.currentScrollPage=t)}static \u0275fac=function(e){return new(e||a)(I(Je),I(bt),I(j))};static \u0275cmp=A({type:a,selectors:[["app-informacion-medica-usuarios"]],standalone:!1,decls:16,vars:9,consts:[[1,"min-h-screen","bg-gradient-to-br","from-blue-50","via-white","to-indigo-50"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-6","text-center"],[1,"bg-gradient-to-r","from-blue-600","to-indigo-600","rounded-xl","shadow-lg","p-4","mb-4"],[1,"text-2xl","font-bold","text-white","mb-1"],[1,"text-blue-100","text-sm"],[4,"ngIf"],["class","mb-6",4,"ngIf"],["class","text-center py-16",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","space-y-8",4,"ngIf"],[1,"mb-6"],[1,"bg-white","rounded-xl","shadow-md","border","border-gray-100","overflow-hidden"],[1,"p-4"],[1,"relative"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","placeholder","Buscar usuario por nombre, email o informaci\xF3n m\xE9dica...",1,"block","w-full","pl-10","pr-3","py-3","text-base","border-0","bg-gray-50","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:bg-white","transition-all","duration-200",3,"ngModelChange","input","ngModel"],[1,"text-center","py-16"],[1,"inline-flex","items-center","justify-center","w-20","h-20","bg-blue-100","rounded-full","mb-4"],[1,"animate-spin","rounded-full","h-12","w-12","border-4","border-blue-600","border-t-transparent"],[1,"text-lg","text-gray-600"],[1,"bg-red-50","border","border-red-200","rounded-2xl","p-8","max-w-md","mx-auto"],[1,"flex","items-center","justify-center","w-16","h-16","bg-red-100","rounded-full","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 15.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-lg","font-semibold","text-red-900","mb-2"],[1,"text-red-700","mb-4"],[1,"inline-flex","items-center","px-4","py-2","bg-red-600","text-white","rounded-lg","hover:bg-red-700","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"overflow-x-auto","pb-4"],[1,"flex","space-x-4",2,"width","max-content"],["class","flex-none w-80 bg-white rounded-lg shadow-md hover:shadow-lg transform hover:-translate-y-1 transition-all duration-300 cursor-pointer border-2 overflow-hidden",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"flex","justify-center","mt-2","space-x-1"],["class","w-2 h-2 rounded-full transition-colors",3,"ngClass",4,"ngFor","ngForOf"],[1,"flex-none","w-80","bg-white","rounded-lg","shadow-md","hover:shadow-lg","transform","hover:-translate-y-1","transition-all","duration-300","cursor-pointer","border-2","overflow-hidden",3,"click","ngClass"],[1,"flex","items-center","space-x-3","mb-3"],[1,"w-10","h-10","bg-gradient-to-br","from-blue-500","to-indigo-600","rounded-full","flex","items-center","justify-center"],[1,"text-white","font-bold","text-sm"],[1,"absolute","-bottom-0.5","-right-0.5","w-3","h-3","rounded-full","border-2","border-white",3,"ngClass"],[1,"flex-1","min-w-0"],[1,"font-semibold","text-gray-900","truncate","text-sm"],[1,"text-xs","text-gray-500","truncate"],[1,"space-y-2"],[1,"flex","items-center","justify-between"],[1,"text-xs","text-gray-600"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["class","border-t pt-2",4,"ngIf"],["class","text-xs text-gray-600",4,"ngIf"],[1,"mt-3","pt-3","border-t"],[1,"text-xs","text-blue-600","font-medium","flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","ml-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"border-t","pt-2"],[1,"text-xs","font-medium","text-gray-900","truncate"],[1,"flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"w-2","h-2","rounded-full","transition-colors",3,"ngClass"],[1,"text-center","py-12"],[1,"bg-gray-50","border","border-gray-200","rounded-xl","p-6","max-w-md","mx-auto"],[1,"w-12","h-12","bg-gray-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-gray-400"],[1,"text-base","font-medium","text-gray-900","mb-1"],[1,"text-sm","text-gray-500"],[1,"bg-gradient-to-br","from-blue-50","to-indigo-50","border-2","border-dashed","border-blue-300","rounded-xl","p-8","max-w-lg","mx-auto"],[1,"w-16","h-16","bg-blue-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-lg","font-bold","text-gray-900","mb-2"],[1,"text-sm","text-gray-600"],[1,"space-y-8"],["class","bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",4,"ngIf"],["class","bg-red-50 border-l-4 border-red-400 p-4 rounded-lg",4,"ngIf"],["class","bg-green-50 border-l-4 border-green-400 p-4 rounded-lg",4,"ngIf"],[1,"bg-white","rounded-2xl","shadow-lg","border","border-gray-100","overflow-hidden"],[3,"ngSubmit","formGroup"],[1,"p-8","border-b","border-gray-100"],[1,"flex","items-center","mb-6"],[1,"w-8","h-8","bg-blue-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[1,"text-xl","font-bold","text-gray-900"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"block","text-sm","font-medium","text-gray-700"],["type","date","formControlName","fecha_nacimiento",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["formControlName","genero",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["value",""],["value","masculino"],["value","femenino"],["value","otro"],["type","tel","formControlName","telefono","placeholder","+502 1234-5678",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],[1,"md:col-span-3","space-y-2"],["formControlName","direccion","rows","2","placeholder","Direcci\xF3n completa",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],[1,"w-8","h-8","bg-red-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"],[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["type","text","formControlName","diagnostico_principal","placeholder","Diagn\xF3stico m\xE9dico principal",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["type","text","placeholder","Separar m\xFAltiples diagn\xF3sticos con comas",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"input","value","disabled"],[1,"text-xs","text-gray-500"],["formControlName","historial_medico","rows","3","placeholder","Historial m\xE9dico relevante, cirug\xEDas previas, etc.",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],["formControlName","medicamentos_actuales","rows","3","placeholder","Lista de medicamentos que toma actualmente",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],["formControlName","alergias","rows","3","placeholder","Alergias conocidas a medicamentos, alimentos, etc.",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],["formControlName","limitaciones_fisicas","rows","2","placeholder","Limitaciones o restricciones f\xEDsicas",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],["formControlName","observaciones_generales","rows","3","placeholder","Observaciones adicionales relevantes",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],[1,"w-8","h-8","bg-green-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],["type","number","formControlName","peso","step","0.1","min","1","max","300","placeholder","70.5",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"input","disabled"],["type","number","formControlName","altura","min","50","max","250","placeholder","175",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"input","disabled"],[1,"bg-gray-50","border","border-gray-300","rounded-lg","p-4","h-14","flex","items-center","justify-center"],["class","text-center",4,"ngIf"],["class","text-center text-gray-500 text-sm",4,"ngIf"],[1,"w-8","h-8","bg-orange-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"],["type","text","formControlName","contacto_emergencia_nombre","placeholder","Nombre del contacto de emergencia",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["type","tel","formControlName","contacto_emergencia_telefono","placeholder","+502 1234-5678",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["formControlName","contacto_emergencia_relacion",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["value","padre"],["value","madre"],["value","esposo"],["value","esposa"],["value","hijo"],["value","hija"],["value","hermano"],["value","hermana"],["value","amigo"],[1,"p-8"],["class","flex justify-end space-x-4",4,"ngIf"],["class","bg-yellow-50 border border-yellow-200 rounded-lg p-6",4,"ngIf"],[1,"bg-white","rounded-xl","shadow-lg","border","border-gray-100","overflow-hidden"],[1,"bg-gradient-to-r","from-blue-600","to-indigo-600","p-4"],[1,"flex","items-center","space-x-4"],[1,"w-14","h-14","bg-white/20","backdrop-blur-sm","rounded-full","flex","items-center","justify-center"],[1,"text-xl","font-bold","text-white"],[1,"flex-1"],[1,"text-xl","font-bold","text-white","mb-1"],[1,"text-blue-100","mb-1","text-sm"],[1,"flex","items-center","space-x-3"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium","bg-white/20","text-white"],[1,"w-1.5","h-1.5","rounded-full","mr-1.5",3,"ngClass"],["class","text-blue-100 text-xs",4,"ngIf"],["class","text-right",4,"ngIf"],[1,"text-blue-100","text-xs"],[1,"text-right"],[1,"p-1.5","rounded-full","bg-white/20","hover:bg-white/30","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"bg-red-50","border-l-4","border-red-400","p-4","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-400","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-red-700"],[1,"ml-auto","text-red-400","hover:text-red-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],[1,"bg-green-50","border-l-4","border-green-400","p-4","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-400","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-green-700"],[1,"ml-auto","text-green-400","hover:text-green-600",3,"click"],[1,"text-center"],[1,"text-lg","font-bold",3,"ngClass"],[1,"text-center","text-gray-500","text-sm"],[1,"flex","justify-end","space-x-4"],["type","button",1,"px-6","py-3","border","border-gray-300","rounded-lg","text-gray-700","font-medium","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-500","transition-all",3,"click"],["type","submit",1,"px-6","py-3","bg-gradient-to-r","from-blue-600","to-indigo-600","text-white","font-medium","rounded-lg","hover:from-blue-700","hover:to-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50","disabled:cursor-not-allowed","transition-all",3,"disabled"],["class","flex items-center",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-5","h-5","mr-2"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"bg-yellow-50","border","border-yellow-200","rounded-lg","p-6"],[1,"flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-yellow-400"],[1,"ml-3"],[1,"text-sm","font-medium","text-yellow-800"],[1,"text-sm","text-yellow-700","mt-1"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),s(5,"Informaci\xF3n M\xE9dica de Usuarios"),r(),n(6,"p",5),x(7,Vs,2,0,"span",6)(8,Fs,2,0,"span",6),r()()(),x(9,Ds,8,1,"div",7)(10,As,5,0,"div",8)(11,Rs,13,1,"div",8)(12,zs,6,2,"div",7)(13,Bs,9,1,"div",9)(14,$s,9,0,"div",9)(15,tl,145,25,"div",10),r()()),e&2&&(l(7),m("ngIf",i.isAdmin),l(),m("ngIf",!i.isAdmin),l(),m("ngIf",i.isAdmin),l(),m("ngIf",i.loading),l(),m("ngIf",i.errorMessage&&!i.loading),l(),m("ngIf",i.isAdmin&&!i.loading&&i.usuarios.length>0),l(),m("ngIf",i.filteredUsuarios.length===0&&i.searchTerm),l(),m("ngIf",!i.selectedUsuario&&i.isAdmin&&!i.loading),l(),m("ngIf",i.selectedUsuario||!i.isAdmin))},dependencies:[$,N,R,ee,J,Z,q,Pe,Q,W,K,Oe,Ie,Ye,Qe,G,Rt],styles:[".transition-all[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.hover\\:-translate-y-1[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}.bg-gradient-to-br[_ngcontent-%COMP%]{background:linear-gradient(to bottom right,var(--tw-gradient-stops))}.focus\\:ring-2[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 2px #3b82f680}.shadow-xl[_ngcontent-%COMP%]{box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.animate-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}.focus\\:outline-none[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px}@media (max-width: 768px){.grid[_ngcontent-%COMP%]{gap:1rem}.p-8[_ngcontent-%COMP%]{padding:1.5rem}.text-4xl[_ngcontent-%COMP%]{font-size:2rem}}"]})};var nl=(a,t,e)=>({"bg-primary":a,"bg-success":t,"bg-info":e}),rl=(a,t,e,i)=>({"alert-warning":a,"alert-success":t,"alert-danger":e,"alert-secondary":i});function ol(a,t){if(a&1&&(n(0,"div",1)(1,"div",30)(2,"div",31)(3,"div",32)(4,"div",33)(5,"div",34)(6,"div",35),s(7," Total Compras "),r(),n(8,"div",36),s(9),r()(),n(10,"div",37),p(11,"i",38),r()()()()(),n(12,"div",30)(13,"div",39)(14,"div",32)(15,"div",33)(16,"div",34)(17,"div",40),s(18," Validadas "),r(),n(19,"div",36),s(20),r()(),n(21,"div",37),p(22,"i",41),r()()()()(),n(23,"div",30)(24,"div",42)(25,"div",32)(26,"div",33)(27,"div",34)(28,"div",43),s(29," Pendientes "),r(),n(30,"div",36),s(31),r()(),n(32,"div",37),p(33,"i",44),r()()()()(),n(34,"div",30)(35,"div",45)(36,"div",32)(37,"div",33)(38,"div",34)(39,"div",46),s(40," Monto Total "),r(),n(41,"div",36),s(42),r()(),n(43,"div",37),p(44,"i",47),r()()()()()()),a&2){let e=d();l(9),v(" ",e.estadisticasPersonales.total," "),l(11),v(" ",e.estadisticasPersonales.validadas," "),l(11),v(" ",e.estadisticasPersonales.pendientes," "),l(11),v(" ",e.formatearPrecio(e.estadisticasPersonales.montoValidado)," ")}}function al(a,t){if(a&1&&(n(0,"option",63),s(1),r()),a&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function sl(a,t){if(a&1&&(n(0,"option",63),s(1),r()),a&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function ll(a,t){if(a&1){let e=C();n(0,"div",1)(1,"div",48)(2,"label",49),s(3,"Estado"),r(),n(4,"select",50),k("ngModelChange",function(o){u(e);let c=d();return E(c.filtroEstado,o)||(c.filtroEstado=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.onFiltroEstadoChange())}),x(5,al,2,2,"option",51),r()(),n(6,"div",48)(7,"label",52),s(8,"M\xE9todo de Pago"),r(),n(9,"select",53),k("ngModelChange",function(o){u(e);let c=d();return E(c.filtroMetodo,o)||(c.filtroMetodo=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.onFiltroMetodoChange())}),x(10,sl,2,2,"option",51),r()(),n(11,"div",54)(12,"label",55),s(13,"Buscar"),r(),n(14,"div",56)(15,"span",57),p(16,"i",58),r(),n(17,"input",59),k("ngModelChange",function(o){u(e);let c=d();return E(c.busqueda,o)||(c.busqueda=o),g(o)}),f("input",function(){u(e);let o=d();return g(o.onBusquedaChange())}),r()()(),n(18,"div",60)(19,"button",61),f("click",function(){u(e);let o=d();return g(o.limpiarFiltros())}),p(20,"i",62),s(21," Limpiar "),r()()()}if(a&2){let e=d();l(4),M("ngModel",e.filtroEstado),l(),m("ngForOf",e.estadosCompra),l(4),M("ngModel",e.filtroMetodo),l(),m("ngForOf",e.metodosPago),l(7),M("ngModel",e.busqueda)}}function cl(a,t){a&1&&(n(0,"div",64)(1,"div",65)(2,"span",66),s(3,"Cargando compras..."),r()(),n(4,"p",67),s(5,"Cargando tus compras..."),r()())}function dl(a,t){if(a&1){let e=C();n(0,"div",68),p(1,"i",69),s(2),n(3,"button",70),f("click",function(){u(e);let o=d();return g(o.cargarMisCompras())}),p(4,"i",71),s(5," Reintentar "),r()()}if(a&2){let e=d();l(2),v(" ",e.error," ")}}function ml(a,t){if(a&1){let e=C();n(0,"div",64),p(1,"i",72),n(2,"h4",73),s(3,"No tienes compras a\xFAn"),r(),n(4,"p",74),s(5,"\xA1Explora nuestros paquetes y realiza tu primera compra!"),r(),n(6,"button",75),f("click",function(){u(e);let o=d();return g(o.irAComprarPaquetes())}),p(7,"i",76),s(8," Explorar Paquetes "),r()()}}function pl(a,t){if(a&1){let e=C();n(0,"div",64),p(1,"i",77),n(2,"h5",78),s(3,"No se encontraron compras"),r(),n(4,"p",78),s(5,"No hay compras que coincidan con los filtros aplicados"),r(),n(6,"button",79),f("click",function(){u(e);let o=d();return g(o.limpiarFiltros())}),p(7,"i",62),s(8," Limpiar filtros "),r()()}}function ul(a,t){if(a&1&&(n(0,"div",110),s(1),r()),a&2){let e=d().$implicit;l(),v(" Transacci\xF3n: ",e.numero_transaccion," ")}}function gl(a,t){if(a&1&&(n(0,"div",111)(1,"span",112),s(2),r(),n(3,"span",113),s(4),r()()),a&2){let e=d().$implicit,i=d(2);l(2),v(" ",i.formatearPrecio(e.precio_paquete)," "),l(2),v(" -",i.formatearPrecio(e.descuento_aplicado)," ")}}function fl(a,t){if(a&1&&(n(0,"div",91)(1,"div",114)(2,"strong",96),s(3,"Motivo del rechazo:"),r(),n(4,"div",96),s(5),r()()()),a&2){let e=d().$implicit;l(5),w(e.motivo_rechazo)}}function _l(a,t){if(a&1){let e=C();n(0,"button",115),f("click",function(){u(e);let o=d().$implicit,c=d(2);return g(c.verComprobante(o))}),p(1,"i",116),s(2," Comprobante "),r()}}function xl(a,t){if(a&1){let e=C();n(0,"button",117),f("click",function(){u(e);let o=d(3);return g(o.irAPaquetesAsignados())}),p(1,"i",118),s(2," Ver Calendario "),r()}}function vl(a,t){if(a&1){let e=C();n(0,"div",84)(1,"div",85)(2,"div",86)(3,"div")(4,"strong",87),s(5),r(),n(6,"small",88),s(7),r()(),n(8,"span",89),p(9,"i",90),s(10),ce(11,"titlecase"),r()(),n(12,"div",32)(13,"div",91)(14,"h6",92),s(15),r(),n(16,"span",93),s(17),ce(18,"titlecase"),r()(),n(19,"div",91)(20,"div",94),p(21,"i",95),n(22,"span",96),s(23),r()(),x(24,ul,2,1,"div",97),r(),n(25,"div",91),x(26,gl,5,2,"div",98),n(27,"div",99),s(28),r()(),n(29,"div",91)(30,"div",100)(31,"small",101),p(32,"i",90),s(33),r()()(),x(34,fl,6,1,"div",102),n(35,"div",91)(36,"small",78),p(37,"i",103),s(38),r()()(),n(39,"div",104)(40,"div",3)(41,"div",105),x(42,_l,3,0,"button",106)(43,xl,3,0,"button",107),r(),n(44,"button",108),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.verDetalleCompra(o))}),p(45,"i",109),r()()()()()}if(a&2){let e=t.$implicit,i=d(2);l(5),v("#",e.compra_id,""),l(2),w(i.formatearFechaCorta(e.fecha_compra)),l(),m("ngClass",i.obtenerClaseEstado(e.estado_compra)),l(),D(i.obtenerIconoEstado(e.estado_compra)),l(),v(" ",pe(11,24,e.estado_compra)," "),l(5),w(e.paquete_nombre),l(),m("ngClass",Ne(28,nl,e.paquete_tipo==="rutina",e.paquete_tipo==="terapia",e.paquete_tipo==="mixto")),l(),v(" ",pe(18,26,e.paquete_tipo)," "),l(4),D(i.obtenerIconoMetodoPago(e.metodo_pago)),m("ngClass",i.obtenerClaseMetodoPago(e.metodo_pago)),l(2),w(i.obtenerLabelMetodoPago(e.metodo_pago)),l(),m("ngIf",e.numero_transaccion),l(2),m("ngIf",e.descuento_aplicado>0),l(2),v(" ",i.formatearPrecio(e.precio_final)," "),l(2),m("ngClass",ve(32,rl,e.estado_compra==="pendiente",e.estado_compra==="validada",e.estado_compra==="rechazada",e.estado_compra==="cancelada")),l(2),D(i.obtenerIconoEstado(e.estado_compra)),l(),v(" ",i.obtenerMensajeEstado(e)," "),l(),m("ngIf",e.estado_compra==="rechazada"&&e.motivo_rechazo),l(4),v(" Hace ",i.calcularTiempoTranscurrido(e.horas_desde_compra)," "),l(4),m("ngIf",i.mostrarBotonVerComprobante(e)),l(),m("ngIf",i.mostrarBotonIrAPaquetes(e))}}function bl(a,t){if(a&1&&(n(0,"div",119)(1,"div",2)(2,"div",120)(3,"div",121)(4,"h6",73),s(5,"Resumen de tus compras"),r(),n(6,"div",81)(7,"div",122)(8,"div",123),s(9),r(),n(10,"small",78),s(11,"Compras exitosas"),r()(),n(12,"div",122)(13,"div",124),s(14),r(),n(15,"small",78),s(16,"Tasa de \xE9xito"),r()(),n(17,"div",122)(18,"div",125),s(19),r(),n(20,"small",78),s(21,"Invertido"),r()()()()()()()),a&2){let e=d(2);l(9),w(e.estadisticasPersonales.validadas),l(5),v("",e.porcentajeValidadas,"%"),l(5),w(e.formatearPrecio(e.estadisticasPersonales.montoValidado))}}function hl(a,t){if(a&1&&(n(0,"div")(1,"div",80)(2,"div",2)(3,"span",78),s(4),r()()(),n(5,"div",81),x(6,vl,46,37,"div",82),r(),x(7,bl,22,3,"div",83),r()),a&2){let e=d();l(4),Re(" ",e.comprasFiltradas.length," compra",e.comprasFiltradas.length!==1?"s":""," encontrada",e.comprasFiltradas.length!==1?"s":""," "),l(2),m("ngForOf",e.comprasFiltradas),l(),m("ngIf",e.comprasFiltradas.length>3)}}function Cl(a,t){if(a&1&&(n(0,"div",91),p(1,"img",128),r()),a&2){let e=d(2);l(),m("src",e.comprobanteActual,me)("alt",e.comprobanteNombre)}}function wl(a,t){if(a&1&&(n(0,"div",91)(1,"div",129),p(2,"i",130),n(3,"h5"),s(4),r(),n(5,"p",101),s(6,"Archivo PDF - Descargar para ver el contenido completo"),r()()()),a&2){let e=d(2);l(4),w(e.comprobanteNombre)}}function yl(a,t){if(a&1&&(n(0,"div",126),x(1,Cl,2,2,"div",102)(2,wl,7,1,"div",102),n(3,"div",127)(4,"h6",78),s(5),r()()()),a&2){let e=d();l(),m("ngIf",e.comprobanteActual.includes("image")),l(),m("ngIf",e.comprobanteActual.includes("pdf")),l(3),w(e.comprobanteNombre)}}function Sl(a,t){a&1&&(n(0,"div",131),p(1,"i",132),n(2,"p",78),s(3,"No se pudo cargar el comprobante"),r()())}function Ml(a,t){if(a&1){let e=C();n(0,"button",10),f("click",function(){u(e);let o=d();return g(o.descargarComprobante())}),p(1,"i",133),s(2," Descargar "),r()}}function El(a,t){a&1&&p(0,"div",134)}var Ct=class a{constructor(t,e,i){this.compraPaquetesService=t;this.authService=e;this.router=i}cargando=!1;error=null;misCompras=[];comprasFiltradas=[];filtroEstado="todos";filtroMetodo="todos";busqueda="";estadosCompra=[{value:"todos",label:"Todos los estados"},...tt];metodosPago=[{value:"todos",label:"Todos los m\xE9todos"},...et];mostrarModalComprobante=!1;comprobanteActual=null;comprobanteNombre="";estadisticasPersonales={total:0,pendientes:0,validadas:0,rechazadas:0,montoTotal:0,montoValidado:0};ngOnInit(){this.cargarMisCompras()}cargarMisCompras(){return h(this,null,function*(){this.cargando=!0,this.error=null;try{this.misCompras=yield this.compraPaquetesService.obtenerMisCompras(),this.calcularEstadisticasPersonales(),this.aplicarFiltros()}catch(t){console.error("Error cargando mis compras:",t),this.error="Error al cargar tus compras. Intenta nuevamente."}finally{this.cargando=!1}})}calcularEstadisticasPersonales(){this.estadisticasPersonales={total:this.misCompras.length,pendientes:this.misCompras.filter(t=>t.estado_compra==="pendiente").length,validadas:this.misCompras.filter(t=>t.estado_compra==="validada").length,rechazadas:this.misCompras.filter(t=>t.estado_compra==="rechazada").length,montoTotal:this.misCompras.reduce((t,e)=>t+e.precio_final,0),montoValidado:this.misCompras.filter(t=>t.estado_compra==="validada").reduce((t,e)=>t+e.precio_final,0)}}aplicarFiltros(){let t=[...this.misCompras];if(this.filtroEstado!=="todos"&&(t=t.filter(e=>e.estado_compra===this.filtroEstado)),this.filtroMetodo!=="todos"&&(t=t.filter(e=>e.metodo_pago===this.filtroMetodo)),this.busqueda.trim()){let e=this.busqueda.toLowerCase().trim();t=t.filter(i=>i.paquete_nombre.toLowerCase().includes(e)||i.numero_transaccion?.toLowerCase().includes(e)||i.compra_id.toString().includes(e))}this.comprasFiltradas=t.sort((e,i)=>new Date(i.fecha_compra).getTime()-new Date(e.fecha_compra).getTime())}onFiltroEstadoChange(){this.aplicarFiltros()}onFiltroMetodoChange(){this.aplicarFiltros()}onBusquedaChange(){this.aplicarFiltros()}limpiarFiltros(){this.filtroEstado="todos",this.filtroMetodo="todos",this.busqueda="",this.aplicarFiltros()}verComprobante(t){return h(this,null,function*(){if(t.tiene_comprobante)try{let e=yield this.compraPaquetesService.obtenerComprobanteBase64(t.compra_id);if(e){let i=this.obtenerTipoMime(t.comprobante_tipo||"");this.comprobanteActual=`data:${i};base64,${e}`,this.comprobanteNombre=t.comprobante_nombre||"Comprobante",this.mostrarModalComprobante=!0}else this.error="No se pudo cargar el comprobante"}catch(e){console.error("Error cargando comprobante:",e),this.error="Error al cargar el comprobante"}})}cerrarModalComprobante(){this.mostrarModalComprobante=!1,this.comprobanteActual=null,this.comprobanteNombre=""}descargarComprobante(){if(!this.comprobanteActual)return;let t=document.createElement("a");t.href=this.comprobanteActual,t.download=this.comprobanteNombre,document.body.appendChild(t),t.click(),document.body.removeChild(t)}obtenerTipoMime(t){return{"image/jpeg":"image/jpeg","image/jpg":"image/jpeg","image/png":"image/png","application/pdf":"application/pdf"}[t]||"application/octet-stream"}irAComprarPaquetes(){this.router.navigate(["/compra-paquetes"])}verDetalleCompra(t){console.log("Ver detalle de compra:",t)}formatearPrecio(t){return this.compraPaquetesService.formatearPrecio(t)}formatearFecha(t){return new Date(t).toLocaleDateString("es-GT",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}formatearFechaCorta(t){return new Date(t).toLocaleDateString("es-GT",{day:"numeric",month:"short",year:"numeric"})}obtenerClaseEstado(t){return{pendiente:"badge bg-warning text-dark",validada:"badge bg-success",rechazada:"badge bg-danger",cancelada:"badge bg-secondary"}[t]||"badge bg-secondary"}obtenerIconoEstado(t){return{pendiente:"fas fa-clock",validada:"fas fa-check-circle",rechazada:"fas fa-times-circle",cancelada:"fas fa-ban"}[t]||"fas fa-question-circle"}obtenerColorEstado(t){return{pendiente:"text-warning",validada:"text-success",rechazada:"text-danger",cancelada:"text-secondary"}[t]||"text-muted"}obtenerClaseMetodoPago(t){return{transferencia:"text-primary",deposito:"text-info",tarjeta_credito:"text-success",tarjeta_debito:"text-warning"}[t]||"text-muted"}obtenerIconoMetodoPago(t){return{transferencia:"fas fa-university",deposito:"fas fa-piggy-bank",tarjeta_credito:"fas fa-credit-card",tarjeta_debito:"fas fa-credit-card"}[t]||"fas fa-credit-card"}obtenerLabelMetodoPago(t){return this.metodosPago.find(i=>i.value===t)?.label||t}calcularTiempoTranscurrido(t){if(t<1){let e=Math.round(t*60);return`${e} minuto${e!==1?"s":""}`}else if(t<24){let e=Math.round(t);return`${e} hora${e!==1?"s":""}`}else{let e=Math.round(t/24);return`${e} d\xEDa${e!==1?"s":""}`}}obtenerMensajeEstado(t){switch(t.estado_compra){case"pendiente":return"Tu compra est\xE1 siendo revisada por un administrador";case"validada":return t.asignacion_completada?"Compra validada y paquete asignado":"Compra validada, pendiente de asignaci\xF3n";case"rechazada":return t.motivo_rechazo||"Compra rechazada";case"cancelada":return"Compra cancelada";default:return t.estado_descripcion}}mostrarBotonVerComprobante(t){return t.tiene_comprobante}mostrarBotonIrAPaquetes(t){return t.estado_compra==="validada"&&t.asignacion_completada}irAPaquetesAsignados(){this.router.navigate(["/calendario-paquetes"])}get tieneCompras(){return this.misCompras.length>0}get tieneComprasFiltradas(){return this.comprasFiltradas.length>0}get porcentajeValidadas(){return this.estadisticasPersonales.total===0?0:Math.round(this.estadisticasPersonales.validadas/this.estadisticasPersonales.total*100)}static \u0275fac=function(e){return new(e||a)(I(it),I(j),I(ue))};static \u0275cmp=A({type:a,selectors:[["app-mis-compras"]],standalone:!1,decls:40,vars:18,consts:[[1,"container-fluid","px-4"],[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"h3","mb-0","text-gray-800"],[1,"fas","fa-shopping-bag","me-2"],[1,"text-muted","mb-0"],[1,"d-flex","gap-2"],["type","button",1,"btn","btn-outline-primary",3,"click","disabled"],[1,"fas","fa-sync-alt","me-1"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus","me-1"],["class","row mb-4",4,"ngIf"],["class","text-center py-5",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],[4,"ngIf"],["tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-file-image","me-2"],["type","button",1,"btn-close",3,"click"],[1,"modal-body","text-center"],["class","comprobante-container",4,"ngIf"],["class","text-center py-4",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["class","modal-backdrop fade show",4,"ngIf"],[1,"col-xl-3","col-md-6","mb-4"],[1,"card","border-left-primary","shadow","h-100","py-2"],[1,"card-body"],[1,"row","no-gutters","align-items-center"],[1,"col","mr-2"],[1,"text-xs","font-weight-bold","text-primary","text-uppercase","mb-1"],[1,"h5","mb-0","font-weight-bold","text-gray-800"],[1,"col-auto"],[1,"fas","fa-shopping-cart","fa-2x","text-gray-300"],[1,"card","border-left-success","shadow","h-100","py-2"],[1,"text-xs","font-weight-bold","text-success","text-uppercase","mb-1"],[1,"fas","fa-check","fa-2x","text-gray-300"],[1,"card","border-left-warning","shadow","h-100","py-2"],[1,"text-xs","font-weight-bold","text-warning","text-uppercase","mb-1"],[1,"fas","fa-clock","fa-2x","text-gray-300"],[1,"card","border-left-info","shadow","h-100","py-2"],[1,"text-xs","font-weight-bold","text-info","text-uppercase","mb-1"],[1,"fas","fa-dollar-sign","fa-2x","text-gray-300"],[1,"col-md-3","mb-3"],["for","filtroEstado",1,"form-label"],["id","filtroEstado",1,"form-select",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","filtroMetodo",1,"form-label"],["id","filtroMetodo",1,"form-select",3,"ngModelChange","change","ngModel"],[1,"col-md-4","mb-3"],["for","busqueda",1,"form-label"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text","id","busqueda","placeholder","Buscar por paquete, transacci\xF3n...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"col-md-2","mb-3","d-flex","align-items-end"],["type","button",1,"btn","btn-outline-secondary","w-100",3,"click"],[1,"fas","fa-times","me-1"],[3,"value"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"],["role","alert",1,"alert","alert-danger"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button",1,"btn","btn-sm","btn-outline-danger","ms-2",3,"click"],[1,"fas","fa-redo","me-1"],[1,"fas","fa-shopping-bag","fa-4x","text-muted","mb-4"],[1,"text-muted","mb-3"],[1,"text-muted","mb-4"],["type","button",1,"btn","btn-primary","btn-lg",3,"click"],[1,"fas","fa-shopping-cart","me-2"],[1,"fas","fa-search","fa-3x","text-muted","mb-3"],[1,"text-muted"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"row","mb-3"],[1,"row"],["class","col-lg-6 col-xl-4 mb-4",4,"ngFor","ngForOf"],["class","row mt-4",4,"ngIf"],[1,"col-lg-6","col-xl-4","mb-4"],[1,"card","h-100","shadow-sm"],[1,"card-header","bg-light","d-flex","justify-content-between","align-items-center"],[1,"text-primary"],[1,"text-muted","d-block"],[3,"ngClass"],[1,"me-1"],[1,"mb-3"],[1,"card-title","mb-1"],[1,"badge",3,"ngClass"],[1,"d-flex","align-items-center"],[1,"me-2",3,"ngClass"],[1,"small"],["class","small text-muted",4,"ngIf"],["class","mb-1",4,"ngIf"],[1,"h5","mb-0","text-primary","fw-bold"],[1,"alert","p-2","mb-0",3,"ngClass"],[1,"mb-0"],["class","mb-3",4,"ngIf"],[1,"fas","fa-clock","me-1"],[1,"card-footer","bg-light"],[1,"d-flex","gap-1"],["type","button","class","btn btn-sm btn-outline-info","title","Ver comprobante",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-outline-success","title","Ver en calendario",3,"click",4,"ngIf"],["type","button","title","Ver detalles",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fas","fa-eye"],[1,"small","text-muted"],[1,"mb-1"],[1,"text-muted","text-decoration-line-through","small"],[1,"badge","bg-success","ms-2"],[1,"alert","alert-danger","p-2"],["type","button","title","Ver comprobante",1,"btn","btn-sm","btn-outline-info",3,"click"],[1,"fas","fa-file-image","me-1"],["type","button","title","Ver en calendario",1,"btn","btn-sm","btn-outline-success",3,"click"],[1,"fas","fa-calendar","me-1"],[1,"row","mt-4"],[1,"card","border-0","bg-light"],[1,"card-body","text-center"],[1,"col-4"],[1,"text-primary","h4","mb-0"],[1,"text-success","h4","mb-0"],[1,"text-info","h4","mb-0"],[1,"comprobante-container"],[1,"mt-3"],[1,"img-fluid","rounded","shadow",2,"max-height","500px",3,"src","alt"],[1,"alert","alert-info"],[1,"fas","fa-file-pdf","fa-4x","mb-3","text-primary"],[1,"text-center","py-4"],[1,"fas","fa-exclamation-triangle","fa-3x","text-muted","mb-3"],[1,"fas","fa-download","me-1"],[1,"modal-backdrop","fade","show"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h1",4),p(6,"i",5),s(7," Mis Compras "),r(),n(8,"p",6),s(9,"Historial y estado de tus compras de paquetes"),r()(),n(10,"div",7)(11,"button",8),f("click",function(){return i.cargarMisCompras()}),p(12,"i",9),s(13," Actualizar "),r(),n(14,"button",10),f("click",function(){return i.irAComprarPaquetes()}),p(15,"i",11),s(16," Comprar Paquetes "),r()()()()(),x(17,ol,45,4,"div",12)(18,ll,22,5,"div",12)(19,cl,6,0,"div",13)(20,dl,6,1,"div",14)(21,ml,9,0,"div",13)(22,pl,9,0,"div",13)(23,hl,8,5,"div",15),r(),n(24,"div",16)(25,"div",17)(26,"div",18)(27,"div",19)(28,"h5",20),p(29,"i",21),s(30," Mi Comprobante de Pago "),r(),n(31,"button",22),f("click",function(){return i.cerrarModalComprobante()}),r()(),n(32,"div",23),x(33,yl,6,3,"div",24)(34,Sl,4,0,"div",25),r(),n(35,"div",26)(36,"button",27),f("click",function(){return i.cerrarModalComprobante()}),s(37," Cerrar "),r(),x(38,Ml,3,0,"button",28),r()()()(),x(39,El,1,0,"div",29)),e&2&&(l(11),m("disabled",i.cargando),l(),O("fa-spin",i.cargando),l(5),m("ngIf",i.tieneCompras),l(),m("ngIf",i.tieneCompras),l(),m("ngIf",i.cargando),l(),m("ngIf",i.error&&!i.cargando),l(),m("ngIf",!i.cargando&&!i.error&&!i.tieneCompras),l(),m("ngIf",!i.cargando&&!i.error&&i.tieneCompras&&!i.tieneComprasFiltradas),l(),m("ngIf",!i.cargando&&!i.error&&i.tieneComprasFiltradas),l(),Y("display",i.mostrarModalComprobante?"block":"none"),O("show",i.mostrarModalComprobante),l(9),m("ngIf",i.comprobanteActual),l(),m("ngIf",!i.comprobanteActual),l(4),m("ngIf",i.comprobanteActual),l(),m("ngIf",i.mostrarModalComprobante))},dependencies:[$,N,R,J,Z,q,Q,W,G,Te],styles:[".container-fluid[_ngcontent-%COMP%]{min-height:100vh;background-color:#f8f9fc}.h3[_ngcontent-%COMP%]{color:#5a5c69;font-weight:600}.border-left-primary[_ngcontent-%COMP%]{border-left:.25rem solid #4e73df!important}.border-left-success[_ngcontent-%COMP%]{border-left:.25rem solid #1cc88a!important}.border-left-warning[_ngcontent-%COMP%]{border-left:.25rem solid #f6c23e!important}.border-left-info[_ngcontent-%COMP%]{border-left:.25rem solid #36b9cc!important}.text-xs[_ngcontent-%COMP%]{font-size:.7rem}.font-weight-bold[_ngcontent-%COMP%]{font-weight:700!important}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase!important}.text-gray-800[_ngcontent-%COMP%]{color:#5a5c69!important}.text-gray-300[_ngcontent-%COMP%]{color:#dddfeb!important}.card[_ngcontent-%COMP%]{border-radius:.75rem;transition:all .3s ease;border:1px solid #e3e6f0}.card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 .5rem 1rem #0000001a!important}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fc!important;border-bottom:1px solid #e3e6f0;padding:1rem 1.25rem;border-radius:.75rem .75rem 0 0!important}.card-body[_ngcontent-%COMP%]{padding:1.25rem}.card-footer[_ngcontent-%COMP%]{background-color:#f8f9fc!important;border-top:1px solid #e3e6f0;padding:.75rem 1.25rem;border-radius:0 0 .75rem .75rem!important}.card-title[_ngcontent-%COMP%]{color:#5a5c69;font-weight:600;margin-bottom:.5rem}.badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem .75rem;border-radius:.5rem;font-weight:600}.badge.bg-primary[_ngcontent-%COMP%]{background-color:#4e73df!important}.badge.bg-success[_ngcontent-%COMP%]{background-color:#1cc88a!important}.badge.bg-info[_ngcontent-%COMP%]{background-color:#36b9cc!important}.badge.bg-warning[_ngcontent-%COMP%]{background-color:#f6c23e!important;color:#5a5c69!important}.badge.bg-danger[_ngcontent-%COMP%]{background-color:#e74a3b!important}.badge.bg-secondary[_ngcontent-%COMP%]{background-color:#858796!important}.badge.bg-light[_ngcontent-%COMP%]{background-color:#f8f9fc!important;color:#5a5c69!important;border:1px solid #e3e6f0}.alert[_ngcontent-%COMP%]{border:none;border-radius:.5rem;font-size:.875rem}.alert-warning[_ngcontent-%COMP%]{background-color:#f6c23e26;color:#b07e07;border-left:4px solid #f6c23e}.alert-success[_ngcontent-%COMP%]{background-color:#1cc88a26;color:#0e6b47;border-left:4px solid #1cc88a}.alert-danger[_ngcontent-%COMP%]{background-color:#e74a3b26;color:#721c24;border-left:4px solid #e74a3b}.alert-info[_ngcontent-%COMP%]{background-color:#36b9cc26;color:#0c5460;border-left:4px solid #36b9cc}.alert-secondary[_ngcontent-%COMP%]{background-color:#85879626;color:#383d41;border-left:4px solid #858796}.btn[_ngcontent-%COMP%]{border-radius:.375rem;font-weight:600;transition:all .15s ease-in-out}.btn-primary[_ngcontent-%COMP%]{background-color:#4e73df;border-color:#4e73df}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#2e59d9;border-color:#2653d4;transform:translateY(-1px)}.btn-outline-primary[_ngcontent-%COMP%]{color:#4e73df;border-color:#4e73df}.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:#4e73df;border-color:#4e73df;color:#fff}.btn-success[_ngcontent-%COMP%]{background-color:#1cc88a;border-color:#1cc88a}.btn-outline-success[_ngcontent-%COMP%]{color:#1cc88a;border-color:#1cc88a}.btn-outline-success[_ngcontent-%COMP%]:hover{background-color:#1cc88a;border-color:#1cc88a;color:#fff}.btn-outline-info[_ngcontent-%COMP%]{color:#36b9cc;border-color:#36b9cc}.btn-outline-info[_ngcontent-%COMP%]:hover{background-color:#36b9cc;border-color:#36b9cc;color:#fff}.btn-outline-secondary[_ngcontent-%COMP%]{color:#858796;border-color:#858796}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#858796;border-color:#858796;color:#fff}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.875rem}.btn-lg[_ngcontent-%COMP%]{padding:.75rem 1.5rem;font-size:1.125rem}.form-label[_ngcontent-%COMP%]{font-weight:600;color:#5a5c69;margin-bottom:.5rem}.form-select[_ngcontent-%COMP%], .form-control[_ngcontent-%COMP%]{border:1px solid #d1d3e2;border-radius:.375rem;transition:all .15s ease-in-out}.form-select[_ngcontent-%COMP%]:focus, .form-control[_ngcontent-%COMP%]:focus{border-color:#4e73df;box-shadow:0 0 0 .2rem #4e73df40}.input-group-text[_ngcontent-%COMP%]{background-color:#f8f9fc;border-color:#d1d3e2;color:#6c757d}.text-primary[_ngcontent-%COMP%]{color:#4e73df!important}.text-success[_ngcontent-%COMP%]{color:#1cc88a!important}.text-info[_ngcontent-%COMP%]{color:#36b9cc!important}.text-warning[_ngcontent-%COMP%]{color:#f6c23e!important}.text-danger[_ngcontent-%COMP%]{color:#e74a3b!important}.text-muted[_ngcontent-%COMP%], .text-secondary[_ngcontent-%COMP%]{color:#858796!important}.modal[_ngcontent-%COMP%]{background-color:#00000080}.modal-dialog[_ngcontent-%COMP%]{margin:1.75rem auto}.modal-content[_ngcontent-%COMP%]{border:none;border-radius:.75rem;box-shadow:0 1rem 3rem #0000002d}.modal-header[_ngcontent-%COMP%]{background-color:#f8f9fc;border-bottom:1px solid #e3e6f0;border-radius:.75rem .75rem 0 0;padding:1.5rem}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-footer[_ngcontent-%COMP%]{background-color:#f8f9fc;border-top:1px solid #e3e6f0;border-radius:0 0 .75rem .75rem;padding:1rem 1.5rem}.modal-title[_ngcontent-%COMP%]{color:#5a5c69;font-weight:600}.comprobante-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;height:auto;border:1px solid #e3e6f0}.empty-state[_ngcontent-%COMP%]{padding:3rem 1rem;text-align:center}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-bottom:1.5rem;opacity:.6}.empty-state[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#858796;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#858796;margin-bottom:1.5rem}.text-decoration-line-through[_ngcontent-%COMP%]{text-decoration:line-through!important}.fw-bold[_ngcontent-%COMP%]{font-weight:700!important}.h4[_ngcontent-%COMP%], .h5[_ngcontent-%COMP%]{font-weight:600}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .5s ease-out}.fa-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fa-spin 1s infinite linear}@keyframes _ngcontent-%COMP%_fa-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem;border:.25em solid currentColor;border-right-color:transparent;border-radius:50%;animation:_ngcontent-%COMP%_spinner-border .75s linear infinite}@keyframes _ngcontent-%COMP%_spinner-border{to{transform:rotate(360deg)}}@media (max-width: 768px){.container-fluid[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.card-body[_ngcontent-%COMP%]{padding:1rem}.card-header[_ngcontent-%COMP%], .card-footer[_ngcontent-%COMP%]{padding:.75rem 1rem}.btn-group-responsive[_ngcontent-%COMP%]{flex-direction:column;width:100%}.btn-group-responsive[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-bottom:.5rem}.d-flex.gap-2[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem!important}.h3[_ngcontent-%COMP%]{font-size:1.5rem}.modal-dialog[_ngcontent-%COMP%]{margin:.5rem}.modal-lg[_ngcontent-%COMP%]{max-width:none}}@media (max-width: 576px){.col-xl-3.col-md-6[_ngcontent-%COMP%]{margin-bottom:1rem}.card-title[_ngcontent-%COMP%]{font-size:1rem}.h4[_ngcontent-%COMP%]{font-size:1.25rem}.h5[_ngcontent-%COMP%]{font-size:1.125rem}.badge[_ngcontent-%COMP%]{font-size:.7rem;padding:.375rem .5rem}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.8rem}}.btn[_ngcontent-%COMP%]:focus, .form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{outline:0;box-shadow:0 0 0 .2rem #4e73df40}.card[_ngcontent-%COMP%]:focus-within{box-shadow:0 0 0 .2rem #4e73df26}.card-hover[_ngcontent-%COMP%]:hover{border-color:#4e73df;box-shadow:0 .5rem 1rem #4e73df26!important}.btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px)}.badge[_ngcontent-%COMP%]:hover{transform:scale(1.05);transition:transform .15s ease}.no-gutters[_ngcontent-%COMP%]{margin-right:0;margin-left:0}.no-gutters[_ngcontent-%COMP%] > .col[_ngcontent-%COMP%], .no-gutters[_ngcontent-%COMP%] > [class*=col-][_ngcontent-%COMP%]{padding-right:0;padding-left:0}.gap-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-3[_ngcontent-%COMP%]{gap:1rem!important}.me-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-3[_ngcontent-%COMP%]{margin-right:1rem!important}.mb-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mt-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}@media print{.btn[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%], .modal-backdrop[_ngcontent-%COMP%]{display:none!important}.card[_ngcontent-%COMP%]{border:1px solid #000!important;box-shadow:none!important;page-break-inside:avoid}.container-fluid[_ngcontent-%COMP%]{max-width:none;width:100%}}@media (prefers-color-scheme: dark){.bg-light[_ngcontent-%COMP%]{background-color:#2d3748!important;color:#e2e8f0!important}.text-muted[_ngcontent-%COMP%]{color:#a0aec0!important}.card[_ngcontent-%COMP%]{background-color:#2d3748!important;border-color:#4a5568!important;color:#e2e8f0!important}.modal-content[_ngcontent-%COMP%]{background-color:#2d3748!important;color:#e2e8f0!important}}"]})};var Gt=(a,t,e)=>({"bg-primary":a,"bg-success":t,"bg-info":e});function kl(a,t){if(a&1&&(n(0,"div",1)(1,"div",49)(2,"div",50)(3,"div",51)(4,"div",52)(5,"div",53)(6,"div",54),s(7," Pendientes "),r(),n(8,"div",55),s(9),r()(),n(10,"div",56),p(11,"i",57),r()()()()(),n(12,"div",49)(13,"div",58)(14,"div",51)(15,"div",52)(16,"div",53)(17,"div",59),s(18," Validadas "),r(),n(19,"div",55),s(20),r()(),n(21,"div",56),p(22,"i",60),r()()()()(),n(23,"div",49)(24,"div",61)(25,"div",51)(26,"div",52)(27,"div",53)(28,"div",62),s(29," Monto Pendiente "),r(),n(30,"div",55),s(31),r()(),n(32,"div",56),p(33,"i",63),r()()()()(),n(34,"div",49)(35,"div",64)(36,"div",51)(37,"div",52)(38,"div",53)(39,"div",65),s(40," Tiempo Promedio "),r(),n(41,"div",55),s(42),r()(),n(43,"div",56),p(44,"i",66),r()()()()()()),a&2){let e=d();l(9),v(" ",e.estadisticas.compras_pendientes," "),l(11),v(" ",e.estadisticas.compras_validadas," "),l(11),v(" ",e.formatearPrecio(e.estadisticas.monto_total_pendiente)," "),l(11),v(" ",e.estadisticas.promedio_tiempo_validacion,"h ")}}function Tl(a,t){a&1&&(n(0,"div",67),p(1,"i",68),s(2," No tienes permisos para validar compras. Esta secci\xF3n es solo para administradores. "),r())}function Pl(a,t){if(a&1&&(n(0,"option",86),s(1),r()),a&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function Il(a,t){if(a&1&&(n(0,"option",86),s(1),r()),a&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function Ol(a,t){a&1&&(n(0,"div",87)(1,"div",88)(2,"span",89),s(3,"Cargando compras..."),r()(),n(4,"p",90),s(5,"Cargando compras pendientes..."),r()())}function Vl(a,t){if(a&1){let e=C();n(0,"div",91),p(1,"i",68),s(2),n(3,"button",92),f("click",function(){u(e);let o=d(2);return g(o.cargarComprasPendientes())}),p(4,"i",93),s(5," Reintentar "),r()()}if(a&2){let e=d(2);l(2),v(" ",e.error," ")}}function Fl(a,t){a&1&&(n(0,"div",87),p(1,"i",94),n(2,"h5",81),s(3,"No se encontraron compras"),r(),n(4,"p",81),s(5,"No hay compras que coincidan con los filtros aplicados"),r()())}function Dl(a,t){if(a&1&&(n(0,"small",81),s(1),r()),a&2){let e=d().$implicit;l(),v(" ",e.numero_transaccion," ")}}function Al(a,t){if(a&1&&(n(0,"div")(1,"small",112),s(2),r(),p(3,"br"),n(4,"small",113),s(5),r()()),a&2){let e=d().$implicit,i=d(3);l(2),v(" ",i.formatearPrecio(e.precio_paquete)," "),l(3),v(" -",i.formatearPrecio(e.descuento_aplicado)," ")}}function Rl(a,t){if(a&1&&(n(0,"span"),s(1),r()),a&2){let e=d(2).$implicit;l(),v(" ",e.hora_pago,"")}}function jl(a,t){if(a&1&&(n(0,"div")(1,"small",81),s(2),x(3,Rl,2,1,"span",11),r()()),a&2){let e=d().$implicit;l(2),v(" Pago: ",e.fecha_pago," "),l(),m("ngIf",e.hora_pago)}}function Ul(a,t){if(a&1){let e=C();n(0,"button",114),f("click",function(){u(e);let o=d().$implicit,c=d(3);return g(c.verComprobante(o))}),p(1,"i",115),r()}}function Ll(a,t){a&1&&(n(0,"span",81),s(1," Sin comprobante "),r())}function Nl(a,t){if(a&1){let e=C();n(0,"button",116),f("click",function(){u(e);let o=d().$implicit,c=d(3);return g(c.abrirModalValidacion(o))}),p(1,"i",117),r()}}function zl(a,t){if(a&1&&(n(0,"tr")(1,"td")(2,"div")(3,"strong"),s(4),r(),p(5,"br"),n(6,"small",81),s(7),r()()(),n(8,"td")(9,"div")(10,"strong"),s(11),r(),p(12,"br"),n(13,"small",81),s(14),r()()(),n(15,"td")(16,"div")(17,"strong"),s(18),r(),p(19,"br"),n(20,"span",102),s(21),ce(22,"titlecase"),r()()(),n(23,"td")(24,"div",103),p(25,"i",104),n(26,"div")(27,"span"),s(28),r(),p(29,"br"),x(30,Dl,2,1,"small",105),r()()(),n(31,"td")(32,"div")(33,"strong"),s(34),r(),x(35,Al,6,2,"div",11),r()(),n(36,"td")(37,"div")(38,"span"),s(39),r(),x(40,jl,4,2,"div",11),r()(),n(41,"td")(42,"span",106),s(43),r()(),n(44,"td"),x(45,Ul,2,0,"button",107)(46,Ll,2,0,"span",105),r(),n(47,"td")(48,"div",108),x(49,Nl,2,0,"button",109),n(50,"button",110),p(51,"i",111),r()()()()),a&2){let e=t.$implicit,i=d(3);l(4),v("#",e.compra_id,""),l(3),v("",i.calcularTiempoTranscurrido(e.horas_desde_compra)," ago"),l(4),w(e.usuario_nombre),l(3),w(e.usuario_username),l(4),w(e.paquete_nombre),l(2),m("ngClass",Ne(23,Gt,e.paquete_tipo==="rutina",e.paquete_tipo==="terapia",e.paquete_tipo==="mixto")),l(),v(" ",pe(22,21,e.paquete_tipo)," "),l(4),D(i.obtenerIconoMetodoPago(e.metodo_pago)),m("ngClass",i.obtenerClaseMetodoPago(e.metodo_pago)),l(3),w(i.obtenerLabelMetodoPago(e.metodo_pago)),l(2),m("ngIf",e.numero_transaccion),l(4),w(i.formatearPrecio(e.precio_final)),l(),m("ngIf",e.descuento_aplicado>0),l(4),w(i.formatearFecha(e.fecha_compra)),l(),m("ngIf",e.fecha_pago),l(2),m("ngClass",i.obtenerClaseEstado(e.estado_compra)),l(),v(" ",e.estado_descripcion," "),l(2),m("ngIf",e.tiene_comprobante),l(),m("ngIf",!e.tiene_comprobante),l(3),m("ngIf",e.estado_compra==="pendiente")}}function Bl(a,t){if(a&1){let e=C();n(0,"li",120)(1,"a",121),f("click",function(){let o=u(e).$implicit,c=d(4);return g(c.cambiarPagina(o))}),s(2),r()()}if(a&2){let e=t.$implicit,i=d(4);O("active",e===i.paginaActual),l(2),w(e)}}function $l(a,t){if(a&1){let e=C();n(0,"nav",118)(1,"ul",119)(2,"li",120)(3,"a",121),f("click",function(){u(e);let o=d(3);return g(o.cambiarPagina(o.paginaActual-1))}),s(4,"Anterior"),r()(),x(5,Bl,3,3,"li",122),n(6,"li",120)(7,"a",121),f("click",function(){u(e);let o=d(3);return g(o.cambiarPagina(o.paginaActual+1))}),s(8,"Siguiente"),r()()()()}if(a&2){let e=d(3);l(2),O("disabled",e.paginaActual===1),l(3),m("ngForOf",e.paginasArray),l(),O("disabled",e.paginaActual===e.totalPaginas)}}function ql(a,t){if(a&1&&(n(0,"div")(1,"div",95)(2,"div",96)(3,"div",97)(4,"table",98)(5,"thead",99)(6,"tr")(7,"th"),s(8,"Compra"),r(),n(9,"th"),s(10,"Usuario"),r(),n(11,"th"),s(12,"Paquete"),r(),n(13,"th"),s(14,"M\xE9todo de Pago"),r(),n(15,"th"),s(16,"Monto"),r(),n(17,"th"),s(18,"Fecha"),r(),n(19,"th"),s(20,"Estado"),r(),n(21,"th"),s(22,"Comprobante"),r(),n(23,"th"),s(24,"Acciones"),r()()(),n(25,"tbody"),x(26,zl,52,27,"tr",100),r()()()()(),x(27,$l,9,5,"nav",101),r()),a&2){let e=d(2);l(26),m("ngForOf",e.comprasFiltradas),l(),m("ngIf",e.totalPaginas>1)}}function Wl(a,t){if(a&1){let e=C();n(0,"div")(1,"div",1)(2,"div",69)(3,"label",70),s(4,"Estado"),r(),n(5,"select",71),k("ngModelChange",function(o){u(e);let c=d();return E(c.filtros.estado_compra,o)||(c.filtros.estado_compra=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.aplicarFiltros())}),x(6,Pl,2,2,"option",72),r()(),n(7,"div",69)(8,"label",73),s(9,"M\xE9todo de Pago"),r(),n(10,"select",74),k("ngModelChange",function(o){u(e);let c=d();return E(c.filtros.metodo_pago,o)||(c.filtros.metodo_pago=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.aplicarFiltros())}),n(11,"option",75),s(12,"Todos los m\xE9todos"),r(),x(13,Il,2,2,"option",72),r()(),n(14,"div",69)(15,"label",76),s(16,"Desde"),r(),n(17,"input",77),k("ngModelChange",function(o){u(e);let c=d();return E(c.filtros.fecha_desde,o)||(c.filtros.fecha_desde=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.aplicarFiltros())}),r()(),n(18,"div",69)(19,"label",78),s(20,"Hasta"),r(),n(21,"input",79),k("ngModelChange",function(o){u(e);let c=d();return E(c.filtros.fecha_hasta,o)||(c.filtros.fecha_hasta=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.aplicarFiltros())}),r()()(),n(22,"div",80)(23,"div",2)(24,"div",3)(25,"span",81),s(26),r(),n(27,"button",82),f("click",function(){u(e);let o=d();return g(o.limpiarFiltros())}),p(28,"i",83),s(29," Limpiar filtros "),r()()()(),x(30,Ol,6,0,"div",84)(31,Vl,6,1,"div",85)(32,Fl,6,0,"div",84)(33,ql,28,2,"div",11),r()}if(a&2){let e=d();l(5),M("ngModel",e.filtros.estado_compra),l(),m("ngForOf",e.estadosCompra),l(4),M("ngModel",e.filtros.metodo_pago),l(3),m("ngForOf",e.metodosPago),l(4),M("ngModel",e.filtros.fecha_desde),l(4),M("ngModel",e.filtros.fecha_hasta),l(5),Re(" ",e.totalItems," compra",e.totalItems!==1?"s":""," encontrada",e.totalItems!==1?"s":""," "),l(4),m("ngIf",e.cargando),l(),m("ngIf",e.error&&!e.cargando),l(),m("ngIf",!e.cargando&&!e.error&&e.comprasFiltradas.length===0),l(),m("ngIf",!e.cargando&&!e.error&&e.comprasFiltradas.length>0)}}function Gl(a,t){if(a&1&&(n(0,"small",81),s(1),r()),a&2){let e=d(2);l(),v(" Transacci\xF3n: ",e.compraSeleccionada.numero_transaccion," ")}}function Hl(a,t){if(a&1&&(n(0,"small",81),p(1,"br"),s(2),r()),a&2){let e=d(2);l(2),v("Banco: ",e.compraSeleccionada.banco," ")}}function Yl(a,t){if(a&1&&(n(0,"div")(1,"span",112),s(2),r(),p(3,"br"),n(4,"span",113),s(5),r(),p(6,"br"),r()),a&2){let e=d(2);l(2),v(" Precio original: ",e.formatearPrecio(e.compraSeleccionada.precio_paquete)," "),l(3),v(" Descuento: -",e.formatearPrecio(e.compraSeleccionada.descuento_aplicado)," ")}}function Ql(a,t){if(a&1&&(n(0,"span"),s(1),r()),a&2){let e=d(2);l(),v(" a las ",e.compraSeleccionada.hora_pago,"")}}function Jl(a,t){if(a&1&&(n(0,"div")(1,"h6",81),s(2,"Notas del usuario"),r(),n(3,"p",125),s(4),r()()),a&2){let e=d(2);l(4),w(e.compraSeleccionada.notas_usuario)}}function Zl(a,t){if(a&1&&(n(0,"div",123)(1,"div",51)(2,"div",23)(3,"div",124)(4,"h6",81),s(5,"Usuario"),r(),n(6,"p",125)(7,"strong"),s(8),r(),p(9,"br"),n(10,"small",81),s(11),r()(),n(12,"h6",81),s(13,"Paquete"),r(),n(14,"p",125)(15,"strong"),s(16),r(),p(17,"br"),n(18,"span",102),s(19),ce(20,"titlecase"),r()(),n(21,"h6",81),s(22,"M\xE9todo de Pago"),r(),n(23,"p",125),p(24,"i",126),s(25),p(26,"br"),x(27,Gl,2,1,"small",105)(28,Hl,3,1,"small",105),r()(),n(29,"div",124)(30,"h6",81),s(31,"Montos"),r(),n(32,"div",125),x(33,Yl,7,2,"div",11),n(34,"strong",127),s(35),r()(),n(36,"h6",81),s(37,"Fechas"),r(),n(38,"p",125)(39,"strong"),s(40,"Compra:"),r(),s(41),p(42,"br"),n(43,"strong"),s(44,"Pago:"),r(),s(45),x(46,Ql,2,1,"span",11),r(),x(47,Jl,5,1,"div",11),r()()()()),a&2){let e=d();l(8),w(e.compraSeleccionada.usuario_nombre),l(3),w(e.compraSeleccionada.usuario_username),l(5),w(e.compraSeleccionada.paquete_nombre),l(2),m("ngClass",Ne(18,Gt,e.compraSeleccionada.paquete_tipo==="rutina",e.compraSeleccionada.paquete_tipo==="terapia",e.compraSeleccionada.paquete_tipo==="mixto")),l(),v(" ",pe(20,16,e.compraSeleccionada.paquete_tipo)," "),l(5),D(e.obtenerIconoMetodoPago(e.compraSeleccionada.metodo_pago)),l(),v(" ",e.obtenerLabelMetodoPago(e.compraSeleccionada.metodo_pago)," "),l(2),m("ngIf",e.compraSeleccionada.numero_transaccion),l(),m("ngIf",e.compraSeleccionada.banco),l(5),m("ngIf",e.compraSeleccionada.descuento_aplicado>0),l(2),v(" Total: ",e.formatearPrecio(e.compraSeleccionada.precio_final)," "),l(6),v(" ",e.formatearFecha(e.compraSeleccionada.fecha_compra),""),l(4),v(" ",e.compraSeleccionada.fecha_pago," "),l(),m("ngIf",e.compraSeleccionada.hora_pago),l(),m("ngIf",e.compraSeleccionada.notas_usuario)}}function Xl(a,t){a&1&&(n(0,"div",128),s(1," Por favor selecciona una acci\xF3n "),r())}function Kl(a,t){a&1&&(n(0,"div",128),s(1," El motivo del rechazo es requerido "),r())}function ec(a,t){if(a&1&&(n(0,"div",21)(1,"label",129),s(2,"Motivo del rechazo *"),r(),p(3,"textarea",130),x(4,Kl,2,0,"div",32),r()),a&2){let e=d();l(3),O("is-invalid",e.motivoRechazoInvalido),l(),m("ngIf",e.motivoRechazoInvalido)}}function tc(a,t){a&1&&(n(0,"div",131),p(1,"i",132),n(2,"strong"),s(3,"Al validar esta compra:"),r(),n(4,"ul",133)(5,"li"),s(6,"Se asignar\xE1 autom\xE1ticamente el paquete al usuario"),r(),n(7,"li"),s(8,"El usuario recibir\xE1 una notificaci\xF3n"),r(),n(9,"li"),s(10,"El paquete aparecer\xE1 en su calendario"),r(),n(11,"li"),s(12,"Esta acci\xF3n no se puede deshacer"),r()()())}function ic(a,t){a&1&&(n(0,"div",134),p(1,"i",68),n(2,"strong"),s(3,"Al rechazar esta compra:"),r(),n(4,"ul",133)(5,"li"),s(6,"El usuario ser\xE1 notificado del rechazo"),r(),n(7,"li"),s(8,"Deber\xE1 especificar un motivo claro"),r(),n(9,"li"),s(10,"El usuario podr\xE1 realizar una nueva compra"),r(),n(11,"li"),s(12,"Esta acci\xF3n no se puede deshacer"),r()()())}function nc(a,t){if(a&1&&(n(0,"div",135),p(1,"i",68),s(2),r()),a&2){let e=d();l(2),v(" ",e.error," ")}}function rc(a,t){a&1&&(fe(0),p(1,"span",136),s(2," Procesando... "),_e())}function oc(a,t){if(a&1&&(fe(0),p(1,"i",137),s(2),_e()),a&2){let e=d();l(),D(e.accionSeleccionada==="validar"?"fas fa-check":"fas fa-times"),l(),v(" ",e.accionSeleccionada==="validar"?"Validar Compra":"Rechazar Compra"," ")}}function ac(a,t){if(a&1&&(n(0,"div",21),p(1,"img",140),r()),a&2){let e=d(2);l(),m("src",e.comprobanteActual,me)("alt",e.comprobanteNombre)}}function sc(a,t){if(a&1&&(n(0,"div",21)(1,"div",131),p(2,"i",141),n(3,"p",125),s(4),r(),n(5,"p",142),s(6,"Archivo PDF - Descargar para ver el contenido completo"),r()()()),a&2){let e=d(2);l(4),w(e.comprobanteNombre)}}function lc(a,t){if(a&1&&(n(0,"div",138),x(1,ac,2,2,"div",33)(2,sc,7,1,"div",33),n(3,"div",139)(4,"h6",81),s(5),r()()()),a&2){let e=d();l(),m("ngIf",e.comprobanteActual.includes("image")),l(),m("ngIf",e.comprobanteActual.includes("pdf")),l(3),w(e.comprobanteNombre)}}function cc(a,t){a&1&&(n(0,"div",143),p(1,"i",144),n(2,"p",81),s(3,"No se pudo cargar el comprobante"),r()())}function dc(a,t){if(a&1){let e=C();n(0,"button",145),f("click",function(){u(e);let o=d();return g(o.descargarComprobante())}),p(1,"i",146),s(2," Descargar "),r()}}function mc(a,t){a&1&&p(0,"div",147)}function pc(a,t){a&1&&p(0,"div",147)}var wt=class a{constructor(t,e,i){this.compraPaquetesService=t;this.authService=e;this.formBuilder=i;this.inicializarFormulario()}cargando=!1;error=null;comprasPendientes=[];comprasFiltradas=[];estadisticas=null;filtros={estado_compra:"pendiente",page:1,limit:20};estadosCompra=tt;metodosPago=et;mostrarModalValidacion=!1;compraSeleccionada=null;formularioValidacion;procesandoValidacion=!1;mostrarModalComprobante=!1;comprobanteActual=null;comprobanteNombre="";paginaActual=1;itemsPorPagina=10;totalItems=0;totalPaginas=0;puedeValidar=!1;ngOnInit(){this.verificarPermisos(),this.cargarComprasPendientes(),this.cargarEstadisticas()}inicializarFormulario(){this.formularioValidacion=this.formBuilder.group({accion:["validar",we.required],motivo_rechazo:[""],notas_admin:[""]}),this.formularioValidacion.get("accion")?.valueChanges.subscribe(t=>{let e=this.formularioValidacion.get("motivo_rechazo");t==="rechazar"?e?.setValidators([we.required]):e?.clearValidators(),e?.updateValueAndValidity()})}verificarPermisos(){return h(this,null,function*(){try{this.puedeValidar=yield this.compraPaquetesService.verificarPermisosValidacion(),this.puedeValidar||(this.error="No tienes permisos para validar compras")}catch(t){console.error("Error verificando permisos:",t),this.error="Error verificando permisos"}})}cargarComprasPendientes(){return h(this,null,function*(){if(this.puedeValidar){this.cargando=!0,this.error=null;try{this.comprasPendientes=yield this.compraPaquetesService.obtenerComprasPendientes(this.filtros),this.aplicarFiltrosLocales(),this.calcularPaginacion()}catch(t){console.error("Error cargando compras:",t),this.error="Error al cargar las compras pendientes"}finally{this.cargando=!1}}})}cargarEstadisticas(){return h(this,null,function*(){try{this.estadisticas=yield this.compraPaquetesService.obtenerEstadisticasCompras()}catch(t){console.error("Error cargando estad\xEDsticas:",t)}})}aplicarFiltrosLocales(){this.comprasFiltradas=[...this.comprasPendientes],this.totalItems=this.comprasFiltradas.length}calcularPaginacion(){this.totalPaginas=Math.ceil(this.totalItems/this.itemsPorPagina);let t=(this.paginaActual-1)*this.itemsPorPagina,e=t+this.itemsPorPagina;this.comprasFiltradas=this.comprasFiltradas.slice(t,e)}aplicarFiltros(){return h(this,null,function*(){this.paginaActual=1,yield this.cargarComprasPendientes()})}limpiarFiltros(){return h(this,null,function*(){this.filtros={estado_compra:"pendiente",page:1,limit:20},this.paginaActual=1,yield this.cargarComprasPendientes()})}cambiarPagina(t){t>=1&&t<=this.totalPaginas&&(this.paginaActual=t,this.calcularPaginacion())}abrirModalValidacion(t){this.compraSeleccionada=t,this.formularioValidacion.reset({accion:"validar",motivo_rechazo:"",notas_admin:""}),this.mostrarModalValidacion=!0}cerrarModalValidacion(){this.mostrarModalValidacion=!1,this.compraSeleccionada=null,this.formularioValidacion.reset(),this.error=null}procesarValidacion(){return h(this,null,function*(){if(!this.formularioValidacion.valid||!this.compraSeleccionada){this.marcarErroresFormulario();return}this.procesandoValidacion=!0,this.error=null;try{let t=this.formularioValidacion.value,e={compra_id:this.compraSeleccionada.compra_id,accion:t.accion,motivo_rechazo:t.motivo_rechazo,notas_admin:t.notas_admin},i=yield this.compraPaquetesService.validarCompraPaquete(e);this.mostrarMensajeExito(i.mensaje),this.cerrarModalValidacion(),yield this.cargarComprasPendientes(),yield this.cargarEstadisticas()}catch(t){console.error("Error procesando validaci\xF3n:",t),this.error="Error al procesar la validaci\xF3n. Intenta nuevamente."}finally{this.procesandoValidacion=!1}})}marcarErroresFormulario(){Object.keys(this.formularioValidacion.controls).forEach(t=>{let e=this.formularioValidacion.get(t);e&&e.invalid&&e.markAsTouched()})}mostrarMensajeExito(t){alert(t)}verComprobante(t){return h(this,null,function*(){if(t.tiene_comprobante)try{let e=yield this.compraPaquetesService.obtenerComprobanteBase64(t.compra_id);if(e){let i=this.obtenerTipoMime(t.comprobante_tipo||"");this.comprobanteActual=`data:${i};base64,${e}`,this.comprobanteNombre=t.comprobante_nombre||"Comprobante",this.mostrarModalComprobante=!0}else this.error="No se pudo cargar el comprobante"}catch(e){console.error("Error cargando comprobante:",e),this.error="Error al cargar el comprobante"}})}cerrarModalComprobante(){this.mostrarModalComprobante=!1,this.comprobanteActual=null,this.comprobanteNombre=""}descargarComprobante(){if(!this.comprobanteActual)return;let t=document.createElement("a");t.href=this.comprobanteActual,t.download=this.comprobanteNombre,document.body.appendChild(t),t.click(),document.body.removeChild(t)}obtenerTipoMime(t){return{"image/jpeg":"image/jpeg","image/jpg":"image/jpeg","image/png":"image/png","application/pdf":"application/pdf"}[t]||"application/octet-stream"}formatearPrecio(t){return this.compraPaquetesService.formatearPrecio(t)}formatearFecha(t){return new Date(t).toLocaleDateString("es-GT",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}obtenerClaseEstado(t){return{pendiente:"badge bg-warning",validada:"badge bg-success",rechazada:"badge bg-danger",cancelada:"badge bg-secondary"}[t]||"badge bg-secondary"}obtenerClaseMetodoPago(t){return{transferencia:"text-primary",deposito:"text-info",tarjeta_credito:"text-success",tarjeta_debito:"text-warning"}[t]||"text-muted"}obtenerIconoMetodoPago(t){return{transferencia:"fas fa-university",deposito:"fas fa-piggy-bank",tarjeta_credito:"fas fa-credit-card",tarjeta_debito:"fas fa-credit-card"}[t]||"fas fa-credit-card"}obtenerLabelMetodoPago(t){return this.metodosPago.find(i=>i.value===t)?.label||t}calcularTiempoTranscurrido(t){if(t<1){let e=Math.round(t*60);return`${e} minuto${e!==1?"s":""}`}else if(t<24){let e=Math.round(t);return`${e} hora${e!==1?"s":""}`}else{let e=Math.round(t/24);return`${e} d\xEDa${e!==1?"s":""}`}}get accionSeleccionada(){return this.formularioValidacion.get("accion")?.value||"validar"}get requiereMotivoRechazo(){return this.accionSeleccionada==="rechazar"}get accionInvalida(){let t=this.formularioValidacion.get("accion");return!!(t&&t.invalid&&t.touched)}get motivoRechazoInvalido(){let t=this.formularioValidacion.get("motivo_rechazo");return!!(t&&t.invalid&&t.touched)}get paginasArray(){let t=[];for(let e=1;e<=this.totalPaginas;e++)t.push(e);return t}static \u0275fac=function(e){return new(e||a)(I(it),I(j),I(Je))};static \u0275cmp=A({type:a,selectors:[["app-validacion-compras"]],standalone:!1,decls:75,vars:36,consts:[[1,"container-fluid","px-4"],[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"h3","mb-0","text-gray-800"],[1,"fas","fa-check-circle","me-2"],[1,"text-muted","mb-0"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"fas","fa-sync-alt","me-1"],["class","row mb-4",4,"ngIf"],["class","alert alert-warning","role","alert",4,"ngIf"],[4,"ngIf"],["tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],["class","card mb-4 border-0 bg-light",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label"],[1,"row"],[1,"col-6"],[1,"form-check"],["type","radio","id","validar","formControlName","accion","value","validar",1,"form-check-input"],["for","validar",1,"form-check-label"],[1,"fas","fa-check","text-success","me-2"],["type","radio","id","rechazar","formControlName","accion","value","rechazar",1,"form-check-input"],["for","rechazar",1,"form-check-label"],[1,"fas","fa-times","text-danger","me-2"],["class","invalid-feedback",4,"ngIf"],["class","mb-3",4,"ngIf"],["for","notas_admin",1,"form-label"],["id","notas_admin","formControlName","notas_admin","rows","3","placeholder","Notas adicionales sobre la validaci\xF3n (opcional)",1,"form-control"],["class","alert alert-info",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","button",1,"btn",3,"click","ngClass","disabled"],[1,"fas","fa-file-image","me-2"],[1,"modal-body","text-center"],["class","comprobante-container",4,"ngIf"],["class","text-center py-4",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["class","modal-backdrop fade show",4,"ngIf"],[1,"col-xl-3","col-md-6","mb-4"],[1,"card","border-left-warning","shadow","h-100","py-2"],[1,"card-body"],[1,"row","no-gutters","align-items-center"],[1,"col","mr-2"],[1,"text-xs","font-weight-bold","text-warning","text-uppercase","mb-1"],[1,"h5","mb-0","font-weight-bold","text-gray-800"],[1,"col-auto"],[1,"fas","fa-clock","fa-2x","text-gray-300"],[1,"card","border-left-success","shadow","h-100","py-2"],[1,"text-xs","font-weight-bold","text-success","text-uppercase","mb-1"],[1,"fas","fa-check","fa-2x","text-gray-300"],[1,"card","border-left-info","shadow","h-100","py-2"],[1,"text-xs","font-weight-bold","text-info","text-uppercase","mb-1"],[1,"fas","fa-dollar-sign","fa-2x","text-gray-300"],[1,"card","border-left-primary","shadow","h-100","py-2"],[1,"text-xs","font-weight-bold","text-primary","text-uppercase","mb-1"],[1,"fas","fa-stopwatch","fa-2x","text-gray-300"],["role","alert",1,"alert","alert-warning"],[1,"fas","fa-exclamation-triangle","me-2"],[1,"col-md-3","mb-3"],["for","filtroEstado",1,"form-label"],["id","filtroEstado",1,"form-select",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","filtroMetodo",1,"form-label"],["id","filtroMetodo",1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],["for","filtroFechaDesde",1,"form-label"],["type","date","id","filtroFechaDesde",1,"form-control",3,"ngModelChange","change","ngModel"],["for","filtroFechaHasta",1,"form-label"],["type","date","id","filtroFechaHasta",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"row","mb-3"],[1,"text-muted"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-times","me-1"],["class","text-center py-5",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],[3,"value"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"],["role","alert",1,"alert","alert-danger"],["type","button",1,"btn","btn-sm","btn-outline-danger","ms-2",3,"click"],[1,"fas","fa-redo","me-1"],[1,"fas","fa-inbox","fa-3x","text-muted","mb-3"],[1,"card","shadow"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[4,"ngFor","ngForOf"],["class","mt-4",4,"ngIf"],[1,"badge",3,"ngClass"],[1,"d-flex","align-items-center"],[1,"me-2",3,"ngClass"],["class","text-muted",4,"ngIf"],[3,"ngClass"],["type","button","class","btn btn-sm btn-outline-info","title","Ver comprobante",3,"click",4,"ngIf"],["role","group",1,"btn-group"],["type","button","class","btn btn-sm btn-success","title","Validar/Rechazar",3,"click",4,"ngIf"],["type","button","title","Ver detalles",1,"btn","btn-sm","btn-outline-secondary"],[1,"fas","fa-eye"],[1,"text-muted","text-decoration-line-through"],[1,"text-success"],["type","button","title","Ver comprobante",1,"btn","btn-sm","btn-outline-info",3,"click"],[1,"fas","fa-file-image"],["type","button","title","Validar/Rechazar",1,"btn","btn-sm","btn-success",3,"click"],[1,"fas","fa-check"],[1,"mt-4"],[1,"pagination","justify-content-center"],[1,"page-item"],[1,"page-link",3,"click"],["class","page-item",3,"active",4,"ngFor","ngForOf"],[1,"card","mb-4","border-0","bg-light"],[1,"col-md-6"],[1,"mb-2"],[1,"me-2"],[1,"h5"],[1,"invalid-feedback"],["for","motivo_rechazo",1,"form-label"],["id","motivo_rechazo","formControlName","motivo_rechazo","rows","3","placeholder","Explica el motivo por el cual se rechaza la compra...",1,"form-control"],[1,"alert","alert-info"],[1,"fas","fa-info-circle","me-2"],[1,"mb-0","mt-2"],[1,"alert","alert-warning"],[1,"alert","alert-danger"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"me-1"],[1,"comprobante-container"],[1,"mt-3"],[1,"img-fluid","rounded","shadow",3,"src","alt"],[1,"fas","fa-file-pdf","fa-3x","mb-2"],[1,"mb-0"],[1,"text-center","py-4"],[1,"fas","fa-exclamation-triangle","fa-3x","text-muted","mb-3"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-download","me-1"],[1,"modal-backdrop","fade","show"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h1",4),p(6,"i",5),s(7," Validaci\xF3n de Compras "),r(),n(8,"p",6),s(9,"Administraci\xF3n y validaci\xF3n de compras de paquetes"),r()(),n(10,"button",7),f("click",function(){return i.cargarComprasPendientes()}),p(11,"i",8),s(12," Actualizar "),r()()()(),x(13,kl,45,4,"div",9)(14,Tl,3,0,"div",10)(15,Wl,34,13,"div",11),r(),n(16,"div",12)(17,"div",13)(18,"div",14)(19,"div",15)(20,"h5",16),p(21,"i",5),s(22),r(),n(23,"button",17),f("click",function(){return i.cerrarModalValidacion()}),r()(),n(24,"div",18),x(25,Zl,48,22,"div",19),n(26,"form",20),f("ngSubmit",function(){return i.procesarValidacion()}),n(27,"div",21)(28,"label",22),s(29,"Acci\xF3n *"),r(),n(30,"div",23)(31,"div",24)(32,"div",25),p(33,"input",26),n(34,"label",27),p(35,"i",28),s(36," Validar compra "),r()()(),n(37,"div",24)(38,"div",25),p(39,"input",29),n(40,"label",30),p(41,"i",31),s(42," Rechazar compra "),r()()()(),x(43,Xl,2,0,"div",32),r(),x(44,ec,5,3,"div",33),n(45,"div",21)(46,"label",34),s(47,"Notas del administrador"),r(),p(48,"textarea",35),r(),x(49,tc,13,0,"div",36)(50,ic,13,0,"div",37)(51,nc,3,1,"div",38),r()(),n(52,"div",39)(53,"button",40),f("click",function(){return i.cerrarModalValidacion()}),s(54," Cancelar "),r(),n(55,"button",41),f("click",function(){return i.procesarValidacion()}),x(56,rc,3,0,"ng-container",11)(57,oc,3,3,"ng-container",11),r()()()()(),n(58,"div",12)(59,"div",13)(60,"div",14)(61,"div",15)(62,"h5",16),p(63,"i",42),s(64," Comprobante de Pago "),r(),n(65,"button",17),f("click",function(){return i.cerrarModalComprobante()}),r()(),n(66,"div",43),x(67,lc,6,3,"div",44)(68,cc,4,0,"div",45),r(),n(69,"div",39)(70,"button",46),f("click",function(){return i.cerrarModalComprobante()}),s(71," Cerrar "),r(),x(72,dc,3,0,"button",47),r()()()(),x(73,mc,1,0,"div",48)(74,pc,1,0,"div",48)),e&2&&(l(10),m("disabled",i.cargando),l(),O("fa-spin",i.cargando),l(2),m("ngIf",i.estadisticas&&i.puedeValidar),l(),m("ngIf",!i.puedeValidar),l(),m("ngIf",i.puedeValidar),l(),Y("display",i.mostrarModalValidacion?"block":"none"),O("show",i.mostrarModalValidacion),l(6),v(" Validar Compra #",i.compraSeleccionada==null?null:i.compraSeleccionada.compra_id," "),l(3),m("ngIf",i.compraSeleccionada),l(),m("formGroup",i.formularioValidacion),l(7),O("is-invalid",i.accionInvalida),l(6),O("is-invalid",i.accionInvalida),l(4),m("ngIf",i.accionInvalida),l(),m("ngIf",i.requiereMotivoRechazo),l(5),m("ngIf",i.accionSeleccionada==="validar"),l(),m("ngIf",i.accionSeleccionada==="rechazar"),l(),m("ngIf",i.error),l(2),m("disabled",i.procesandoValidacion),l(2),m("ngClass",i.accionSeleccionada==="validar"?"btn-success":"btn-danger")("disabled",!i.formularioValidacion.valid||i.procesandoValidacion),l(),m("ngIf",i.procesandoValidacion),l(),m("ngIf",!i.procesandoValidacion),l(),Y("display",i.mostrarModalComprobante?"block":"none"),O("show",i.mostrarModalComprobante),l(9),m("ngIf",i.comprobanteActual),l(),m("ngIf",!i.comprobanteActual),l(4),m("ngIf",i.comprobanteActual),l(),m("ngIf",i.mostrarModalValidacion),l(),m("ngIf",i.mostrarModalComprobante))},dependencies:[$,N,R,ee,J,Z,q,Q,Lt,W,K,Ye,Qe,G,Te],encapsulation:2})};var yt=class a{constructor(t,e){this.authService=t;this.router=e}canActivate(){return h(this,null,function*(){try{let t=yield this.authService.getCurrentUser();return t&&t.id_perfil===1?!0:(this.router.navigate(["/dashboard"]),!1)}catch{return this.router.navigate(["/login"]),!1}})}static \u0275fac=function(e){return new(e||a)(he(j),he(ue))};static \u0275prov=ke({token:a,factory:a.\u0275fac,providedIn:"root"})};var uc=[{path:"",component:Be},{path:"home",component:Be},{path:"login",component:nt},{path:"register",component:rt},{path:"",component:lt,canActivate:[Se],children:[{path:"dashboard",component:at},{path:"usuarios",component:st,canActivate:[ze],data:{permissions:["view","admin"],profiles:[1,3]}},{path:"rutinas",component:ct,canActivate:[ze],data:{permissions:["view"],profiles:[1,3]}},{path:"tipos-seccion",component:dt,canActivate:[Pt],data:{profiles:[1]}},{path:"rutinas-usuario",component:mt,canActivate:[Pt],data:{profiles:[1]}},{path:"mis-rutinas",component:gt,canActivate:[Se]},{path:"terapias",component:ft,canActivate:[ze],data:{permissions:["view"],profiles:[1,3]}},{path:"terapias-asignadas",component:_t,canActivate:[ze],data:{permissions:["view"],profiles:[1,3]}},{path:"mis-terapias",component:vt,canActivate:[Se]},{path:"informacion-medica",component:ht,canActivate:[Se]},{path:"paquetes",loadChildren:()=>import("./chunk-YZVB6CYN.js").then(a=>a.PaquetesModule),canActivate:[Se],data:{title:"Gesti\xF3n de Paquetes"}},{path:"chat-discussions",loadChildren:()=>import("./chunk-CLJ3MBEN.js").then(a=>a.ChatDiscussionModule),canActivate:[Se],data:{title:"Sistema de Discusiones",requiredPermissions:["view"]}},{path:"discusiones",redirectTo:"chat-discussions",pathMatch:"full"},{path:"chat",redirectTo:"chat-discussions",pathMatch:"full"},{path:"compra-paquetes",component:qt,canActivate:[Se],data:{title:"Comprar Paquetes"}},{path:"mis-compras",component:Ct,canActivate:[Se],data:{title:"Mis Compras"}},{path:"validacion-compras",component:wt,canActivate:[Se,yt],data:{title:"Validaci\xF3n de Compras"}}]},{path:"**",redirectTo:"/"}],St=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=He({type:a});static \u0275inj=We({imports:[Tt.forRoot(uc,{enableTracing:!1,scrollPositionRestoration:"top",anchorScrolling:"enabled"}),Tt]})};var Mt=class a{title="Rehabimovementgt";static \u0275fac=function(e){return new(e||a)};static \u0275cmp=A({type:a,selectors:[["app-root"]],standalone:!1,decls:1,vars:0,template:function(e,i){e&1&&p(0,"router-outlet")},dependencies:[Xe],encapsulation:2})};var gc="@vercel/analytics",fc="1.5.0",_c=()=>{window.va||(window.va=function(...t){(window.vaq=window.vaq||[]).push(t)})};function Ht(){return typeof window<"u"}function Yt(){try{let a="production";if(a==="development"||a==="test")return"development"}catch{}return"production"}function xc(a="auto"){if(a==="auto"){window.vam=Yt();return}window.vam=a}function vc(){return(Ht()?window.vam:Yt())||"production"}function Ot(){return vc()==="development"}function bc(a){return a.scriptSrc?a.scriptSrc:Ot()?"https://va.vercel-scripts.com/v1/script.debug.js":a.basePath?`${a.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function Qt(a={debug:!0}){var t;if(!Ht())return;xc(a.mode),_c(),a.beforeSend&&((t=window.va)==null||t.call(window,"beforeSend",a.beforeSend));let e=bc(a);if(document.head.querySelector(`script[src*="${e}"]`))return;let i=document.createElement("script");i.src=e,i.defer=!0,i.dataset.sdkn=gc+(a.framework?`/${a.framework}`:""),i.dataset.sdkv=fc,a.disableAutoTrack&&(i.dataset.disableAutoTrack="1"),a.endpoint?i.dataset.endpoint=a.endpoint:a.basePath&&(i.dataset.endpoint=`${a.basePath}/insights`),a.dsn&&(i.dataset.dsn=a.dsn),i.onerror=()=>{let o=Ot()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${e}. ${o}`)},Ot()&&a.debug===!1&&(i.dataset.debug="false"),document.head.appendChild(i)}Qt();var Et=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=He({type:a,bootstrap:[Mt]});static \u0275inj=We({imports:[Ut,St,zt,Nt]})};jt().bootstrapModule(Et,{ngZoneEventCoalescing:!0}).catch(a=>console.error(a));
