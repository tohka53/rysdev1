import{b as Y,d as ie}from"./chunk-KMBL3I2X.js";import{A as L,Aa as G,B as P,Ba as H,C as i,Ca as W,D as n,Da as he,E as _,Ea as ye,F as oe,G as re,H as C,Ha as Ye,I as g,Ia as Qe,J as p,Ja as Je,La as ee,Na as U,Oa as ne,P as o,Q as y,Qa as se,R as m,Ra as te,S as I,Sa as Xe,T as je,U as Le,V as E,W as M,X as k,a as Ve,aa as O,ba as A,ca as ve,da as ze,g as ge,ga as B,h as _e,ha as z,i as fe,ia as N,ja as Ue,k as x,ka as Re,l as h,m as b,ma as Be,n as w,na as Ne,qa as K,ra as R,s,sa as $,t as q,ta as $e,u as j,v as be,va as Z,w as f,wa as Ge,xa as xe,y as d,ya as He,z as De,za as We}from"./chunk-RWUPR6KW.js";import{a as V,b as D,c as Oe,g as v}from"./chunk-6AOLKZEJ.js";var we=[{value:"terapia",label:"Terapia"},{value:"rutina",label:"Rutina"}];var Q=class r{constructor(t){this.supabaseService=t}obtenerPaquetes(t){return v(this,null,function*(){try{let e=this.supabaseService.client.from("paquetes").select("*").order("fecha_creacion",{ascending:!1});t?.tipo&&t.tipo!=="todos"&&(e=e.eq("tipo",t.tipo)),t?.status!==void 0&&(e=e.eq("status",t.status)),t?.busqueda&&(e=e.or(`nombre.ilike.%${t.busqueda}%,descripcion.ilike.%${t.busqueda}%`)),t?.precio_min&&(e=e.gte("precio_final",t.precio_min)),t?.precio_max&&(e=e.lte("precio_final",t.precio_max));let{data:a,error:l}=yield e;if(l)throw console.error("Error obteniendo paquetes:",l),l;return a||[]}catch(e){throw console.error("Error en obtenerPaquetes:",e),e}})}obtenerPaquetePorId(t){return v(this,null,function*(){try{let{data:e,error:a}=yield this.supabaseService.client.from("paquetes").select(`
          *,
          paquete_rutinas:paquete_rutinas(rutina_id),
          paquete_terapias:paquete_terapias(terapia_id)
        `).eq("id",t).single();if(a)throw console.error("Error obteniendo paquete:",a),a;return e&&(e.rutinas_seleccionadas=e.paquete_rutinas?.map(l=>l.rutina_id)||[],e.terapias_seleccionadas=e.paquete_terapias?.map(l=>l.terapia_id)||[]),e}catch(e){throw console.error("Error en obtenerPaquetePorId:",e),e}})}crearPaquete(t){return v(this,null,function*(){try{let e=t,{rutinas_seleccionadas:a,terapias_seleccionadas:l}=e,c=Oe(e,["rutinas_seleccionadas","terapias_seleccionadas"]),{data:u,error:S}=yield this.supabaseService.client.from("paquetes").insert([c]).select().single();if(S)throw console.error("Error creando paquete:",S),S;return t.tipo==="rutina"&&a&&a.length>0?yield this.guardarRelacionesRutinas(u.id,a):t.tipo==="terapia"&&l&&l.length>0&&(yield this.guardarRelacionesTerapias(u.id,l)),{success:!0,message:"Paquete creado exitosamente",data:u}}catch(a){return console.error("Error en crearPaquete:",a),{success:!1,message:"Error al crear el paquete"}}})}actualizarPaquete(t,e){return v(this,null,function*(){try{let a=e,{rutinas_seleccionadas:l,terapias_seleccionadas:c}=a,u=Oe(a,["rutinas_seleccionadas","terapias_seleccionadas"]),{data:S,error:F}=yield this.supabaseService.client.from("paquetes").update(u).eq("id",t).select().single();if(F)throw console.error("Error actualizando paquete:",F),F;return yield this.limpiarRelacionesExistentes(t),e.tipo==="rutina"&&l&&l.length>0?yield this.guardarRelacionesRutinas(t,l):e.tipo==="terapia"&&c&&c.length>0&&(yield this.guardarRelacionesTerapias(t,c)),{success:!0,message:"Paquete actualizado exitosamente",data:S}}catch(l){return console.error("Error en actualizarPaquete:",l),{success:!1,message:"Error al actualizar el paquete"}}})}eliminarPaquete(t){return v(this,null,function*(){try{yield this.limpiarRelacionesExistentes(t);let{data:e,error:a}=yield this.supabaseService.client.from("paquetes").update({status:0}).eq("id",t).select().single();if(a)throw console.error("Error eliminando paquete:",a),a;return{success:!0,message:"Paquete eliminado exitosamente",data:e}}catch(e){return console.error("Error en eliminarPaquete:",e),{success:!1,message:"Error al eliminar el paquete"}}})}cambiarEstadoPaquete(t,e){return v(this,null,function*(){try{let{data:a,error:l}=yield this.supabaseService.client.from("paquetes").update({status:e}).eq("id",t).select().single();if(l)throw console.error("Error cambiando estado del paquete:",l),l;return{success:!0,message:`Paquete ${e===1?"activado":"desactivado"} exitosamente`,data:a}}catch(a){return console.error("Error en cambiarEstadoPaquete:",a),{success:!1,message:"Error al cambiar el estado del paquete"}}})}activarPaquete(t){return v(this,null,function*(){return this.cambiarEstadoPaquete(t,1)})}desactivarPaquete(t){return v(this,null,function*(){return this.cambiarEstadoPaquete(t,0)})}activarPaqueteConDatos(t,e){return v(this,null,function*(){return e?this.actualizarPaquete(t,e):this.activarPaquete(t)})}guardarRelacionesRutinas(t,e){return v(this,null,function*(){let a=e.map(c=>({paquete_id:t,rutina_id:c})),{error:l}=yield this.supabaseService.client.from("paquete_rutinas").insert(a);if(l)throw console.error("Error guardando relaciones con rutinas:",l),l})}guardarRelacionesTerapias(t,e){return v(this,null,function*(){let a=e.map(c=>({paquete_id:t,terapia_id:c})),{error:l}=yield this.supabaseService.client.from("paquete_terapias").insert(a);if(l)throw console.error("Error guardando relaciones con terapias:",l),l})}limpiarRelacionesExistentes(t){return v(this,null,function*(){yield this.supabaseService.client.from("paquete_rutinas").delete().eq("paquete_id",t),yield this.supabaseService.client.from("paquete_terapias").delete().eq("paquete_id",t)})}obtenerEstadisticasPaquetes(){return v(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.client.rpc("obtener_estadisticas_paquetes");if(e)throw console.error("Error obteniendo estad\xEDsticas:",e),e;return t}catch(t){return console.error("Error en obtenerEstadisticasPaquetes:",t),{total_paquetes:0,paquetes_activos:0,paquetes_terapia:0,paquetes_rutina:0,promedio_precio:0,total_ventas:0}}})}duplicarPaquete(t){return v(this,null,function*(){try{let e=yield this.obtenerPaquetePorId(t);if(!e)throw new Error("Paquete no encontrado");let a={nombre:`Copia de ${e.nombre}`,descripcion:e.descripcion,precio:e.precio,cantidad_sesiones:e.cantidad_sesiones,tipo:e.tipo,descuento:e.descuento,rutinas_seleccionadas:e.rutinas_seleccionadas,terapias_seleccionadas:e.terapias_seleccionadas};return yield this.crearPaquete(a)}catch(e){return console.error("Error en duplicarPaquete:",e),{success:!1,message:"Error al duplicar el paquete"}}})}validarPaquete(t){let e=[];return(!t.nombre||t.nombre.trim().length===0)&&e.push("El nombre es requerido"),t.nombre&&t.nombre.length>255&&e.push("El nombre no puede exceder 255 caracteres"),(!t.precio||t.precio<=0)&&e.push("El precio debe ser mayor a 0"),(!t.cantidad_sesiones||t.cantidad_sesiones<1||t.cantidad_sesiones>25)&&e.push("La cantidad de sesiones debe estar entre 1 y 25"),(!t.tipo||!["terapia","rutina"].includes(t.tipo))&&e.push("Debe seleccionar un tipo v\xE1lido (terapia o rutina)"),(t.descuento<0||t.descuento>100)&&e.push("El descuento debe estar entre 0 y 100%"),t.tipo==="rutina"?!t.rutinas_seleccionadas||t.rutinas_seleccionadas.length===0?e.push("Debe seleccionar al menos una rutina"):t.rutinas_seleccionadas.length>t.cantidad_sesiones&&e.push("No puede seleccionar m\xE1s rutinas que la cantidad de sesiones"):t.tipo==="terapia"&&(!t.terapias_seleccionadas||t.terapias_seleccionadas.length===0?e.push("Debe seleccionar al menos una terapia"):t.terapias_seleccionadas.length>t.cantidad_sesiones&&e.push("No puede seleccionar m\xE1s terapias que la cantidad de sesiones")),{valido:e.length===0,errores:e}}buscarPaquetes(t){return v(this,null,function*(){try{if(!t||t.trim().length===0)return yield this.obtenerPaquetes();let{data:e,error:a}=yield this.supabaseService.client.from("paquetes").select("*").or(`nombre.ilike.%${t}%,descripcion.ilike.%${t}%`).eq("status",1).order("nombre");if(a)throw console.error("Error buscando paquetes:",a),a;return e||[]}catch(e){throw console.error("Error en buscarPaquetes:",e),e}})}obtenerPaquetesPorTipo(t){return v(this,null,function*(){try{let{data:e,error:a}=yield this.supabaseService.client.from("paquetes").select("*").eq("tipo",t).eq("status",1).order("nombre");if(a)throw console.error("Error obteniendo paquetes por tipo:",a),a;return e||[]}catch(e){throw console.error("Error en obtenerPaquetesPorTipo:",e),e}})}formatearPrecio(t){return new Intl.NumberFormat("es-GT",{style:"currency",currency:"GTQ"}).format(t)}calcularPrecioFinal(t,e){return t-t*e/100}calcularPrecioPorSesion(t,e){return e>0?t/e:0}obtenerResumenPaquete(t){let e=this.calcularPrecioFinal(t.precio,t.descuento),a=this.calcularPrecioPorSesion(e,t.cantidad_sesiones);return{id:t.id,nombre:t.nombre,tipo:t.tipo,cantidadSesiones:t.cantidad_sesiones,precioBase:t.precio,descuento:t.descuento,precioFinal:e,precioPorSesion:a,ahorroTotal:t.precio-e,status:t.status,fechaCreacion:t.fecha_creacion}}static \u0275fac=function(e){return new(e||r)(fe(te))};static \u0275prov=ge({token:r,factory:r.\u0275fac,providedIn:"root"})};function et(r,t){if(r&1&&(i(0,"option",19),o(1),n()),r&2){let e=t.$implicit;d("value",e.value),s(),m(" ",e.label," ")}}function tt(r,t){if(r&1&&(i(0,"option",19),o(1),n()),r&2){let e=t.$implicit;d("value",e.value),s(),m(" ",e.label," ")}}function it(r,t){r&1&&(i(0,"div",20),_(1,"div",21),i(2,"p",22),o(3,"Cargando paquetes..."),n()())}function nt(r,t){if(r&1&&(i(0,"div",23),o(1),n()),r&2){let e=p();s(),m(" ",e.error," ")}}function at(r,t){if(r&1&&(i(0,"div",54),o(1),O(2,"slice"),n()),r&2){let e=p().$implicit;s(),I(" ",ze(2,2,e.descripcion,0,50),"",e.descripcion.length>50?"...":""," ")}}function ot(r,t){if(r&1&&(i(0,"div",55),o(1),n()),r&2){let e=p().$implicit,a=p(2);s(),m(" ",a.formatearPrecio(e.precio)," ")}}function rt(r,t){if(r&1&&(i(0,"div",56),o(1),n()),r&2){let e=p().$implicit;s(),m(" ",e.descuento,"% descuento ")}}function st(r,t){r&1&&(b(),i(0,"svg",5),_(1,"path",57),n())}function lt(r,t){r&1&&(b(),i(0,"svg",5),_(1,"path",58),n())}function ct(r,t){if(r&1){let e=C();i(0,"tr",33)(1,"td",34)(2,"div")(3,"div",35),o(4),n(),f(5,at,3,6,"div",36),n()(),i(6,"td",34)(7,"span",37),o(8),O(9,"titlecase"),n()(),i(10,"td",38),o(11),n(),i(12,"td",34)(13,"div",39),f(14,ot,2,1,"div",40),i(15,"div",41),o(16),n(),f(17,rt,2,1,"div",42),n()(),i(18,"td",34)(19,"span",37),o(20),n()(),i(21,"td",43)(22,"div",44)(23,"button",45),g("click",function(){let l=x(e).$implicit,c=p(2);return h(c.verDetalle(l.id))}),b(),i(24,"svg",5),_(25,"path",46)(26,"path",47),n()(),w(),i(27,"button",48),g("click",function(){let l=x(e).$implicit,c=p(2);return h(c.irAEditar(l.id))}),b(),i(28,"svg",5),_(29,"path",49),n()(),w(),i(30,"button",50),g("click",function(){let l=x(e).$implicit,c=p(2);return h(c.toggleStatus(l))}),f(31,st,2,0,"svg",51)(32,lt,2,0,"svg",51),n(),i(33,"button",52),g("click",function(){let l=x(e).$implicit,c=p(2);return h(c.confirmarEliminacion(l))}),b(),i(34,"svg",5),_(35,"path",53),n()()()()()}if(r&2){let e=t.$implicit,a=p(2);s(4),y(e.nombre),s(),d("ngIf",e.descripcion),s(2),P(a.obtenerClaseTipo(e.tipo)),s(),m(" ",A(9,19,e.tipo)," "),s(3),m(" ",e.cantidad_sesiones," sesiones "),s(3),d("ngIf",e.descuento>0),s(),L("text-green-600",e.descuento>0),s(),m(" ",a.formatearPrecio(e.precio_final||e.precio)," "),s(),d("ngIf",e.descuento>0),s(2),P(a.obtenerClaseStatus(e.status)),s(),m(" ",a.obtenerTextoStatus(e.status)," "),s(10),P(e.status===1?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"),d("title",e.status===1?"Desactivar":"Activar"),s(),d("ngIf",e.status===1),s(),d("ngIf",e.status===0)}}function dt(r,t){r&1&&(i(0,"tr")(1,"td",59)(2,"div",60),b(),i(3,"svg",61),_(4,"path",62),n(),w(),i(5,"p",63),o(6,"No se encontraron paquetes"),n(),i(7,"p",64),o(8,"Intenta ajustar los filtros o crear un nuevo paquete"),n()()()())}function pt(r,t){if(r&1){let e=C();i(0,"button",79),g("click",function(){let l=x(e).$implicit,c=p(3);return h(c.irAPagina(l))}),o(1),n()}if(r&2){let e=t.$implicit,a=p(3);P(e===a.paginaActual?"bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),s(),m(" ",e," ")}}function ut(r,t){if(r&1){let e=C();i(0,"div",65)(1,"div",66)(2,"button",67),g("click",function(){x(e);let l=p(2);return h(l.irAPagina(l.paginaActual-1))}),o(3," Anterior "),n(),i(4,"button",68),g("click",function(){x(e);let l=p(2);return h(l.irAPagina(l.paginaActual+1))}),o(5," Siguiente "),n()(),i(6,"div",69)(7,"div")(8,"p",70),o(9," Mostrando "),i(10,"span",41),o(11),n(),o(12," a "),i(13,"span",41),o(14),n(),o(15," de "),i(16,"span",41),o(17),n(),o(18," resultados "),n()(),i(19,"div")(20,"nav",71)(21,"button",72),g("click",function(){x(e);let l=p(2);return h(l.irAPagina(l.paginaActual-1))}),i(22,"span",73),o(23,"Anterior"),n(),b(),i(24,"svg",74),_(25,"path",75),n()(),f(26,pt,2,3,"button",76),w(),i(27,"button",77),g("click",function(){x(e);let l=p(2);return h(l.irAPagina(l.paginaActual+1))}),i(28,"span",73),o(29,"Siguiente"),n(),b(),i(30,"svg",74),_(31,"path",78),n()()()()()()}if(r&2){let e=p(2);s(2),d("disabled",e.paginaActual===1),s(2),d("disabled",e.paginaActual===e.totalPaginas),s(7),y((e.paginaActual-1)*e.itemsPorPagina+1),s(3),y(e.Math.min(e.paginaActual*e.itemsPorPagina,e.paquetesFiltrados.length)),s(3),y(e.paquetesFiltrados.length),s(4),d("disabled",e.paginaActual===1),s(5),d("ngForOf",e.paginasArray),s(),d("disabled",e.paginaActual===e.totalPaginas)}}function mt(r,t){if(r&1&&(i(0,"div",24)(1,"div",25)(2,"table",26)(3,"thead",27)(4,"tr")(5,"th",28),o(6," Paquete "),n(),i(7,"th",28),o(8," Tipo "),n(),i(9,"th",28),o(10," Sesiones "),n(),i(11,"th",28),o(12," Precio "),n(),i(13,"th",28),o(14," Estado "),n(),i(15,"th",28),o(16," Acciones "),n()()(),i(17,"tbody",29),f(18,ct,36,21,"tr",30)(19,dt,9,0,"tr",31),n()()(),f(20,ut,32,8,"div",32),n()),r&2){let e=p();s(18),d("ngForOf",e.paquetesPaginados),s(),d("ngIf",e.paquetesPaginados.length===0),s(),d("ngIf",e.paquetesFiltrados.length>e.itemsPorPagina)}}function gt(r,t){r&1&&(i(0,"span"),o(1,"Eliminar"),n())}function _t(r,t){r&1&&(i(0,"span"),o(1,"Eliminando..."),n())}function ft(r,t){if(r&1){let e=C();i(0,"div",80),g("click",function(){x(e);let l=p();return h(l.cancelarEliminacion())}),i(1,"div",81),g("click",function(l){return x(e),h(l.stopPropagation())}),i(2,"div",82)(3,"div",83),b(),i(4,"svg",84),_(5,"path",85),n()(),w(),i(6,"h3",86),o(7,"Confirmar eliminaci\xF3n"),n(),i(8,"div",87)(9,"p",54),o(10),n()(),i(11,"div",88)(12,"div",89)(13,"button",90),g("click",function(){x(e);let l=p();return h(l.eliminarPaquete())}),f(14,gt,2,0,"span",31)(15,_t,2,0,"span",31),n(),i(16,"button",91),g("click",function(){x(e);let l=p();return h(l.cancelarEliminacion())}),o(17," Cancelar "),n()()()()()()}if(r&2){let e=p();s(10),m(' \xBFEst\xE1s seguro de que deseas eliminar el paquete "',e.paqueteAEliminar==null?null:e.paqueteAEliminar.nombre,'"? Esta acci\xF3n no se puede deshacer. '),s(3),d("disabled",e.cargando),s(),d("ngIf",!e.cargando),s(),d("ngIf",e.cargando),s(),d("disabled",e.cargando)}}var Pe=class r{constructor(t,e){this.paquetesService=t;this.router=e}paquetes=[];paquetesFiltrados=[];cargando=!1;error=null;filtros={tipo:"todos",status:1,busqueda:""};tiposPaquete=[{value:"todos",label:"Todos los tipos"},...we];statusOptions=[{value:1,label:"Activos"},{value:0,label:"Inactivos"},{value:void 0,label:"Todos"}];paginaActual=1;itemsPorPagina=10;totalPaginas=0;mostrarModalEliminar=!1;paqueteAEliminar=null;Math;ngOnInit(){this.cargarPaquetes()}cargarPaquetes(){return v(this,null,function*(){this.cargando=!0,this.error=null;try{this.paquetes=yield this.paquetesService.obtenerPaquetes(this.filtros),this.aplicarFiltrosYPaginacion()}catch(t){console.error("Error cargando paquetes:",t),this.error="Error al cargar los paquetes. Por favor, intenta de nuevo."}finally{this.cargando=!1}})}aplicarFiltrosYPaginacion(){let t=[...this.paquetes];if(this.filtros.busqueda){let e=this.filtros.busqueda.toLowerCase();t=t.filter(a=>a.nombre.toLowerCase().includes(e)||a.descripcion&&a.descripcion.toLowerCase().includes(e))}this.paquetesFiltrados=t,this.calcularPaginacion()}onFiltroChange(){this.paginaActual=1,this.cargarPaquetes()}onBusquedaChange(){this.paginaActual=1,this.aplicarFiltrosYPaginacion()}limpiarFiltros(){this.filtros={tipo:"todos",status:1,busqueda:""},this.cargarPaquetes()}calcularPaginacion(){this.totalPaginas=Math.ceil(this.paquetesFiltrados.length/this.itemsPorPagina)}get paquetesPaginados(){let t=(this.paginaActual-1)*this.itemsPorPagina,e=t+this.itemsPorPagina;return this.paquetesFiltrados.slice(t,e)}irAPagina(t){t>=1&&t<=this.totalPaginas&&(this.paginaActual=t)}get paginasArray(){return Array.from({length:this.totalPaginas},(t,e)=>e+1)}irACrear(){this.router.navigate(["/paquetes/crear"])}irAEditar(t){this.router.navigate(["/paquetes/editar",t])}verDetalle(t){this.router.navigate(["/paquetes/detalle",t])}confirmarEliminacion(t){this.paqueteAEliminar=t,this.mostrarModalEliminar=!0}cancelarEliminacion(){this.mostrarModalEliminar=!1,this.paqueteAEliminar=null}eliminarPaquete(){return v(this,null,function*(){if(this.paqueteAEliminar){this.cargando=!0;try{let t=yield this.paquetesService.eliminarPaquete(this.paqueteAEliminar.id);t.success?(yield this.cargarPaquetes(),this.mostrarMensajeExito("Paquete eliminado exitosamente")):this.mostrarMensajeError(t.message)}catch(t){console.error("Error eliminando paquete:",t),this.mostrarMensajeError("Error al eliminar el paquete")}finally{this.cargando=!1,this.cancelarEliminacion()}}})}toggleStatus(t){return v(this,null,function*(){this.cargando=!0;try{let e=t.status===1?yield this.paquetesService.eliminarPaquete(t.id):yield this.paquetesService.activarPaquete(t.id);if(e.success){yield this.cargarPaquetes();let a=t.status===1?"desactivado":"activado";this.mostrarMensajeExito(`Paquete ${a} exitosamente`)}else this.mostrarMensajeError(e.message)}catch(e){console.error("Error cambiando status:",e),this.mostrarMensajeError("Error al cambiar el estado del paquete")}finally{this.cargando=!1}})}formatearPrecio(t){return this.paquetesService.formatearPrecio(t)}obtenerClaseStatus(t){return t===1?"badge badge-success":"badge badge-secondary"}obtenerTextoStatus(t){return t===1?"Activo":"Inactivo"}obtenerClaseTipo(t){return t==="terapia"?"badge badge-info":"badge badge-warning"}mostrarMensajeExito(t){console.log("\xC9xito:",t)}mostrarMensajeError(t){console.error("Error:",t),this.error=t}static \u0275fac=function(e){return new(e||r)(q(Q),q(U))};static \u0275cmp=j({type:r,selectors:[["app-paquetes"]],standalone:!1,decls:34,vars:9,consts:[[1,"container","mx-auto","px-4","py-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],[1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded-lg","flex","items-center","gap-2","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"bg-white","p-4","rounded-lg","shadow-sm","border","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","placeholder","Nombre o descripci\xF3n...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","input","ngModel"],[1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","items-end"],[1,"w-full","bg-gray-500","hover:bg-gray-600","text-white","px-4","py-2","rounded-md","transition-colors",3,"click"],["class","text-center py-8",4,"ngIf"],["class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4",4,"ngIf"],["class","bg-white rounded-lg shadow-sm border overflow-hidden",4,"ngIf"],["class","fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",3,"click",4,"ngIf"],[3,"value"],[1,"text-center","py-8"],[1,"inline-block","animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"mt-2","text-gray-600"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg","mb-4"],[1,"bg-white","rounded-lg","shadow-sm","border","overflow-hidden"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],[4,"ngIf"],["class","bg-white px-4 py-3 border-t border-gray-200 sm:px-6",4,"ngIf"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],["class","text-sm text-gray-500",4,"ngIf"],[1,"px-2","py-1","text-xs","font-semibold","rounded-full"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"text-sm","text-gray-900"],["class","line-through text-gray-500",4,"ngIf"],[1,"font-medium"],["class","text-xs text-green-600",4,"ngIf"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium"],[1,"flex","space-x-2"],["title","Ver detalle",1,"text-blue-600","hover:text-blue-900","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Editar",1,"text-indigo-600","hover:text-indigo-900","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"transition-colors",3,"click","title"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["title","Eliminar",1,"text-red-600","hover:text-red-900","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-sm","text-gray-500"],[1,"line-through","text-gray-500"],[1,"text-xs","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L5.636 5.636"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],["colspan","6",1,"px-6","py-8","text-center","text-gray-500"],[1,"flex","flex-col","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-gray-400","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"text-lg","font-medium"],[1,"text-sm"],[1,"bg-white","px-4","py-3","border-t","border-gray-200","sm:px-6"],[1,"flex-1","flex","justify-between","sm:hidden"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"ml-3","relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"hidden","sm:flex-1","sm:flex","sm:items-center","sm:justify-between"],[1,"text-sm","text-gray-700"],[1,"relative","z-0","inline-flex","rounded-md","shadow-sm","-space-x-px"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-l-md","border","border-gray-300","bg-white","text-sm","font-medium","text-gray-500","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"sr-only"],["fill","currentColor","viewBox","0 0 20 20",1,"h-5","w-5"],["fill-rule","evenodd","d","M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule","evenodd"],["class","relative inline-flex items-center px-4 py-2 border text-sm font-medium",3,"class","click",4,"ngFor","ngForOf"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-r-md","border","border-gray-300","bg-white","text-sm","font-medium","text-gray-500","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["fill-rule","evenodd","d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule","evenodd"],[1,"relative","inline-flex","items-center","px-4","py-2","border","text-sm","font-medium",3,"click"],[1,"fixed","inset-0","bg-gray-600","bg-opacity-50","overflow-y-auto","h-full","w-full","z-50",3,"click"],[1,"relative","top-20","mx-auto","p-5","border","w-96","shadow-lg","rounded-md","bg-white",3,"click"],[1,"mt-3","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-lg","leading-6","font-medium","text-gray-900","mt-4"],[1,"mt-2","px-7","py-3"],[1,"items-center","px-4","py-3"],[1,"flex","space-x-3"],[1,"px-4","py-2","bg-red-500","text-white","text-base","font-medium","rounded-md","w-full","shadow-sm","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-300","disabled:opacity-50",3,"click","disabled"],[1,"px-4","py-2","bg-gray-500","text-white","text-base","font-medium","rounded-md","w-full","shadow-sm","hover:bg-gray-700","focus:outline-none","focus:ring-2","focus:ring-gray-300","disabled:opacity-50",3,"click","disabled"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),o(4,"Gesti\xF3n de Paquetes"),n(),i(5,"p",3),o(6,"Administra los paquetes de terapias y rutinas"),n()(),i(7,"button",4),g("click",function(){return a.irACrear()}),b(),i(8,"svg",5),_(9,"path",6),n(),o(10," Nuevo Paquete "),n()(),w(),i(11,"div",7)(12,"div",8)(13,"div")(14,"label",9),o(15,"Buscar"),n(),i(16,"input",10),k("ngModelChange",function(c){return M(a.filtros.busqueda,c)||(a.filtros.busqueda=c),c}),g("input",function(){return a.onBusquedaChange()}),n()(),i(17,"div")(18,"label",9),o(19,"Tipo"),n(),i(20,"select",11),k("ngModelChange",function(c){return M(a.filtros.tipo,c)||(a.filtros.tipo=c),c}),g("change",function(){return a.onFiltroChange()}),f(21,et,2,2,"option",12),n()(),i(22,"div")(23,"label",9),o(24,"Estado"),n(),i(25,"select",11),k("ngModelChange",function(c){return M(a.filtros.status,c)||(a.filtros.status=c),c}),g("change",function(){return a.onFiltroChange()}),f(26,tt,2,2,"option",12),n()(),i(27,"div",13)(28,"button",14),g("click",function(){return a.limpiarFiltros()}),o(29," Limpiar Filtros "),n()()()(),f(30,it,4,0,"div",15)(31,nt,2,1,"div",16)(32,mt,21,3,"div",17),n(),f(33,ft,18,5,"div",18)),e&2&&(s(16),E("ngModel",a.filtros.busqueda),s(4),E("ngModel",a.filtros.tipo),s(),d("ngForOf",a.tiposPaquete),s(4),E("ngModel",a.filtros.status),s(),d("ngForOf",a.statusOptions),s(4),d("ngIf",a.cargando),s(),d("ngIf",a.error&&!a.cargando),s(),d("ngIf",!a.cargando&&!a.error),s(),d("ngIf",a.mostrarModalEliminar))},dependencies:[B,z,H,W,K,G,$,Z,Be,N],styles:[".paquetes-container[_ngcontent-%COMP%]{min-height:100vh;--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;border-radius:9999px;padding:.125rem .625rem;font-size:.75rem;line-height:1rem;font-weight:500}.badge-success[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(22 101 52 / var(--tw-text-opacity, 1))}.badge-secondary[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.badge-info[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.badge-warning[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(254 249 195 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(133 77 14 / var(--tw-text-opacity, 1))}.table-hover-row[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1));transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.action-button[_ngcontent-%COMP%]{display:inline-flex;height:2rem;width:2rem;align-items:center;justify-content:center;border-radius:9999px;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.action-button[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.pagination-button[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;border-width:1px;padding:.5rem 1rem;font-size:.875rem;line-height:1.25rem;font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.pagination-button[_ngcontent-%COMP%]:hover:not(:disabled){--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.pagination-button[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.5}.pagination-button.active[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:50;height:100%;width:100%;overflow-y:auto;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1));--tw-bg-opacity: .5;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.modal-content[_ngcontent-%COMP%]{position:relative;top:5rem;margin-left:auto;margin-right:auto;width:24rem;border-radius:.375rem;border-width:1px;--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1));padding:1.25rem;--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow);animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.loading-spinner[_ngcontent-%COMP%]{display:inline-block}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite;border-radius:9999px;border-bottom-width:2px;--tw-border-opacity: 1;border-color:rgb(37 99 235 / var(--tw-border-opacity, 1))}.price-display[_ngcontent-%COMP%]{text-align:right}.price-original[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1));text-decoration-line:line-through}.price-final[_ngcontent-%COMP%]{font-size:1.5rem;line-height:2rem;font-weight:700}.price-discount[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:500}.status-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.status-active[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.status-inactive[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}@media (max-width: 768px){.modal-content[_ngcontent-%COMP%]{top:2.5rem;width:91.666667%}.pagination-button[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem;line-height:1rem}}.form-container[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;max-width:56rem}.form-section[_ngcontent-%COMP%]{margin-bottom:1.5rem;border-radius:.5rem;border-width:1px;--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1));padding:1.5rem;--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.form-section-title[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.125rem;line-height:1.75rem;font-weight:600;--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:1.5rem}@media (min-width: 768px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}.form-field[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.form-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;line-height:1.25rem;font-weight:500;--tw-text-opacity: 1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.form-input[_ngcontent-%COMP%]{width:100%;border-radius:.375rem;border-width:1px;padding:.5rem .75rem;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.form-input[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.form-input[_ngcontent-%COMP%]:not(.error){--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.form-input[_ngcontent-%COMP%]:not(.error):focus{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1));--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.form-input.error[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(252 165 165 / var(--tw-border-opacity, 1))}.form-input.error[_ngcontent-%COMP%]:focus{--tw-border-opacity: 1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1));--tw-ring-opacity: 1;--tw-ring-color: rgb(239 68 68 / var(--tw-ring-opacity, 1))}.form-error[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.form-actions[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}.form-actions[_ngcontent-%COMP%]{padding-top:1.5rem}.preview-card[_ngcontent-%COMP%]{border-radius:.5rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1));padding:1.5rem;--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.preview-title[_ngcontent-%COMP%]{margin-bottom:.5rem;font-size:1.25rem;line-height:1.75rem;font-weight:600;--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.preview-description[_ngcontent-%COMP%]{margin-bottom:.75rem;--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.preview-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.preview-price[_ngcontent-%COMP%]{text-align:right}.info-box[_ngcontent-%COMP%]{border-radius:.375rem;padding:1rem}.info-box.blue[_ngcontent-%COMP%]{border-width:1px;--tw-border-opacity: 1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.info-box.green[_ngcontent-%COMP%]{border-width:1px;--tw-border-opacity: 1;border-color:rgb(187 247 208 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.info-box.yellow[_ngcontent-%COMP%]{border-width:1px;--tw-border-opacity: 1;border-color:rgb(254 240 138 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.info-box.red[_ngcontent-%COMP%]{border-width:1px;--tw-border-opacity: 1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.detail-header[_ngcontent-%COMP%]{margin-bottom:1.5rem;display:flex;align-items:flex-start;justify-content:space-between}.detail-title[_ngcontent-%COMP%]{font-size:1.875rem;line-height:2.25rem;font-weight:700;--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.detail-subtitle[_ngcontent-%COMP%]{margin-top:.25rem;--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.detail-actions[_ngcontent-%COMP%]{display:flex}.detail-actions[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.75rem * var(--tw-space-x-reverse));margin-left:calc(.75rem * calc(1 - var(--tw-space-x-reverse)))}.stat-card[_ngcontent-%COMP%]{border-radius:.5rem;border-width:1px;padding:1rem}.stat-card.blue[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.stat-card.gray[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.stat-card.yellow[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(254 240 138 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.stat-card.green[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(187 247 208 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.stat-icon[_ngcontent-%COMP%]{height:2rem;width:2rem;flex-shrink:0}.stat-label[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:500}.stat-value[_ngcontent-%COMP%]{font-size:1.5rem;line-height:2rem;font-weight:700}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding-top:3rem;padding-bottom:3rem;text-align:center}.empty-state-icon[_ngcontent-%COMP%]{margin-bottom:1rem;height:3rem;width:3rem;--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.empty-state-title[_ngcontent-%COMP%]{margin-bottom:.5rem;font-size:1.125rem;line-height:1.75rem;font-weight:500;--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.empty-state-description[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.breadcrumb[_ngcontent-%COMP%]{margin-bottom:.5rem;display:flex;align-items:center;gap:.5rem;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.breadcrumb[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.breadcrumb[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;border-radius:.375rem;border-width:1px;border-color:transparent;padding:.5rem 1rem;font-size:.875rem;line-height:1.25rem;font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.btn[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-offset-width: 2px}.btn-primary[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.btn-primary[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.btn-primary[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.btn-secondary[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(107 114 128 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.btn-secondary[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.btn-secondary[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(107 114 128 / var(--tw-ring-opacity, 1))}.btn-success[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.btn-success[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.btn-success[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(34 197 94 / var(--tw-ring-opacity, 1))}.btn-danger[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.btn-danger[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.btn-danger[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(239 68 68 / var(--tw-ring-opacity, 1))}.btn-outline[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.btn-outline[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.btn-outline[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(107 114 128 / var(--tw-ring-opacity, 1))}.btn[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.5}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.slide-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}"]})};function bt(r,t){r&1&&(i(0,"div",10),_(1,"div",11),i(2,"p",12),o(3,"Cargando informaci\xF3n del paquete..."),n()())}function vt(r,t){if(r&1&&(i(0,"div",13),o(1),n()),r&2){let e=p();s(),m(" ",e.error," ")}}function xt(r,t){if(r&1&&(i(0,"p",49),o(1),n()),r&2){let e=p(2);s(),m(" ",e.obtenerMensajeError("nombre")," ")}}function ht(r,t){if(r&1&&(i(0,"option",50),o(1),n()),r&2){let e=t.$implicit;d("value",e.value),s(),m(" ",e.label," ")}}function yt(r,t){if(r&1&&(i(0,"p",49),o(1),n()),r&2){let e=p(2);s(),m(" ",e.obtenerMensajeError("tipo")," ")}}function wt(r,t){if(r&1&&(i(0,"p",49),o(1),n()),r&2){let e=p(2);s(),m(" ",e.obtenerMensajeError("cantidad_sesiones")," ")}}function Ct(r,t){r&1&&(i(0,"div",10),_(1,"div",51),i(2,"p",12),o(3,"Cargando opciones disponibles..."),n()())}function Pt(r,t){r&1&&(i(0,"div",55),b(),i(1,"svg",56),_(2,"path",57),n(),w(),i(3,"p"),o(4,"No hay rutinas disponibles"),n(),i(5,"p",34),o(6,"Crea rutinas primero para poder seleccionarlas"),n()())}function St(r,t){if(r&1&&(i(0,"p",67),o(1),n()),r&2){let e=p().$implicit;s(),m(" ",e.descripcion," ")}}function qt(r,t){if(r&1&&(i(0,"p",68),o(1),n()),r&2){let e=p().$implicit;s(),m(" ",e.informacion_adicional," ")}}function Et(r,t){r&1&&(i(0,"div",69)(1,"span",70),o(2," \u2713 Seleccionada "),n()())}function Mt(r,t){if(r&1){let e=C();i(0,"div",58)(1,"div",59)(2,"div",60)(3,"input",61),g("change",function(){let l=x(e).$implicit,c=p(3);return h(c.onSeleccionChange(l.id,!0))}),n()(),i(4,"div",62)(5,"label",63),o(6),n(),f(7,St,2,1,"p",64)(8,qt,2,1,"p",65),n(),f(9,Et,3,0,"div",66),n()()}if(r&2){let e=t.$implicit,a=p(3);L("border-blue-500",e.seleccionado)("bg-blue-50",e.seleccionado)("border-gray-200",!e.seleccionado),s(3),d("id","rutina-"+e.id)("checked",e.seleccionado)("disabled",!e.seleccionado&&a.cantidadSeleccionada>=a.cantidadPermitida),s(2),d("for","rutina-"+e.id),s(),m(" ",e.nombre," "),s(),d("ngIf",e.descripcion),s(),d("ngIf",e.informacion_adicional),s(),d("ngIf",e.seleccionado)}}function kt(r,t){if(r&1&&(i(0,"div",52),f(1,Pt,7,0,"div",53)(2,Mt,10,14,"div",54),n()),r&2){let e=p(2);s(),d("ngIf",e.rutinasDisponibles.length===0),s(),d("ngForOf",e.rutinasDisponibles)}}function It(r,t){r&1&&(i(0,"div",55),b(),i(1,"svg",56),_(2,"path",71),n(),w(),i(3,"p"),o(4,"No hay terapias disponibles"),n(),i(5,"p",34),o(6,"Crea terapias primero para poder seleccionarlas"),n()())}function Ot(r,t){if(r&1&&(i(0,"p",67),o(1),n()),r&2){let e=p().$implicit;s(),m(" ",e.descripcion," ")}}function Ft(r,t){if(r&1&&(i(0,"p",68),o(1),n()),r&2){let e=p().$implicit;s(),m(" ",e.informacion_adicional," ")}}function Tt(r,t){r&1&&(i(0,"div",69)(1,"span",70),o(2," \u2713 Seleccionada "),n()())}function At(r,t){if(r&1){let e=C();i(0,"div",58)(1,"div",59)(2,"div",60)(3,"input",61),g("change",function(){let l=x(e).$implicit,c=p(3);return h(c.onSeleccionChange(l.id,!1))}),n()(),i(4,"div",62)(5,"label",63),o(6),n(),f(7,Ot,2,1,"p",64)(8,Ft,2,1,"p",65),n(),f(9,Tt,3,0,"div",66),n()()}if(r&2){let e=t.$implicit,a=p(3);L("border-blue-500",e.seleccionado)("bg-blue-50",e.seleccionado)("border-gray-200",!e.seleccionado),s(3),d("id","terapia-"+e.id)("checked",e.seleccionado)("disabled",!e.seleccionado&&a.cantidadSeleccionada>=a.cantidadPermitida),s(2),d("for","terapia-"+e.id),s(),m(" ",e.nombre," "),s(),d("ngIf",e.descripcion),s(),d("ngIf",e.informacion_adicional),s(),d("ngIf",e.seleccionado)}}function Vt(r,t){if(r&1&&(i(0,"div",52),f(1,It,7,0,"div",53)(2,At,10,14,"div",54),n()),r&2){let e=p(2);s(),d("ngIf",e.terapiasDisponibles.length===0),s(),d("ngForOf",e.terapiasDisponibles)}}function Dt(r,t){if(r&1){let e=C();i(0,"button",77),g("click",function(){x(e);let l=p(3);return h(l.limpiarSelecciones())}),o(1," Limpiar selecciones "),n()}}function jt(r,t){r&1&&(i(0,"span"),o(1,"Selecciona al menos una opci\xF3n"),n())}function Lt(r,t){if(r&1&&(i(0,"span"),o(1),n()),r&2){let e=p(3);s(),m(" Puedes seleccionar ",e.cantidadPermitida-e.cantidadSeleccionada," m\xE1s ")}}function zt(r,t){r&1&&(i(0,"span",78),o(1," \u2713 Selecci\xF3n completa "),n())}function Ut(r,t){if(r&1&&(i(0,"div",72)(1,"div",73),f(2,Dt,2,0,"button",74),i(3,"div",75),f(4,jt,2,0,"span",47)(5,Lt,2,1,"span",47)(6,zt,2,0,"span",76),n()()()),r&2){let e=p(2);s(2),d("ngIf",e.cantidadSeleccionada>0),s(2),d("ngIf",e.cantidadSeleccionada===0),s(),d("ngIf",e.cantidadSeleccionada>0&&e.cantidadSeleccionada<e.cantidadPermitida),s(),d("ngIf",e.cantidadSeleccionada===e.cantidadPermitida)}}function Rt(r,t){if(r&1&&(i(0,"p",49),o(1),n()),r&2){let e=p(2);s(),m(" ",e.obtenerMensajeError("precio")," ")}}function Bt(r,t){if(r&1&&(i(0,"p",49),o(1),n()),r&2){let e=p(2);s(),m(" ",e.obtenerMensajeError("descuento")," ")}}function Nt(r,t){if(r&1&&(i(0,"span"),o(1),n()),r&2){let e=p(2);s(),m(" ",e.esEdicion?"Actualizar":"Crear"," Paquete ")}}function $t(r,t){if(r&1&&(i(0,"span",79),b(),i(1,"svg",80),_(2,"circle",81)(3,"path",82),n(),o(4),n()),r&2){let e=p(2);s(4),m(" ",e.esEdicion?"Actualizando...":"Creando..."," ")}}function Gt(r,t){if(r&1){let e=C();i(0,"div",14)(1,"form",15),g("ngSubmit",function(){x(e);let l=p();return h(l.onSubmit())}),i(2,"div",16)(3,"h2",17),o(4,"Informaci\xF3n B\xE1sica"),n(),i(5,"div",18)(6,"div",19)(7,"label",20),o(8," Nombre del Paquete * "),n(),_(9,"input",21),f(10,xt,2,1,"p",22),n(),i(11,"div")(12,"label",23),o(13," Tipo de Paquete * "),n(),i(14,"select",24),f(15,ht,2,2,"option",25),n(),f(16,yt,2,1,"p",22),n(),i(17,"div")(18,"label",26),o(19," Cantidad de Sesiones * "),n(),_(20,"input",27),i(21,"p",28),o(22,"M\xEDnimo 1, m\xE1ximo 25 sesiones"),n(),f(23,wt,2,1,"p",22),n(),i(24,"div",19)(25,"label",29),o(26," Descripci\xF3n "),n(),i(27,"textarea",30),o(28,"            "),n()()()(),i(29,"div",16)(30,"div",31)(31,"div")(32,"h2",32),o(33),n(),i(34,"p",33),o(35),n()(),i(36,"div",34)(37,"span",35),o(38,"Seleccionadas: "),n(),i(39,"span"),o(40),n()()(),f(41,Ct,4,0,"div",6)(42,kt,3,2,"div",36)(43,Vt,3,2,"div",36)(44,Ut,7,4,"div",37),n(),i(45,"div",16)(46,"h2",17),o(47,"Informaci\xF3n de Precios"),n(),i(48,"div",18)(49,"div")(50,"label",38),o(51," Precio Base * "),n(),i(52,"div",39)(53,"span",40),o(54,"Q"),n(),_(55,"input",41),n(),f(56,Rt,2,1,"p",22),n(),i(57,"div")(58,"label",42),o(59," Descuento (%) "),n(),_(60,"input",43),i(61,"p",28),o(62,"0% = Sin descuento, m\xE1ximo 100%"),n(),f(63,Bt,2,1,"p",22),n()()(),i(64,"div",44)(65,"button",45),g("click",function(){x(e);let l=p();return h(l.cancelar())}),o(66," Cancelar "),n(),i(67,"button",46),f(68,Nt,2,1,"span",47)(69,$t,5,1,"span",48),n()()()()}if(r&2){let e,a,l,c,u=p();s(),d("formGroup",u.paqueteForm),s(8),P(u.esInvalido("nombre")?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"),s(),d("ngIf",u.esInvalido("nombre")),s(4),P(u.esInvalido("tipo")?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"),s(),d("ngForOf",u.tiposPaquete),s(),d("ngIf",u.esInvalido("tipo")),s(4),P(u.esInvalido("cantidad_sesiones")?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"),s(3),d("ngIf",u.esInvalido("cantidad_sesiones")),s(10),m(" Seleccionar ",((e=u.paqueteForm.get("tipo"))==null?null:e.value)==="rutina"?"Rutinas":"Terapias"," "),s(2),I(" Puedes seleccionar hasta ",u.cantidadPermitida," ",((a=u.paqueteForm.get("tipo"))==null?null:a.value)==="rutina"?"rutinas":"terapias"," para este paquete "),s(4),P(u.cantidadSeleccionada===u.cantidadPermitida?"text-green-600":"text-blue-600"),s(),I(" ",u.cantidadSeleccionada," / ",u.cantidadPermitida," "),s(),d("ngIf",u.cargandoOpciones),s(),d("ngIf",!u.cargandoOpciones&&((l=u.paqueteForm.get("tipo"))==null?null:l.value)==="rutina"),s(),d("ngIf",!u.cargandoOpciones&&((c=u.paqueteForm.get("tipo"))==null?null:c.value)==="terapia"),s(),d("ngIf",!u.cargandoOpciones&&(u.rutinasDisponibles.length>0||u.terapiasDisponibles.length>0)),s(11),P(u.esInvalido("precio")?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"),s(),d("ngIf",u.esInvalido("precio")),s(4),P(u.esInvalido("descuento")?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"),s(3),d("ngIf",u.esInvalido("descuento")),s(4),d("disabled",u.paqueteForm.invalid||u.guardando||u.cantidadSeleccionada===0),s(),d("ngIf",!u.guardando),s(),d("ngIf",u.guardando)}}function Ht(r,t){if(r&1&&(i(0,"p",103),o(1),n()),r&2){let e=p(2);s(),m(" ",e.paqueteForm.value.descripcion," ")}}function Wt(r,t){if(r&1&&(oe(0),_(1,"span",106),o(2),re()),r&2){let e=p().$implicit;s(2),m(" ",e.nombre," ")}}function Yt(r,t){if(r&1&&(i(0,"li",105),f(1,Wt,3,1,"ng-container",47),n()),r&2){let e=t.$implicit;s(),d("ngIf",e.seleccionado)}}function Qt(r,t){if(r&1&&(oe(0),f(1,Yt,2,1,"li",104),re()),r&2){let e=p(2);s(),d("ngForOf",e.rutinasDisponibles)}}function Jt(r,t){if(r&1&&(oe(0),_(1,"span",106),o(2),re()),r&2){let e=p().$implicit;s(2),m(" ",e.nombre," ")}}function Xt(r,t){if(r&1&&(i(0,"li",105),f(1,Jt,3,1,"ng-container",47),n()),r&2){let e=t.$implicit;s(),d("ngIf",e.seleccionado)}}function Kt(r,t){if(r&1&&(oe(0),f(1,Xt,2,1,"li",104),re()),r&2){let e=p(2);s(),d("ngForOf",e.terapiasDisponibles)}}function Zt(r,t){if(r&1&&(i(0,"div",107),o(1),n()),r&2){let e=p(2);s(),m(" ",e.formatearPrecio(e.paqueteForm.value.precio||0)," ")}}function ei(r,t){if(r&1&&(i(0,"div",108),o(1),n()),r&2){let e=p(2);s(),m(" ",e.paqueteForm.value.descuento,"% de descuento ")}}function ti(r,t){if(r&1&&(i(0,"div",83)(1,"h3",17),o(2,"Vista Previa del Paquete"),n(),i(3,"div",84)(4,"div",85)(5,"div",86)(6,"div",87)(7,"h4",88),o(8),n(),i(9,"span",89),o(10),O(11,"titlecase"),n()(),f(12,Ht,2,1,"p",90),i(13,"div",91)(14,"div",92),b(),i(15,"svg",93),_(16,"path",94),n(),o(17),n(),w(),i(18,"div",92),b(),i(19,"svg",93),_(20,"path",57),n(),o(21),n()(),w(),i(22,"div",95)(23,"h5",96),o(24),n(),i(25,"ul",97),f(26,Qt,2,1,"ng-container",47)(27,Kt,2,1,"ng-container",47),n()()(),i(28,"div",98),f(29,Zt,2,1,"div",99),i(30,"div",100),o(31),n(),f(32,ei,2,1,"div",101),i(33,"div",102),o(34),n()()()()()),r&2){let e=p();s(8),y(e.paqueteForm.value.nombre||"Nombre del paquete"),s(),P(e.paqueteForm.value.tipo==="terapia"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),s(),m(" ",A(11,17,e.paqueteForm.value.tipo)," "),s(2),d("ngIf",e.paqueteForm.value.descripcion),s(5),m(" ",e.paqueteForm.value.cantidad_sesiones||0," sesiones "),s(4),I(" ",e.cantidadSeleccionada," ",e.paqueteForm.value.tipo==="rutina"?"rutinas":"terapias"," incluidas "),s(3),m(" ",e.paqueteForm.value.tipo==="rutina"?"Rutinas":"Terapias"," incluidas: "),s(2),d("ngIf",e.paqueteForm.value.tipo==="rutina"),s(),d("ngIf",e.paqueteForm.value.tipo==="terapia"),s(2),d("ngIf",e.hayDescuento),s(),L("text-green-600",e.hayDescuento),s(),m(" ",e.formatearPrecio(e.precioFinalCalculado)," "),s(),d("ngIf",e.hayDescuento),s(2),m(" ",e.formatearPrecio(e.precioFinalCalculado/(e.paqueteForm.value.cantidad_sesiones||1))," por sesi\xF3n ")}}var pe=class r{constructor(t,e,a,l,c){this.fb=t;this.route=e;this.router=a;this.paquetesService=l;this.supabaseService=c}paqueteForm;esEdicion=!1;paqueteId=null;cargando=!1;guardando=!1;error=null;tiposPaquete=we;rutinasDisponibles=[];terapiasDisponibles=[];cargandoOpciones=!1;rutinasSeleccionadas=[];terapiasSeleccionadas=[];ngOnInit(){this.inicializarFormulario(),this.verificarModoEdicion()}inicializarFormulario(){this.paqueteForm=this.fb.group({nombre:["",[R.required,R.maxLength(255)]],descripcion:[""],precio:[0,[R.required,R.min(.01)]],cantidad_sesiones:[1,[R.required,R.min(1),R.max(25)]],tipo:["terapia",[R.required]],descuento:[0,[R.min(0),R.max(100)]]}),this.paqueteForm.get("tipo")?.valueChanges.subscribe(t=>{this.onTipoChange(t)}),this.paqueteForm.get("cantidad_sesiones")?.valueChanges.subscribe(t=>{this.validarSelecciones()}),this.cargarTerapias()}verificarModoEdicion(){let t=this.route.snapshot.paramMap.get("id");t&&(this.esEdicion=!0,this.paqueteId=parseInt(t),this.cargarPaquete())}cargarPaquete(){return v(this,null,function*(){if(this.paqueteId){this.cargando=!0,this.error=null;try{let t=yield this.paquetesService.obtenerPaquetePorId(this.paqueteId);t?(this.paqueteForm.patchValue({nombre:t.nombre,descripcion:t.descripcion||"",precio:t.precio,cantidad_sesiones:t.cantidad_sesiones,tipo:t.tipo,descuento:t.descuento}),t.tipo==="rutina"&&t.rutinas_seleccionadas?this.rutinasSeleccionadas=[...t.rutinas_seleccionadas]:t.tipo==="terapia"&&t.terapias_seleccionadas&&(this.terapiasSeleccionadas=[...t.terapias_seleccionadas]),yield this.onTipoChange(t.tipo)):this.error="Paquete no encontrado"}catch(t){console.error("Error cargando paquete:",t),this.error="Error al cargar el paquete"}finally{this.cargando=!1}}})}cargarRutinas(){return v(this,null,function*(){try{this.cargandoOpciones=!0;let{data:t,error:e}=yield this.supabaseService.client.from("rutinas").select("id, nombre, descripcion, nivel, duracion_estimada, tipo").eq("status",1).order("nombre");if(e)throw e;this.rutinasDisponibles=(t||[]).map(a=>({id:Number(a.id),nombre:String(a.nombre||""),descripcion:String(a.descripcion||""),informacion_adicional:this.construirInfoRutina(a),seleccionado:this.rutinasSeleccionadas.includes(Number(a.id))}))}catch(t){console.error("Error cargando rutinas:",t),this.error="Error al cargar las rutinas disponibles"}finally{this.cargandoOpciones=!1}})}cargarTerapias(){return v(this,null,function*(){try{this.cargandoOpciones=!0;let{data:t,error:e}=yield this.supabaseService.client.from("terapias").select("id, nombre, descripcion, tipo, area_especializacion, nivel, duracion_estimada").eq("status",1).order("nombre");if(e)throw e;this.terapiasDisponibles=(t||[]).map(a=>({id:Number(a.id),nombre:String(a.nombre||""),descripcion:String(a.descripcion||""),informacion_adicional:this.construirInfoTerapia(a),seleccionado:this.terapiasSeleccionadas.includes(Number(a.id))}))}catch(t){console.error("Error cargando terapias:",t),this.error="Error al cargar las terapias disponibles"}finally{this.cargandoOpciones=!1}})}onTipoChange(t){return v(this,null,function*(){this.rutinasSeleccionadas=[],this.terapiasSeleccionadas=[],t==="rutina"?yield this.cargarRutinas():t==="terapia"&&(yield this.cargarTerapias())})}onSeleccionChange(t,e){let a=this.paqueteForm.get("cantidad_sesiones")?.value||1;if(e){let l=this.rutinasSeleccionadas.indexOf(t);if(l>-1)this.rutinasSeleccionadas.splice(l,1);else if(this.rutinasSeleccionadas.length<a)this.rutinasSeleccionadas.push(t);else{this.mostrarMensajeError(`Solo puedes seleccionar hasta ${a} rutinas`);return}this.rutinasDisponibles=this.rutinasDisponibles.map(c=>D(V({},c),{seleccionado:this.rutinasSeleccionadas.includes(c.id)}))}else{let l=this.terapiasSeleccionadas.indexOf(t);if(l>-1)this.terapiasSeleccionadas.splice(l,1);else if(this.terapiasSeleccionadas.length<a)this.terapiasSeleccionadas.push(t);else{this.mostrarMensajeError(`Solo puedes seleccionar hasta ${a} terapias`);return}this.terapiasDisponibles=this.terapiasDisponibles.map(c=>D(V({},c),{seleccionado:this.terapiasSeleccionadas.includes(c.id)}))}}validarSelecciones(){let t=this.paqueteForm.get("cantidad_sesiones")?.value||1,e=this.paqueteForm.get("tipo")?.value;e==="rutina"&&this.rutinasSeleccionadas.length>t?(this.rutinasSeleccionadas=this.rutinasSeleccionadas.slice(0,t),this.actualizarEstadoVisualRutinas()):e==="terapia"&&this.terapiasSeleccionadas.length>t&&(this.terapiasSeleccionadas=this.terapiasSeleccionadas.slice(0,t),this.actualizarEstadoVisualTerapias())}actualizarEstadoVisualRutinas(){this.rutinasDisponibles=this.rutinasDisponibles.map(t=>D(V({},t),{seleccionado:this.rutinasSeleccionadas.includes(t.id)}))}actualizarEstadoVisualTerapias(){this.terapiasDisponibles=this.terapiasDisponibles.map(t=>D(V({},t),{seleccionado:this.terapiasSeleccionadas.includes(t.id)}))}limpiarSelecciones(){this.rutinasSeleccionadas=[],this.terapiasSeleccionadas=[],this.actualizarEstadoVisualRutinas(),this.actualizarEstadoVisualTerapias()}onSubmit(){return v(this,null,function*(){if(this.paqueteForm.invalid){this.marcarCamposComoTocados();return}let t=this.paqueteForm.get("tipo")?.value;if(t==="rutina"&&this.rutinasSeleccionadas.length===0){this.error="Debe seleccionar al menos una rutina para el paquete";return}else if(t==="terapia"&&this.terapiasSeleccionadas.length===0){this.error="Debe seleccionar al menos una terapia para el paquete";return}this.guardando=!0,this.error=null;try{let e=D(V({},this.paqueteForm.value),{rutinas_seleccionadas:t==="rutina"?this.rutinasSeleccionadas:void 0,terapias_seleccionadas:t==="terapia"?this.terapiasSeleccionadas:void 0}),a;this.esEdicion&&this.paqueteId?a=yield this.paquetesService.actualizarPaquete(this.paqueteId,e):a=yield this.paquetesService.crearPaquete(e),a.success?(this.mostrarMensajeExito(a.message),this.router.navigate(["/paquetes"])):this.error=a.message}catch(e){console.error("Error guardando paquete:",e),this.error="Error al guardar el paquete"}finally{this.guardando=!1}})}cancelar(){this.router.navigate(["/paquetes"])}construirInfoRutina(t){let e=[];return t.nivel&&e.push(`Nivel: ${String(t.nivel)}`),t.duracion_estimada&&e.push(`${t.duracion_estimada} min`),t.tipo&&e.push(String(t.tipo)),e.join(" \u2022 ")}construirInfoTerapia(t){let e=[];return t.tipo&&e.push(`Tipo: ${String(t.tipo)}`),t.area_especializacion&&e.push(String(t.area_especializacion)),t.nivel&&e.push(`Nivel: ${String(t.nivel)}`),t.duracion_estimada&&e.push(`${t.duracion_estimada} min`),e.join(" \u2022 ")}marcarCamposComoTocados(){Object.keys(this.paqueteForm.controls).forEach(t=>{this.paqueteForm.get(t)?.markAsTouched()})}esInvalido(t){let e=this.paqueteForm.get(t);return!!(e&&e.invalid&&e.touched)}obtenerMensajeError(t){let e=this.paqueteForm.get(t);if(e?.errors){if(e.errors.required)return`${t} es requerido`;if(e.errors.min)return`${t} debe ser mayor a ${e.errors.min.min}`;if(e.errors.max)return`${t} debe ser menor a ${e.errors.max.max}`;if(e.errors.maxlength)return`${t} es demasiado largo`}return""}mostrarMensajeExito(t){console.log("\xC9xito:",t)}mostrarMensajeError(t){console.log("Error:",t)}get hayDescuento(){return(this.paqueteForm.get("descuento")?.value||0)>0}get precioFinalCalculado(){let t=this.paqueteForm.get("precio")?.value||0,e=this.paqueteForm.get("descuento")?.value||0;return t-t*e/100}get cantidadSeleccionada(){return this.paqueteForm.get("tipo")?.value==="rutina"?this.rutinasSeleccionadas.length:this.terapiasSeleccionadas.length}get cantidadPermitida(){return this.paqueteForm.get("cantidad_sesiones")?.value||1}formatearPrecio(t){return new Intl.NumberFormat("es-GT",{style:"currency",currency:"GTQ"}).format(t)}static \u0275fac=function(e){return new(e||r)(q(Ye),q(ee),q(U),q(Q),q(te))};static \u0275cmp=j({type:r,selectors:[["app-paquete-form"]],standalone:!1,decls:17,vars:7,consts:[[1,"container","mx-auto","px-4","py-6"],[1,"mb-6"],[1,"flex","items-center","gap-2","text-sm","text-gray-500","mb-2"],["routerLink","/paquetes",1,"hover:text-blue-600"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],["class","text-center py-8",4,"ngIf"],["class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",4,"ngIf"],["class","max-w-4xl",4,"ngIf"],["class","mt-8 max-w-4xl",4,"ngIf"],[1,"text-center","py-8"],[1,"inline-block","animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"mt-2","text-gray-600"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg","mb-6"],[1,"max-w-4xl"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"bg-white","p-6","rounded-lg","shadow-sm","border"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"md:col-span-2"],["for","nombre",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","nombre","formControlName","nombre","placeholder","Ej: Paquete Rehabilitaci\xF3n B\xE1sica",1,"w-full","px-3","py-2","border","rounded-md","focus:outline-none","focus:ring-2","transition-colors"],["class","mt-1 text-sm text-red-600",4,"ngIf"],["for","tipo",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","tipo","formControlName","tipo",1,"w-full","px-3","py-2","border","rounded-md","focus:outline-none","focus:ring-2","transition-colors"],[3,"value",4,"ngFor","ngForOf"],["for","cantidad_sesiones",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","number","id","cantidad_sesiones","formControlName","cantidad_sesiones","min","1","max","25",1,"w-full","px-3","py-2","border","rounded-md","focus:outline-none","focus:ring-2","transition-colors"],[1,"mt-1","text-xs","text-gray-500"],["for","descripcion",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","descripcion","formControlName","descripcion","rows","3","placeholder","Describe el contenido y beneficios del paquete...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:border-blue-500","focus:ring-2","focus:ring-blue-500","transition-colors"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600","mt-1"],[1,"text-sm"],[1,"font-medium"],["class","space-y-3",4,"ngIf"],["class","mt-4 pt-4 border-t border-gray-200",4,"ngIf"],["for","precio",1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"relative"],[1,"absolute","left-3","top-2","text-gray-500"],["type","number","id","precio","formControlName","precio","min","0.01","step","0.01",1,"w-full","pl-8","pr-3","py-2","border","rounded-md","focus:outline-none","focus:ring-2","transition-colors"],["for","descuento",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","number","id","descuento","formControlName","descuento","min","0","max","100","step","0.01",1,"w-full","px-3","py-2","border","rounded-md","focus:outline-none","focus:ring-2","transition-colors"],[1,"flex","flex-col","sm:flex-row","gap-3","pt-6"],["type","button",1,"px-6","py-2","border","border-gray-300","text-gray-700","rounded-lg","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-gray-500","focus:ring-offset-2","transition-colors",3,"click"],["type","submit",1,"px-6","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"disabled"],[4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"mt-1","text-sm","text-red-600"],[3,"value"],[1,"inline-block","animate-spin","rounded-full","h-6","w-6","border-b-2","border-blue-600"],[1,"space-y-3"],["class","text-center py-8 text-gray-500",4,"ngIf"],["class","border rounded-lg p-4 transition-all duration-200 hover:shadow-md",3,"border-blue-500","bg-blue-50","border-gray-200",4,"ngFor","ngForOf"],[1,"text-center","py-8","text-gray-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mx-auto","mb-3","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"border","rounded-lg","p-4","transition-all","duration-200","hover:shadow-md"],[1,"flex","items-start","gap-3"],[1,"flex-shrink-0","mt-1"],["type","checkbox",1,"w-4","h-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500",3,"change","id","checked","disabled"],[1,"flex-1","min-w-0"],[1,"block","font-medium","text-gray-900","cursor-pointer",3,"for"],["class","text-sm text-gray-600 mt-1 line-clamp-2",4,"ngIf"],["class","text-xs text-gray-500 mt-2",4,"ngIf"],["class","flex-shrink-0",4,"ngIf"],[1,"text-sm","text-gray-600","mt-1","line-clamp-2"],[1,"text-xs","text-gray-500","mt-2"],[1,"flex-shrink-0"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"],[1,"mt-4","pt-4","border-t","border-gray-200"],[1,"flex","items-center","justify-between"],["type","button","class","text-sm text-red-600 hover:text-red-700 font-medium",3,"click",4,"ngIf"],[1,"text-sm","text-gray-600"],["class","text-green-600 font-medium",4,"ngIf"],["type","button",1,"text-sm","text-red-600","hover:text-red-700","font-medium",3,"click"],[1,"text-green-600","font-medium"],[1,"flex","items-center"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"mt-8","max-w-4xl"],[1,"bg-white","border","border-gray-200","rounded-lg","p-6","shadow-sm"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"flex","items-center","gap-3","mb-2"],[1,"text-xl","font-semibold","text-gray-900"],[1,"px-2","py-1","text-xs","font-semibold","rounded-full"],["class","text-gray-600 mb-3",4,"ngIf"],[1,"flex","items-center","gap-4","text-sm","text-gray-500","mb-3"],[1,"flex","items-center","gap-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-gray-50","rounded-lg","p-3"],[1,"text-sm","font-medium","text-gray-700","mb-2"],[1,"text-sm","text-gray-600","space-y-1"],[1,"text-right"],["class","text-sm text-gray-500 line-through",4,"ngIf"],[1,"text-2xl","font-bold"],["class","text-sm text-green-600 font-medium",4,"ngIf"],[1,"text-sm","text-gray-500","mt-1"],[1,"text-gray-600","mb-3"],["class","flex items-center gap-2",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-2"],[1,"w-1.5","h-1.5","bg-blue-600","rounded-full"],[1,"text-sm","text-gray-500","line-through"],[1,"text-sm","text-green-600","font-medium"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),o(4,"Paquetes"),n(),i(5,"span"),o(6,"/"),n(),i(7,"span"),o(8),n()(),i(9,"h1",4),o(10),n(),i(11,"p",5),o(12),n()(),f(13,bt,4,0,"div",6)(14,vt,2,1,"div",7)(15,Gt,70,31,"div",8)(16,ti,35,19,"div",9),n()),e&2&&(s(8),m("",a.esEdicion?"Editar":"Crear"," Paquete"),s(2),m(" ",a.esEdicion?"Editar":"Crear"," Paquete "),s(2),m(" ",a.esEdicion?"Modifica la informaci\xF3n del paquete":"Completa la informaci\xF3n para crear un nuevo paquete"," "),s(),d("ngIf",a.cargando),s(),d("ngIf",a.error&&!a.cargando),s(),d("ngIf",!a.cargando),s(),d("ngIf",!a.cargando&&a.paqueteForm.value.nombre&&a.cantidadSeleccionada>0))},dependencies:[B,z,Ge,H,W,K,xe,G,$,$e,ye,he,He,We,ne,N],encapsulation:2})};function ii(r,t){if(r&1){let e=C();i(0,"button",15),g("click",function(){x(e);let l=p();return h(l.irAAsignar())}),b(),i(1,"svg",16),_(2,"path",17),n(),o(3," Asignar a Usuario "),n()}}function ni(r,t){if(r&1){let e=C();i(0,"button",18),g("click",function(){x(e);let l=p();return h(l.irAEditar())}),b(),i(1,"svg",16),_(2,"path",19),n(),o(3," Editar "),n()}}function ai(r,t){r&1&&(i(0,"div",20),_(1,"div",21),i(2,"p",22),o(3,"Cargando informaci\xF3n del paquete..."),n()())}function oi(r,t){if(r&1){let e=C();i(0,"div",23)(1,"div",24)(2,"span"),o(3),n(),i(4,"button",25),g("click",function(){x(e);let l=p();return h(l.limpiarError())}),b(),i(5,"svg",16),_(6,"path",26),n()()()()}if(r&2){let e=p();s(3),y(e.error)}}function ri(r,t){if(r&1&&(i(0,"p",91),o(1),n()),r&2){let e=p(2);s(),m(" ",e.paquete.descripcion," ")}}function si(r,t){if(r&1&&(i(0,"div",92)(1,"p",93),o(2,"Ahorro total"),n(),i(3,"p",94),o(4),n()()),r&2){let e=p(2);s(4),y(e.formatearPrecio(e.paquete.precio-(e.paquete.precio_final||e.paquete.precio)))}}function li(r,t){r&1&&(i(0,"div",61)(1,"p",95),o(2,"Este paquete no tiene descuento aplicado"),n()())}function ci(r,t){if(r&1){let e=C();i(0,"button",96),g("click",function(){x(e);let l=p(2);return h(l.irAAsignar())}),b(),i(1,"svg",16),_(2,"path",17),n(),w(),i(3,"div",76)(4,"div",77),o(5,"Asignar a Usuario"),n(),i(6,"div",78),o(7,"Crear nueva asignaci\xF3n"),n()()()}}function di(r,t){if(r&1){let e=C();i(0,"button",97),g("click",function(){x(e);let l=p(2);return h(l.irAEditar())}),b(),i(1,"svg",16),_(2,"path",19),n(),w(),i(3,"div",76)(4,"div",77),o(5,"Editar Paquete"),n(),i(6,"div",78),o(7,"Modificar informaci\xF3n"),n()()()}}function pi(r,t){r&1&&(b(),i(0,"svg",82),_(1,"path",98),n())}function ui(r,t){r&1&&(b(),i(0,"svg",82),_(1,"path",56),n())}function mi(r,t){if(r&1){let e=C();i(0,"div",27)(1,"div",28)(2,"div",29)(3,"div",30)(4,"div",31)(5,"h2",32),o(6),n(),i(7,"span",33),o(8),O(9,"titlecase"),n(),i(10,"span",33),o(11),n()(),f(12,ri,2,1,"p",34),n()(),i(13,"div",35)(14,"div",36)(15,"div",37)(16,"div",38),b(),i(17,"svg",39),_(18,"path",40),n()(),w(),i(19,"div",41)(20,"p",42),o(21,"Sesiones Incluidas"),n(),i(22,"p",43),o(23),n()()()(),i(24,"div",44)(25,"div",37)(26,"div",38),b(),i(27,"svg",45),_(28,"path",46),n()(),w(),i(29,"div",41)(30,"p",47),o(31,"Precio Base"),n(),i(32,"p",48),o(33),n()()()(),i(34,"div",49)(35,"div",37)(36,"div",38),b(),i(37,"svg",50),_(38,"path",51),n()(),w(),i(39,"div",41)(40,"p",52),o(41,"Descuento"),n(),i(42,"p",53),o(43),n()()()(),i(44,"div",54)(45,"div",37)(46,"div",38),b(),i(47,"svg",55),_(48,"path",56),n()(),w(),i(49,"div",41)(50,"p",57),o(51,"Precio Final"),n(),i(52,"p",58),o(53),n()()()()()(),i(54,"div",28)(55,"h3",59),o(56,"An\xE1lisis de Costos"),n(),i(57,"div",60)(58,"div",61)(59,"p",62),o(60,"Costo por sesi\xF3n (precio base)"),n(),i(61,"p",63),o(62),n()(),i(63,"div",64)(64,"p",65),o(65,"Costo por sesi\xF3n (precio final)"),n(),i(66,"p",66),o(67),n()(),f(68,si,5,1,"div",67)(69,li,3,0,"div",68),n()(),i(70,"div",28)(71,"h3",59),o(72,"Informaci\xF3n del Sistema"),n(),i(73,"div",69)(74,"div")(75,"p",70),o(76,"Fecha de Creaci\xF3n"),n(),i(77,"p",71),o(78),n()(),i(79,"div")(80,"p",70),o(81,"\xDAltima Actualizaci\xF3n"),n(),i(82,"p",71),o(83),n()()()(),i(84,"div",28)(85,"h3",59),o(86,"Acciones Principales"),n(),i(87,"div",72),f(88,ci,8,0,"button",73),i(89,"button",74),g("click",function(){x(e);let l=p();return h(l.verAsignaciones())}),b(),i(90,"svg",16),_(91,"path",75),n(),w(),i(92,"div",76)(93,"div",77),o(94,"Ver Asignaciones"),n(),i(95,"div",78),o(96,"Usuarios con este paquete"),n()()(),f(97,di,8,0,"button",79),n()(),i(98,"div",28)(99,"h3",59),o(100,"Acciones Adicionales"),n(),i(101,"div",80)(102,"button",81),g("click",function(){x(e);let l=p();return h(l.duplicarPaquete())}),b(),i(103,"svg",82),_(104,"path",83),n(),o(105," Duplicar "),n(),w(),i(106,"button",84),g("click",function(){x(e);let l=p();return h(l.exportarPaquete())}),b(),i(107,"svg",82),_(108,"path",85),n(),o(109," Exportar "),n(),w(),i(110,"button",15),g("click",function(){x(e);let l=p();return h(l.imprimirPaquete())}),b(),i(111,"svg",82),_(112,"path",86),n(),o(113," Imprimir "),n(),w(),i(114,"button",87),g("click",function(){x(e);let l=p();return h(l.compartirPaquete())}),b(),i(115,"svg",82),_(116,"path",88),n(),o(117," Compartir "),n(),w(),i(118,"button",89),g("click",function(){x(e);let l=p();return h(l.toggleStatus())}),f(119,pi,2,0,"svg",90)(120,ui,2,0,"svg",90),o(121),n()()()()}if(r&2){let e=p();s(6),y(e.paquete.nombre),s(),P(e.obtenerClaseTipo(e.paquete.tipo)),s(),I(" ",e.obtenerIconoTipo(e.paquete.tipo)," ",A(9,27,e.paquete.tipo)," "),s(2),P(e.obtenerClaseStatus(e.paquete.status)),s(),I(" ",e.obtenerIconoStatus(e.paquete.status)," ",e.obtenerTextoStatus(e.paquete.status)," "),s(),d("ngIf",e.paquete.descripcion),s(11),y(e.paquete.cantidad_sesiones),s(10),y(e.formatearPrecio(e.paquete.precio)),s(10),m("",e.paquete.descuento||0,"%"),s(10),y(e.formatearPrecio(e.paquete.precio_final||e.paquete.precio)),s(9),y(e.formatearPrecio(e.paquete.precio/e.paquete.cantidad_sesiones)),s(5),y(e.formatearPrecio((e.paquete.precio_final||e.paquete.precio)/e.paquete.cantidad_sesiones)),s(),d("ngIf",(e.paquete.descuento||0)>0),s(),d("ngIf",(e.paquete.descuento||0)===0),s(9),y(e.formatearFecha(e.paquete.fecha_creacion)),s(5),y(e.formatearFecha(e.paquete.fecha_actualizacion)),s(5),d("ngIf",e.paquete.status===1),s(9),d("ngIf",e.paquete.status===1),s(21),P(e.paquete.status===1?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"),s(),d("ngIf",e.paquete.status===1),s(),d("ngIf",e.paquete.status===0),s(),m(" ",e.paquete.status===1?"Desactivar":"Activar"," ")}}function gi(r,t){r&1&&(i(0,"span"),o(1,"Desactivar"),n())}function _i(r,t){r&1&&(i(0,"span"),o(1,"Desactivando..."),n())}function fi(r,t){if(r&1){let e=C();i(0,"div",99),g("click",function(){x(e);let l=p();return h(l.cancelarEliminacion())}),i(1,"div",100),g("click",function(l){return x(e),h(l.stopPropagation())}),i(2,"div",101)(3,"div",102),b(),i(4,"svg",103),_(5,"path",104),n()(),w(),i(6,"h3",105),o(7,"Confirmar desactivaci\xF3n"),n(),i(8,"div",106)(9,"p",107),o(10),n()(),i(11,"div",108)(12,"div",7)(13,"button",109),g("click",function(){x(e);let l=p();return h(l.eliminarPaquete())}),f(14,gi,2,0,"span",110)(15,_i,2,0,"span",110),n(),i(16,"button",111),g("click",function(){x(e);let l=p();return h(l.cancelarEliminacion())}),o(17," Cancelar "),n()()()()()()}if(r&2){let e=p();s(10),m(' \xBFEst\xE1s seguro de que deseas desactivar el paquete "',e.paquete==null?null:e.paquete.nombre,'"? Esto afectar\xE1 las asignaciones activas. '),s(3),d("disabled",e.procesandoAccion),s(),d("ngIf",!e.procesandoAccion),s(),d("ngIf",e.procesandoAccion),s(),d("disabled",e.procesandoAccion)}}function bi(r,t){r&1&&(i(0,"span"),o(1,"Activar"),n())}function vi(r,t){r&1&&(i(0,"span"),o(1,"Activando..."),n())}function xi(r,t){if(r&1){let e=C();i(0,"div",99),g("click",function(){x(e);let l=p();return h(l.cancelarActivacion())}),i(1,"div",100),g("click",function(l){return x(e),h(l.stopPropagation())}),i(2,"div",101)(3,"div",112),b(),i(4,"svg",113),_(5,"path",56),n()(),w(),i(6,"h3",105),o(7,"Confirmar activaci\xF3n"),n(),i(8,"div",106)(9,"p",107),o(10),n()(),i(11,"div",108)(12,"div",7)(13,"button",114),g("click",function(){x(e);let l=p();return h(l.activarPaquete())}),f(14,bi,2,0,"span",110)(15,vi,2,0,"span",110),n(),i(16,"button",111),g("click",function(){x(e);let l=p();return h(l.cancelarActivacion())}),o(17," Cancelar "),n()()()()()()}if(r&2){let e=p();s(10),m(' \xBFEst\xE1s seguro de que deseas activar el paquete "',e.paquete==null?null:e.paquete.nombre,'"? Estar\xE1 disponible para nuevas asignaciones. '),s(3),d("disabled",e.procesandoAccion),s(),d("ngIf",!e.procesandoAccion),s(),d("ngIf",e.procesandoAccion),s(),d("disabled",e.procesandoAccion)}}var qe=class r{constructor(t,e,a){this.route=t;this.router=e;this.paquetesService=a;this.paqueteId=parseInt(this.route.snapshot.paramMap.get("id")||"0")}paquete=null;cargando=!1;error=null;paqueteId;mostrarModalEliminar=!1;mostrarModalActivar=!1;procesandoAccion=!1;ahorroTotal=0;preciosPorSesion={base:0,final:0};ngOnInit(){this.paqueteId>0?this.cargarPaquete():this.error="ID de paquete inv\xE1lido"}cargarPaquete(){return v(this,null,function*(){this.cargando=!0,this.error=null;try{this.paquete=yield this.paquetesService.obtenerPaquetePorId(this.paqueteId),this.paquete?this.calcularDatosAdicionales():this.error="Paquete no encontrado"}catch(t){console.error("Error cargando paquete:",t),this.error="Error al cargar el paquete. Por favor, intenta de nuevo."}finally{this.cargando=!1}})}calcularDatosAdicionales(){this.paquete&&(this.ahorroTotal=this.paquete.precio-(this.paquete.precio_final||this.paquete.precio),this.preciosPorSesion={base:this.paquete.precio/this.paquete.cantidad_sesiones,final:(this.paquete.precio_final||this.paquete.precio)/this.paquete.cantidad_sesiones})}irAEditar(){this.router.navigate(["/paquetes/editar",this.paqueteId])}volver(){this.router.navigate(["/paquetes"])}irALista(){this.router.navigate(["/paquetes"])}irAAsignar(){this.router.navigate(["/paquetes/asignar"],{queryParams:{paquete_id:this.paqueteId}})}verAsignaciones(){this.router.navigate(["/paquetes/asignaciones"],{queryParams:{paquete_id:this.paqueteId}})}confirmarEliminacion(){this.mostrarModalEliminar=!0}cancelarEliminacion(){this.mostrarModalEliminar=!1}eliminarPaquete(){return v(this,null,function*(){if(this.paquete){this.procesandoAccion=!0;try{let t=yield this.paquetesService.eliminarPaquete(this.paquete.id);t.success?(this.mostrarMensajeExito("Paquete eliminado exitosamente"),setTimeout(()=>{this.volver()},1500)):this.mostrarMensajeError(t.message)}catch(t){console.error("Error eliminando paquete:",t),this.mostrarMensajeError("Error al eliminar el paquete")}finally{this.procesandoAccion=!1,this.cancelarEliminacion()}}})}confirmarActivacion(){this.mostrarModalActivar=!0}cancelarActivacion(){this.mostrarModalActivar=!1}activarPaquete(){return v(this,null,function*(){if(this.paquete){this.procesandoAccion=!0;try{let t=yield this.paquetesService.activarPaquete(this.paquete.id);t.success?(this.mostrarMensajeExito("Paquete activado exitosamente"),yield this.cargarPaquete()):this.mostrarMensajeError(t.message)}catch(t){console.error("Error activando paquete:",t),this.mostrarMensajeError("Error al activar el paquete")}finally{this.procesandoAccion=!1,this.cancelarActivacion()}}})}toggleStatus(){return v(this,null,function*(){this.paquete&&(this.paquete.status===1?this.confirmarEliminacion():this.confirmarActivacion())})}formatearPrecio(t){return this.paquetesService.formatearPrecio(t)}formatearFecha(t){return new Date(t).toLocaleDateString("es-GT",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}formatearFechaCorta(t){return new Date(t).toLocaleDateString("es-GT",{year:"numeric",month:"short",day:"numeric"})}obtenerClaseStatus(t){return t===1?"bg-green-100 text-green-800 border-green-200":"bg-red-100 text-red-800 border-red-200"}obtenerTextoStatus(t){return t===1?"Activo":"Inactivo"}obtenerIconoStatus(t){return t===1?"\u2713":"\u2717"}obtenerClaseTipo(t){return t==="terapia"?"bg-blue-100 text-blue-800 border-blue-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}obtenerIconoTipo(t){return t==="terapia"?"\u{1F3E5}":"\u{1F4AA}"}get tieneDescuento(){return(this.paquete?.descuento||0)>0}get esPaqueteActivo(){return this.paquete?.status===1}get porcentajeAhorro(){return!this.paquete||this.paquete.precio===0?0:this.ahorroTotal/this.paquete.precio*100}get informacionResumida(){return this.paquete?{sesiones:this.paquete.cantidad_sesiones,tipo:this.paquete.tipo,precio_base:this.paquete.precio,precio_final:this.paquete.precio_final||this.paquete.precio,descuento:this.paquete.descuento,precio_por_sesion:this.preciosPorSesion.final,ahorro_total:this.ahorroTotal,estado:this.paquete.status}:null}duplicarPaquete(){this.paquete&&this.router.navigate(["/paquetes/crear"],{queryParams:{duplicar:this.paquete.id,nombre:`Copia de ${this.paquete.nombre}`,tipo:this.paquete.tipo,precio:this.paquete.precio,sesiones:this.paquete.cantidad_sesiones,descuento:this.paquete.descuento}})}imprimirPaquete(){window.print()}exportarPaquete(){if(!this.paquete)return;let t=D(V({},this.paquete),{precio_por_sesion:this.preciosPorSesion.final,ahorro_total:this.ahorroTotal,exportado_en:new Date().toISOString()}),e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t,null,2)),a=document.createElement("a");a.setAttribute("href",e),a.setAttribute("download",`paquete_${this.paquete.id}_${this.paquete.nombre.replace(/\s+/g,"_")}.json`),document.body.appendChild(a),a.click(),a.remove()}compartirPaquete(){this.paquete&&(navigator.share?navigator.share({title:this.paquete.nombre,text:`${this.paquete.descripcion||"Paquete de "+this.paquete.tipo}`,url:window.location.href}).catch(console.error):navigator.clipboard.writeText(window.location.href).then(()=>{this.mostrarMensajeExito("Enlace copiado al portapapeles")}))}mostrarMensajeExito(t){console.log("\xC9xito:",t)}mostrarMensajeError(t){console.error("Error:",t),this.error=t}mostrarMensajeInfo(t){console.info("Info:",t)}limpiarError(){this.error=null}ngOnDestroy(){this.cancelarEliminacion(),this.cancelarActivacion()}static \u0275fac=function(e){return new(e||r)(q(ee),q(U),q(Q))};static \u0275cmp=j({type:r,selectors:[["app-paquete-detalle"]],standalone:!1,decls:25,vars:7,consts:[[1,"container","mx-auto","px-4","py-6"],[1,"mb-6"],[1,"flex","items-center","gap-2","text-sm","text-gray-500","mb-2"],["routerLink","/paquetes",1,"hover:text-blue-600"],[1,"flex","justify-between","items-start"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],[1,"flex","space-x-3"],[1,"bg-gray-500","hover:bg-gray-600","text-white","px-4","py-2","rounded-lg","transition-colors",3,"click"],["class","bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",3,"click",4,"ngIf"],["class","bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",3,"click",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",4,"ngIf"],["class","space-y-6",4,"ngIf"],["class","fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",3,"click",4,"ngIf"],[1,"bg-green-600","hover:bg-green-700","text-white","px-4","py-2","rounded-lg","flex","items-center","gap-2","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded-lg","flex","items-center","gap-2","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"text-center","py-12"],[1,"inline-block","animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"mt-2","text-gray-600"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg"],[1,"flex","items-center","justify-between"],[1,"text-red-500","hover:text-red-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"space-y-6"],[1,"bg-white","rounded-lg","shadow-sm","border","p-6"],[1,"flex","justify-between","items-start","mb-6"],[1,"flex-1"],[1,"flex","items-center","gap-3","mb-2"],[1,"text-2xl","font-bold","text-gray-900"],[1,"px-3","py-1","text-sm","font-semibold","rounded-full","border"],["class","text-gray-600 text-lg",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-6"],[1,"bg-blue-50","p-4","rounded-lg","border","border-blue-200"],[1,"flex","items-center"],[1,"flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-4"],[1,"text-sm","font-medium","text-blue-900"],[1,"text-2xl","font-bold","text-blue-600"],[1,"bg-gray-50","p-4","rounded-lg","border","border-gray-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-2xl","font-bold","text-gray-600"],[1,"bg-yellow-50","p-4","rounded-lg","border","border-yellow-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-yellow-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],[1,"text-sm","font-medium","text-yellow-900"],[1,"text-2xl","font-bold","text-yellow-600"],[1,"bg-green-50","p-4","rounded-lg","border","border-green-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","font-medium","text-green-900"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"text-center","p-4","bg-gray-50","rounded-lg"],[1,"text-sm","text-gray-600","mb-1"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-center","p-4","bg-green-50","rounded-lg"],[1,"text-sm","text-green-700","mb-1"],[1,"text-xl","font-bold","text-green-600"],["class","text-center p-4 bg-blue-50 rounded-lg",4,"ngIf"],["class","text-center p-4 bg-gray-50 rounded-lg",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"text-sm","font-medium","text-gray-700"],[1,"text-gray-900"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],["class","bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg flex items-center gap-3 transition-colors w-full",3,"click",4,"ngIf"],[1,"bg-purple-600","hover:bg-purple-700","text-white","px-4","py-3","rounded-lg","flex","items-center","gap-3","transition-colors","w-full",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"text-left"],[1,"font-medium"],[1,"text-sm","opacity-90"],["class","bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg flex items-center gap-3 transition-colors w-full",3,"click",4,"ngIf"],[1,"flex","flex-wrap","gap-3"],[1,"bg-gray-600","hover:bg-gray-700","text-white","px-4","py-2","rounded-lg","flex","items-center","gap-2","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"bg-indigo-600","hover:bg-indigo-700","text-white","px-4","py-2","rounded-lg","flex","items-center","gap-2","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"],[1,"bg-yellow-600","hover:bg-yellow-700","text-white","px-4","py-2","rounded-lg","flex","items-center","gap-2","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"],[1,"text-white","px-4","py-2","rounded-lg","flex","items-center","gap-2","transition-colors",3,"click"],["class","w-4 h-4","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"text-gray-600","text-lg"],[1,"text-center","p-4","bg-blue-50","rounded-lg"],[1,"text-sm","text-blue-700","mb-1"],[1,"text-xl","font-bold","text-blue-600"],[1,"text-gray-600"],[1,"bg-green-600","hover:bg-green-700","text-white","px-4","py-3","rounded-lg","flex","items-center","gap-3","transition-colors","w-full",3,"click"],[1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-3","rounded-lg","flex","items-center","gap-3","transition-colors","w-full",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L5.636 5.636"],[1,"fixed","inset-0","bg-gray-600","bg-opacity-50","overflow-y-auto","h-full","w-full","z-50",3,"click"],[1,"relative","top-20","mx-auto","p-5","border","w-96","shadow-lg","rounded-md","bg-white",3,"click"],[1,"mt-3","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-lg","leading-6","font-medium","text-gray-900","mt-4"],[1,"mt-2","px-7","py-3"],[1,"text-sm","text-gray-500"],[1,"items-center","px-4","py-3"],[1,"px-4","py-2","bg-red-500","text-white","text-base","font-medium","rounded-md","w-full","shadow-sm","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-300","disabled:opacity-50",3,"click","disabled"],[4,"ngIf"],[1,"px-4","py-2","bg-gray-500","text-white","text-base","font-medium","rounded-md","w-full","shadow-sm","hover:bg-gray-700","focus:outline-none","focus:ring-2","focus:ring-gray-300","disabled:opacity-50",3,"click","disabled"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-green-100"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-green-600"],[1,"px-4","py-2","bg-green-500","text-white","text-base","font-medium","rounded-md","w-full","shadow-sm","hover:bg-green-700","focus:outline-none","focus:ring-2","focus:ring-green-300","disabled:opacity-50",3,"click","disabled"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),o(4,"Paquetes"),n(),i(5,"span"),o(6,"/"),n(),i(7,"span"),o(8,"Detalle"),n()(),i(9,"div",4)(10,"div")(11,"h1",5),o(12,"Detalle del Paquete"),n(),i(13,"p",6),o(14,"Informaci\xF3n completa del paquete seleccionado"),n()(),i(15,"div",7)(16,"button",8),g("click",function(){return a.volver()}),o(17," Volver "),n(),f(18,ii,4,0,"button",9)(19,ni,4,0,"button",10),n()()(),f(20,ai,4,0,"div",11)(21,oi,7,1,"div",12)(22,mi,122,29,"div",13),n(),f(23,fi,18,5,"div",14)(24,xi,18,5,"div",14)),e&2&&(s(18),d("ngIf",a.paquete&&a.paquete.status===1),s(),d("ngIf",a.paquete&&a.paquete.status===1),s(),d("ngIf",a.cargando),s(),d("ngIf",a.error&&!a.cargando),s(),d("ngIf",a.paquete&&!a.cargando&&!a.error),s(),d("ngIf",a.mostrarModalEliminar),s(),d("ngIf",a.mostrarModalActivar))},dependencies:[z,ne,N],styles:[".detalle-container[_ngcontent-%COMP%]{min-height:100vh;--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.detalle-header[_ngcontent-%COMP%]{margin-bottom:1.5rem;border-bottom-width:1px;--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.breadcrumb-nav[_ngcontent-%COMP%]{margin-bottom:1rem;display:flex;align-items:center;gap:.5rem;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.breadcrumb-link[_ngcontent-%COMP%]{cursor:pointer;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.breadcrumb-link[_ngcontent-%COMP%]:hover{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.breadcrumb-separator[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.header-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}@media (min-width: 768px){.header-content[_ngcontent-%COMP%]{flex-direction:row;align-items:flex-start;justify-content:space-between}}.header-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:.5rem;font-size:1.875rem;line-height:2.25rem;font-weight:700;--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.header-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.header-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;border-radius:9999px;border-width:1px;padding:.25rem .75rem;font-size:.875rem;line-height:1.25rem;font-weight:600}.badge-tipo[_ngcontent-%COMP%], .badge-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.tipo-icon[_ngcontent-%COMP%], .status-icon[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem}.info-card[_ngcontent-%COMP%]{margin-bottom:1.5rem;border-radius:.5rem;border-width:1px;--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1));padding:1.5rem;--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.card-title[_ngcontent-%COMP%]{margin-bottom:1rem;border-bottom-width:1px;--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1));padding-bottom:.5rem;font-size:1.125rem;line-height:1.75rem;font-weight:600;--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.card-content[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:1.5rem}@media (min-width: 768px){.info-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width: 1024px){.info-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,minmax(0,1fr))}}.stat-card[_ngcontent-%COMP%]{border-radius:.5rem;border-width:1px;padding:1rem;transition:transform .2s ease,box-shadow .2s ease}.stat-card[_ngcontent-%COMP%]:hover{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));box-shadow:0 10px 25px #0000001a}.stat-card.blue[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.stat-card.gray[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.stat-card.yellow[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(254 240 138 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.stat-card.green[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(187 247 208 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.stat-card.red[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.stat-header[_ngcontent-%COMP%]{margin-bottom:.5rem;display:flex;align-items:center;gap:.75rem}.stat-icon[_ngcontent-%COMP%]{height:2rem;width:2rem;flex-shrink:0}.stat-icon.blue[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.stat-icon.gray[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.stat-icon.yellow[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.stat-icon.green[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.stat-icon.red[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.stat-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:.25rem;font-size:.875rem;line-height:1.25rem;font-weight:500}.stat-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.5rem;line-height:2rem;font-weight:700}.stat-content.blue[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(30 58 138 / var(--tw-text-opacity, 1))}.stat-content.blue[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.stat-content.gray[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.stat-content.gray[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.stat-content.yellow[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(113 63 18 / var(--tw-text-opacity, 1))}.stat-content.yellow[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.stat-content.green[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(20 83 45 / var(--tw-text-opacity, 1))}.stat-content.green[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.stat-content.red[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(127 29 29 / var(--tw-text-opacity, 1))}.stat-content.red[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.cost-analysis[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:1.5rem}@media (min-width: 768px){.cost-analysis[_ngcontent-%COMP%]{grid-template-columns:repeat(3,minmax(0,1fr))}}.cost-item[_ngcontent-%COMP%]{border-radius:.5rem;padding:1rem;text-align:center}.cost-item.gray[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.cost-item.green[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.cost-item.blue[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.cost-label[_ngcontent-%COMP%]{margin-bottom:.25rem;font-size:.875rem;line-height:1.25rem}.cost-label.gray[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.cost-label.green[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.cost-label.blue[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(29 78 216 / var(--tw-text-opacity, 1))}.cost-value[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1.75rem;font-weight:700}.cost-value.gray[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.cost-value.green[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.cost-value.blue[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.system-info[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:1.5rem}@media (min-width: 768px){.system-info[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}.info-item[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.info-label[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:500;--tw-text-opacity: 1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.info-value[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.no-discount[_ngcontent-%COMP%]{border-radius:.5rem;--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1));padding:1rem;text-align:center}.no-discount[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.actions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:1rem}@media (min-width: 768px){.actions-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width: 1024px){.actions-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,minmax(0,1fr))}}.action-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;border-radius:.5rem;padding:.5rem 1rem;font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.action-button[_ngcontent-%COMP%]:hover{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.action-button.primary[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.action-button.primary[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.action-button.success[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.action-button.success[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.action-button.warning[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(202 138 4 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.action-button.warning[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(161 98 7 / var(--tw-bg-opacity, 1))}.action-button.danger[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.action-button.danger[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.action-button.secondary[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.action-button.secondary[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.action-button.purple[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.action-button.purple[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}.action-button.indigo[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(79 70 229 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.action-button.indigo[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(67 56 202 / var(--tw-bg-opacity, 1))}.action-icon[_ngcontent-%COMP%]{height:1rem;width:1rem}.loading-container[_ngcontent-%COMP%]{padding-top:3rem;padding-bottom:3rem;text-align:center}.loading-spinner[_ngcontent-%COMP%]{margin-bottom:1rem;display:inline-block;height:2rem;width:2rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite;border-radius:9999px;border-bottom-width:2px;--tw-border-opacity: 1;border-color:rgb(37 99 235 / var(--tw-border-opacity, 1))}.loading-text[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.error-container[_ngcontent-%COMP%]{margin-bottom:1.5rem;border-radius:.5rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1));padding:.75rem 1rem;--tw-text-opacity: 1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.error-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.error-message[_ngcontent-%COMP%]{flex:1 1 0%}.error-close[_ngcontent-%COMP%]{margin-left:1rem;cursor:pointer;--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.error-close[_ngcontent-%COMP%]:hover{--tw-text-opacity: 1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:50;display:flex;height:100%;width:100%;align-items:center;justify-content:center;overflow-y:auto;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1));--tw-bg-opacity: .5;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.modal-container[_ngcontent-%COMP%]{position:relative;margin-left:1rem;margin-right:1rem;width:100%;max-width:28rem;border-radius:.5rem;--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1));--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow);animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-header[_ngcontent-%COMP%]{padding:1.5rem 1.5rem 1rem}.modal-icon[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;margin-bottom:1rem;display:flex;height:3rem;width:3rem;align-items:center;justify-content:center;border-radius:9999px}.modal-icon.danger[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.modal-icon.success[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.modal-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:1.5rem;width:1.5rem}.modal-icon.danger[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.modal-icon.success[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.modal-title[_ngcontent-%COMP%]{text-align:center;font-size:1.125rem;font-weight:500;line-height:1.5rem;--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.modal-body[_ngcontent-%COMP%]{padding-left:1.5rem;padding-right:1.5rem;padding-bottom:1rem}.modal-text[_ngcontent-%COMP%]{text-align:center;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.modal-footer[_ngcontent-%COMP%]{padding:.5rem 1.5rem 1.5rem}.modal-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column-reverse;gap:.75rem}@media (min-width: 768px){.modal-actions[_ngcontent-%COMP%]{flex-direction:row}}.modal-button[_ngcontent-%COMP%]{flex:1 1 0%;border-radius:.375rem;padding:.5rem 1rem;font-size:.875rem;line-height:1.25rem;font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.modal-button[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-offset-width: 2px}.modal-button.primary[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.modal-button.primary[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.modal-button.primary[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(239 68 68 / var(--tw-ring-opacity, 1))}.modal-button.secondary[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.modal-button.secondary[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity, 1))}.modal-button.secondary[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(107 114 128 / var(--tw-ring-opacity, 1))}.modal-button[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.5}.paquete-description[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem;line-height:1.625;--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}@media (max-width: 768px){.header-content[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.actions-grid[_ngcontent-%COMP%], .info-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(1,minmax(0,1fr))}@media (min-width: 768px){.info-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}.cost-analysis[_ngcontent-%COMP%]{grid-template-columns:repeat(1,minmax(0,1fr))}.modal-container[_ngcontent-%COMP%]{margin-left:.5rem;margin-right:.5rem}.modal-actions[_ngcontent-%COMP%]{flex-direction:column;gap:.75rem}}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.slide-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.info-card[_ngcontent-%COMP%]:hover{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow);transition:box-shadow .3s ease}.action-button[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-offset-width: 2px}.action-button.primary[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.action-button.success[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(34 197 94 / var(--tw-ring-opacity, 1))}.action-button.warning[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(234 179 8 / var(--tw-ring-opacity, 1))}.action-button.danger[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(239 68 68 / var(--tw-ring-opacity, 1))}@media print{.header-actions[_ngcontent-%COMP%], .modal-overlay[_ngcontent-%COMP%], .action-button[_ngcontent-%COMP%]{display:none}.info-card[_ngcontent-%COMP%]{border-width:1px;--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1));--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}}"]})};var ae=class r{constructor(t){this.supabaseService=t}obtenerUsuarios(){return v(this,null,function*(){try{console.log("\u{1F50D} Iniciando carga de usuarios...");let{data:t,error:e}=yield this.supabaseService.client.from("profiles").select("id, username, full_name, created_at, status").eq("status",1).order("full_name");if(e)throw console.error("\u274C Error obteniendo usuarios:",e),e;return console.log("\u2705 Usuarios cargados:",t?.length||0),(t||[]).map(l=>({id:l.id,nombre:l.full_name||l.username||"Usuario sin nombre",email:l.username||`usuario${l.id}@example.com`,telefono:void 0,fecha_nacimiento:void 0,estado:l.status===1?"activo":"inactivo"}))}catch(t){throw console.error("\u274C Error en obtenerUsuarios:",t),new Error("No se pudieron cargar los usuarios")}})}obtenerTerapeutas(){return v(this,null,function*(){try{console.log("\u{1F50D} Iniciando carga de terapeutas...");let{data:t,error:e}=yield this.supabaseService.client.from("profiles").select("id, username, full_name, created_at, status, id_perfil").eq("status",1).in("id_perfil",[1,3]).order("full_name");return e?(console.error("\u274C Error obteniendo terapeutas:",e),this.obtenerUsuarios()):(console.log("\u2705 Terapeutas cargados:",t?.length||0),(t||[]).map(l=>({id:l.id,nombre:l.full_name||l.username||"Terapeuta sin nombre",email:l.username||`terapeuta${l.id}@example.com`,telefono:void 0,fecha_nacimiento:void 0,estado:l.status===1?"activo":"inactivo"})))}catch(t){return console.error("\u274C Error en obtenerTerapeutas:",t),this.obtenerUsuarios()}})}buscarUsuarios(t){return v(this,null,function*(){try{if(console.log("\u{1F50D} Buscando usuarios con t\xE9rmino:",t),!t||t.trim().length===0)return yield this.obtenerUsuarios();let e=t.trim(),{data:a,error:l}=yield this.supabaseService.client.from("profiles").select("id, username, full_name, created_at, status").eq("status",1).or(`full_name.ilike.%${e}%,username.ilike.%${e}%`).order("full_name").limit(50);if(l)throw console.error("\u274C Error buscando usuarios:",l),l;return console.log("\u2705 Usuarios encontrados:",a?.length||0),(a||[]).map(u=>({id:u.id,nombre:u.full_name||u.username||"Usuario sin nombre",email:u.username||`usuario${u.id}@example.com`,telefono:void 0,fecha_nacimiento:void 0,estado:u.status===1?"activo":"inactivo"}))}catch(e){throw console.error("\u274C Error en buscarUsuarios:",e),new Error("No se pudieron buscar los usuarios")}})}obtenerPaquetes(){return v(this,null,function*(){try{console.log("\u{1F50D} Iniciando carga de paquetes...");let{data:t,error:e}=yield this.supabaseService.client.from("paquetes").select("*").eq("status",1).order("nombre");if(e)throw console.error("\u274C Error obteniendo paquetes:",e),e;return console.log("\u2705 Paquetes cargados:",t?.length||0),t||[]}catch(t){throw console.error("\u274C Error en obtenerPaquetes:",t),new Error("No se pudieron cargar los paquetes")}})}asignarPaqueteAUsuario(t){return v(this,null,function*(){try{if(console.log("\u{1F680} Iniciando asignaci\xF3n de paquete:",t),!t.usuario_id||!t.paquete_id)return{success:!1,message:"Usuario y paquete son requeridos"};if(!t.fecha_inicio)return{success:!1,message:"Fecha de inicio es requerida"};if(t.precio_pagado<=0)return{success:!1,message:"El precio debe ser mayor a cero"};let{data:e,error:a}=yield this.supabaseService.client.from("paquetes").select("*").eq("id",t.paquete_id).eq("status",1).single();if(a||!e)return console.error("\u274C Paquete no encontrado:",a),{success:!1,message:"Paquete no encontrado o inactivo"};let{data:l,error:c}=yield this.supabaseService.client.from("profiles").select("id, full_name, username").eq("id",t.usuario_id).eq("status",1).single();if(c||!l)return console.error("\u274C Usuario no encontrado:",c),{success:!1,message:"Usuario no encontrado o inactivo"};let{data:u}=yield this.supabaseService.client.from("usuario_paquetes").select("id").eq("usuario_id",t.usuario_id).eq("paquete_id",t.paquete_id).eq("estado","activo").maybeSingle();if(u)return{success:!1,message:"El usuario ya tiene este paquete asignado y activo"};try{console.log("\u{1F527} Intentando con funci\xF3n SQL asignar_paquete_terapias_completo...");let{data:T,error:Ae}=yield this.supabaseService.client.rpc("asignar_paquete_terapias_completo",{p_usuario_id:t.usuario_id,p_paquete_id:t.paquete_id,p_precio_pagado:t.precio_pagado,p_fecha_inicio:t.fecha_inicio,p_terapeuta_id:t.terapeuta_asignado,p_metodo_pago:t.metodo_pago||"efectivo",p_asignado_por:1});if(!Ae&&T?.success)return console.log("\u2705 Asignaci\xF3n exitosa con funci\xF3n SQL:",T),{success:!0,message:T.mensaje||"Paquete asignado exitosamente usando funci\xF3n SQL",data:T};console.log("\u26A0\uFE0F Funci\xF3n SQL fall\xF3 o no disponible, usando m\xE9todo manual:",Ae)}catch{console.log("\u26A0\uFE0F Funci\xF3n SQL no disponible, usando m\xE9todo manual")}console.log("\u{1F527} Usando m\xE9todo manual de inserci\xF3n...");let S=new Date(t.fecha_inicio),F=new Date(S);F.setMonth(F.getMonth()+3);let ke=new Date,Te={usuario_id:t.usuario_id,paquete_id:t.paquete_id,fecha_inicio:t.fecha_inicio,fecha_fin:F.toISOString().split("T")[0],fecha_compra:ke.toISOString().split("T")[0],precio_pagado:Number(t.precio_pagado),descuento_aplicado:Number(t.descuento_aplicado||0),metodo_pago:t.metodo_pago||"efectivo",notas_administrativas:t.notas_administrativas||"",terapeuta_asignado:t.terapeuta_asignado||null,estado:"activo",sesiones_totales:e.cantidad_sesiones||1,sesiones_utilizadas:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("\u{1F4E4} Datos a insertar:",Te);let{data:Ie,error:J}=yield this.supabaseService.client.from("usuario_paquetes").insert([Te]).select(`
          *,
          paquete:paquetes!usuario_paquetes_paquete_id_fkey(nombre, tipo)
        `).single();if(J){console.error("\u274C Error insertando asignaci\xF3n:",J);let T="Error al asignar paquete";return J.code==="23505"?T="Ya existe una asignaci\xF3n duplicada":J.code==="23503"?T="Referencias inv\xE1lidas (usuario o paquete no existen)":J.code==="23514"?T="Datos inv\xE1lidos (verificar restricciones)":J.message.includes("permission")?T="Permisos insuficientes para crear asignaci\xF3n":J.message.includes("column")&&(T="Error de estructura de base de datos"),{success:!1,message:`${T}: ${J.message}`,error:J}}console.log("\u2705 Asignaci\xF3n creada exitosamente:",Ie);try{yield this.crearSeguimientoInicial(Ie.id,t,e)}catch(T){console.log("\u26A0\uFE0F No se pudo crear seguimiento autom\xE1tico:",T)}return{success:!0,message:`Paquete "${e.nombre}" asignado exitosamente a ${l.full_name||l.username}`,data:Ie}}catch(e){return console.error("\u274C Error general en asignarPaqueteAUsuario:",e),{success:!1,message:"Error interno al procesar la asignaci\xF3n",error:e}}})}crearSeguimientoInicial(t,e,a){return v(this,null,function*(){try{console.log("\u{1F4C5} Creando seguimiento inicial...");let l=new Date(e.fecha_inicio);for(let c=1;c<=(a.cantidad_sesiones||1);c++){let u=new Date(l);u.setDate(u.getDate()+c*2),yield this.supabaseService.client.from("paquete_seguimiento").insert({usuario_paquete_id:t,contenido_id:a.id,contenido_tipo:a.tipo,fecha_programada:u.toISOString().split("T")[0],terapeuta_id:e.terapeuta_asignado,estado:"pendiente",created_at:new Date().toISOString()})}console.log("\u2705 Seguimiento inicial creado")}catch(l){console.log("\u26A0\uFE0F No se pudo crear seguimiento autom\xE1tico (normal si la tabla no existe):",l)}})}obtenerAsignaciones(){return v(this,arguments,function*(t={}){try{console.log("\u{1F50D} Iniciando carga de asignaciones con filtros:",t);let e=this.supabaseService.client.from("usuario_paquetes").select(`
          *,
          usuario:profiles!usuario_paquetes_usuario_id_fkey(id, username, full_name),
          paquete:paquetes!usuario_paquetes_paquete_id_fkey(id, nombre, tipo, precio, cantidad_sesiones),
          terapeuta:profiles!usuario_paquetes_terapeuta_asignado_fkey(id, username, full_name)
        `);t.usuario_id&&(e=e.eq("usuario_id",t.usuario_id)),t.paquete_id&&(e=e.eq("paquete_id",t.paquete_id)),t.estado&&(e=e.eq("estado",t.estado)),t.fecha_inicio&&(e=e.gte("fecha_inicio",t.fecha_inicio)),t.fecha_fin&&(e=e.lte("fecha_fin",t.fecha_fin)),t.terapeuta_id&&(e=e.eq("terapeuta_asignado",t.terapeuta_id)),e=e.order("created_at",{ascending:!1});let{data:a,error:l}=yield e;if(l)throw console.error("\u274C Error obteniendo asignaciones:",l),l;return console.log("\u2705 Asignaciones cargadas:",a?.length||0),(a||[]).map(u=>D(V({},u),{usuario:u.usuario?{id:u.usuario.id,nombre:u.usuario.full_name||u.usuario.username||"Sin nombre",email:u.usuario.username||"Sin email"}:void 0,paquete:u.paquete?V({},u.paquete):void 0,terapeuta:u.terapeuta?{id:u.terapeuta.id,nombre:u.terapeuta.full_name||u.terapeuta.username||"Sin nombre",email:u.terapeuta.username||"Sin email"}:void 0}))}catch(e){throw console.error("\u274C Error en obtenerAsignaciones:",e),new Error("No se pudieron cargar las asignaciones")}})}crearAsignacion(t){return v(this,null,function*(){return this.asignarPaqueteAUsuario(t)})}actualizarEstadoAsignacion(t,e){return v(this,null,function*(){try{console.log("\u{1F504} Actualizando estado de asignaci\xF3n:",t,"a",e);let{data:a,error:l}=yield this.supabaseService.client.from("usuario_paquetes").update({estado:e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(l)throw console.error("\u274C Error actualizando estado:",l),l;return console.log("\u2705 Estado actualizado exitosamente:",a),{success:!0,message:`Estado cambiado a ${e} exitosamente`,data:a}}catch(a){return console.error("\u274C Error en actualizarEstadoAsignacion:",a),{success:!1,message:"Error al actualizar el estado",error:a}}})}calcularPrecioFinal(t,e){if(t<=0||e<0||e>100)return t;let a=e/100,l=t-t*a;return Math.round(l*100)/100}formatearPrecio(t){return new Intl.NumberFormat("es-GT",{style:"currency",currency:"GTQ"}).format(t)}calcularDiasRestantes(t){let e=new Date,l=new Date(t).getTime()-e.getTime();return Math.ceil(l/(1e3*3600*24))}obtenerEstadoTexto(t){return{activo:"Activo",pausado:"Pausado",completado:"Completado",cancelado:"Cancelado"}[t]||t}obtenerClaseEstado(t){return{activo:"bg-green-100 text-green-800",pausado:"bg-yellow-100 text-yellow-800",completado:"bg-blue-100 text-blue-800",cancelado:"bg-red-100 text-red-800"}[t]||"bg-gray-100 text-gray-800"}debugServicio(){return v(this,null,function*(){console.log("=== DEBUG AsignacionPaquetesService ===");try{let{count:t,error:e}=yield this.supabaseService.client.from("profiles").select("*",{count:"exact",head:!0}).eq("status",1);console.log("\u2705 Conexi\xF3n Supabase:",!e),console.log("\u{1F465} Total usuarios activos:",t);let{count:a,error:l}=yield this.supabaseService.client.from("paquetes").select("*",{count:"exact",head:!0}).eq("status",1);console.log("\u{1F4E6} Total paquetes activos:",a);let{count:c,error:u}=yield this.supabaseService.client.from("usuario_paquetes").select("*",{count:"exact",head:!0});console.log("\u{1F4CB} Total asignaciones:",c),console.log("\u274C Errores encontrados:",{errorUsuarios:e,errorPaquetes:l,errorAsignaciones:u})}catch(t){console.error("\u274C Error en debug:",t)}console.log("==========================================")})}static \u0275fac=function(e){return new(e||r)(fe(te))};static \u0275prov=ge({token:r,factory:r.\u0275fac,providedIn:"root"})};function hi(r,t){if(r&1&&(i(0,"div",62)(1,"div",50),b(),i(2,"svg",63),_(3,"path",64),n(),w(),i(4,"pre",65),o(5),n()()()),r&2){let e=p();s(5),y(e.error)}}function yi(r,t){if(r&1&&(i(0,"div",66)(1,"div",50),b(),i(2,"svg",63),_(3,"path",67),n(),w(),i(4,"pre",65),o(5),n()()()),r&2){let e=p();s(5),y(e.exito)}}function wi(r,t){if(r&1&&(i(0,"option",17),o(1),O(2,"titlecase"),n()),r&2){let e=t.$implicit,a=p();d("value",e.id),s(),Le(" ",e.nombre," - ",A(2,5,e.tipo)," (",e.cantidad_sesiones," sesiones) - ",a.formatearPrecio(e.precio_final||e.precio)," ")}}function Ci(r,t){if(r&1&&(i(0,"div")(1,"span",69),o(2,"Descuento:"),n(),i(3,"span",70),o(4),n()()),r&2){let e=p(2);s(4),m("",e.paqueteSeleccionado.descuento,"%")}}function Pi(r,t){if(r&1&&(i(0,"p",72),o(1),n()),r&2){let e=p(2);s(),m(" ",e.paqueteSeleccionado.descripcion," ")}}function Si(r,t){if(r&1&&(i(0,"div",68)(1,"h4",44),o(2),n(),i(3,"div",49)(4,"div")(5,"span",69),o(6,"Tipo:"),n(),i(7,"span",70),o(8),n()(),i(9,"div")(10,"span",69),o(11,"Sesiones:"),n(),i(12,"span",70),o(13),n()(),i(14,"div")(15,"span",69),o(16,"Precio base:"),n(),i(17,"span",70),o(18),n()(),f(19,Ci,5,1,"div",61),n(),f(20,Pi,2,1,"p",71),n()),r&2){let e=p();s(2),y(e.paqueteSeleccionado.nombre),s(6),y(e.paqueteSeleccionado.cantidad_sesiones),s(5),y(e.paqueteSeleccionado.cantidad_sesiones),s(5),y(e.formatearPrecio(e.paqueteSeleccionado.precio||0)),s(),d("ngIf",((e.paqueteSeleccionado==null?null:e.paqueteSeleccionado.descuento)||0)>0),s(),d("ngIf",e.paqueteSeleccionado==null?null:e.paqueteSeleccionado.descripcion)}}function qi(r,t){r&1&&(i(0,"div",73),o(1," Buscando usuarios... "),n())}function Ei(r,t){r&1&&(i(0,"div",74)(1,"p"),o(2,"No se encontraron usuarios"),n()())}function Mi(r,t){if(r&1&&(i(0,"p",81),o(1),n()),r&2){let e=p().$implicit;s(),m(" ",e.telefono," ")}}function ki(r,t){if(r&1){let e=C();i(0,"label",75)(1,"input",76),g("change",function(){let l=x(e).$implicit,c=p();return h(c.toggleUsuario(l.id))}),n(),i(2,"div",77)(3,"p",78),o(4),n(),i(5,"p",79),o(6),n(),f(7,Mi,2,1,"p",80),n()()}if(r&2){let e=t.$implicit,a=p();L("bg-blue-50",a.isUsuarioSelected(e.id)),s(),d("checked",a.isUsuarioSelected(e.id)),s(3),m(" ",e.nombre," "),s(2),m(" ",e.email," "),s(),d("ngIf",e.telefono)}}function Ii(r,t){if(r&1&&(i(0,"option",17),o(1),n()),r&2){let e=t.$implicit;d("value",e.value),s(),m(" ",e.label," ")}}function Oi(r,t){if(r&1&&(i(0,"option",17),o(1),n()),r&2){let e=t.$implicit;d("value",e.id),s(),I(" ",e.nombre," - ",e.email," ")}}function Fi(r,t){if(r&1&&(i(0,"div",99),o(1),n()),r&2){let e=t.$implicit;s(),m(" ",e," ")}}function Ti(r,t){if(r&1&&(i(0,"div",100)(1,"span"),o(2),n(),i(3,"span"),o(4),n()()),r&2){let e=p(2);s(2),m("Descuento (",e.resumenAsignacion.descuento,"%):"),s(2),m("-",e.formatearPrecio(e.resumenAsignacion.ahorro_por_usuario),"")}}function Ai(r,t){if(r&1&&(i(0,"div",101)(1,"span"),o(2,"Ahorro total:"),n(),i(3,"span"),o(4),n()()),r&2){let e=p(2);s(4),y(e.formatearPrecio(e.resumenAsignacion.ahorro_total))}}function Vi(r,t){if(r&1&&(i(0,"div",13)(1,"h3",14),o(2,"Resumen de Asignaci\xF3n"),n(),i(3,"div",82)(4,"div",83)(5,"span",84),o(6,"Paquete:"),n(),i(7,"span",85),o(8),n()(),i(9,"div",83)(10,"span",84),o(11,"Tipo:"),n(),i(12,"span",86),o(13),n()(),i(14,"div",83)(15,"span",84),o(16,"Sesiones:"),n(),i(17,"span",85),o(18),n()(),i(19,"div",83)(20,"span",84),o(21,"Usuarios seleccionados:"),n(),i(22,"span",85),o(23),n()(),i(24,"div",83)(25,"span",84),o(26,"Fecha inicio:"),n(),i(27,"span",85),o(28),O(29,"date"),n()(),_(30,"hr",87),i(31,"div",88)(32,"span",89),o(33,"Usuarios:"),n(),i(34,"div",90),f(35,Fi,2,1,"div",91),n()(),_(36,"hr",87),i(37,"div",92)(38,"div",83)(39,"span",84),o(40,"Precio base por usuario:"),n(),i(41,"span"),o(42),n()(),f(43,Ti,5,2,"div",93),i(44,"div",94)(45,"span"),o(46,"Precio final por usuario:"),n(),i(47,"span"),o(48),n()(),_(49,"hr",95),i(50,"div",96)(51,"span"),o(52,"Total a cobrar:"),n(),i(53,"span",97),o(54),n()(),f(55,Ai,5,1,"div",98),n()()()),r&2){let e=p();s(8),y(e.resumenAsignacion.paquete),s(5),y(e.resumenAsignacion.tipo),s(5),y(e.resumenAsignacion.sesiones),s(5),y(e.resumenAsignacion.usuarios_count),s(5),y(ve(29,11,e.resumenAsignacion.fecha_inicio,"dd/MM/yyyy")),s(7),d("ngForOf",e.resumenAsignacion.usuarios_nombres),s(7),y(e.formatearPrecio(e.resumenAsignacion.precio_base)),s(),d("ngIf",e.resumenAsignacion.descuento>0),s(5),y(e.formatearPrecio(e.resumenAsignacion.precio_final)),s(6),y(e.formatearPrecio(e.resumenAsignacion.precio_total)),s(),d("ngIf",e.resumenAsignacion.ahorro_total>0)}}function Di(r,t){r&1&&(b(),i(0,"svg",102),_(1,"circle",103)(2,"path",104),n())}function ji(r,t){r&1&&(i(0,"span",105),o(1," Completar formulario "),n())}function Li(r,t){if(r&1&&(i(0,"span"),o(1),n()),r&2){let e=p();s(),I(" Asignar a ",e.asignacionForm.usuarios_seleccionados.length," Usuario",e.asignacionForm.usuarios_seleccionados.length!==1?"s":""," ")}}function zi(r,t){r&1&&(i(0,"span"),o(1," Asignando... "),n())}var ue=class r{constructor(t,e,a,l){this.router=t;this.route=e;this.asignacionService=a;this.paquetesService=l}cargando=!1;buscandoUsuarios=!1;error=null;exito=null;usuarios=[];paquetes=[];terapeutas=[];asignacionForm={paquete_id:null,usuarios_seleccionados:[],fecha_inicio:this.obtenerFechaHoy(),precio_pagado:0,descuento_aplicado:0,terapeuta_asignado:null,metodo_pago:"efectivo",notas_administrativas:""};terminoBusquedaUsuarios="";paqueteSeleccionado=null;precioFinal=0;descuentoAplicado=0;metodosPago=[{value:"efectivo",label:"Efectivo"},{value:"tarjeta",label:"Tarjeta de Cr\xE9dito"},{value:"transferencia",label:"Transferencia Bancaria"},{value:"deposito",label:"Dep\xF3sito Bancario"},{value:"otro",label:"Otro"}];ngOnInit(){return v(this,null,function*(){yield this.inicializarDatos()})}inicializarDatos(){return v(this,null,function*(){this.cargando=!0;try{console.log("\u{1F680} Inicializando datos del componente..."),yield Promise.all([this.cargarPaquetes(),this.cargarTerapeutas(),this.cargarUsuarios()]),this.verificarParametrosURL(),console.log("\u2705 Inicializaci\xF3n completada")}catch(t){console.error("\u274C Error inicializando datos:",t),this.mostrarError("Error al cargar los datos iniciales")}finally{this.cargando=!1}})}verificarParametrosURL(){let t=this.route.snapshot.queryParams.paquete_id;if(console.log("\u{1F517} Verificando par\xE1metros URL, paquete_id:",t),t){let e=parseInt(t),a=this.paquetes.find(l=>l.id===e);a?(this.asignacionForm.paquete_id=e,this.onPaqueteSeleccionado(e),console.log("\u2705 Paquete preseleccionado:",a.nombre)):console.warn("\u26A0\uFE0F Paquete ID no encontrado en lista")}}cargarPaquetes(){return v(this,null,function*(){try{if(console.log("\u{1F4E6} Cargando paquetes..."),this.paquetesService&&typeof this.paquetesService.obtenerPaquetes=="function"){let t=yield this.paquetesService.obtenerPaquetes({status:1});this.paquetes=this.convertirPaquetes(t)}else console.log("\u26A0\uFE0F PaquetesService no disponible, usando fallback"),this.paquetes=yield this.cargarPaquetesDirecto();console.log("\u2705 Paquetes cargados:",this.paquetes.length)}catch(t){console.error("\u274C Error cargando paquetes:",t),this.paquetes=[],this.mostrarError("Error al cargar la lista de paquetes")}})}convertirPaquetes(t){return t.filter(e=>e.id!==void 0).map(e=>({id:e.id,nombre:e.nombre,descripcion:e.descripcion,precio:e.precio,cantidad_sesiones:e.cantidad_sesiones,tipo:e.tipo,descuento:e.descuento,precio_final:e.precio_final,status:e.status}))}cargarPaquetesDirecto(){return v(this,null,function*(){try{let t=this.asignacionService.supabaseService?.client;if(!t)throw new Error("Cliente de Supabase no disponible");let{data:e,error:a}=yield t.from("paquetes").select("*").eq("status",1).order("nombre");if(a)throw a;return(e||[]).filter(l=>l.id!=null).map(l=>({id:l.id,nombre:l.nombre||"Sin nombre",descripcion:l.descripcion,precio:l.precio||0,cantidad_sesiones:l.cantidad_sesiones||1,tipo:l.tipo||"rutina",descuento:l.descuento||0,precio_final:l.precio_final,status:l.status||1}))}catch(t){return console.error("Error cargando paquetes directamente:",t),[]}})}cargarTerapeutas(){return v(this,null,function*(){try{console.log("\u{1F468}\u200D\u2695\uFE0F Cargando terapeutas..."),this.terapeutas=yield this.asignacionService.obtenerTerapeutas(),console.log("\u2705 Terapeutas cargados:",this.terapeutas.length)}catch(t){console.error("\u274C Error cargando terapeutas:",t),this.terapeutas=[]}})}cargarUsuarios(){return v(this,null,function*(){try{console.log("\u{1F465} Cargando usuarios..."),this.usuarios=yield this.asignacionService.obtenerUsuarios(),console.log("\u2705 Usuarios cargados:",this.usuarios.length)}catch(t){console.error("\u274C Error cargando usuarios:",t),this.usuarios=[],this.mostrarError("Error al cargar la lista de usuarios")}})}buscarUsuarios(){return v(this,null,function*(){if(this.terminoBusquedaUsuarios.length<2){yield this.cargarUsuarios();return}this.buscandoUsuarios=!0;try{console.log("\u{1F50D} Buscando usuarios:",this.terminoBusquedaUsuarios),this.usuarios=yield this.asignacionService.buscarUsuarios(this.terminoBusquedaUsuarios),console.log("\u2705 Usuarios encontrados:",this.usuarios.length)}catch(t){console.error("\u274C Error buscando usuarios:",t),this.usuarios=[]}finally{this.buscandoUsuarios=!1}})}limpiarBusqueda(){return v(this,null,function*(){this.terminoBusquedaUsuarios="",yield this.cargarUsuarios()})}isUsuarioSelected(t){return this.asignacionForm.usuarios_seleccionados.includes(t)}toggleUsuario(t){let e=this.asignacionForm.usuarios_seleccionados.indexOf(t);e>-1?(this.asignacionForm.usuarios_seleccionados.splice(e,1),console.log("\u2796 Usuario deseleccionado:",t)):(this.asignacionForm.usuarios_seleccionados.push(t),console.log("\u2795 Usuario seleccionado:",t)),console.log("\u{1F465} Total usuarios seleccionados:",this.asignacionForm.usuarios_seleccionados.length)}selectAllUsuarios(){this.asignacionForm.usuarios_seleccionados=this.usuarios.map(t=>t.id),console.log("\u2705 Todos los usuarios seleccionados")}clearAllUsuarios(){this.asignacionForm.usuarios_seleccionados=[],console.log("\u{1F5D1}\uFE0F Selecci\xF3n de usuarios limpiada")}trackByUserId(t,e){return e.id}onPaqueteSeleccionado(t){console.log("\u{1F4E6} Paquete seleccionado ID:",t),this.paqueteSeleccionado=this.paquetes.find(e=>e.id===t)||null,this.paqueteSeleccionado?(console.log("\u2705 Paquete encontrado:",this.paqueteSeleccionado.nombre),this.asignacionForm.descuento_aplicado=this.paqueteSeleccionado.descuento||0,this.calcularPrecioFinal(),console.log("\u{1F4B0} Configuraci\xF3n de precios:"),console.log("- Precio base:",this.paqueteSeleccionado.precio),console.log("- Descuento:",this.asignacionForm.descuento_aplicado,"%"),console.log("- Precio final:",this.precioFinal)):console.warn("\u26A0\uFE0F Paquete no encontrado para ID:",t)}onDescuentoChange(){console.log("\u{1F4B8} Descuento cambiado a:",this.asignacionForm.descuento_aplicado),this.calcularPrecioFinal()}calcularPrecioFinal(){if(!this.paqueteSeleccionado)return;let t=this.paqueteSeleccionado.precio,e=this.asignacionForm.descuento_aplicado||0;this.precioFinal=this.asignacionService.calcularPrecioFinal(t,e),this.descuentoAplicado=t-this.precioFinal,this.asignacionForm.precio_pagado=this.precioFinal,console.log("\u{1F9EE} C\xE1lculo de precio actualizado:"),console.log("- Precio base:",t),console.log("- Descuento:",e,"%"),console.log("- Precio final:",this.precioFinal),console.log("- Ahorro:",this.descuentoAplicado)}onSubmit(){return v(this,null,function*(){if(console.log("\u{1F680} Iniciando proceso de asignaci\xF3n..."),!!this.validarFormulario()){this.cargando=!0,this.limpiarMensajes();try{let t=[],e=0,a=0;console.log("\u{1F4CB} Procesando asignaciones para",this.asignacionForm.usuarios_seleccionados.length,"usuarios");for(let l of this.asignacionForm.usuarios_seleccionados){let c=this.usuarios.find(u=>u.id===l);try{let u={usuario_id:l,paquete_id:this.asignacionForm.paquete_id,fecha_inicio:this.asignacionForm.fecha_inicio,precio_pagado:this.asignacionForm.precio_pagado,descuento_aplicado:this.asignacionForm.descuento_aplicado,metodo_pago:this.asignacionForm.metodo_pago,notas_administrativas:this.asignacionForm.notas_administrativas};this.asignacionForm.terapeuta_asignado&&(u.terapeuta_asignado=this.asignacionForm.terapeuta_asignado),console.log("\u{1F464} Procesando usuario:",c?.nombre,u);let S=yield this.asignacionService.asignarPaqueteAUsuario(u);S.success?(e++,t.push(`\u2705 ${c?.nombre||`Usuario ${l}`}: Asignado exitosamente`),console.log("\u2705 Asignaci\xF3n exitosa para usuario",l)):(a++,t.push(`\u274C ${c?.nombre||`Usuario ${l}`}: ${S.message}`),console.error("\u274C Error en asignaci\xF3n para usuario",l,S.message))}catch(u){a++,t.push(`\u274C ${c?.nombre||`Usuario ${l}`}: Error interno`),console.error("\u274C Error procesando usuario",l,u)}}this.mostrarResumenResultados(e,a,t)}catch(t){console.error("\u274C Error en proceso de asignaci\xF3n:",t),this.mostrarError("Error interno al procesar las asignaciones")}finally{this.cargando=!1}}})}validarFormulario(){return console.log("\u{1F50D} Validando formulario..."),this.asignacionForm.paquete_id?this.asignacionForm.usuarios_seleccionados.length===0?(this.mostrarError("Debe seleccionar al menos un usuario"),!1):this.asignacionForm.fecha_inicio?this.asignacionForm.precio_pagado<=0?(this.mostrarError("El precio debe ser mayor a cero"),!1):(console.log("\u2705 Formulario v\xE1lido"),!0):(this.mostrarError("Debe especificar la fecha de inicio"),!1):(this.mostrarError("Debe seleccionar un paquete"),!1)}mostrarResumenResultados(t,e,a){let l=`
Proceso completado:
\u2022 Asignaciones exitosas: ${t}
\u2022 Con errores: ${e}

Detalles:
${a.join(`
`)}
    `;t>0?(this.mostrarExito(l),e===0&&setTimeout(()=>{this.router.navigate(["/paquetes/asignaciones"])},3e3)):this.mostrarError(l)}reintentarCargaUsuarios(){return v(this,null,function*(){console.log("\u{1F504} Reintentando carga de usuarios..."),this.buscandoUsuarios=!0,this.limpiarMensajes();try{this.usuarios=yield this.asignacionService.obtenerUsuarios(),console.log("\u2705 Usuarios recargados:",this.usuarios.length),this.usuarios.length===0?this.mostrarError("No se encontraron usuarios activos en el sistema"):(this.mostrarExito(`Se cargaron ${this.usuarios.length} usuarios correctamente`),setTimeout(()=>this.limpiarMensajes(),3e3))}catch(t){console.error("\u274C Error en reintento:",t),this.mostrarError("Error al cargar usuarios. Verifica tu conexi\xF3n.")}finally{this.buscandoUsuarios=!1}})}refrescarTodosLosDatos(){return v(this,null,function*(){console.log("\u{1F504} Refrescando todos los datos..."),this.cargando=!0,this.limpiarMensajes();try{yield Promise.all([this.cargarPaquetes(),this.cargarTerapeutas(),this.cargarUsuarios()]),this.mostrarExito("Datos actualizados correctamente"),setTimeout(()=>this.limpiarMensajes(),3e3)}catch(t){console.error("\u274C Error refrescando datos:",t),this.mostrarError("Error al actualizar los datos")}finally{this.cargando=!1}})}volver(){this.router.navigate(["/paquetes"])}irAAsignaciones(){this.router.navigate(["/paquetes/asignaciones"])}obtenerFechaHoy(){return new Date().toISOString().split("T")[0]}formatearPrecio(t){return this.asignacionService.formatearPrecio(t)}mostrarError(t){this.error=t,this.exito=null,console.error("\u{1F6A8} Error:",t)}mostrarExito(t){this.exito=t,this.error=null,console.log("\u2705 \xC9xito:",t)}limpiarMensajes(){this.error=null,this.exito=null}get usuariosSeleccionadosNombres(){return this.asignacionForm.usuarios_seleccionados.map(t=>this.usuarios.find(a=>a.id===t)?.nombre||`Usuario ${t}`)}get resumenAsignacion(){if(!this.paqueteSeleccionado||this.asignacionForm.usuarios_seleccionados.length===0)return null;let t=this.asignacionForm.usuarios_seleccionados.length,e=this.precioFinal*t,a=this.descuentoAplicado*t;return{paquete:this.paqueteSeleccionado.nombre,tipo:this.paqueteSeleccionado.tipo,sesiones:this.paqueteSeleccionado.cantidad_sesiones,usuarios_count:t,usuarios_nombres:this.usuariosSeleccionadosNombres,precio_base:this.paqueteSeleccionado.precio,descuento:this.asignacionForm.descuento_aplicado||0,precio_final:this.precioFinal,precio_total:e,ahorro_por_usuario:this.descuentoAplicado,ahorro_total:a,fecha_inicio:this.asignacionForm.fecha_inicio}}get mostrarResumen(){let t={tieneUsuarios:this.asignacionForm.usuarios_seleccionados.length>0,tienePaquete:!!this.paqueteSeleccionado,tieneFecha:!!this.asignacionForm.fecha_inicio,tienePrecio:this.asignacionForm.precio_pagado>0},e=Object.values(t).every(Boolean);return console.log("\u{1F3AF} Validaci\xF3n mostrarResumen:",D(V({},t),{resultado:e})),e}debugFormulario(){console.log("\u{1F41B} DEBUG - Estado del formulario:"),console.log("- Paquete seleccionado:",this.paqueteSeleccionado?.nombre),console.log("- Usuarios seleccionados:",this.asignacionForm.usuarios_seleccionados.length),console.log("- Formulario completo:",this.asignacionForm),console.log("- Mostrar resumen:",this.mostrarResumen),console.log("- Resumen:",this.resumenAsignacion)}debugAsignacionCompleta(){return v(this,null,function*(){console.log("\u{1F41B} DEBUGGING COMPLETO DE ASIGNACI\xD3N"),console.log("====================================="),console.log("\u{1F4CB} Estado del formulario:"),console.log("- Paquete ID:",this.asignacionForm.paquete_id),console.log("- Usuarios seleccionados:",this.asignacionForm.usuarios_seleccionados),console.log("- Fecha inicio:",this.asignacionForm.fecha_inicio),console.log("- Precio:",this.asignacionForm.precio_pagado),console.log("- Formulario completo:",this.asignacionForm),console.log("\u{1F4E6} Datos del paquete seleccionado:"),console.log("- Paquete:",this.paqueteSeleccionado),console.log("\u{1F465} Usuarios disponibles:"),console.log("- Total usuarios cargados:",this.usuarios.length),console.log("- Usuarios:",this.usuarios.slice(0,3)),console.log("\u{1F50D} Validando usuarios seleccionados:");for(let t of this.asignacionForm.usuarios_seleccionados){let e=this.usuarios.find(a=>a.id===t);console.log(`- Usuario ${t}: ${e?e.nombre:"NO ENCONTRADO"}`)}if(this.asignacionForm.paquete_id&&this.asignacionForm.usuarios_seleccionados.length>0){console.log("\u{1F9EA} Probando asignaci\xF3n individual...");let t={usuario_id:this.asignacionForm.usuarios_seleccionados[0],paquete_id:this.asignacionForm.paquete_id,fecha_inicio:this.asignacionForm.fecha_inicio,precio_pagado:this.asignacionForm.precio_pagado,descuento_aplicado:this.asignacionForm.descuento_aplicado,metodo_pago:this.asignacionForm.metodo_pago,notas_administrativas:this.asignacionForm.notas_administrativas};this.asignacionForm.terapeuta_asignado&&(t.terapeuta_asignado=this.asignacionForm.terapeuta_asignado),console.log("\u{1F4E4} Datos de prueba:",t);try{let e=yield this.asignacionService.asignarPaqueteAUsuario(t);console.log("\u{1F4E5} Resultado de prueba:",e),e.success?this.mostrarExito(`Prueba exitosa: ${e.message}`):this.mostrarError(`Prueba fall\xF3: ${e.message}`)}catch(e){console.error("\u{1F4A5} Error en prueba:",e),this.mostrarError(`Error en prueba: ${e}`)}}console.log("=====================================")})}static \u0275fac=function(e){return new(e||r)(q(U),q(ee),q(ae),q(Q))};static \u0275cmp=j({type:r,selectors:[["app-asignar-paquete"]],standalone:!1,decls:139,vars:46,consts:[[1,"container","mx-auto","px-4","py-6"],[1,"mb-6"],[1,"flex","items-center","gap-2","text-sm","text-gray-500","mb-2"],["routerLink","/paquetes",1,"hover:text-blue-600"],[1,"flex","justify-between","items-start"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],[1,"flex","space-x-3"],[1,"bg-gray-500","hover:bg-gray-600","text-white","px-4","py-2","rounded-lg","transition-colors",3,"click"],["class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",4,"ngIf"],["class","bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2","space-y-6"],[1,"bg-white","rounded-lg","shadow-sm","border","p-6"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","change","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["class","mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200",4,"ngIf"],[1,"mb-4"],["type","text","placeholder","Escribe nombre o email...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","input","ngModel"],["class","mt-2 text-sm text-gray-500",4,"ngIf"],[1,"flex","justify-between","items-center","mb-3"],[1,"block","text-sm","font-medium","text-gray-700"],[1,"text-gray-500"],[1,"flex","space-x-2"],["type","button",1,"text-xs","text-blue-600","hover:text-blue-800",3,"click"],["type","button",1,"text-xs","text-gray-600","hover:text-gray-800",3,"click"],[1,"border","border-gray-300","rounded-md","p-3","max-h-64","overflow-y-auto"],["class","text-center py-4 text-gray-500",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-2"],["class","flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer",3,"bg-blue-50",4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["type","date",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],[1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["type","number","min","0","max","100","step","0.01","placeholder","0.00",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","input","ngModel"],["type","number","min","0","step","0.01","readonly","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],[1,"md:col-span-2"],["rows","3","placeholder","Notas internas sobre esta asignaci\xF3n...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],[1,"lg:col-span-1"],[1,"sticky","top-6"],["class","bg-white rounded-lg shadow-sm border p-6",4,"ngIf"],[1,"bg-blue-50","rounded-lg","border","border-blue-200","p-4","mt-6"],[1,"font-medium","text-blue-900","mb-2"],[1,"text-sm","text-blue-800","space-y-1"],[1,"flex","flex-col","space-y-4","pt-6","border-t","mt-6"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"text-sm","font-medium","text-gray-700","mb-2"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"flex","items-center"],[1,"mr-2"],[1,"mt-3","pt-3","border-t","border-gray-200"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium"],[1,"text-sm","font-bold"],[1,"flex","justify-end","space-x-4"],["type","button",1,"px-6","py-2","border","border-gray-300","text-gray-700","rounded-lg","hover:bg-gray-50","transition-colors",3,"click"],["type","button",1,"px-6","py-2","text-white","rounded-lg","transition-colors","disabled:opacity-50","flex","items-center",3,"click","disabled"],["class","animate-spin -ml-1 mr-3 h-5 w-5 text-white","fill","none","viewBox","0 0 24 24",4,"ngIf"],["class","text-gray-300",4,"ngIf"],[4,"ngIf"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg","mb-6"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","mr-2"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"whitespace-pre-wrap"],[1,"bg-green-50","border","border-green-200","text-green-700","px-4","py-3","rounded-lg","mb-6"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],[1,"mt-4","p-4","bg-blue-50","rounded-lg","border","border-blue-200"],[1,"text-blue-700"],[1,"ml-1"],["class","text-blue-800 mt-2",4,"ngIf"],[1,"text-blue-800","mt-2"],[1,"mt-2","text-sm","text-gray-500"],[1,"text-center","py-4","text-gray-500"],[1,"flex","items-center","p-2","hover:bg-gray-50","rounded","cursor-pointer"],["type","checkbox",1,"h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300","rounded",3,"change","checked"],[1,"ml-3","min-w-0","flex-1"],[1,"text-sm","font-medium","text-gray-900","truncate"],[1,"text-xs","text-gray-500","truncate"],["class","text-xs text-gray-500",4,"ngIf"],[1,"text-xs","text-gray-500"],[1,"space-y-3"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],[1,"font-medium","capitalize"],[1,"my-3"],[1,"mb-3"],[1,"text-sm","font-medium","text-gray-700"],[1,"mt-1","max-h-32","overflow-y-auto"],["class","text-sm text-gray-600 py-1 px-2 bg-gray-50 rounded mb-1",4,"ngFor","ngForOf"],[1,"space-y-2"],["class","flex justify-between text-green-600",4,"ngIf"],[1,"flex","justify-between","font-medium"],[1,"my-2"],[1,"flex","justify-between","text-lg","font-bold","text-gray-900","pt-2","border-t"],[1,"text-blue-600"],["class","flex justify-between text-sm text-green-600",4,"ngIf"],[1,"text-sm","text-gray-600","py-1","px-2","bg-gray-50","rounded","mb-1"],[1,"flex","justify-between","text-green-600"],[1,"flex","justify-between","text-sm","text-green-600"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-gray-300"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),o(4,"Paquetes"),n(),i(5,"span"),o(6,"/"),n(),i(7,"span"),o(8,"Asignar a Usuarios"),n()(),i(9,"div",4)(10,"div")(11,"h1",5),o(12,"Asignar Paquete a Usuarios"),n(),i(13,"p",6),o(14,"Asigna un paquete a m\xFAltiples usuarios y genera el seguimiento autom\xE1tico"),n()(),i(15,"div",7)(16,"button",8),g("click",function(){return a.volver()}),o(17," Cancelar "),n()()()(),f(18,hi,6,1,"div",9)(19,yi,6,1,"div",10),i(20,"div",11)(21,"div",12)(22,"div",13)(23,"h3",14),o(24,"1. Seleccionar Paquete"),n(),i(25,"div")(26,"label",15),o(27," Paquete * "),n(),i(28,"select",16),k("ngModelChange",function(c){return M(a.asignacionForm.paquete_id,c)||(a.asignacionForm.paquete_id=c),c}),g("change",function(){return a.onPaqueteSeleccionado(a.asignacionForm.paquete_id)}),i(29,"option",17),o(30,"Seleccionar paquete..."),n(),f(31,wi,3,7,"option",18),n()(),f(32,Si,21,6,"div",19),n(),i(33,"div",13)(34,"h3",14),o(35,"2. Seleccionar Usuarios"),n(),i(36,"div",20)(37,"label",15),o(38," Buscar Usuarios "),n(),i(39,"input",21),k("ngModelChange",function(c){return M(a.terminoBusquedaUsuarios,c)||(a.terminoBusquedaUsuarios=c),c}),g("input",function(){return a.buscarUsuarios()}),n(),f(40,qi,2,0,"div",22),n(),i(41,"div",23)(42,"label",24),o(43," Usuarios * "),i(44,"span",25),o(45),n()(),i(46,"div",26)(47,"button",27),g("click",function(){return a.selectAllUsuarios()}),o(48," Seleccionar todos "),n(),i(49,"button",28),g("click",function(){return a.clearAllUsuarios()}),o(50," Limpiar selecci\xF3n "),n()()(),i(51,"div",29),f(52,Ei,3,0,"div",30),i(53,"div",31),f(54,ki,8,6,"label",32),n()()(),i(55,"div",13)(56,"h3",14),o(57,"3. Configuraci\xF3n de la Asignaci\xF3n"),n(),i(58,"div",33)(59,"div")(60,"label",15),o(61," Fecha de Inicio * "),n(),i(62,"input",34),k("ngModelChange",function(c){return M(a.asignacionForm.fecha_inicio,c)||(a.asignacionForm.fecha_inicio=c),c}),n()(),i(63,"div")(64,"label",15),o(65," M\xE9todo de Pago * "),n(),i(66,"select",35),k("ngModelChange",function(c){return M(a.asignacionForm.metodo_pago,c)||(a.asignacionForm.metodo_pago=c),c}),f(67,Ii,2,2,"option",18),n()(),i(68,"div")(69,"label",15),o(70," Descuento Adicional (%) "),n(),i(71,"input",36),k("ngModelChange",function(c){return M(a.asignacionForm.descuento_aplicado,c)||(a.asignacionForm.descuento_aplicado=c),c}),g("input",function(){return a.onDescuentoChange()}),n()(),i(72,"div")(73,"label",15),o(74," Precio por Usuario * "),n(),i(75,"input",37),k("ngModelChange",function(c){return M(a.asignacionForm.precio_pagado,c)||(a.asignacionForm.precio_pagado=c),c}),n()(),i(76,"div",38)(77,"label",15),o(78," Terapeuta Asignado (Opcional) "),n(),i(79,"select",35),k("ngModelChange",function(c){return M(a.asignacionForm.terapeuta_asignado,c)||(a.asignacionForm.terapeuta_asignado=c),c}),i(80,"option",17),o(81,"Sin terapeuta asignado"),n(),f(82,Oi,2,3,"option",18),n()(),i(83,"div",38)(84,"label",15),o(85," Notas Administrativas "),n(),i(86,"textarea",39),k("ngModelChange",function(c){return M(a.asignacionForm.notas_administrativas,c)||(a.asignacionForm.notas_administrativas=c),c}),n()()()()(),i(87,"div",40)(88,"div",41),f(89,Vi,56,14,"div",42),i(90,"div",43)(91,"h4",44),o(92,"\u2139\uFE0F Informaci\xF3n Importante"),n(),i(93,"ul",45)(94,"li"),o(95,"\u2022 Se crear\xE1 autom\xE1ticamente el seguimiento para cada usuario"),n(),i(96,"li"),o(97,"\u2022 Las sesiones se programar\xE1n seg\xFAn el tipo de paquete"),n(),i(98,"li"),o(99,"\u2022 Cada usuario podr\xE1 ver su progreso individual"),n(),i(100,"li"),o(101,"\u2022 Se notificar\xE1 al terapeuta asignado (si aplica)"),n(),i(102,"li"),o(103,"\u2022 El precio se aplicar\xE1 por separado a cada usuario"),n()()()()()(),i(104,"div",46)(105,"div",47)(106,"h4",48),o(107,"Estado del Formulario:"),n(),i(108,"div",49)(109,"div",50)(110,"span",51),o(111),n(),o(112," Paquete seleccionado "),n(),i(113,"div",50)(114,"span",51),o(115),n(),o(116),n(),i(117,"div",50)(118,"span",51),o(119),n(),o(120," Fecha de inicio "),n(),i(121,"div",50)(122,"span",51),o(123),n(),o(124),n()(),i(125,"div",52)(126,"div",53)(127,"span",54),o(128,"Estado general:"),n(),i(129,"span",55),o(130),n()()()(),i(131,"div",56)(132,"button",57),g("click",function(){return a.volver()}),o(133," Cancelar "),n(),i(134,"button",58),g("click",function(){return a.onSubmit()}),f(135,Di,3,0,"svg",59)(136,ji,2,0,"span",60)(137,Li,2,2,"span",61)(138,zi,2,0,"span",61),n()()()()),e&2&&(s(18),d("ngIf",a.error),s(),d("ngIf",a.exito),s(9),E("ngModel",a.asignacionForm.paquete_id),s(),d("value",null),s(2),d("ngForOf",a.paquetes),s(),d("ngIf",a.paqueteSeleccionado),s(7),E("ngModel",a.terminoBusquedaUsuarios),s(),d("ngIf",a.buscandoUsuarios),s(5),m("(",a.asignacionForm.usuarios_seleccionados.length," seleccionados)"),s(7),d("ngIf",a.usuarios.length===0&&!a.buscandoUsuarios),s(2),d("ngForOf",a.usuarios)("ngForTrackBy",a.trackByUserId),s(8),E("ngModel",a.asignacionForm.fecha_inicio),s(4),E("ngModel",a.asignacionForm.metodo_pago),s(),d("ngForOf",a.metodosPago),s(4),E("ngModel",a.asignacionForm.descuento_aplicado),s(4),E("ngModel",a.asignacionForm.precio_pagado),s(4),E("ngModel",a.asignacionForm.terapeuta_asignado),s(),d("value",null),s(2),d("ngForOf",a.terapeutas),s(4),E("ngModel",a.asignacionForm.notas_administrativas),s(3),d("ngIf",a.mostrarResumen),s(21),P(a.paqueteSeleccionado?"text-green-600":"text-red-600"),s(),m(" ",a.paqueteSeleccionado?"\u2705":"\u274C"," "),s(3),P(a.asignacionForm.usuarios_seleccionados.length>0?"text-green-600":"text-red-600"),s(),m(" ",a.asignacionForm.usuarios_seleccionados.length>0?"\u2705":"\u274C"," "),s(),m(" Usuarios seleccionados (",a.asignacionForm.usuarios_seleccionados.length,") "),s(2),P(a.asignacionForm.fecha_inicio?"text-green-600":"text-red-600"),s(),m(" ",a.asignacionForm.fecha_inicio?"\u2705":"\u274C"," "),s(3),P(a.asignacionForm.precio_pagado>0?"text-green-600":"text-red-600"),s(),m(" ",a.asignacionForm.precio_pagado>0?"\u2705":"\u274C"," "),s(),m(" Precio v\xE1lido (",a.formatearPrecio(a.asignacionForm.precio_pagado),") "),s(5),P(a.mostrarResumen?"text-green-600":"text-red-600"),s(),m(" ",a.mostrarResumen?"\u2705 Listo para asignar":"\u274C Faltan campos"," "),s(4),P(!a.mostrarResumen||a.cargando?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 cursor-pointer"),d("disabled",!a.mostrarResumen||a.cargando),s(),d("ngIf",a.cargando),s(),d("ngIf",!a.cargando&&!a.mostrarResumen),s(),d("ngIf",!a.cargando&&a.mostrarResumen),s(),d("ngIf",a.cargando))},dependencies:[B,z,H,W,K,xe,G,$,ye,he,Z,ne,N,Ue],encapsulation:2})};function Ui(r,t){if(r&1&&(i(0,"option",46),o(1),n()),r&2){let e=t.$implicit;d("value",e.value),s(),m(" ",e.label," ")}}function Ri(r,t){r&1&&(i(0,"div",47),_(1,"div",48),n())}function Bi(r,t){if(r&1){let e=C();i(0,"div",49)(1,"div",50)(2,"div",13),b(),i(3,"svg",51),_(4,"path",52),n()(),w(),i(5,"div",17)(6,"h3",53),o(7,"Error"),n(),i(8,"div",54),o(9),n(),i(10,"div",55)(11,"button",56),g("click",function(){x(e);let l=p();return h(l.limpiarError())}),o(12," Cerrar "),n()()()()()}if(r&2){let e=p();s(9),m(" ",e.error," ")}}function Ni(r,t){if(r&1){let e=C();i(0,"div",61),b(),i(1,"svg",62),_(2,"path",16),n(),w(),i(3,"h3",63),o(4,"No hay asignaciones"),n(),i(5,"p",64),o(6),n(),i(7,"div",65)(8,"button",66),g("click",function(){x(e);let l=p(2);return h(l.nuevaAsignacion())}),b(),i(9,"svg",67),_(10,"path",9),n(),o(11," Nueva Asignaci\xF3n "),n()()()}if(r&2){let e=p(2);s(6),m(" ",e.terminoBusqueda||e.filtros.estado?"No se encontraron asignaciones con los filtros aplicados.":"Comienza asignando un paquete a un usuario."," ")}}function $i(r,t){if(r&1){let e=C();i(0,"button",101),g("click",function(){x(e);let l=p().$implicit,c=p(3);return h(c.toggleEstadoMenu(l.id))}),b(),i(1,"svg",42),_(2,"path",102),n()()}}function Gi(r,t){if(r&1){let e=C();i(0,"button",105),g("click",function(){let l=x(e).$implicit,c=p(2).$implicit,u=p(3);return h(u.cambiarEstado(c,l.value))}),o(1),n()}if(r&2){let e=t.$implicit,a=p(2).$implicit;d("disabled",e.value===a.estado),s(),m(" ",e.label," ")}}function Hi(r,t){if(r&1&&(i(0,"div",103),f(1,Gi,2,2,"button",104),n()),r&2){let e=p(4);s(),d("ngForOf",e.estadosDisponibles.slice(1))}}function Wi(r,t){if(r&1&&(i(0,"div"),o(1),n()),r&2){let e=p().$implicit,a=p(3);P(a.calcularDiasRestantes(e.fecha_fin)<=7?"text-red-600 font-medium":"text-gray-500"),s(),m(" ",a.calcularDiasRestantes(e.fecha_fin)," d\xEDas restantes ")}}function Yi(r,t){if(r&1){let e=C();i(0,"tr",75)(1,"td",76)(2,"div",12)(3,"div",77)(4,"div",78),b(),i(5,"svg",79),_(6,"path",80),n()()(),w(),i(7,"div",81)(8,"div",18),o(9),n(),i(10,"div",82),o(11),n()()()(),i(12,"td",76)(13,"div")(14,"div",83)(15,"span"),o(16),n(),o(17),n(),i(18,"div",82),o(19),n()()(),i(20,"td",76)(21,"div",84)(22,"span"),o(23),n(),f(24,$i,3,0,"button",85)(25,Hi,2,1,"div",86),n()(),i(26,"td",76)(27,"div")(28,"div",87)(29,"span",88),o(30),n(),i(31,"span",18),o(32),n()(),i(33,"div",89),_(34,"div"),n()()(),i(35,"td",90)(36,"div")(37,"div",91),o(38),n(),i(39,"div",92),o(40),n(),f(41,Wi,2,3,"div",93),n()(),i(42,"td",94)(43,"div",95)(44,"button",96),g("click",function(){let l=x(e).$implicit,c=p(3);return h(c.verDetalle(l.id))}),b(),i(45,"svg",42),_(46,"path",97)(47,"path",98),n()(),w(),i(48,"button",99),g("click",function(){let l=x(e).$implicit,c=p(3);return h(c.verSeguimiento(l.id))}),b(),i(49,"svg",42),_(50,"path",100),n()()()()()}if(r&2){let e=t.$implicit,a=p(3);s(9),y((e.usuario==null?null:e.usuario.nombre)||"Sin nombre"),s(2),y((e.usuario==null?null:e.usuario.email)||"Sin email"),s(5),y(a.obtenerIconoTipo((e.paquete==null?null:e.paquete.tipo)||"")),s(),m(" ",(e.paquete==null?null:e.paquete.nombre)||"Sin nombre"," "),s(2),m(" ",a.formatearPrecio(e.precio_pagado)," "),s(3),P("inline-flex px-2 py-1 text-xs font-semibold rounded-full "+a.obtenerClaseEstado(e.estado)),s(),m(" ",a.obtenerTextoEstado(e.estado)," "),s(),d("ngIf",e.estado!=="completado"&&e.estado!=="cancelado"),s(),d("ngIf",a.mostrandoMenuEstado===e.id),s(5),I("",e.sesiones_utilizadas,"/",e.sesiones_totales,""),s(2),m("",a.calcularProgreso(e),"%"),s(2),P("h-2 rounded-full "+a.obtenerClaseProgreso(a.calcularProgreso(e))),De("width",a.calcularProgreso(e),"%"),s(4),m("Inicio: ",a.formatearFecha(e.fecha_inicio),""),s(2),m("Fin: ",a.formatearFecha(e.fecha_fin),""),s(),d("ngIf",a.calcularDiasRestantes(e.fecha_fin)>=0)}}function Qi(r,t){if(r&1&&(i(0,"div",68)(1,"table",69)(2,"thead",70)(3,"tr")(4,"th",71),o(5," Usuario "),n(),i(6,"th",71),o(7," Paquete "),n(),i(8,"th",71),o(9," Estado "),n(),i(10,"th",71),o(11," Progreso "),n(),i(12,"th",71),o(13," Fechas "),n(),i(14,"th",72),o(15," Acciones "),n()()(),i(16,"tbody",73),f(17,Yi,51,20,"tr",74),n()()()),r&2){let e=p(2);s(17),d("ngForOf",e.asignacionesPaginadas)}}function Ji(r,t){if(r&1){let e=C();i(0,"button",120),g("click",function(){let l=x(e).$implicit,c=p(3);return h(c.irAPagina(l))}),o(1),n()}if(r&2){let e=t.$implicit,a=p(3);P(e===a.paginaActual?"relative inline-flex items-center px-4 py-2 border border-blue-500 bg-blue-50 text-sm font-medium text-blue-600":"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"),s(),m(" ",e," ")}}function Xi(r,t){if(r&1){let e=C();i(0,"div",106)(1,"div",107)(2,"div",108)(3,"button",109),g("click",function(){x(e);let l=p(2);return h(l.irAPagina(l.paginaActual-1))}),o(4," Anterior "),n(),i(5,"button",110),g("click",function(){x(e);let l=p(2);return h(l.irAPagina(l.paginaActual+1))}),o(6," Siguiente "),n()(),i(7,"div",111)(8,"div")(9,"p",112),o(10," Mostrando "),i(11,"span",91),o(12),n(),o(13," a "),i(14,"span",91),o(15),n(),o(16," de "),i(17,"span",91),o(18),n(),o(19," resultados "),n()(),i(20,"div")(21,"nav",113)(22,"button",114),g("click",function(){x(e);let l=p(2);return h(l.irAPagina(l.paginaActual-1))}),b(),i(23,"svg",115),_(24,"path",116),n()(),f(25,Ji,2,3,"button",117),w(),i(26,"button",118),g("click",function(){x(e);let l=p(2);return h(l.irAPagina(l.paginaActual+1))}),b(),i(27,"svg",115),_(28,"path",119),n()()()()()()()}if(r&2){let e=p(2);s(3),d("disabled",e.paginaActual===1),s(2),d("disabled",e.paginaActual===e.totalPaginas),s(7),y(e.Math.min((e.paginaActual-1)*e.itemsPorPagina+1,e.asignacionesFiltradas.length)),s(3),y(e.Math.min(e.paginaActual*e.itemsPorPagina,e.asignacionesFiltradas.length)),s(3),y(e.asignacionesFiltradas.length),s(4),d("disabled",e.paginaActual===1),s(3),d("ngForOf",e.paginasArray),s(),d("disabled",e.paginaActual===e.totalPaginas)}}function Ki(r,t){if(r&1&&(i(0,"div",57),f(1,Ni,12,1,"div",58)(2,Qi,18,1,"div",59)(3,Xi,29,8,"div",60),n()),r&2){let e=p();s(),d("ngIf",e.asignacionesFiltradas.length===0),s(),d("ngIf",e.asignacionesFiltradas.length>0),s(),d("ngIf",e.asignacionesFiltradas.length>0)}}var me=class r{constructor(t,e,a){this.asignacionService=t;this.router=e;this.route=a}asignaciones=[];asignacionesFiltradas=[];cargando=!1;error=null;filtros={};terminoBusqueda="";estadosDisponibles=[{value:"",label:"Todos los estados"},{value:"activo",label:"Activos"},{value:"pausado",label:"Pausados"},{value:"completado",label:"Completados"},{value:"cancelado",label:"Cancelados"}];paginaActual=1;itemsPorPagina=10;totalPaginas=0;estadisticas={total:0,activos:0,completados:0,pausados:0,cancelados:0};ngOnInit(){this.verificarParametrosURL(),this.cargarAsignaciones(),this.cargarEstadisticas()}verificarParametrosURL(){let t=this.route.snapshot.queryParams.paquete_id,e=this.route.snapshot.queryParams.usuario_id,a=this.route.snapshot.queryParams.estado;t&&(this.filtros.paquete_id=parseInt(t)),e&&(this.filtros.usuario_id=parseInt(e)),a&&(this.filtros.estado=a)}cargarAsignaciones(){return v(this,null,function*(){this.cargando=!0,this.error=null;try{this.asignaciones=yield this.asignacionService.obtenerAsignaciones(this.filtros),this.aplicarFiltrosYPaginacion()}catch(t){console.error("Error cargando asignaciones:",t),this.error="Error al cargar las asignaciones. Por favor, intenta de nuevo."}finally{this.cargando=!1}})}cargarEstadisticas(){return v(this,null,function*(){})}aplicarFiltrosYPaginacion(){let t=[...this.asignaciones];if(this.terminoBusqueda){let e=this.terminoBusqueda.toLowerCase();t=t.filter(a=>a.usuario?.nombre.toLowerCase().includes(e)||a.usuario?.email.toLowerCase().includes(e)||a.paquete?.nombre.toLowerCase().includes(e))}this.asignacionesFiltradas=t,this.calcularPaginacion()}onFiltroChange(){this.paginaActual=1,this.cargarAsignaciones()}onBusquedaChange(){this.paginaActual=1,this.aplicarFiltrosYPaginacion()}limpiarFiltros(){this.filtros={},this.terminoBusqueda="",this.cargarAsignaciones()}calcularPaginacion(){this.totalPaginas=Math.ceil(this.asignacionesFiltradas.length/this.itemsPorPagina)}get asignacionesPaginadas(){let t=(this.paginaActual-1)*this.itemsPorPagina,e=t+this.itemsPorPagina;return this.asignacionesFiltradas.slice(t,e)}irAPagina(t){t>=1&&t<=this.totalPaginas&&(this.paginaActual=t)}get paginasArray(){return Array.from({length:this.totalPaginas},(t,e)=>e+1)}verDetalle(t){this.router.navigate(["/paquetes/asignaciones/detalle",t])}verSeguimiento(t){this.router.navigate(["/paquetes/seguimiento",t])}nuevaAsignacion(){this.router.navigate(["/paquetes/asignar"])}cambiarEstado(t,e){return v(this,null,function*(){this.cargando=!0;try{let a=yield this.asignacionService.actualizarEstadoAsignacion(t.id,e);a.success?(this.mostrarMensajeExito(`Estado cambiado a ${e} exitosamente`),yield this.cargarAsignaciones(),yield this.cargarEstadisticas()):this.mostrarMensajeError(a.message)}catch(a){console.error("Error cambiando estado:",a),this.mostrarMensajeError("Error al cambiar el estado")}finally{this.cargando=!1}})}formatearPrecio(t){return this.asignacionService.formatearPrecio(t)}formatearFecha(t){return new Date(t).toLocaleDateString("es-GT")}calcularProgreso(t){return t.sesiones_totales===0?0:Math.round(t.sesiones_utilizadas/t.sesiones_totales*100)}calcularDiasRestantes(t){return this.asignacionService.calcularDiasRestantes(t)}obtenerTextoEstado(t){return this.asignacionService.obtenerEstadoTexto(t)}obtenerClaseEstado(t){return this.asignacionService.obtenerClaseEstado(t)}obtenerClaseProgreso(t){return t>=80?"bg-green-500":t>=50?"bg-yellow-500":t>=20?"bg-orange-500":"bg-red-500"}obtenerIconoTipo(t){return t==="terapia"?"\u{1F3E5}":"\u{1F4AA}"}exportarAsignaciones(){let t=this.asignacionesFiltradas.map(l=>({usuario:l.usuario?.nombre,email:l.usuario?.email,paquete:l.paquete?.nombre,tipo:l.paquete?.tipo,estado:l.estado,fecha_inicio:l.fecha_inicio,fecha_fin:l.fecha_fin,sesiones_utilizadas:l.sesiones_utilizadas,sesiones_totales:l.sesiones_totales,progreso:this.calcularProgreso(l)+"%",precio_pagado:l.precio_pagado,terapeuta:l.terapeuta?.nombre||"Sin asignar"})),e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t,null,2)),a=document.createElement("a");a.setAttribute("href",e),a.setAttribute("download",`asignaciones_paquetes_${new Date().toISOString().split("T")[0]}.json`),document.body.appendChild(a),a.click(),a.remove(),this.mostrarMensajeExito("Asignaciones exportadas exitosamente")}mostrandoMenuEstado=null;toggleEstadoMenu(t){this.mostrandoMenuEstado=this.mostrandoMenuEstado===t?null:t}ngAfterViewInit(){document.addEventListener("click",t=>{this.mostrandoMenuEstado!==null&&(t.target.closest(".relative")||(this.mostrandoMenuEstado=null))})}Math=Math;mostrarMensajeExito(t){console.log("\xC9xito:",t)}mostrarMensajeError(t){console.error("Error:",t),this.error=t}limpiarError(){this.error=null}static \u0275fac=function(e){return new(e||r)(q(ae),q(U),q(ee))};static \u0275cmp=j({type:r,selectors:[["app-asignaciones-lista"]],standalone:!1,decls:99,vars:13,consts:[[1,"container","mx-auto","px-4","py-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],[1,"flex","space-x-3"],[1,"bg-green-600","hover:bg-green-700","text-white","px-4","py-2","rounded-lg","flex","items-center","gap-2","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded-lg","flex","items-center","gap-2","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4","mb-6"],[1,"bg-white","p-4","rounded-lg","shadow-sm","border"],[1,"flex","items-center"],[1,"flex-shrink-0"],[1,"w-8","h-8","bg-blue-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"ml-3"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-lg","font-bold","text-blue-600"],[1,"w-8","h-8","bg-green-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-lg","font-bold","text-green-600"],[1,"w-8","h-8","bg-yellow-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-yellow-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-lg","font-bold","text-yellow-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"w-8","h-8","bg-red-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"text-lg","font-bold","text-red-600"],[1,"bg-white","p-4","rounded-lg","shadow-sm","border","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","placeholder","Usuario, email o paquete...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","input","ngModel"],[1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["type","date",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","change","ngModel"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-gray-600","hover:text-gray-900","flex","items-center","gap-1",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["class","flex justify-center items-center py-12",4,"ngIf"],["class","bg-red-50 border border-red-200 rounded-lg p-4 mb-6",4,"ngIf"],["class","bg-white rounded-lg shadow-sm border overflow-hidden",4,"ngIf"],[3,"value"],[1,"flex","justify-center","items-center","py-12"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-sm","font-medium","text-red-800"],[1,"mt-1","text-sm","text-red-700"],[1,"mt-2"],[1,"text-sm","bg-red-100","text-red-800","px-2","py-1","rounded","hover:bg-red-200",3,"click"],[1,"bg-white","rounded-lg","shadow-sm","border","overflow-hidden"],["class","text-center py-12",4,"ngIf"],["class","overflow-x-auto",4,"ngIf"],["class","bg-white px-4 py-3 border-t border-gray-200 sm:px-6",4,"ngIf"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"px-6","py-3","text-right","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","whitespace-nowrap"],[1,"flex-shrink-0","h-10","w-10"],[1,"h-10","w-10","rounded-full","bg-gray-200","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[1,"ml-4"],[1,"text-sm","text-gray-500"],[1,"text-sm","font-medium","text-gray-900","flex","items-center","gap-2"],[1,"relative"],["class","ml-2 text-gray-400 hover:text-gray-600",3,"click",4,"ngIf"],["class","absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-10 min-w-32",4,"ngIf"],[1,"flex","items-center","justify-between","mb-1"],[1,"text-sm","text-gray-600"],[1,"w-full","bg-gray-200","rounded-full","h-2"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"font-medium"],[1,"text-gray-500"],[3,"class",4,"ngIf"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","items-center","justify-end","space-x-2"],["title","Ver detalles",1,"text-blue-600","hover:text-blue-900",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Ver seguimiento",1,"text-green-600","hover:text-green-900",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"ml-2","text-gray-400","hover:text-gray-600",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"absolute","top-full","left-0","mt-1","bg-white","border","border-gray-200","rounded-md","shadow-lg","z-10","min-w-32"],["class","block w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",3,"disabled","click",4,"ngFor","ngForOf"],[1,"block","w-full","text-left","px-3","py-2","text-sm","text-gray-700","hover:bg-gray-100","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"bg-white","px-4","py-3","border-t","border-gray-200","sm:px-6"],[1,"flex","items-center","justify-between"],[1,"flex-1","flex","justify-between","sm:hidden"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"ml-3","relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"hidden","sm:flex-1","sm:flex","sm:items-center","sm:justify-between"],[1,"text-sm","text-gray-700"],["aria-label","Paginaci\xF3n",1,"relative","z-0","inline-flex","rounded-md","shadow-sm","-space-x-px"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-l-md","border","border-gray-300","bg-white","text-sm","font-medium","text-gray-500","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[3,"class","click",4,"ngFor","ngForOf"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-r-md","border","border-gray-300","bg-white","text-sm","font-medium","text-gray-500","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[3,"click"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),o(4,"Asignaciones de Paquetes"),n(),i(5,"p",3),o(6,"Gestiona las asignaciones de paquetes a usuarios"),n()(),i(7,"div",4)(8,"button",5),g("click",function(){return a.exportarAsignaciones()}),b(),i(9,"svg",6),_(10,"path",7),n(),o(11," Exportar "),n(),w(),i(12,"button",8),g("click",function(){return a.nuevaAsignacion()}),b(),i(13,"svg",6),_(14,"path",9),n(),o(15," Nueva Asignaci\xF3n "),n()()(),w(),i(16,"div",10)(17,"div",11)(18,"div",12)(19,"div",13)(20,"div",14),b(),i(21,"svg",15),_(22,"path",16),n()()(),w(),i(23,"div",17)(24,"p",18),o(25,"Total"),n(),i(26,"p",19),o(27),n()()()(),i(28,"div",11)(29,"div",12)(30,"div",13)(31,"div",20),b(),i(32,"svg",21),_(33,"path",22),n()()(),w(),i(34,"div",17)(35,"p",18),o(36,"Activos"),n(),i(37,"p",23),o(38),n()()()(),i(39,"div",11)(40,"div",12)(41,"div",13)(42,"div",24),b(),i(43,"svg",25),_(44,"path",26),n()()(),w(),i(45,"div",17)(46,"p",18),o(47,"Pausados"),n(),i(48,"p",27),o(49),n()()()(),i(50,"div",11)(51,"div",12)(52,"div",13)(53,"div",14),b(),i(54,"svg",15),_(55,"path",28),n()()(),w(),i(56,"div",17)(57,"p",18),o(58,"Completados"),n(),i(59,"p",19),o(60),n()()()(),i(61,"div",11)(62,"div",12)(63,"div",13)(64,"div",29),b(),i(65,"svg",30),_(66,"path",31),n()()(),w(),i(67,"div",17)(68,"p",18),o(69,"Cancelados"),n(),i(70,"p",32),o(71),n()()()()(),i(72,"div",33)(73,"div",34)(74,"div")(75,"label",35),o(76,"Buscar"),n(),i(77,"input",36),k("ngModelChange",function(c){return M(a.terminoBusqueda,c)||(a.terminoBusqueda=c),c}),g("input",function(){return a.onBusquedaChange()}),n()(),i(78,"div")(79,"label",35),o(80,"Estado"),n(),i(81,"select",37),k("ngModelChange",function(c){return M(a.filtros.estado,c)||(a.filtros.estado=c),c}),g("change",function(){return a.onFiltroChange()}),f(82,Ui,2,2,"option",38),n()(),i(83,"div")(84,"label",35),o(85,"Fecha Desde"),n(),i(86,"input",39),k("ngModelChange",function(c){return M(a.filtros.fecha_inicio,c)||(a.filtros.fecha_inicio=c),c}),g("change",function(){return a.onFiltroChange()}),n()(),i(87,"div")(88,"label",35),o(89,"Fecha Hasta"),n(),i(90,"input",39),k("ngModelChange",function(c){return M(a.filtros.fecha_fin,c)||(a.filtros.fecha_fin=c),c}),g("change",function(){return a.onFiltroChange()}),n()()(),i(91,"div",40)(92,"button",41),g("click",function(){return a.limpiarFiltros()}),b(),i(93,"svg",42),_(94,"path",31),n(),o(95," Limpiar filtros "),n()()(),f(96,Ri,2,0,"div",43)(97,Bi,13,1,"div",44)(98,Ki,4,3,"div",45),n()),e&2&&(s(27),y(a.estadisticas.total),s(11),y(a.estadisticas.activos),s(11),y(a.estadisticas.pausados),s(11),y(a.estadisticas.completados),s(11),y(a.estadisticas.cancelados),s(6),E("ngModel",a.terminoBusqueda),s(4),E("ngModel",a.filtros.estado),s(),d("ngForOf",a.estadosDisponibles),s(4),E("ngModel",a.filtros.fecha_inicio),s(4),E("ngModel",a.filtros.fecha_fin),s(6),d("ngIf",a.cargando),s(),d("ngIf",a.error&&!a.cargando),s(),d("ngIf",!a.cargando&&!a.error))},dependencies:[B,z,H,W,K,G,$,Z],encapsulation:2})};function Zi(r,t){if(r&1&&(i(0,"option",44),o(1),n()),r&2){let e=t.$implicit;d("value",e.id),s(),m(" ",e.nombre," ")}}function en(r,t){if(r&1){let e=C();i(0,"div")(1,"label",13),o(2,"Usuario"),n(),i(3,"select",14),k("ngModelChange",function(l){x(e);let c=p();return M(c.filtros.usuarioId,l)||(c.filtros.usuarioId=l),h(l)}),g("ngModelChange",function(){x(e);let l=p();return h(l.aplicarFiltros())}),i(4,"option",15),o(5,"Todos los usuarios"),n(),f(6,Zi,2,2,"option",43),n()()}if(r&2){let e=p();s(3),E("ngModel",e.filtros.usuarioId),s(3),d("ngForOf",e.usuarios)}}function tn(r,t){r&1&&(i(0,"div",45),_(1,"div",46),n())}function nn(r,t){if(r&1&&(i(0,"div",60),o(1),n()),r&2){let e=t.$implicit;s(),m(" ",e," ")}}function an(r,t){r&1&&_(0,"div",67)}function on(r,t){if(r&1&&(i(0,"span",76),o(1),n()),r&2){let e=p().$implicit;s(),m("(",e.progreso,"%)")}}function rn(r,t){if(r&1){let e=C();i(0,"div",68),g("click",function(){let l=x(e).$implicit,c=p(3);return h(c.verDetalles(l))}),i(1,"div",69)(2,"span",70),o(3),n(),i(4,"span",71),o(5),n(),_(6,"div",72),n(),i(7,"div",73)(8,"span",74),o(9),n(),f(10,on,2,1,"span",75),n()()}if(r&2){let e=t.$implicit,a=p(3);P(a.getEstadoClasses(e.estado)),d("title",e.contenido_nombre+" - "+a.getEstadoTexto(e.estado)),s(3),y(a.getTipoIcon(e.contenido_tipo)),s(2),m(" ",e.contenido_nombre," "),s(),P(a.getColorByEstado(e.estado)),s(3),y(e.usuario_nombre),s(),d("ngIf",e.progreso!==void 0)}}function sn(r,t){if(r&1&&(i(0,"div",77),o(1),n()),r&2){let e=p().$implicit;s(),m(" +",e.sesiones.length-3," m\xE1s ")}}function ln(r,t){if(r&1&&(i(0,"div")(1,"div",61)(2,"span",62),o(3),n(),f(4,an,1,0,"div",63),n(),i(5,"div",64),f(6,rn,11,9,"div",65)(7,sn,2,1,"div",66),n()()),r&2){let e=t.$implicit,a=p(2);P(a.getClasesDiaCalendario(e)),s(2),L("text-blue-600",e.esHoy)("font-bold",e.esHoy),s(),m(" ",e.fecha.getDate()," "),s(),d("ngIf",e.esHoy),s(2),d("ngForOf",e.sesiones.slice(0,3))("ngForTrackBy",a.trackBySesionId),s(),d("ngIf",e.sesiones.length>3)}}function cn(r,t){if(r&1){let e=C();i(0,"div",47)(1,"div",48)(2,"div",49)(3,"button",50),g("click",function(){x(e);let l=p();return h(l.mesAnterior())}),b(),i(4,"svg",51),_(5,"path",52),n()(),w(),i(6,"h2",53),o(7),n(),i(8,"button",50),g("click",function(){x(e);let l=p();return h(l.mesSiguiente())}),b(),i(9,"svg",51),_(10,"path",54),n()()(),w(),i(11,"button",55),g("click",function(){x(e);let l=p();return h(l.irAHoy())}),o(12," Hoy "),n()(),i(13,"div",56),f(14,nn,2,1,"div",57),n(),i(15,"div",58),f(16,ln,8,11,"div",59),n()()}if(r&2){let e=p();s(7),I(" ",e.getNombreMes()," ",e.getAnio()," "),s(7),d("ngForOf",e.diasSemana),s(2),d("ngForOf",e.diasCalendario)}}function dn(r,t){if(r&1&&(i(0,"span",26),b(),i(1,"svg",96),_(2,"path",108),n(),o(3),n()),r&2){let e=p().$implicit;s(3),m(" Dr. ",e.terapeuta_nombre," ")}}function pn(r,t){if(r&1){let e=C();i(0,"div",109)(1,"button",110),g("click",function(){x(e);let l=p().$implicit,c=p(3);return h(c.completarSesion(l))}),o(2," Completar "),n(),i(3,"button",111),g("click",function(){x(e);let l=p().$implicit,c=p(3);return h(c.cancelarSesion(l))}),o(4," Cancelar "),n()()}}function un(r,t){if(r&1){let e=C();i(0,"div",109)(1,"button",112),g("click",function(){x(e);let l=p().$implicit,c=p(3);return h(c.verRegistro(l))}),o(2," Ver Registro "),n()()}}function mn(r,t){if(r&1&&(i(0,"div",113)(1,"div",114)(2,"div")(3,"span",115),o(4,"Fecha programada:"),n(),i(5,"p",116),o(6),n()(),i(7,"div")(8,"span",115),o(9,"Tipo:"),n(),i(10,"p",116),o(11),O(12,"titlecase"),n()(),i(13,"div")(14,"span",115),o(15,"Origen:"),n(),i(16,"p",116),o(17),O(18,"titlecase"),n()()()()),r&2){let e=p().$implicit,a=p(3);s(6),y(a.formatearFecha(e.fecha_programada)),s(5),y(A(12,3,e.tipo_programa)),s(6),y(A(18,5,e.origen))}}function gn(r,t){if(r&1){let e=C();i(0,"div",86)(1,"div",69)(2,"div",49)(3,"div",87)(4,"div",88)(5,"span",89),o(6),n()()(),i(7,"div",90)(8,"div",91)(9,"h4",92),o(10),n(),i(11,"span",93),o(12),n(),i(13,"span",94),o(14),O(15,"titlecase"),n()(),i(16,"div",95)(17,"span",26),b(),i(18,"svg",96),_(19,"path",97),n(),o(20),n(),f(21,dn,4,1,"span",98),w(),i(22,"span",26),b(),i(23,"svg",96),_(24,"path",99),n(),o(25),n()()()(),w(),i(26,"div",100)(27,"button",101),g("click",function(){let l=x(e).$implicit,c=p(3);return h(c.verDetalles(l))}),b(),i(28,"svg",51),_(29,"path",102),n()(),w(),i(30,"button",103),g("click",function(){let l=x(e).$implicit,c=p(3);return h(c.verDetallesCompletos(l))}),b(),i(31,"svg",51),_(32,"path",104)(33,"path",105),n()(),f(34,pn,5,0,"div",106)(35,un,3,0,"div",106),n()(),f(36,mn,19,7,"div",107),n()}if(r&2){let e=t.$implicit,a=p(3);s(4),P(a.getAvatarClasses(e)),s(2),m(" ",a.getIniciales(e.usuario_nombre)," "),s(4),m(" ",e.contenido_nombre," "),s(),P(a.getEstadoClasses(e.estado)),s(),m(" ",a.getEstadoTexto(e.estado)," "),s(),P(a.getTipoClasses(e.contenido_tipo)),s(),m(" ",A(15,16,e.contenido_tipo)," "),s(6),m(" ",e.usuario_nombre," "),s(),d("ngIf",e.terapeuta_nombre),s(4),m(" ",e.paquete_nombre," "),s(9),d("ngIf",e.estado==="pendiente"),s(),d("ngIf",e.estado==="completada"),s(),d("ngIf",e.expandido)}}function _n(r,t){if(r&1&&(i(0,"div",47)(1,"div",81)(2,"h3",82),o(3),n(),i(4,"p",83),o(5),n()(),i(6,"div",84),f(7,gn,37,18,"div",85),n()()),r&2){let e=t.$implicit,a=p(2);s(3),m(" ",a.formatearFechaGrupo(e.key)," "),s(2),je(" ",e.value.length," sesi\xF3n",e.value.length!==1?"es":""," programada",e.value.length!==1?"s":""," "),s(2),d("ngForOf",e.value)}}function fn(r,t){r&1&&(i(0,"div",117),b(),i(1,"svg",118),_(2,"path",9),n(),w(),i(3,"h3",119),o(4,"No hay sesiones"),n(),i(5,"p",120),o(6,"No se encontraron sesiones con los filtros aplicados."),n()())}function bn(r,t){if(r&1&&(i(0,"div",78),f(1,_n,8,5,"div",79),O(2,"keyvalue"),f(3,fn,7,0,"div",80),n()),r&2){let e=p();s(),d("ngForOf",ve(2,2,e.sesionesFiltradas,e.ordenarPorFecha)),s(2),d("ngIf",e.sesionesFiltradas.size===0)}}function vn(r,t){r&1&&(i(0,"div",121),b(),i(1,"svg",118),_(2,"path",9),n(),w(),i(3,"h3",119),o(4,"No hay sesiones programadas"),n(),i(5,"p",120),o(6,"No tienes sesiones de paquetes programadas para mostrar en el calendario."),n()())}function xn(r,t){if(r&1&&(i(0,"p")(1,"span",74),o(2,"Progreso:"),n(),o(3),n()),r&2){let e=p(3);s(3),m(" ",e.sesionSeleccionada.progreso,"%")}}function hn(r,t){if(r&1){let e=C();i(0,"button",137),g("click",function(){x(e);let l=p(3);return l.completarSesion(l.sesionSeleccionada),h(l.cerrarModal())}),o(1," Marcar como Completada "),n()}}function yn(r,t){if(r&1){let e=C();i(0,"div",128)(1,"div",129)(2,"div")(3,"h4",130),o(4),n(),i(5,"p",131),o(6),n()(),i(7,"div")(8,"span",132),o(9),n()()(),i(10,"div",133)(11,"div")(12,"h5",134),o(13,"Informaci\xF3n del Usuario"),n(),i(14,"div",135)(15,"p")(16,"span",74),o(17,"Nombre:"),n(),o(18),n(),i(19,"p")(20,"span",74),o(21,"ID Usuario:"),n(),o(22),n()()(),i(23,"div")(24,"h5",134),o(25,"Informaci\xF3n de la Sesi\xF3n"),n(),i(26,"div",135)(27,"p")(28,"span",74),o(29,"Fecha:"),n(),o(30),n(),i(31,"p")(32,"span",74),o(33,"Tipo:"),n(),o(34),O(35,"titlecase"),n(),i(36,"p")(37,"span",74),o(38,"Terapeuta:"),n(),o(39),n(),f(40,xn,4,1,"p",12),n()()(),i(41,"div",136)(42,"button",137),g("click",function(){x(e);let l=p(2);return h(l.verDetallesCompletos(l.sesionSeleccionada))}),o(43," Ver Rutina/Terapia Completa "),n(),i(44,"div",138)(45,"button",22),g("click",function(){x(e);let l=p(2);return h(l.cerrarModal())}),o(46," Cerrar "),n(),f(47,hn,2,0,"button",139),n()()()}if(r&2){let e=p(2);s(4),y(e.sesionSeleccionada.contenido_nombre),s(2),y(e.sesionSeleccionada.paquete_nombre),s(2),P(e.getEstadoClasses(e.sesionSeleccionada.estado)),s(),m(" ",e.getEstadoTexto(e.sesionSeleccionada.estado)," "),s(9),m(" ",e.sesionSeleccionada.usuario_nombre,""),s(4),m(" ",e.sesionSeleccionada.usuario_id,""),s(8),m(" ",e.formatearFecha(e.sesionSeleccionada.fecha_programada),""),s(4),m(" ",A(35,12,e.sesionSeleccionada.contenido_tipo),""),s(5),m(" ",e.sesionSeleccionada.terapeuta_nombre||"No asignado",""),s(),d("ngIf",e.sesionSeleccionada.progreso!==void 0),s(7),d("ngIf",e.sesionSeleccionada.estado==="pendiente")}}function wn(r,t){if(r&1){let e=C();i(0,"div",122)(1,"div",123)(2,"div",124)(3,"h3",125),o(4,"Detalles de Sesi\xF3n"),n(),i(5,"button",126),g("click",function(){x(e);let l=p();return h(l.cerrarModal())}),b(),i(6,"svg",28),_(7,"path",37),n()()(),f(8,yn,48,14,"div",127),n()()}if(r&2){let e=p();s(8),d("ngIf",e.sesionSeleccionada)}}function Cn(r,t){if(r&1){let e=C();i(0,"div",122)(1,"div",140)(2,"div",141)(3,"div")(4,"h3",142),o(5),n(),i(6,"p",143),o(7),n()(),i(8,"button",126),g("click",function(){x(e);let l=p();return h(l.cerrarModalDetalle())}),b(),i(9,"svg",28),_(10,"path",37),n()()(),w(),i(11,"div",144)(12,"div",145)(13,"div",146),_(14,"div",147)(15,"div",148)(16,"div",149),n(),i(17,"div",150),o(18),n()(),i(19,"div",151),o(20),n()(),i(21,"div",152)(22,"div",153),o(23),O(24,"titlecase"),n(),i(25,"div",138)(26,"button",154),g("click",function(){x(e);let l=p();return h(l.copyToClipboard())}),b(),i(27,"svg",155),_(28,"path",156),n(),o(29," Copiar "),n(),w(),i(30,"button",154),g("click",function(){x(e);let l=p();return h(l.downloadContent())}),b(),i(31,"svg",155),_(32,"path",157),n(),o(33," Descargar "),n(),w(),i(34,"button",22),g("click",function(){x(e);let l=p();return h(l.cerrarModalDetalle())}),o(35," Cerrar "),n()()()()()}if(r&2){let e=p();s(5),y(e.detalleContenido==null?null:e.detalleContenido.nombre),s(2),I(" Vista previa de la ",e.detalleContenido==null?null:e.detalleContenido.tipo," - ",e.detalleContenido==null?null:e.detalleContenido.descripcion," "),s(11),m(" ",e.getFileName()," "),s(2),y(e.getFormattedContent()),s(3),m(" ",A(24,6,e.detalleContenido==null?null:e.detalleContenido.tipo)," cargada desde la base de datos ")}}var Ee=class r{constructor(t,e,a){this.supabaseService=t;this.authService=e;this.router=a;this.currentUser=this.authService.getCurrentUser(),this.esAdmin=this.currentUser?.id_perfil===1,this.esSupervisor=this.currentUser?.id_perfil===3,this.puedeVerTodos=this.esAdmin||this.esSupervisor}vistaActual="calendario";sesiones=[];sesionesFiltradas=new Map;usuarios=[];paquetes=[];fechaActual=new Date;mesActual=new Date;diasCalendario=[];cargando=!1;error="";modalAbierto=!1;modalDetalleAbierto=!1;sesionSeleccionada=null;detalleContenido=null;currentUser=null;esAdmin=!1;esSupervisor=!1;puedeVerTodos=!1;filtros={usuarioId:void 0,estado:"",fechaDesde:"",fechaHasta:"",tipo:void 0};estadisticas={totalSesiones:0,sesionesCompletadas:0,sesionesPendientes:0,sesionesCanceladas:0,progresoPromedio:0,sesionesHoy:0,pendientes:0,completadas:0,canceladas:0};meses=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];diasSemana=["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"];subscriptions=new Ve;ngOnInit(){return v(this,null,function*(){console.log("\u{1F680} Inicializando Calendario de Paquetes"),console.log("\u{1F464} Usuario actual:",this.currentUser),console.log("\u{1F511} Permisos:",{esAdmin:this.esAdmin,esSupervisor:this.esSupervisor}),this.inicializarFechas(),yield this.cargarDatosIniciales()})}ngOnDestroy(){this.subscriptions.unsubscribe()}inicializarFechas(){let t=new Date,e=new Date;e.setDate(t.getDate()-30);let a=new Date;a.setDate(t.getDate()+30),this.filtros.fechaDesde=this.formatearFechaInput(e),this.filtros.fechaHasta=this.formatearFechaInput(a),console.log("\u{1F4C5} Fechas inicializadas:",this.filtros.fechaDesde,"a",this.filtros.fechaHasta)}cambiarVista(t){console.log("Cambiando vista a:",t),this.vistaActual=t,t==="calendario"&&this.generarCalendario()}get mostrarVistaLista(){return this.vistaActual==="lista"}get mostrarVistaCalendario(){return this.vistaActual==="calendario"}generarCalendario(){console.log("\u{1F4C5} Generando calendario para mes:",this.mesActual),this.diasCalendario=[];let t=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth(),1),e=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()+1,0),a=new Date,l=t.getDay();for(let u=l-1;u>=0;u--){let S=new Date(t);S.setDate(S.getDate()-(u+1)),this.diasCalendario.push({fecha:new Date(S),esMesActual:!1,esHoy:this.esMismaFecha(S,a),sesiones:this.getSesionesDelDia(S)})}for(let u=1;u<=e.getDate();u++){let S=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth(),u);this.diasCalendario.push({fecha:new Date(S),esMesActual:!0,esHoy:this.esMismaFecha(S,a),sesiones:this.getSesionesDelDia(S)})}let c=42-this.diasCalendario.length;for(let u=1;u<=c;u++){let S=new Date(e);S.setDate(S.getDate()+u),this.diasCalendario.push({fecha:new Date(S),esMesActual:!1,esHoy:this.esMismaFecha(S,a),sesiones:this.getSesionesDelDia(S)})}console.log("\u2705 Calendario generado con",this.diasCalendario.length,"d\xEDas")}esMismaFecha(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}getSesionesDelDia(t){let e=this.formatearFechaInput(t);return this.sesiones.filter(a=>a.fecha_programada===e)}mesAnterior(){this.mesActual=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()-1,1),this.generarCalendario()}mesSiguiente(){this.mesActual=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()+1,1),this.generarCalendario()}irAHoy(){this.mesActual=new Date,this.generarCalendario()}cargarDatosIniciales(){return v(this,null,function*(){this.cargando=!0,this.error="";try{console.log("\u{1F4CA} Cargando datos iniciales..."),yield Promise.all([this.cargarUsuarios(),this.cargarPaquetes(),this.cargarCalendario()]),this.calcularEstadisticas(),this.vistaActual==="calendario"&&this.generarCalendario(),console.log("\u2705 Datos iniciales cargados exitosamente")}catch(t){console.error("\u{1F4A5} Error cargando datos iniciales:",t),this.error="Error al cargar los datos del calendario. Por favor, int\xE9ntalo de nuevo."}finally{this.cargando=!1}})}cargarUsuarios(){return v(this,null,function*(){try{if(!this.puedeVerTodos){this.usuarios=[],console.log("\u{1F464} Usuario regular: no se cargan otros usuarios para filtros");return}console.log("\u{1F465} Cargando usuarios para filtros (solo admin/supervisor)...");let{data:t,error:e}=yield this.supabaseService.client.from("profiles").select("id, full_name, username").eq("status",1).order("full_name");if(e)throw e;this.usuarios=(t||[]).map(a=>({id:a.id,nombre:a.full_name||a.username||`Usuario ${a.id}`})),console.log("\u2705 Usuarios cargados para admin/supervisor:",this.usuarios.length)}catch(t){console.error("\u{1F4A5} Error cargando usuarios:",t),this.usuarios=[]}})}cargarPaquetes(){return v(this,null,function*(){try{console.log("\u{1F4E6} Cargando paquetes para filtros...");let{data:t,error:e}=yield this.supabaseService.client.from("paquetes").select("id, nombre, tipo").eq("status",1).order("nombre");if(e)throw e;this.paquetes=t||[],console.log("\u2705 Paquetes cargados:",this.paquetes.length)}catch(t){console.error("\u{1F4A5} Error cargando paquetes:",t),this.paquetes=[]}})}cargarCalendario(){return v(this,null,function*(){try{console.log("\u{1F5D3}\uFE0F Cargando calendario con filtros:",this.filtros),yield this.cargarCalendarioConVista()}catch(t){console.error("\u{1F4A5} Error cargando calendario con vista, intentando m\xE9todo alternativo:",t),yield this.cargarCalendarioFallback()}})}cargarCalendarioConVista(){return v(this,null,function*(){let t=this.supabaseService.client.from("vista_calendario_paquetes_usuario").select("*");console.log("\u{1F512} Aplicando filtro de usuario actual:",this.currentUser.id),t=t.eq("usuario_id",this.currentUser.id),this.puedeVerTodos&&this.filtros.usuarioId&&this.filtros.usuarioId!==this.currentUser.id&&(console.log("\u{1F468}\u200D\u{1F4BC} Admin/Supervisor viendo usuario espec\xEDfico:",this.filtros.usuarioId),t=t.eq("usuario_id",this.filtros.usuarioId)),this.filtros.fechaDesde&&(t=t.gte("fecha_programada",this.filtros.fechaDesde)),this.filtros.fechaHasta&&(t=t.lte("fecha_programada",this.filtros.fechaHasta)),this.filtros.estado&&(t=t.eq("estado",this.filtros.estado)),this.filtros.tipo&&(t=t.eq("contenido_tipo",this.filtros.tipo)),t=t.order("fecha_programada",{ascending:!0});let{data:e,error:a}=yield t;if(a)throw a;console.log("\u{1F4CA} Datos obtenidos para usuario:",this.currentUser.id,"- Total sesiones:",(e||[]).length),this.procesarDatosSesiones(e||[])})}cargarCalendarioFallback(){return v(this,null,function*(){console.log("\u{1F504} Usando m\xE9todo de respaldo para cargar calendario"),this.crearDatosEjemplo()})}procesarDatosSesiones(t){this.sesiones=t.map(e=>({sesion_id:e.sesion_id,usuario_paquete_id:e.usuario_paquete_id,usuario_id:e.usuario_id,usuario_nombre:e.usuario_nombre,username:e.username||e.usuario_nombre,fecha_programada:e.fecha_programada,contenido_tipo:e.contenido_tipo,contenido_id:e.contenido_id,contenido_nombre:this.obtenerNombreContenido(e.contenido_tipo,e.contenido_id),estado:e.estado,terapeuta_nombre:e.terapeuta_nombre,paquete_nombre:e.paquete_nombre,tipo_programa:e.tipo_programa||"paquete",origen:"paquete",progreso:e.progreso||0,calificacion:e.calificacion,comentarios:e.comentarios,puede_modificar:this.puedeModificarSesion(e.usuario_id),expandido:!1})),this.aplicarFiltrosLocales(),console.log("\u2705 Calendario cargado:",{totalSesiones:this.sesiones.length,sesionesAgrupadas:this.sesionesFiltradas.size})}crearDatosEjemplo(){console.log("\u{1F4DD} Creando datos de ejemplo para demostraci\xF3n");let t=new Date;this.sesiones=[{sesion_id:1,usuario_paquete_id:1,usuario_id:this.currentUser.id,usuario_nombre:this.currentUser.full_name||"Usuario Actual",username:this.currentUser.username,fecha_programada:this.formatearFechaInput(t),contenido_tipo:"terapia",contenido_id:1,contenido_nombre:"Terapia Respiratoria B\xE1sica",estado:"pendiente",terapeuta_nombre:"Dr. Garc\xEDa",paquete_nombre:"Paquete Rehabilitaci\xF3n Integral",tipo_programa:"paquete",origen:"paquete",progreso:0,puede_modificar:!0,expandido:!1},{sesion_id:2,usuario_paquete_id:1,usuario_id:this.currentUser.id,usuario_nombre:this.currentUser.full_name||"Usuario Actual",username:this.currentUser.username,fecha_programada:this.formatearFechaInput(new Date(t.getTime()+864e5)),contenido_tipo:"rutina",contenido_id:1,contenido_nombre:"CrossFit - D\xEDa Completo",estado:"completada",terapeuta_nombre:"Dr. Garc\xEDa",paquete_nombre:"Paquete Rehabilitaci\xF3n Integral",tipo_programa:"paquete",origen:"paquete",progreso:100,puede_modificar:!0,expandido:!1}],this.aplicarFiltrosLocales()}cargarDetalleContenido(t){return v(this,null,function*(){console.log("\u{1F4CB} Cargando detalles del contenido:",t.contenido_tipo,t.contenido_id),this.cargando=!0;try{t.contenido_tipo==="rutina"?yield this.cargarDetalleRutina(t):t.contenido_tipo==="terapia"&&(yield this.cargarDetalleTerapia(t))}catch(e){console.error("\u{1F4A5} Error cargando detalles:",e),this.error="Error al cargar los detalles del contenido"}finally{this.cargando=!1}})}cargarDetalleRutina(t){return v(this,null,function*(){try{console.log("\u{1F3C3}\u200D\u2642\uFE0F Cargando rutina completa desde BD:",t.contenido_id);let{data:e,error:a}=yield this.supabaseService.client.from("rutinas").select("*").eq("id",t.contenido_id).eq("status",1).single();if(a)throw a;console.log("\u2705 Rutina cargada desde BD:",e),this.detalleContenido={id:e.id,nombre:e.nombre,descripcion:e.descripcion,tipo:"rutina",detalles:e},t.rutina_detalles=e,console.log("\u{1F3AF} Abriendo modal de rutina:",e.nombre),this.modalDetalleAbierto=!0}catch(e){console.error("\u{1F4A5} Error cargando rutina:",e),this.crearRutinaBasica(t)}})}cargarDetalleTerapia(t){return v(this,null,function*(){try{console.log("\u{1F3E5} Cargando terapia completa desde BD:",t.contenido_id);let{data:e,error:a}=yield this.supabaseService.client.from("terapias").select("*").eq("id",t.contenido_id).eq("status",1).single();if(a)throw a;console.log("\u2705 Terapia cargada desde BD:",e),this.detalleContenido={id:e.id,nombre:e.nombre,descripcion:e.descripcion,tipo:"terapia",detalles:e},t.terapia_detalles=e,console.log("\u{1F3AF} Abriendo modal de terapia:",e.nombre),this.modalDetalleAbierto=!0}catch(e){console.error("\u{1F4A5} Error cargando terapia:",e),this.crearTerapiaBasica(t)}})}crearRutinaBasica(t){console.log("\u{1F4DD} Creando rutina b\xE1sica para fallback"),this.detalleContenido={id:t.contenido_id,nombre:t.contenido_nombre,descripcion:"Rutina de entrenamiento",tipo:"rutina",detalles:{id:t.contenido_id,nombre:t.contenido_nombre,descripcion:"Rutina de entrenamiento personalizada",nivel:"intermedio",duracion_estimada:60,tipo:"entrenamiento",warm_up:null,met_con:null,strength:null,core:null,extra:null}},this.modalDetalleAbierto=!0}crearTerapiaBasica(t){console.log("\u{1F4DD} Creando terapia b\xE1sica para fallback"),this.detalleContenido={id:t.contenido_id,nombre:t.contenido_nombre,descripcion:"Terapia de rehabilitaci\xF3n",tipo:"terapia",detalles:{id:t.contenido_id,nombre:t.contenido_nombre,descripcion:"Terapia de rehabilitaci\xF3n personalizada",tipo:"fisica",nivel:"intermedio",duracion_estimada:45,area_especializacion:"Rehabilitaci\xF3n General",ejercicios:null}},this.modalDetalleAbierto=!0}obtenerNombreContenido(t,e){return t==="terapia"?`Terapia ${e}`:`Rutina ${e}`}puedeModificarSesion(t){return[1,3].includes(this.currentUser.id_perfil)?!0:this.currentUser.id===t}calcularEstadisticas(){let t=new Date().toISOString().split("T")[0],e=this.sesiones.filter(c=>c.estado==="completada").length,a=this.sesiones.filter(c=>c.estado==="pendiente").length,l=this.sesiones.filter(c=>c.estado==="cancelada").length;this.estadisticas={totalSesiones:this.sesiones.length,sesionesCompletadas:e,sesionesPendientes:a,sesionesCanceladas:l,progresoPromedio:this.calcularProgresoPromedio(),sesionesHoy:this.sesiones.filter(c=>c.fecha_programada===t).length,pendientes:a,completadas:e,canceladas:l}}calcularProgresoPromedio(){let t=this.sesiones.filter(a=>a.progreso!==void 0&&a.progreso>0);if(t.length===0)return 0;let e=t.reduce((a,l)=>a+(l.progreso||0),0);return Math.round(e/t.length)}aplicarFiltros(){return v(this,null,function*(){console.log("\u{1F50D} Aplicando filtros:",this.filtros),!this.puedeVerTodos&&this.filtros.usuarioId&&(console.log("\u26A0\uFE0F Usuario regular intentando filtrar por otro usuario - resetando filtro"),this.filtros.usuarioId=void 0),this.cargando=!0;try{yield this.cargarCalendario(),this.calcularEstadisticas(),this.vistaActual==="calendario"&&this.generarCalendario()}catch(t){console.error("\u{1F4A5} Error aplicando filtros:",t)}finally{this.cargando=!1}})}aplicarFiltrosLocales(){this.agruparSesionesPorFecha([...this.sesiones])}agruparSesionesPorFecha(t){this.sesionesFiltradas.clear(),t.forEach(e=>{let a=e.fecha_programada;this.sesionesFiltradas.has(a)||this.sesionesFiltradas.set(a,[]),this.sesionesFiltradas.get(a).push(e)}),this.sesionesFiltradas.forEach(e=>{e.sort((a,l)=>{let c={pendiente:0,completada:1,cancelada:2};return a.estado!==l.estado?(c[a.estado]||3)-(c[l.estado]||3):a.contenido_nombre.localeCompare(l.contenido_nombre)})})}limpiarFiltros(){console.log("\u{1F9F9} Limpiando filtros"),this.filtros={usuarioId:void 0,estado:"",fechaDesde:"",fechaHasta:"",tipo:void 0},this.inicializarFechas(),this.aplicarFiltros()}completarSesion(t){return v(this,null,function*(){if(!t.puede_modificar){alert("No tienes permisos para modificar esta sesi\xF3n");return}try{console.log("\u2705 Completando sesi\xF3n:",t.sesion_id);let{error:e}=yield this.supabaseService.client.from("paquete_seguimiento").update({estado:"completada",progreso:100,fecha_completada:new Date().toISOString(),comentarios:`Sesi\xF3n completada el ${new Date().toLocaleDateString()}`,updated_at:new Date().toISOString()}).eq("id",t.sesion_id);if(e)throw e;t.estado="completada",t.progreso=100,this.calcularEstadisticas(),this.vistaActual==="calendario"&&this.generarCalendario(),console.log("\u2705 Sesi\xF3n completada exitosamente")}catch(e){console.error("\u{1F4A5} Error completando sesi\xF3n:",e),alert("Error al completar la sesi\xF3n. Por favor, int\xE9ntalo de nuevo.")}})}cancelarSesion(t){return v(this,null,function*(){if(!t.puede_modificar){alert("No tienes permisos para modificar esta sesi\xF3n");return}let e=prompt("\xBFPor qu\xE9 deseas cancelar esta sesi\xF3n? (opcional)");if(e!==null)try{console.log("\u274C Cancelando sesi\xF3n:",t.sesion_id);let a={estado:"cancelada",updated_at:new Date().toISOString()};e&&(a.comentarios=e);let{error:l}=yield this.supabaseService.client.from("paquete_seguimiento").update(a).eq("id",t.sesion_id);if(l)throw l;t.estado="cancelada",e&&(t.comentarios=e),this.calcularEstadisticas(),this.vistaActual==="calendario"&&this.generarCalendario(),console.log("\u2705 Sesi\xF3n cancelada exitosamente")}catch(a){console.error("\u{1F4A5} Error cancelando sesi\xF3n:",a),alert("Error al cancelar la sesi\xF3n. Por favor, int\xE9ntalo de nuevo.")}})}verDetalles(t){console.log("\u{1F441}\uFE0F Mostrando detalles de sesi\xF3n:",t.sesion_id),this.sesionSeleccionada=t,this.modalAbierto=!0}verDetallesCompletos(t){return v(this,null,function*(){console.log("\u{1F4CB} Cargando detalles completos:",t.contenido_tipo,t.contenido_id),yield this.cargarDetalleContenido(t)})}cerrarModal(){this.modalAbierto=!1,this.sesionSeleccionada=null}cerrarModalDetalle(){this.modalDetalleAbierto=!1,this.detalleContenido=null}getFormattedContent(){return this.detalleContenido?this.detalleContenido.tipo==="rutina"?this.formatRutinaContent(this.detalleContenido.detalles):this.detalleContenido.tipo==="terapia"?this.formatTerapiaContent(this.detalleContenido.detalles):"Contenido no disponible":""}formatRutinaContent(t){let e=`${t.nombre}
`;return e+=`${t.descripcion||""}
`,e+=`Nivel: ${t.nivel} | Duraci\xF3n: ${t.duracion_estimada||0}m 0m

`,t.objetivo_principal&&(e+=`Objetivo: ${t.objetivo_principal}
`,e+=`\xC1rea: ${t.area_enfoque||"General"}

`),t.rutina_secciones&&t.rutina_secciones.length>0&&t.rutina_secciones.forEach(a=>{e+=`${a.seccion_nombre.toUpperCase()}
`,a.instrucciones&&(e+=`${a.instrucciones}
`),a.rutina_ejercicios&&a.rutina_ejercicios.length>0&&a.rutina_ejercicios.forEach((l,c)=>{e+=`${c+1}. ${l.ejercicios?.nombre||"Ejercicio sin nombre"}
`;let u=[];l.sets&&u.push(`${l.sets} series`),l.reps&&u.push(`${l.reps} repeticiones`),l.tiempo&&u.push(`${l.tiempo}`),l.peso&&u.push(`Peso: ${l.peso}`),u.length>0&&(e+=`   ${u.join(" x ")}
`),l.tiempo&&(e+=`   Duraci\xF3n: ${l.tiempo}
`),l.notas&&(e+=`   \u26A0\uFE0F  ${l.notas}
`),e+=`
`}),e+=`
`}),t.criterios_progresion&&(e+=`CRITERIOS DE PROGRESI\xD3N
`,e+=`${t.criterios_progresion}

`),e}formatTerapiaContent(t){let e=`${t.nombre}
`;return e+=`${t.descripcion||""}
`,e+=`Nivel: ${t.nivel} | Duraci\xF3n: ${t.duracion_estimada||0}h 0m

`,t.objetivo_principal&&(e+=`Objetivo: ${t.objetivo_principal}
`,e+=`\xC1rea: ${t.area_enfoque||t.tipo}

`),t.terapia_secciones&&t.terapia_secciones.length>0&&t.terapia_secciones.forEach(a=>{e+=`${a.seccion_nombre.toUpperCase()}
`,a.instrucciones&&(e+=`${a.instrucciones}
`),a.terapia_ejercicios&&a.terapia_ejercicios.length>0&&a.terapia_ejercicios.forEach((l,c)=>{e+=`${c+1}. ${l.ejercicios?.nombre||"Ejercicio sin nombre"}
`;let u=[];l.repeticiones&&u.push(`${l.repeticiones} repeticiones`),l.duracion&&u.push(`${l.duracion}`),l.intensidad&&u.push(`Intensidad: ${l.intensidad}`),u.length>0&&(e+=`   ${u.join(" | ")}
`),l.notas&&(e+=`   \u26A0\uFE0F  ${l.notas}
`),l.ejercicios?.instrucciones&&(e+=`   \u{1F4DD} ${l.ejercicios.instrucciones}
`),e+=`
`}),e+=`
`}),t.ejercicios&&typeof t.ejercicios=="object"&&(e+=`PLAN DE EJERCICIOS
`,e+=`\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550

`,["respiracion","calentamiento","fortalecimiento","equilibrio","coordinacion","estiramiento","flexibilidad","movilidad","resistencia"].forEach(l=>{let c=t.ejercicios[l];c&&c.ejercicios&&Array.isArray(c.ejercicios)&&c.ejercicios.length>0&&(e+=`${l.toUpperCase()}
`,c.descripcion&&(e+=`${c.descripcion}
`),c.ejercicios.forEach((u,S)=>{e+=`${S+1}. ${u.nombre||"Ejercicio sin nombre"}
`,u.descripcion&&(e+=`   ${u.descripcion}
`);let F=[];u.series&&F.push(`${u.series} series`),u.repeticiones&&F.push(`${u.repeticiones} reps`),u.duracion&&F.push(`${u.duracion}`),F.length>0&&(e+=`   ${F.join(" | ")}
`),u.ejecucion&&(e+=`   Ejecuci\xF3n: ${u.ejecucion}
`),u.precauciones&&(e+=`   \u26A0\uFE0F  ${u.precauciones}
`),e+=`
`}),e+=`
`)})),t.criterios_progresion&&(e+=`CRITERIOS DE PROGRESI\xD3N
`,e+=`${t.criterios_progresion}
`),e}getFileName(){return this.detalleContenido?`${this.detalleContenido.nombre.replace(/\s+/g,"_").toLowerCase()}.txt`:"contenido.txt"}copySuccess=!1;copyToClipboard(){return v(this,null,function*(){let t=this.getFormattedContent();try{yield navigator.clipboard.writeText(t),this.copySuccess=!0,console.log("Contenido copiado al portapapeles"),setTimeout(()=>{this.copySuccess=!1},2e3)}catch(e){console.error("Error al copiar al portapapeles:",e),this.fallbackCopyTextToClipboard(t)}})}fallbackCopyTextToClipboard(t){let e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")&&(this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3))}catch(a){console.error("Fallback: Error al copiar al portapapeles:",a)}document.body.removeChild(e)}downloadContent(){let t=this.getFormattedContent(),e=this.getFileName(),a=new Blob([t],{type:"text/plain;charset=utf-8"}),l=window.URL.createObjectURL(a),c=document.createElement("a");c.href=l,c.download=e,c.click(),window.URL.revokeObjectURL(l),console.log("Contenido descargado:",e)}verRegistro(t){console.log("\u{1F4CB} Navegando a registro de sesi\xF3n:",t.sesion_id),this.router.navigate(["/paquetes/sesion",t.sesion_id])}ordenarPorFecha=(t,e)=>new Date(t.key).getTime()-new Date(e.key).getTime();formatearFechaGrupo(t){let e=new Date(t+"T00:00:00"),a=new Date,l=new Date;l.setDate(a.getDate()+1);let c=new Date;c.setDate(a.getDate()-1);let u=new Date(e.getFullYear(),e.getMonth(),e.getDate()),S=new Date(a.getFullYear(),a.getMonth(),a.getDate()),F=new Date(l.getFullYear(),l.getMonth(),l.getDate()),ke=new Date(c.getFullYear(),c.getMonth(),c.getDate());return u.getTime()===S.getTime()?"\u{1F5D3}\uFE0F Hoy - "+this.formatearFecha(t):u.getTime()===F.getTime()?"\u23ED\uFE0F Ma\xF1ana - "+this.formatearFecha(t):u.getTime()===ke.getTime()?"\u23EE\uFE0F Ayer - "+this.formatearFecha(t):this.formatearFecha(t)}formatearFecha(t){return new Date(t+"T00:00:00").toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}formatearFechaCorta(t){return t.toLocaleDateString("es-ES",{day:"numeric",month:"short"})}formatearFechaInput(t){return t.toISOString().split("T")[0]}getNombreMes(){return this.meses[this.mesActual.getMonth()]}getAnio(){return this.mesActual.getFullYear()}getEstadoClasses(t){switch(t){case"completada":return"bg-green-100 text-green-800 border-green-200";case"cancelada":return"bg-red-100 text-red-800 border-red-200";case"pendiente":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}}getEstadoTexto(t){switch(t){case"completada":return"\u2705 Completada";case"cancelada":return"\u274C Cancelada";case"pendiente":return"\u23F3 Pendiente";default:return t}}getColorByEstado(t){switch(t){case"completada":return"bg-green-500";case"cancelada":return"bg-red-500";case"pendiente":return"bg-yellow-500";default:return"bg-gray-500"}}getAvatarClasses(t){switch(t.estado){case"completada":return"bg-green-600 text-white";case"cancelada":return"bg-red-600 text-white";case"pendiente":return"bg-blue-600 text-white";default:return"bg-gray-600 text-white"}}getTipoClasses(t){switch(t){case"terapia":return"bg-purple-100 text-purple-800";case"rutina":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}}getTipoIcon(t){switch(t){case"terapia":return"\u{1F3E5}";case"rutina":return"\u{1F4AA}";default:return"\u{1F4CB}"}}getClasesDiaCalendario(t){let e="relative p-2 h-32 border border-gray-200 bg-white cursor-pointer hover:bg-gray-50 transition-colors";return t.esMesActual||(e+=" bg-gray-50 text-gray-400"),t.esHoy&&(e+=" bg-blue-50 border-blue-300"),e}getIniciales(t){return t.split(" ").map(e=>e.charAt(0)).join("").toUpperCase().substring(0,2)}getPorcentajeProgreso(t,e){return e>0?Math.round(t/e*100):0}navegarAPaquetes(){this.router.navigate(["/paquetes"])}navegarAAsignaciones(){this.puedeVerTodos&&this.router.navigate(["/paquetes/asignaciones"])}actualizarDatos(){return v(this,null,function*(){console.log("\u{1F504} Actualizando datos del calendario..."),yield this.cargarDatosIniciales()})}toggleExpandir(t){t.expandido=!t.expandido}verificarFiltroUsuario(){console.log("\u{1F50D} Estado actual del filtro de usuario:"),console.log("- Usuario actual:",this.currentUser.id,"-",this.currentUser.full_name),console.log("- Es admin/supervisor:",this.puedeVerTodos),console.log("- Filtro aplicado:",this.filtros.usuarioId),console.log("- Total sesiones cargadas:",this.sesiones.length),console.log("- Sesiones por usuario:",this.sesiones.reduce((t,e)=>(t[e.usuario_id]=(t[e.usuario_id]||0)+1,t),{}))}trackBySesionId(t,e){return e.sesion_id}static \u0275fac=function(e){return new(e||r)(q(te),q(Xe),q(U))};static \u0275cmp=j({type:r,selectors:[["app-calendario-paquetes"]],standalone:!1,decls:94,vars:29,consts:[[1,"min-h-screen","bg-gray-50","p-6"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-2"],[1,"flex","bg-gray-100","rounded-lg","p-1"],[1,"px-3","py-2","rounded-md","text-sm","font-medium","transition-colors","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1","inline"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 10h16M4 14h16M4 18h16"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"bg-white","rounded-lg","shadow-sm","p-6","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[4,"ngIf"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"w-full","rounded-lg","border-gray-300","shadow-sm","focus:border-blue-500","focus:ring-blue-500",3,"ngModelChange","ngModel"],["value",""],["value","pendiente"],["value","completada"],["value","cancelada"],["value","rutina"],["value","terapia"],[1,"flex","items-end","space-x-2"],[1,"px-4","py-2","text-gray-600","hover:text-gray-800","transition-colors",3,"click"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6","mb-6"],[1,"bg-white","rounded-lg","shadow-sm","p-6"],[1,"flex","items-center"],[1,"p-3","rounded-full","bg-blue-100","text-blue-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-2xl","font-bold","text-gray-900"],[1,"p-3","rounded-full","bg-yellow-100","text-yellow-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"p-3","rounded-full","bg-green-100","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"p-3","rounded-full","bg-red-100","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["class","flex justify-center items-center py-12",4,"ngIf"],["class","bg-white rounded-lg shadow-sm overflow-hidden",4,"ngIf"],["class","space-y-4",4,"ngIf"],["class","bg-white rounded-lg shadow-sm p-12 text-center",4,"ngIf"],["class","fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"flex","justify-center","items-center","py-12"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600"],[1,"bg-white","rounded-lg","shadow-sm","overflow-hidden"],[1,"bg-gray-50","px-6","py-4","border-b","flex","justify-between","items-center"],[1,"flex","items-center","space-x-4"],[1,"p-2","rounded-lg","hover:bg-gray-200","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-xl","font-semibold","text-gray-900"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"px-3","py-2","bg-blue-600","text-white","rounded-lg","text-sm","hover:bg-blue-700","transition-colors",3,"click"],[1,"grid","grid-cols-7","bg-gray-100"],["class","px-4 py-3 text-center text-sm font-medium text-gray-700 border-r border-gray-200 last:border-r-0",4,"ngFor","ngForOf"],[1,"grid","grid-cols-7"],[3,"class",4,"ngFor","ngForOf"],[1,"px-4","py-3","text-center","text-sm","font-medium","text-gray-700","border-r","border-gray-200","last:border-r-0"],[1,"flex","justify-between","items-start","mb-1"],[1,"text-sm","font-medium"],["class","w-2 h-2 bg-blue-600 rounded-full",4,"ngIf"],[1,"space-y-1"],["class","text-xs p-1 rounded cursor-pointer transition-all hover:scale-105",3,"class","title","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-xs text-gray-500 text-center py-1 bg-gray-100 rounded",4,"ngIf"],[1,"w-2","h-2","bg-blue-600","rounded-full"],[1,"text-xs","p-1","rounded","cursor-pointer","transition-all","hover:scale-105",3,"click","title"],[1,"flex","items-center","justify-between"],[1,"mr-1"],[1,"truncate","flex-1","font-medium"],[1,"w-2","h-2","rounded-full","ml-1","flex-shrink-0"],[1,"text-gray-600","mt-1","truncate"],[1,"font-medium"],["class","ml-1",4,"ngIf"],[1,"ml-1"],[1,"text-xs","text-gray-500","text-center","py-1","bg-gray-100","rounded"],[1,"space-y-4"],["class","bg-white rounded-lg shadow-sm overflow-hidden",4,"ngFor","ngForOf"],["class","text-center py-12",4,"ngIf"],[1,"bg-gray-50","px-6","py-4","border-b"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"divide-y","divide-gray-200"],["class","p-6 hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[1,"p-6","hover:bg-gray-50","transition-colors"],[1,"flex-shrink-0"],[1,"w-12","h-12","rounded-full","flex","items-center","justify-center"],[1,"text-sm","font-bold","text-white"],[1,"flex-1"],[1,"flex","items-center","space-x-3"],[1,"text-lg","font-medium","text-gray-900"],[1,"px-2","py-1","rounded-full","text-xs","font-medium"],[1,"px-2","py-1","rounded-full","text-xs"],[1,"mt-1","flex","items-center","space-x-4","text-sm","text-gray-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["class","flex items-center",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],[1,"flex","items-center","space-x-2"],["title","Ver detalles b\xE1sicos",1,"p-2","text-gray-400","hover:text-blue-600","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["title","Ver rutina/terapia completa",1,"p-2","text-gray-400","hover:text-green-600","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["class","flex space-x-2",4,"ngIf"],["class","mt-4 pt-4 border-t border-gray-200",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","space-x-2"],[1,"px-3","py-2","bg-green-600","text-white","text-xs","rounded-lg","hover:bg-green-700","transition-colors",3,"click"],[1,"px-3","py-2","bg-red-600","text-white","text-xs","rounded-lg","hover:bg-red-700","transition-colors",3,"click"],[1,"px-3","py-2","bg-blue-600","text-white","text-xs","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"mt-4","pt-4","border-t","border-gray-200"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-600"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],[1,"mt-4","text-lg","font-medium","text-gray-900"],[1,"mt-2","text-gray-600"],[1,"bg-white","rounded-lg","shadow-sm","p-12","text-center"],[1,"fixed","inset-0","bg-gray-600","bg-opacity-50","overflow-y-auto","h-full","w-full","z-50"],[1,"relative","top-20","mx-auto","p-5","border","w-11/12","md:w-3/4","lg:w-1/2","shadow-lg","rounded-md","bg-white"],[1,"flex","justify-between","items-center","pb-4","border-b"],[1,"text-lg","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["class","mt-4",4,"ngIf"],[1,"mt-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"font-medium","text-gray-900"],[1,"text-gray-600","mt-1"],[1,"px-3","py-1","rounded-full","text-sm","font-medium"],[1,"mt-6","grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"font-medium","text-gray-900","mb-3"],[1,"space-y-2","text-sm"],[1,"mt-6","flex","justify-between"],[1,"px-4","py-2","bg-green-600","text-white","rounded-lg","hover:bg-green-700","transition-colors",3,"click"],[1,"flex","space-x-3"],["class","px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",3,"click",4,"ngIf"],[1,"modal-content-detalle","border","shadow-lg","rounded-md","bg-white"],[1,"flex","justify-between","items-center","pb-4","border-b","sticky","top-0","bg-white","z-10"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-600","mt-1"],[1,"terminal-container","mt-6"],[1,"terminal-header"],[1,"terminal-buttons"],[1,"terminal-button","red"],[1,"terminal-button","yellow"],[1,"terminal-button","green"],[1,"terminal-filename"],[1,"terminal-content"],[1,"mt-6","flex","justify-between","items-center","pt-4","border-t","sticky","bottom-0","bg-white"],[1,"text-sm","text-gray-500"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),o(5,"Calendario de Paquetes"),n(),i(6,"p",4),o(7,"Gestiona y visualiza las sesiones de paquetes asignados"),n()(),i(8,"div",5)(9,"button",6),g("click",function(){return a.cambiarVista("lista")}),b(),i(10,"svg",7),_(11,"path",8),n(),o(12," Lista "),n(),w(),i(13,"button",6),g("click",function(){return a.cambiarVista("calendario")}),b(),i(14,"svg",7),_(15,"path",9),n(),o(16," Calendario "),n()()()(),w(),i(17,"div",10)(18,"div",11),f(19,en,7,2,"div",12),i(20,"div")(21,"label",13),o(22,"Estado"),n(),i(23,"select",14),k("ngModelChange",function(c){return M(a.filtros.estado,c)||(a.filtros.estado=c),c}),g("ngModelChange",function(){return a.aplicarFiltros()}),i(24,"option",15),o(25,"Todos los estados"),n(),i(26,"option",16),o(27,"Pendiente"),n(),i(28,"option",17),o(29,"Completada"),n(),i(30,"option",18),o(31,"Cancelada"),n()()(),i(32,"div")(33,"label",13),o(34,"Tipo"),n(),i(35,"select",14),k("ngModelChange",function(c){return M(a.filtros.tipo,c)||(a.filtros.tipo=c),c}),g("ngModelChange",function(){return a.aplicarFiltros()}),i(36,"option",15),o(37,"Todos los tipos"),n(),i(38,"option",19),o(39,"Rutinas"),n(),i(40,"option",20),o(41,"Terapias"),n()()(),i(42,"div",21)(43,"button",22),g("click",function(){return a.limpiarFiltros()}),o(44," Limpiar "),n(),i(45,"button",23),g("click",function(){return a.actualizarDatos()}),o(46," Actualizar "),n()()()(),i(47,"div",24)(48,"div",25)(49,"div",26)(50,"div",27),b(),i(51,"svg",28),_(52,"path",9),n()(),w(),i(53,"div",29)(54,"p",30),o(55,"Total Sesiones"),n(),i(56,"p",31),o(57),n()()()(),i(58,"div",25)(59,"div",26)(60,"div",32),b(),i(61,"svg",28),_(62,"path",33),n()(),w(),i(63,"div",29)(64,"p",30),o(65,"Pendientes"),n(),i(66,"p",31),o(67),n()()()(),i(68,"div",25)(69,"div",26)(70,"div",34),b(),i(71,"svg",28),_(72,"path",35),n()(),w(),i(73,"div",29)(74,"p",30),o(75,"Completadas"),n(),i(76,"p",31),o(77),n()()()(),i(78,"div",25)(79,"div",26)(80,"div",36),b(),i(81,"svg",28),_(82,"path",37),n()(),w(),i(83,"div",29)(84,"p",30),o(85,"Canceladas"),n(),i(86,"p",31),o(87),n()()()()(),f(88,tn,2,0,"div",38)(89,cn,17,4,"div",39)(90,bn,4,5,"div",40)(91,vn,7,0,"div",41),n(),f(92,wn,9,1,"div",42)(93,Cn,36,8,"div",42)),e&2&&(s(9),L("bg-white",a.mostrarVistaLista)("text-gray-900",a.mostrarVistaLista)("shadow-sm",a.mostrarVistaLista)("text-gray-500",!a.mostrarVistaLista),s(4),L("bg-white",a.mostrarVistaCalendario)("text-gray-900",a.mostrarVistaCalendario)("shadow-sm",a.mostrarVistaCalendario)("text-gray-500",!a.mostrarVistaCalendario),s(6),d("ngIf",a.puedeVerTodos),s(4),E("ngModel",a.filtros.estado),s(12),E("ngModel",a.filtros.tipo),s(22),y(a.estadisticas.totalSesiones),s(10),y(a.estadisticas.pendientes),s(10),y(a.estadisticas.completadas),s(10),y(a.estadisticas.canceladas),s(),d("ngIf",a.cargando),s(),d("ngIf",a.mostrarVistaCalendario&&!a.cargando),s(),d("ngIf",a.mostrarVistaLista&&!a.cargando),s(),d("ngIf",a.mostrarVistaCalendario&&!a.cargando&&a.sesiones.length===0),s(),d("ngIf",a.modalAbierto),s(),d("ngIf",a.modalDetalleAbierto))},dependencies:[B,z,H,W,G,$,Z,N,Re],styles:['.calendar-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.calendar-day[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.calendar-day[_ngcontent-%COMP%]:hover{background-color:#f9fafb;transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.calendar-day.today[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border:2px solid #3b82f6}.calendar-day.today[_ngcontent-%COMP%]:before{content:"";position:absolute;top:2px;right:2px;width:8px;height:8px;background:#3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1);opacity:1}50%{transform:scale(1.2);opacity:.7}to{transform:scale(1);opacity:1}}.session-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out;border-left:3px solid transparent}.session-card[_ngcontent-%COMP%]:hover{transform:scale(1.02);box-shadow:0 2px 8px #00000026}.session-card.pendiente[_ngcontent-%COMP%]{border-left-color:#f59e0b;background:linear-gradient(135deg,#fef3c7,#fde68a)}.session-card.completada[_ngcontent-%COMP%]{border-left-color:#10b981;background:linear-gradient(135deg,#d1fae5,#a7f3d0)}.modal-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out;margin:2rem auto!important;max-width:70vw!important;width:65vw!important;max-height:85vh!important;position:fixed!important;left:50%!important;top:5%!important;transform:translate(-50%)!important;z-index:1000!important}.modal-content-detalle[_ngcontent-%COMP%]{margin:1rem auto!important;max-width:60vw!important;width:55vw!important;max-height:85vh!important;position:fixed!important;left:50%!important;top:8%!important;transform:translate(-50%)!important;z-index:1000!important;padding:20px!important;overflow-y:auto!important}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translate(-50%) translateY(-30px) scale(.95)}to{opacity:1;transform:translate(-50%) translateY(0) scale(1)}}.stats-card[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.stats-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 25px #00000026}.stats-icon[_ngcontent-%COMP%]{transition:transform .3s ease-in-out}.stats-card[_ngcontent-%COMP%]:hover   .stats-icon[_ngcontent-%COMP%]{transform:scale(1.1) rotate(5deg)}.btn-calendar[_ngcontent-%COMP%]{position:relative;overflow:hidden;transition:all .3s ease-in-out}.btn-calendar[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.btn-calendar[_ngcontent-%COMP%]:hover:before{left:100%}.btn-calendar[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.calendar-loading[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:400px}.calendar-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid #e5e7eb;border-top:4px solid #3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.content-type-rutina[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border-left:4px solid #3b82f6}.content-type-terapia[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f3e8ff,#e9d5ff);border-left:4px solid #8b5cf6}.progress-indicator[_ngcontent-%COMP%]{position:relative;background:#e5e7eb;border-radius:10px;height:4px;overflow:hidden}.progress-bar[_ngcontent-%COMP%]{height:100%;border-radius:10px;transition:width .5s ease-in-out;background:linear-gradient(90deg,#10b981,#34d399)}.progress-bar.completed[_ngcontent-%COMP%]{background:linear-gradient(90deg,#10b981,#059669)}.progress-bar.in-progress[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f59e0b,#fbbf24)}.action-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out;position:relative;overflow:hidden}.action-button[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.action-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.user-avatar[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);transition:all .3s ease-in-out}.user-avatar[_ngcontent-%COMP%]:hover{transform:scale(1.1) rotate(5deg);box-shadow:0 4px 15px #0003}.calendar-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;background-color:#e5e7eb;border-radius:8px;overflow:hidden}.calendar-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#374151,#1f2937);color:#fff;font-weight:600;text-align:center;padding:12px 8px}.calendar-nav-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out;border-radius:8px}.calendar-nav-button[_ngcontent-%COMP%]:hover{background-color:#e5e7eb;transform:scale(1.1)}.calendar-nav-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.modal-section[_ngcontent-%COMP%]{border-radius:8px;border:1px solid #e5e7eb;transition:all .3s ease-in-out}.modal-section[_ngcontent-%COMP%]:hover{border-color:#3b82f6;box-shadow:0 4px 12px #3b82f626}.modal-section-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9);border-bottom:1px solid #e2e8f0}.exercise-tag[_ngcontent-%COMP%]{font-size:11px;font-weight:500;padding:4px 8px;border-radius:12px;transition:all .2s ease-in-out}.exercise-tag[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 2px 4px #0000001a}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:4px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.error-state[_ngcontent-%COMP%]{color:#dc2626;background-color:#fef2f2;border:1px solid #fecaca;border-radius:6px;padding:12px;margin:16px 0}.success-state[_ngcontent-%COMP%]{color:#059669;background-color:#f0fdf4;border:1px solid #bbf7d0;border-radius:6px;padding:12px;margin:16px 0}.list-item[_ngcontent-%COMP%]{transition:all .3s ease-in-out;border-left:4px solid transparent}.list-item[_ngcontent-%COMP%]:hover{border-left-color:#3b82f6;background:linear-gradient(90deg,#f8fafc,#fff);transform:translate(4px)}.loading-skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite;border-radius:4px}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}.focus-visible[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}.interactive-element[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none;transition:all .2s ease-in-out}.interactive-element[_ngcontent-%COMP%]:hover{opacity:.8}.interactive-element[_ngcontent-%COMP%]:active{transform:scale(.98)}@media (max-width: 1200px){.modal-content[_ngcontent-%COMP%]{width:90vw!important;margin:1.5rem auto!important}.modal-content-detalle[_ngcontent-%COMP%]{width:95vw!important;margin:1rem auto!important}}@media (max-width: 768px){.calendar-day[_ngcontent-%COMP%]{height:100px;padding:4px}.session-card[_ngcontent-%COMP%]{font-size:10px;padding:2px;margin-bottom:2px}.modal-content[_ngcontent-%COMP%]{width:95vw!important;margin:1rem auto!important;max-height:90vh!important}.modal-content-detalle[_ngcontent-%COMP%]{width:98vw!important;margin:.5rem auto!important;max-height:95vh!important}}@media (max-width: 480px){.calendar-day[_ngcontent-%COMP%]{height:60px;padding:1px}.session-card[_ngcontent-%COMP%]{font-size:8px;padding:1px 2px;margin-bottom:1px}.modal-content[_ngcontent-%COMP%]{margin:.5rem auto!important;width:98vw!important;max-height:95vh!important}.modal-content-detalle[_ngcontent-%COMP%]{margin:.25rem auto!important;width:99vw!important;max-height:98vh!important}}.fade-in-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .6s ease-out}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.terminal-container[_ngcontent-%COMP%]{background:#0d1117!important;border-radius:8px;overflow:hidden;box-shadow:0 8px 32px #0000004d;max-height:60vh!important;margin:0!important}.terminal-header[_ngcontent-%COMP%]{background:#21262d;padding:8px 16px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #30363d;flex-shrink:0}.terminal-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.terminal-button[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%}.terminal-button.red[_ngcontent-%COMP%]{background:#ff5f56}.terminal-button.yellow[_ngcontent-%COMP%]{background:#ffbd2e}.terminal-button.green[_ngcontent-%COMP%]{background:#27ca3f}.terminal-filename[_ngcontent-%COMP%]{color:#8b949e;font-size:12px;font-family:SF Mono,Monaco,Cascadia Code,Roboto Mono,monospace}.terminal-content[_ngcontent-%COMP%]{background:#0d1117;color:#58a6ff;font-family:SF Mono,Monaco,Cascadia Code,Roboto Mono,monospace;font-size:12px;line-height:1.4;padding:12px 16px;max-height:55vh;overflow-y:auto;white-space:pre-wrap;word-wrap:break-word}.modal-backdrop-custom[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#00000080;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);z-index:999}@media (prefers-color-scheme: dark){.calendar-day[_ngcontent-%COMP%]{background-color:#374151;color:#f9fafb;border-color:#4b5563}.calendar-day.today[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1e40af,#3b82f6)}.modal-content[_ngcontent-%COMP%]{background-color:#1f2937;color:#f9fafb}}.session-card.cancelada[_ngcontent-%COMP%]{border-left-color:#ef4444;background:linear-gradient(135deg,#fee2e2,#fecaca)}.more-sessions-indicator[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e5e7eb,#d1d5db);border:1px dashed #9ca3af;transition:all .2s ease-in-out}.more-sessions-indicator[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#d1d5db,#9ca3af);transform:scale(1.05)}@media (max-width: 768px){.calendar-day[_ngcontent-%COMP%]{height:100px;padding:4px}.session-card[_ngcontent-%COMP%]{font-size:10px;padding:2px;margin-bottom:2px}}@media (max-width: 640px){.calendar-day[_ngcontent-%COMP%]{height:80px;padding:2px}.session-card[_ngcontent-%COMP%]{font-size:9px;padding:1px}}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);transition:all .3s ease-in-out}.modal-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}']})};var Pn=[{path:"",component:Pe,canActivate:[Y],data:{title:"Lista de Paquetes"}},{path:"crear",component:pe,canActivate:[Y,ie],data:{profiles:[1,3],title:"Crear Paquete"}},{path:"editar/:id",component:pe,canActivate:[Y,ie],data:{profiles:[1,3],title:"Editar Paquete"}},{path:"detalle/:id",component:qe,canActivate:[Y],data:{profiles:[1,3],title:"Editar Paquete"}},{path:"asignar",component:ue,canActivate:[Y,ie],data:{profiles:[1,3],title:"Asignar Paquete"}},{path:"asignar/:id",component:ue,canActivate:[Y,ie],data:{profiles:[1,3],title:"Asignar Paquete Espec\xEDfico"}},{path:"asignaciones",component:me,canActivate:[Y,ie],data:{profiles:[1,3],title:"Gesti\xF3n de Asignaciones"}},{path:"asignaciones/detalle/:id",component:me,canActivate:[Y,ie],data:{profiles:[1,3],title:"Detalle de Asignaci\xF3n"}},{path:"calendario",component:Ee,canActivate:[Y],data:{title:"Calendario de Paquetes"}},{path:"**",redirectTo:""}],Me=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=be({type:r});static \u0275inj=_e({imports:[se.forChild(Pn),se]})};var Ze=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=be({type:r});static \u0275inj=_e({imports:[Ne,Qe,Je,se,Me]})};export{Ze as PaquetesModule};
