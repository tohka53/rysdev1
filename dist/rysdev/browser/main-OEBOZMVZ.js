import{a as Ye,b as Oe,c as je,d as ht}from"./chunk-KMBL3I2X.js";import{$ as De,A as F,Aa as ie,B as A,Ba as ne,C as n,Ca as re,D as r,Da as ke,E as u,Ea as Te,F as fe,Fa as ve,G as _e,H as w,Ha as Ot,I as _,Ia as Vt,J as c,Ja as Ft,K as Ct,Ka as He,Ma as qe,Na as be,O as Y,Oa as Dt,P as a,Pa as At,Q as C,Qa as xt,R as v,Ra as Q,S as N,Sa as L,T as St,V as E,W as k,X as T,Y as _t,Z as ue,_ as xe,a as Ne,aa as he,ba as Se,ca as Mt,ea as K,f as ze,fa as $,g as Ve,ga as z,h as Be,ha as R,i as Ce,ia as Ge,j as $e,k as p,l as g,la as Et,m as h,n as y,o as Fe,oa as kt,p as ge,pa as Tt,q as wt,qa as W,r as yt,ra as Me,s as l,sa as G,t as O,ta as ee,u as D,ua as se,v as We,va as H,w as x,wa as te,x as Re,xa as Ee,y as m,ya as Pt,z as X,za as It}from"./chunk-RWUPR6KW.js";import{a as ce,b as Ie,g as b}from"./chunk-6AOLKZEJ.js";function Nt(s,t){s&1&&(h(),n(0,"svg",13),u(1,"path",26)(2,"path",27),r())}function zt(s,t){s&1&&(h(),n(0,"svg",13),u(1,"path",28),r())}function Bt(s,t){if(s&1&&(n(0,"div",29)(1,"div",30),h(),n(2,"svg",31),u(3,"path",32),r(),y(),n(4,"span"),a(5),r()()()),s&2){let e=c();l(5),C(e.errorMessage)}}function $t(s,t){s&1&&(n(0,"span",33),h(),n(1,"svg",34),u(2,"path",35),r()())}var Qe=class s{constructor(t,e){this.authService=t;this.router=e;console.log("LoginComponent inicializado")}credentials={username:"",password:""};loading=!1;errorMessage="";showPassword=!1;onLogin(){return b(this,null,function*(){if(console.log("onLogin ejecutado"),!this.credentials.username||!this.credentials.password){this.errorMessage="Por favor complete todos los campos",console.log("Error: Campos vac\xEDos");return}this.loading=!0,this.errorMessage="";try{console.log("Intentando login con:",this.credentials.username);let t=yield this.authService.login(this.credentials);t.success?(console.log("Login exitoso, navegando a dashboard"),this.router.navigate(["/dashboard"])):(console.log("Login fall\xF3:",t.message),this.errorMessage=t.message)}catch(t){console.error("Error inesperado en login:",t),this.errorMessage="Error inesperado. Intente nuevamente."}finally{this.loading=!1}})}togglePasswordVisibility(){this.showPassword=!this.showPassword,console.log("Password visibility toggled:",this.showPassword)}goToRegister(){console.log("goToRegister ejecutado - navegando a /register");try{this.router.navigate(["/register"]),console.log("Navegaci\xF3n a /register iniciada")}catch(t){console.error("Error al navegar a register:",t)}}testNavigation(){console.log("Test navigation button clicked!"),alert("\xA1El bot\xF3n funciona! Navegando a register..."),this.goToRegister()}static \u0275fac=function(e){return new(e||s)(O(L),O(be))};static \u0275cmp=D({type:s,selectors:[["app-login"]],standalone:!1,decls:41,vars:9,consts:[[1,"login-container"],[1,"watermark"],["src","/rh.png","alt","RehabiMovement"],[1,"login-card"],[1,"login-header"],[1,"logo-container"],["src","/rh.png","alt","RehabiMovement",1,"main-logo"],[1,"login-form",3,"ngSubmit"],[1,"form-group"],["for","username"],[1,"input-container"],["id","username","name","username","type","text","autocomplete","username","required","","placeholder","Ingresa tu usuario",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-icon"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["for","password"],["id","password","name","password","autocomplete","current-password","required","","placeholder","Ingresa tu contrase\xF1a",1,"form-control",3,"ngModelChange","type","ngModel"],["type","button",1,"password-toggle",3,"click"],["class","icon","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","error-message",4,"ngIf"],["type","submit",1,"btn-primary",3,"disabled"],["class","loading-spinner",4,"ngIf"],[1,"btn-text"],[1,"toggle-mode"],["type","button",1,"link-btn",3,"click"],[1,"login-footer"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"],[1,"error-message"],[1,"error-content"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"error-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"loading-spinner"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"spinner"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1),u(2,"img",2),r(),n(3,"div",3)(4,"div",4)(5,"div",5),u(6,"img",6),r(),n(7,"h2"),a(8,"Iniciar Sesi\xF3n"),r(),n(9,"p"),a(10,"Ingresa a RehabiMovement"),r()(),n(11,"form",7),_("ngSubmit",function(){return i.onLogin()}),n(12,"div",8)(13,"label",9),a(14,"Nombre de Usuario"),r(),n(15,"div",10)(16,"input",11),T("ngModelChange",function(d){return k(i.credentials.username,d)||(i.credentials.username=d),d}),r(),n(17,"div",12),h(),n(18,"svg",13),u(19,"path",14),r()()()(),y(),n(20,"div",8)(21,"label",15),a(22,"Contrase\xF1a"),r(),n(23,"div",10)(24,"input",16),T("ngModelChange",function(d){return k(i.credentials.password,d)||(i.credentials.password=d),d}),r(),n(25,"button",17),_("click",function(){return i.togglePasswordVisibility()}),x(26,Nt,3,0,"svg",18)(27,zt,2,0,"svg",18),r()()(),x(28,Bt,6,1,"div",19),n(29,"button",20),x(30,$t,3,0,"span",21),n(31,"span",22),a(32),r()()(),n(33,"div",23)(34,"p"),a(35," \xBFNo tienes cuenta? "),n(36,"button",24),_("click",function(){return i.goToRegister()}),a(37," Reg\xEDstrate aqu\xED "),r()()(),n(38,"div",25)(39,"p"),a(40,"\xA9 2025 RehabiMovement - Sistema de Gesti\xF3n"),r()()()()),e&2&&(l(16),E("ngModel",i.credentials.username),l(8),m("type",i.showPassword?"text":"password"),E("ngModel",i.credentials.password),l(2),m("ngIf",!i.showPassword),l(),m("ngIf",i.showPassword),l(),m("ngIf",i.errorMessage),l(),m("disabled",i.loading),l(),m("ngIf",i.loading),l(2),v(" ",i.loading?"Iniciando sesi\xF3n...":"Iniciar Sesi\xF3n"," "))},dependencies:[R,te,W,G,ee,ve,H,se],styles:['.login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#f5f7fa,#c3cfe2);padding:20px;position:relative;overflow:hidden}.watermark[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:0;opacity:.15;pointer-events:none;filter:grayscale(20%) blur(.5px)}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:900px;height:auto;max-width:95vw}.watermark-secondary[_ngcontent-%COMP%]{position:absolute;top:30%;right:15%;transform:translate(50%,-50%) rotate(15deg);z-index:0;opacity:.08;pointer-events:none;filter:grayscale(40%) blur(1px)}.watermark-secondary[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:400px;height:auto;max-width:50vw}.login-card[_ngcontent-%COMP%]{background:#ffffffeb;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);border-radius:20px;padding:40px;box-shadow:0 25px 50px #00000026,0 0 0 1px #ffffff4d;width:100%;max-width:420px;position:relative;z-index:1;border:1px solid rgba(255,255,255,.4)}.login-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:35px}.logo-container[_ngcontent-%COMP%]{margin-bottom:20px}.main-logo[_ngcontent-%COMP%]{width:80px;height:80px;object-fit:contain;filter:drop-shadow(0 4px 8px rgba(0,0,0,.1))}.login-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2d3748;margin-bottom:8px;font-size:32px;font-weight:700;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.login-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#718096;margin:0;font-size:16px;font-weight:500}.login-form[_ngcontent-%COMP%]{margin-bottom:30px}.form-group[_ngcontent-%COMP%]{margin-bottom:25px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#2d3748;font-weight:600;font-size:14px;letter-spacing:.025em}.input-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.form-control[_ngcontent-%COMP%]{width:100%;padding:16px 50px 16px 16px;border:2px solid #e2e8f0;border-radius:12px;font-size:16px;transition:all .3s ease;box-sizing:border-box;background:#fffc}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a;background:#fff}.form-control[_ngcontent-%COMP%]::placeholder{color:#a0aec0;font-weight:400}.input-icon[_ngcontent-%COMP%]{position:absolute;right:16px;top:50%;transform:translateY(-50%);pointer-events:none}.password-toggle[_ngcontent-%COMP%]{position:absolute;right:16px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;padding:4px;border-radius:6px;transition:background-color .2s ease}.password-toggle[_ngcontent-%COMP%]:hover{background-color:#667eea1a}.icon[_ngcontent-%COMP%]{width:20px;height:20px;color:#a0aec0;transition:color .2s ease}.password-toggle[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{color:#667eea}.error-message[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fee,#fef0f0);border:1px solid #fed7d7;color:#e53e3e;padding:16px;border-radius:12px;margin-bottom:20px;font-size:14px;font-weight:500}.error-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.error-icon[_ngcontent-%COMP%]{width:20px;height:20px;flex-shrink:0}.btn-primary[_ngcontent-%COMP%]{width:100%;padding:18px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center;gap:10px}.btn-primary[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s ease}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled):before{left:100%}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 10px 25px #667eea66}.btn-primary[_ngcontent-%COMP%]:active{transform:translateY(0)}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed;transform:none}.loading-spinner[_ngcontent-%COMP%]{display:flex;align-items:center}.spinner[_ngcontent-%COMP%]{width:20px;height:20px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.btn-text[_ngcontent-%COMP%]{font-weight:600}.toggle-mode[_ngcontent-%COMP%]{text-align:center;margin-top:30px;padding-top:25px;border-top:1px solid rgba(226,232,240,.8)}.toggle-mode[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#718096;font-size:14px;font-weight:500}.link-btn[_ngcontent-%COMP%]{background:none;border:none;color:#667eea;cursor:pointer;font-weight:600;text-decoration:none;margin-left:4px;padding:2px 4px;border-radius:4px;transition:all .2s ease}.link-btn[_ngcontent-%COMP%]:hover{color:#5a67d8;background-color:#667eea1a}.login-footer[_ngcontent-%COMP%]{text-align:center;margin-top:25px;padding-top:20px;border-top:1px solid rgba(226,232,240,.5)}.login-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#a0aec0;font-size:12px;font-weight:500}@media (max-width: 480px){.login-container[_ngcontent-%COMP%]{padding:15px}.login-card[_ngcontent-%COMP%]{padding:30px 25px;border-radius:16px}.main-logo[_ngcontent-%COMP%]{width:60px;height:60px}.login-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:28px}.form-control[_ngcontent-%COMP%]{padding:14px 45px 14px 14px;font-size:16px}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:700px}.watermark-secondary[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px}}@media (max-width: 320px){.login-card[_ngcontent-%COMP%]{padding:25px 20px}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:500px}.watermark-secondary[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.login-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .6s ease-out}.form-control[_ngcontent-%COMP%]:hover{border-color:#cbd5e0}.form-control[_ngcontent-%COMP%]:focus + .input-icon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{color:#667eea}.form-control.error[_ngcontent-%COMP%]{border-color:#e53e3e;box-shadow:0 0 0 3px #e53e3e1a}.form-control.success[_ngcontent-%COMP%]{border-color:#38a169;box-shadow:0 0 0 3px #38a1691a}']})};function Wt(s,t){s&1&&(h(),n(0,"svg",30),u(1,"path",31)(2,"path",32),r())}function Gt(s,t){s&1&&(h(),n(0,"svg",30),u(1,"path",33),r())}function Ht(s,t){s&1&&(h(),n(0,"svg",30),u(1,"path",31)(2,"path",32),r())}function qt(s,t){s&1&&(h(),n(0,"svg",30),u(1,"path",33),r())}function Yt(s,t){if(s&1&&(n(0,"div",34)(1,"div",35),h(),n(2,"svg",36),u(3,"path",37),r(),y(),n(4,"div",38)(5,"p",39),a(6),r()()()()),s&2){let e=c();l(6),C(e.errorMessage)}}function Qt(s,t){if(s&1&&(n(0,"div",40)(1,"div",35),h(),n(2,"svg",41),u(3,"path",42),r(),y(),n(4,"div",38)(5,"p",43),a(6),r()()()()),s&2){let e=c();l(6),C(e.successMessage)}}function Jt(s,t){s&1&&(n(0,"span",44),h(),n(1,"svg",45),u(2,"path",46),r()())}var Je=class s{constructor(t,e){this.authService=t;this.router=e;console.log("RegisterComponent inicializado")}user={username:"",full_name:"",password:"",status:1,id_perfil:2};confirmPassword="";loading=!1;errorMessage="";successMessage="";showPassword=!1;showConfirmPassword=!1;onRegister(){return b(this,null,function*(){if(console.log("onRegister llamado"),console.log("Datos del formulario:",this.user),this.errorMessage="",this.successMessage="",!this.user.username||!this.user.full_name||!this.user.password||!this.confirmPassword){this.errorMessage="Por favor complete todos los campos",console.log("Error: Campos vac\xEDos");return}if(this.user.password!==this.confirmPassword){this.errorMessage="Las contrase\xF1as no coinciden",console.log("Error: Contrase\xF1as no coinciden");return}if(this.user.password.length<6){this.errorMessage="La contrase\xF1a debe tener al menos 6 caracteres",console.log("Error: Contrase\xF1a muy corta");return}if(this.user.username.length<3){this.errorMessage="El nombre de usuario debe tener al menos 3 caracteres",console.log("Error: Username muy corto");return}if(this.user.username.includes(" ")){this.errorMessage="El nombre de usuario no puede contener espacios",console.log("Error: Username con espacios");return}if(!/^[a-zA-Z0-9_.-]+$/.test(this.user.username)){this.errorMessage="El nombre de usuario solo puede contener letras, n\xFAmeros, guiones, puntos y guiones bajos",console.log("Error: Username con caracteres inv\xE1lidos");return}this.loading=!0,console.log("Iniciando proceso de registro...");try{let e=yield this.authService.register(this.user);console.log("Resultado del registro:",e),e.success?(this.successMessage="Usuario creado exitosamente. Redirigiendo al login...",console.log("Registro exitoso, redirigiendo..."),this.user={username:"",full_name:"",password:"",status:1,id_perfil:2},this.confirmPassword="",setTimeout(()=>{this.router.navigate(["/login"])},2e3)):(this.errorMessage=e.message,console.log("Error en registro:",e.message))}catch(e){console.error("Error inesperado:",e),this.errorMessage="Error inesperado. Intente nuevamente."}finally{this.loading=!1}})}togglePasswordVisibility(){this.showPassword=!this.showPassword,console.log("Password visibility toggled:",this.showPassword)}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword,console.log("Confirm password visibility toggled:",this.showConfirmPassword)}goToLogin(){console.log("Navegando a login"),this.router.navigate(["/login"])}testButton(){console.log("Test button clicked!"),console.log("Current user data:",this.user),console.log("Confirm password:",this.confirmPassword)}static \u0275fac=function(e){return new(e||s)(O(L),O(be))};static \u0275cmp=D({type:s,selectors:[["app-register"]],standalone:!1,decls:53,vars:15,consts:[["registerForm","ngForm"],[1,"min-h-screen","bg-gradient-to-br","from-green-50","to-teal-100","flex","items-center","justify-center","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8"],[1,"text-center"],[1,"mx-auto","h-12","w-12","bg-green-600","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"],[1,"mt-6","text-3xl","font-extrabold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"bg-white","rounded-lg","shadow-xl","p-8"],[1,"space-y-6",3,"ngSubmit"],["for","fullName",1,"block","text-sm","font-medium","text-gray-700"],[1,"mt-1","relative"],["id","fullName","name","fullName","type","text","autocomplete","name","required","","placeholder","Ingresa tu nombre completo",1,"appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-green-500","focus:border-green-500","focus:z-10","sm:text-sm",3,"ngModelChange","ngModel"],["for","username",1,"block","text-sm","font-medium","text-gray-700"],["id","username","name","username","type","text","autocomplete","username","required","","placeholder","Elige un nombre de usuario",1,"appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-green-500","focus:border-green-500","focus:z-10","sm:text-sm",3,"ngModelChange","ngModel"],["for","password",1,"block","text-sm","font-medium","text-gray-700"],["id","password","name","password","autocomplete","new-password","required","","placeholder","Crea una contrase\xF1a",1,"appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-green-500","focus:border-green-500","focus:z-10","sm:text-sm","pr-10",3,"ngModelChange","type","ngModel"],["type","button",1,"absolute","inset-y-0","right-0","pr-3","flex","items-center",3,"click"],["class","h-5 w-5 text-gray-400","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["for","confirmPassword",1,"block","text-sm","font-medium","text-gray-700"],["id","confirmPassword","name","confirmPassword","autocomplete","new-password","required","","placeholder","Confirma tu contrase\xF1a",1,"appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-green-500","focus:border-green-500","focus:z-10","sm:text-sm","pr-10",3,"ngModelChange","type","ngModel"],["class","bg-red-50 border border-red-200 rounded-md p-4",4,"ngIf"],["class","bg-green-50 border border-green-200 rounded-md p-4",4,"ngIf"],[1,"flex","space-x-2"],["type","button",1,"flex-1","bg-yellow-500","text-white","py-2","px-4","rounded","text-sm",3,"click"],["type","submit",1,"group","relative","w-full","flex","justify-center","py-2","px-4","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-green-600","hover:bg-green-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-green-500","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors","duration-200",3,"disabled"],["class","absolute left-0 inset-y-0 flex items-center pl-3",4,"ngIf"],[1,"text-sm","text-gray-600"],["type","button",1,"font-medium","text-green-600","hover:text-green-500","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"bg-green-50","border","border-green-200","rounded-md","p-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-green-700"],[1,"absolute","left-0","inset-y-0","flex","items-center","pl-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-green-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"]],template:function(e,i){if(e&1){let o=w();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),h(),n(4,"svg",5),u(5,"path",6),r()(),y(),n(6,"h2",7),a(7," Crear Cuenta "),r(),n(8,"p",8),a(9," Reg\xEDstrate para comenzar "),r()(),n(10,"div",9)(11,"form",10,0),_("ngSubmit",function(){return p(o),g(i.onRegister())}),n(13,"div")(14,"label",11),a(15," Nombre Completo "),r(),n(16,"div",12)(17,"input",13),T("ngModelChange",function(f){return p(o),k(i.user.full_name,f)||(i.user.full_name=f),g(f)}),r()()(),n(18,"div")(19,"label",14),a(20," Nombre de Usuario "),r(),n(21,"div",12)(22,"input",15),T("ngModelChange",function(f){return p(o),k(i.user.username,f)||(i.user.username=f),g(f)}),r()()(),n(23,"div")(24,"label",16),a(25," Contrase\xF1a "),r(),n(26,"div",12)(27,"input",17),T("ngModelChange",function(f){return p(o),k(i.user.password,f)||(i.user.password=f),g(f)}),r(),n(28,"button",18),_("click",function(){return p(o),g(i.togglePasswordVisibility())}),x(29,Wt,3,0,"svg",19)(30,Gt,2,0,"svg",19),r()()(),n(31,"div")(32,"label",20),a(33," Confirmar Contrase\xF1a "),r(),n(34,"div",12)(35,"input",21),T("ngModelChange",function(f){return p(o),k(i.confirmPassword,f)||(i.confirmPassword=f),g(f)}),r(),n(36,"button",18),_("click",function(){return p(o),g(i.toggleConfirmPasswordVisibility())}),x(37,Ht,3,0,"svg",19)(38,qt,2,0,"svg",19),r()()(),x(39,Yt,7,1,"div",22)(40,Qt,7,1,"div",23),n(41,"div",24)(42,"button",25),_("click",function(){return p(o),g(i.onRegister())}),a(43," Test onRegister() "),r()(),n(44,"div")(45,"button",26),x(46,Jt,3,0,"span",27),a(47),r()(),n(48,"div",3)(49,"p",28),a(50," \xBFYa tienes cuenta? "),n(51,"button",29),_("click",function(){return p(o),g(i.goToLogin())}),a(52," Inicia sesi\xF3n aqu\xED "),r()()()()()()()}e&2&&(l(17),E("ngModel",i.user.full_name),l(5),E("ngModel",i.user.username),l(5),m("type",i.showPassword?"text":"password"),E("ngModel",i.user.password),l(2),m("ngIf",!i.showPassword),l(),m("ngIf",i.showPassword),l(5),m("type",i.showConfirmPassword?"text":"password"),E("ngModel",i.confirmPassword),l(2),m("ngIf",!i.showConfirmPassword),l(),m("ngIf",i.showConfirmPassword),l(),m("ngIf",i.errorMessage),l(),m("ngIf",i.successMessage),l(5),m("disabled",i.loading),l(),m("ngIf",i.loading),l(),v(" ",i.loading?"Creando cuenta...":"Crear Cuenta"," "))},dependencies:[R,te,W,G,ee,ve,H,se],encapsulation:2})};function Zt(s,t){s&1&&(h(),n(0,"svg",22),u(1,"path",35),r())}function Xt(s,t){s&1&&(h(),n(0,"svg",22),u(1,"path",36),r())}function Kt(s,t){if(s&1){let e=w();n(0,"button",37),_("click",function(){let o=p(e).index,d=c();return g(d.goToQuote(o))}),r()}if(s&2){let e=t.$implicit,i=t.index,o=c();F("active",i===o.currentQuoteIndex),m("title",e.category+": "+e.text.substring(0,50)+"...")}}function ei(s,t){if(s&1){let e=w();n(0,"div",42),_("click",function(){let o=p(e).index,d=c(2);return g(d.goToQuote(o))}),n(1,"div",43),a(2),r(),n(3,"div",44),a(4),r(),n(5,"div",45),a(6),r()()}if(s&2){let e=t.$implicit,i=t.index,o=c(2);F("current",i===o.currentQuoteIndex),l(2),C(e.category),l(2),v("",e.text.substring(0,80),"..."),l(2),C(e.author)}}function ti(s,t){if(s&1&&(n(0,"div",38)(1,"h4",39),a(2,"Otras frases motivacionales:"),r(),n(3,"div",40),x(4,ei,7,5,"div",41),r()()),s&2){let e=c();l(4),m("ngForOf",e.motivationalQuotes.slice(0,6))}}var Ze=class s{currentQuoteIndex=0;isAutoRotating=!0;intervalId;ROTATION_INTERVAL=12*60*60*1e3;motivationalQuotes=[{text:"Cada paso que das en tu rehabilitaci\xF3n es un paso hacia una vida mejor.",author:"RehabiMovement",category:"Progreso"},{text:"La fortaleza no viene de la capacidad f\xEDsica, sino de una voluntad indomable.",author:"Mahatma Gandhi",category:"Fortaleza"},{text:"No importa cu\xE1n lento vayas, siempre y cuando no te detengas.",author:"Confucio",category:"Perseverancia"},{text:"Tu recuperaci\xF3n no es una carrera, es un viaje. Disfruta cada momento de progreso.",author:"RehabiMovement",category:"Paciencia"},{text:"El dolor es temporal, pero rendirse dura para siempre.",author:"Lance Armstrong",category:"Resistencia"},{text:"Cada ejercicio que haces hoy es una inversi\xF3n en tu futuro yo.",author:"RehabiMovement",category:"Futuro"},{text:"La diferencia entre lo imposible y lo posible radica en la determinaci\xF3n.",author:"Tommy Lasorda",category:"Determinaci\xF3n"},{text:"Tu cuerpo puede hacerlo. Es tu mente la que tienes que convencer.",author:"Motivaci\xF3n Fitness",category:"Mentalidad"},{text:"No se trata de ser perfecto, se trata de ser mejor que ayer.",author:"RehabiMovement",category:"Mejora"},{text:"La rehabilitaci\xF3n es el arte de transformar limitaciones en oportunidades.",author:"RehabiMovement",category:"Transformaci\xF3n"},{text:"Cada d\xEDa sin desistir es una victoria en s\xED misma.",author:"Motivaci\xF3n Personal",category:"Victoria"},{text:"Tu fuerza interior es m\xE1s poderosa que cualquier obst\xE1culo externo.",author:"RehabiMovement",category:"Fuerza Interior"},{text:"El \xE9xito es la suma de peque\xF1os esfuerzos repetidos d\xEDa tras d\xEDa.",author:"Robert Collier",category:"\xC9xito"},{text:"No mires atr\xE1s, no vas en esa direcci\xF3n. Enf\xF3cate en tu progreso.",author:"RehabiMovement",category:"Enfoque"},{text:"La sanaci\xF3n es un proceso, no un destino. Celebra cada peque\xF1o avance.",author:"RehabiMovement",category:"Sanaci\xF3n"},{text:"Tu dedicaci\xF3n de hoy ser\xE1 tu fuerza de ma\xF1ana.",author:"RehabiMovement",category:"Dedicaci\xF3n"},{text:"Los campeones siguen jugando hasta que lo hacen bien.",author:"Billie Jean King",category:"Persistencia"},{text:"La recuperaci\xF3n requiere valent\xEDa para enfrentar tus miedos y seguir adelante.",author:"RehabiMovement",category:"Valent\xEDa"},{text:"Cada sesi\xF3n de terapia es una inversi\xF3n en tu independencia futura.",author:"RehabiMovement",category:"Independencia"},{text:"Cree en ti mismo y en tu capacidad de superar cualquier desaf\xEDo.",author:"RehabiMovement",category:"Autoconfianza"}];ngOnInit(){this.loadSavedState(),this.startAutoRotation()}ngOnDestroy(){this.stopAutoRotation()}loadSavedState(){try{let t=localStorage.getItem("motivational-quote-index"),e=localStorage.getItem("motivational-quote-last-update");t&&e&&(Date.now()-parseInt(e)>=this.ROTATION_INTERVAL?this.nextQuote():this.currentQuoteIndex=parseInt(t))}catch(t){console.error("Error loading saved state:",t)}}saveState(){try{localStorage.setItem("motivational-quote-index",this.currentQuoteIndex.toString()),localStorage.setItem("motivational-quote-last-update",Date.now().toString())}catch(t){console.error("Error saving state:",t)}}startAutoRotation(){this.isAutoRotating&&(this.intervalId=setInterval(()=>{this.nextQuote()},this.ROTATION_INTERVAL))}stopAutoRotation(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}get currentQuote(){return this.motivationalQuotes[this.currentQuoteIndex]}nextQuote(){this.currentQuoteIndex=(this.currentQuoteIndex+1)%this.motivationalQuotes.length,this.saveState()}previousQuote(){this.currentQuoteIndex=this.currentQuoteIndex===0?this.motivationalQuotes.length-1:this.currentQuoteIndex-1,this.saveState()}goToQuote(t){t>=0&&t<this.motivationalQuotes.length&&(this.currentQuoteIndex=t,this.saveState())}toggleAutoRotation(){this.isAutoRotating=!this.isAutoRotating,this.isAutoRotating?this.startAutoRotation():this.stopAutoRotation()}getTimeUntilNextUpdate(){try{let t=localStorage.getItem("motivational-quote-last-update");if(!t)return"No disponible";let e=Date.now()-parseInt(t),i=this.ROTATION_INTERVAL-e;if(i<=0)return"Pr\xF3ximamente";let o=Math.floor(i/(60*60*1e3)),d=Math.floor(i%(60*60*1e3)/(60*1e3));return`${o}h ${d}m`}catch{return"No disponible"}}forceUpdate(){this.nextQuote(),this.stopAutoRotation(),this.isAutoRotating&&this.startAutoRotation()}getProgressPercentage(){return(this.currentQuoteIndex+1)/this.motivationalQuotes.length*100}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=D({type:s,selectors:[["app-motivational-quotes"]],standalone:!1,decls:46,vars:15,consts:[[1,"motivational-quotes-container"],[1,"watermark"],["src","/rh.png","alt","RehabiMovement"],[1,"quote-card"],[1,"quote-header"],[1,"quote-category"],[1,"category-badge"],[1,"quote-controls"],[1,"progress-indicator"],[1,"progress-text"],[1,"progress-bar"],[1,"progress-fill"],[1,"auto-rotation-btn",3,"click","title"],["class","icon","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"quote-content"],[1,"quote-icon"],["fill","currentColor","viewBox","0 0 24 24",1,"icon"],["d","M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h4v10h-10z"],[1,"quote-text"],[1,"quote-author"],[1,"quote-navigation"],["title","Frase anterior",1,"nav-btn","prev-btn",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"nav-info"],[1,"next-update-info"],[1,"update-label"],[1,"update-time"],["title","Cambiar frase ahora",1,"force-update-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["title","Siguiente frase",1,"nav-btn","next-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"quote-dots"],["class","dot",3,"active","title","click",4,"ngFor","ngForOf"],["class","preview-cards",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"dot",3,"click","title"],[1,"preview-cards"],[1,"preview-title"],[1,"preview-grid"],["class","preview-card",3,"current","click",4,"ngFor","ngForOf"],[1,"preview-card",3,"click"],[1,"preview-category"],[1,"preview-text"],[1,"preview-author"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1),u(2,"img",2),r(),n(3,"div",3)(4,"div",4)(5,"div",5)(6,"span",6),a(7),r()(),n(8,"div",7)(9,"div",8)(10,"span",9),a(11),r(),n(12,"div",10),u(13,"div",11),r()(),n(14,"button",12),_("click",function(){return i.toggleAutoRotation()}),x(15,Zt,2,0,"svg",13)(16,Xt,2,0,"svg",13),r()()(),n(17,"div",14)(18,"div",15),h(),n(19,"svg",16),u(20,"path",17),r()(),y(),n(21,"blockquote",18),a(22),r(),n(23,"div",19)(24,"cite"),a(25),r()()(),n(26,"div",20)(27,"button",21),_("click",function(){return i.previousQuote()}),h(),n(28,"svg",22),u(29,"path",23),r()(),y(),n(30,"div",24)(31,"div",25)(32,"span",26),a(33,"Pr\xF3xima actualizaci\xF3n autom\xE1tica:"),r(),n(34,"span",27),a(35),r()(),n(36,"button",28),_("click",function(){return i.forceUpdate()}),h(),n(37,"svg",22),u(38,"path",29),r(),a(39," Cambiar ahora "),r()(),y(),n(40,"button",30),_("click",function(){return i.nextQuote()}),h(),n(41,"svg",22),u(42,"path",31),r()()()(),y(),n(43,"div",32),x(44,Kt,1,3,"button",33),r(),x(45,ti,5,1,"div",34),r()),e&2&&(l(7),C(i.currentQuote.category),l(4),N("",i.currentQuoteIndex+1,"/",i.motivationalQuotes.length,""),l(2),X("width",i.getProgressPercentage(),"%"),l(),F("active",i.isAutoRotating),Ct("title",i.isAutoRotating?"Desactivar rotaci\xF3n autom\xE1tica":"Activar rotaci\xF3n autom\xE1tica"),l(),m("ngIf",i.isAutoRotating),l(),m("ngIf",!i.isAutoRotating),l(6),v(" ",i.currentQuote.text," "),l(3),v("- ",i.currentQuote.author,""),l(10),C(i.getTimeUntilNextUpdate()),l(9),m("ngForOf",i.motivationalQuotes),l(),m("ngIf",i.motivationalQuotes.length>0))},dependencies:[z,R],styles:['.motivational-quotes-container[_ngcontent-%COMP%]{position:relative;width:100%;min-height:600px;padding:30px;overflow:hidden;background:linear-gradient(135deg,#fcfcfd,#f8fafc);border-radius:24px;box-shadow:0 20px 40px #00000014}.watermark[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:0;opacity:.3;pointer-events:none;filter:grayscale(10%) blur(.2px);width:100%;height:100%;display:flex;align-items:center;justify-content:center}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:700px;height:auto;max-width:90vw;object-fit:contain}.quote-card[_ngcontent-%COMP%]{position:relative;z-index:1;background:#ffffffb3;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);border-radius:28px;padding:40px;box-shadow:0 15px 30px #00000008,0 0 0 1px #fff6;border:1px solid rgba(255,255,255,.5);max-width:900px;margin:0 auto;transition:all .3s ease;animation:_ngcontent-%COMP%_fadeInUp .6s ease-out;overflow:hidden}.quote-card[_ngcontent-%COMP%]:hover{transform:translateY(-6px);background:#fffc;box-shadow:0 25px 50px #0000000d,0 0 0 1px #fff9}.quote-card[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background-image:url(/rh.png);background-size:200px auto;background-position:center;background-repeat:no-repeat;opacity:.12;z-index:-1;pointer-events:none;filter:grayscale(20%) blur(.1px)}.quote-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;position:relative;z-index:2}.quote-category[_ngcontent-%COMP%]{display:flex;align-items:center}.category-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:8px 16px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;box-shadow:0 4px 12px #667eea4d}.quote-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.progress-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.progress-text[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#6b7280;min-width:40px}.progress-bar[_ngcontent-%COMP%]{width:80px;height:4px;background:#e5e7ebcc;border-radius:2px;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(135deg,#667eea,#764ba2);transition:width .3s ease;border-radius:2px}.auto-rotation-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:36px;height:36px;background:#f3f4f6cc;border:none;border-radius:8px;cursor:pointer;transition:all .2s ease;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px)}.auto-rotation-btn[_ngcontent-%COMP%]:hover{background:#e5e7ebe6;transform:scale(1.05)}.auto-rotation-btn.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;box-shadow:0 4px 12px #667eea4d}.auto-rotation-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:18px;height:18px}.quote-content[_ngcontent-%COMP%]{text-align:center;margin-bottom:36px;position:relative;z-index:2}.quote-icon[_ngcontent-%COMP%]{margin-bottom:24px;position:relative;z-index:2}.quote-icon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:56px;height:56px;color:#fbbf24;filter:drop-shadow(0 6px 12px rgba(251,191,36,.4))}.quote-text[_ngcontent-%COMP%]{font-size:28px;line-height:1.6;font-weight:500;color:#1f2937;margin-bottom:24px;font-style:italic;position:relative;text-shadow:0 1px 2px rgba(0,0,0,.05);z-index:2}.quote-author[_ngcontent-%COMP%]{margin-top:16px;position:relative;z-index:2}.quote-author[_ngcontent-%COMP%]   cite[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;font-weight:500;font-style:normal}.quote-navigation[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:20px;padding-top:24px;border-top:1px solid rgba(229,231,235,.6);position:relative;z-index:2}.nav-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:44px;height:44px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:50%;cursor:pointer;transition:all .2s ease;box-shadow:0 4px 12px #667eea4d}.nav-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #667eea66}.nav-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:20px;height:20px}.nav-info[_ngcontent-%COMP%]{flex:1;text-align:center}.next-update-info[_ngcontent-%COMP%]{margin-bottom:12px}.update-label[_ngcontent-%COMP%]{display:block;font-size:12px;color:#6b7280;margin-bottom:4px}.update-time[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#374151}.force-update-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:8px 16px;background:#f3f4f6cc;border:1px solid rgba(209,213,219,.7);border-radius:8px;font-size:12px;font-weight:500;color:#374151;cursor:pointer;transition:all .2s ease;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px)}.force-update-btn[_ngcontent-%COMP%]:hover{background:#e5e7ebe6;transform:translateY(-1px)}.force-update-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:14px;height:14px}.quote-dots[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:8px;margin-top:24px;padding:16px}.dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#d1d5dbcc;border:none;cursor:pointer;transition:all .2s ease}.dot[_ngcontent-%COMP%]:hover{background:#9ca3af;transform:scale(1.2)}.dot.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);transform:scale(1.3);box-shadow:0 2px 8px #667eea66}.preview-cards[_ngcontent-%COMP%]{margin-top:50px;position:relative;z-index:1}.preview-title[_ngcontent-%COMP%]{text-align:center;font-size:20px;font-weight:600;color:#374151;margin-bottom:24px}.preview-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;max-width:900px;margin:0 auto}.preview-card[_ngcontent-%COMP%]{background:#fffc;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.6);border-radius:16px;padding:20px;cursor:pointer;transition:all .3s ease;position:relative;overflow:hidden}.preview-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 12px 24px #00000014;background:#ffffffe6}.preview-card.current[_ngcontent-%COMP%]{border-color:#667eea;box-shadow:0 0 0 2px #667eea33;background:#ffffffe6}.preview-category[_ngcontent-%COMP%]{font-size:10px;font-weight:600;color:#667eea;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px}.preview-text[_ngcontent-%COMP%]{font-size:13px;line-height:1.4;color:#374151;margin-bottom:8px}.preview-author[_ngcontent-%COMP%]{font-size:11px;color:#6b7280;font-style:italic}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.7}}.quote-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .6s ease-out}@media (max-width: 768px){.motivational-quotes-container[_ngcontent-%COMP%]{padding:20px;min-height:500px}.watermark[_ngcontent-%COMP%]{opacity:.4}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:450px;min-width:350px}.quote-card[_ngcontent-%COMP%]{padding:28px;border-radius:20px;background:#fff9}.quote-card[_ngcontent-%COMP%]:hover{background:#ffffffb3}.quote-card[_ngcontent-%COMP%]:before{background-size:160px auto;opacity:.16}.quote-text[_ngcontent-%COMP%]{font-size:22px}.quote-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;align-items:stretch}.quote-controls[_ngcontent-%COMP%]{justify-content:center}.quote-navigation[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.nav-info[_ngcontent-%COMP%]{order:-1}.preview-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 480px){.motivational-quotes-container[_ngcontent-%COMP%]{padding:16px}.watermark[_ngcontent-%COMP%]{opacity:.45}.watermark[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:350px;min-width:280px}.quote-card[_ngcontent-%COMP%]{padding:24px;background:#ffffff8c;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px)}.quote-card[_ngcontent-%COMP%]:hover{background:#ffffffa6}.quote-card[_ngcontent-%COMP%]:before{background-size:140px auto;opacity:.18}.quote-text[_ngcontent-%COMP%]{font-size:20px}.quote-dots[_ngcontent-%COMP%]{gap:6px}.dot[_ngcontent-%COMP%]{width:6px;height:6px}.category-badge[_ngcontent-%COMP%], .nav-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eeae6,#764ba2e6)}.auto-rotation-btn[_ngcontent-%COMP%]{background:#f3f4f6b3}.force-update-btn[_ngcontent-%COMP%]{background:#f3f4f6b3;border:1px solid rgba(209,213,219,.6)}}@media (prefers-color-scheme: dark){.motivational-quotes-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563)}.watermark[_ngcontent-%COMP%]{opacity:.18;filter:grayscale(20%) blur(.2px) invert(.1)}.quote-card[_ngcontent-%COMP%]{background:#6b7280b3;border-color:#9ca3af4d;box-shadow:0 15px 30px #00000026,0 0 0 1px #9ca3af33}.quote-card[_ngcontent-%COMP%]:hover{background:#6b7280cc}.quote-card[_ngcontent-%COMP%]:before{opacity:.08;filter:grayscale(30%) blur(.1px) invert(.1)}.quote-text[_ngcontent-%COMP%]{color:#f9fafb}.quote-author[_ngcontent-%COMP%]   cite[_ngcontent-%COMP%]{color:#d1d5db}.preview-card[_ngcontent-%COMP%]{background:#6b7280a6;border-color:#9ca3af4d}.preview-card[_ngcontent-%COMP%]:hover{background:#6b7280cc}.preview-text[_ngcontent-%COMP%]{color:#f3f4f6}.progress-bar[_ngcontent-%COMP%]{background:#9ca3af80}.auto-rotation-btn[_ngcontent-%COMP%]{background:#9ca3afb3}.force-update-btn[_ngcontent-%COMP%]{background:#9ca3afb3;border-color:#d1d5db80;color:#f3f4f6}.dot[_ngcontent-%COMP%]{background:#d1d5db99}@media (max-width: 480px){.watermark[_ngcontent-%COMP%]{opacity:.28}.quote-card[_ngcontent-%COMP%]{background:#6b728099}.quote-card[_ngcontent-%COMP%]:hover{background:#6b7280b3}.quote-card[_ngcontent-%COMP%]:before{opacity:.12}}}']})};function ri(s,t){s&1&&(n(0,"div",7),u(1,"div",8),r())}function oi(s,t){if(s&1){let e=w();n(0,"img",22),_("error",function(o){return p(e),g(o.target.style.display="none")}),r()}if(s&2){let e=c(2);m("src",e.getUserAvatarUrl(),ge)("alt",(e.currentUser==null?null:e.currentUser.full_name)||"Avatar")}}function ai(s,t){if(s&1&&(n(0,"span",23),a(1),r()),s&2){let e=c(2);l(),v(" ",e.getUserInitials()," ")}}function si(s,t){if(s&1&&(n(0,"div")(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"div",13),x(6,oi,1,2,"img",14)(7,ai,2,1,"ng-template",null,0,K),r()(),n(9,"div",15)(10,"h2",16),a(11),r(),n(12,"p",17),a(13,"Sistema RehabiMovement - Tu camino hacia la recuperaci\xF3n"),r(),n(14,"div",18),h(),n(15,"svg",19),u(16,"path",20),r(),y(),n(17,"span",21),a(18),r()()()()()(),n(19,"div",9),u(20,"app-motivational-quotes"),r()()),s&2){let e=Y(8),i=c();l(6),m("ngIf",i.currentUser==null?null:i.currentUser.avatar_url)("ngIfElse",e),l(5),v("\xA1Bienvenido, ",i.currentUser==null?null:i.currentUser.full_name,"!"),l(7),v("\xDAltima conexi\xF3n: ",i.getCurrentTime(),"")}}var Xe=class s{constructor(t,e,i){this.authService=t;this.permissionsService=e;this.router=i}currentUser=null;menuItems=[];isSidebarCollapsed=!1;loading=!0;error="";currentRoute="";expandedModules=new Set;stats={todayProgress:0,sessionsCompleted:0,daysActive:0,achievementPoints:0};subscriptions=new Ne;ngOnInit(){return b(this,null,function*(){console.log("Dashboard inicializado");try{if(this.currentUser=this.authService.getCurrentUser(),console.log("Usuario actual:",this.currentUser),!this.currentUser){console.log("No hay usuario autenticado, redirigiendo a login"),this.router.navigate(["/login"]);return}yield this.loadUserMenu(),yield this.loadDashboardStats(),this.subscriptions.add(this.router.events.pipe(ze(t=>t instanceof He)).subscribe(t=>{this.currentRoute=t.urlAfterRedirects,console.log("Ruta actual:",this.currentRoute)})),this.currentRoute=this.router.url}catch(t){console.error("Error inicializando dashboard:",t),this.error="Error cargando el dashboard"}finally{this.loading=!1}})}ngOnDestroy(){this.subscriptions.unsubscribe()}loadUserMenu(){return b(this,null,function*(){try{console.log("Cargando men\xFA del usuario..."),this.menuItems=yield this.permissionsService.loadUserMenu(),(!this.menuItems||this.menuItems.length===0)&&(console.log("No se obtuvo men\xFA de la BD, usando men\xFA por defecto"),this.menuItems=this.createDefaultMenu()),this.updateExpandedModules(),console.log("Men\xFA cargado:",this.menuItems)}catch(t){console.error("Error cargando men\xFA:",t),this.menuItems=this.createDefaultMenu(),this.updateExpandedModules()}})}createDefaultMenu(){return[{id_modulo:1,nombre:"Dashboard",descripcion:"Panel principal",icono:"fas fa-tachometer-alt",ruta:"/dashboard",orden:1,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1},{id_modulo:2,nombre:"Usuarios",descripcion:"Gesti\xF3n de usuarios",icono:"fas fa-users",ruta:"/usuarios",orden:2,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1},{id_modulo:3,nombre:"Reportes",descripcion:"Sistema de reportes",icono:"fas fa-chart-bar",ruta:"/reportes",orden:3,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1},{id_modulo:4,nombre:"Configuraci\xF3n",descripcion:"Configuraci\xF3n del sistema",icono:"fas fa-cog",ruta:"/configuracion",orden:4,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1}]}updateExpandedModules(){this.menuItems.forEach(t=>{t.expanded===void 0&&(t.expanded=!1),t.children&&t.children.forEach(e=>{e.expanded===void 0&&(e.expanded=!1)})})}loadDashboardStats(){return b(this,null,function*(){try{this.stats={todayProgress:this.calculateTodayProgress(),sessionsCompleted:this.getSessionsCompleted(),daysActive:this.getDaysActive(),achievementPoints:this.getAchievementPoints()}}catch(t){console.error("Error cargando estad\xEDsticas:",t)}})}calculateTodayProgress(){let e=new Date().getHours();return e<8?10:e<12?35:e<16?65:e<20?85:95}getSessionsCompleted(){let t=this.getDaysActive();return Math.floor(t*.8)+15}getDaysActive(){if(!this.currentUser?.created_at)return 1;let t=new Date(this.currentUser.created_at),i=Math.abs(new Date().getTime()-t.getTime()),o=Math.ceil(i/(1e3*60*60*24));return Math.max(1,o)}getAchievementPoints(){let t=this.getSessionsCompleted(),e=this.getDaysActive();return t*10+e*5+Math.floor(this.calculateTodayProgress()/10)*25}getUserAvatarUrl(){return this.authService.getAvatarUrl(this.currentUser||void 0)}toggleSidebar(){this.isSidebarCollapsed=!this.isSidebarCollapsed,console.log("Sidebar colapsado:",this.isSidebarCollapsed)}toggleModule(t){this.expandedModules.has(t)?this.expandedModules.delete(t):this.expandedModules.add(t);let e=this.menuItems.find(i=>i.id_modulo===t);e&&(e.expanded=this.expandedModules.has(t),console.log(`M\xF3dulo ${e.nombre} ${e.expanded?"expandido":"colapsado"}`))}isModuleExpanded(t){return this.expandedModules.has(t)}logout(){console.log("Cerrando sesi\xF3n desde dashboard"),this.permissionsService.clearUserData(),this.currentUser=null,this.menuItems=[],this.authService.logout()}getFilteredMenuItems(){return this.menuItems.filter(t=>!t.modulo_padre_id)}getFilteredChildren(t){return t.children?t.children:this.menuItems.filter(e=>e.modulo_padre_id===t.id_modulo)}isRouteActive(t){return!t||t==="#"?!1:this.currentRoute===t||this.currentRoute.startsWith(t+"/")}navigateTo(t){t&&t!=="#"&&(console.log("Navegando a:",t),this.router.navigate([t]))}getUserInitials(){return this.authService.getUserInitials(this.currentUser||void 0)}getUserRole(){switch(this.currentUser?.id_perfil){case 1:return"Administrador";case 2:return"Usuario";case 3:return"Supervisor";case 4:return"Invitado";default:return"Usuario"}}getPageTitle(){switch(this.currentRoute){case"/dashboard":return"Dashboard";case"/usuarios":return"Gesti\xF3n de Usuarios";case"/reportes":return"Reportes";case"/configuracion":return"Configuraci\xF3n";default:return"Dashboard"}}isDashboardHome(){return this.currentRoute==="/dashboard"}isUsersPage(){return this.currentRoute==="/usuarios"}formatDate(t){return t?new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"N/A"}getCurrentTime(){return new Date().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}refreshDashboard(){return b(this,null,function*(){this.loading=!0;try{yield this.loadUserMenu(),yield this.loadDashboardStats(),yield this.permissionsService.loadUserPermissions()}catch(t){console.error("Error refrescando dashboard:",t)}finally{this.loading=!1}})}static \u0275fac=function(e){return new(e||s)(O(L),O(Ye),O(be))};static \u0275cmp=D({type:s,selectors:[["app-dashboard"]],standalone:!1,decls:6,vars:2,consts:[["welcomeInitials",""],[1,"min-h-screen","bg-gray-50","flex"],[1,"flex-1","flex","flex-col","overflow-hidden"],[1,"flex-1","overflow-auto"],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],["class","flex justify-center items-center h-64",4,"ngIf"],[4,"ngIf"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-indigo-600"],[1,"mb-8"],[1,"bg-gradient-to-r","from-indigo-500","to-purple-600","rounded-lg","shadow-lg","p-6","text-white"],[1,"flex","items-center"],[1,"flex-shrink-0"],[1,"h-16","w-16","rounded-full","overflow-hidden","bg-white","bg-opacity-20","flex","items-center","justify-center","shadow-lg"],["class","w-full h-full object-cover",3,"src","alt","error",4,"ngIf","ngIfElse"],[1,"ml-6"],[1,"text-3xl","font-bold"],[1,"text-indigo-100","text-lg"],[1,"mt-2","flex","items-center","text-indigo-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm"],[1,"w-full","h-full","object-cover",3,"error","src","alt"],[1,"text-xl","font-bold","text-white"]],template:function(e,i){e&1&&(n(0,"div",1)(1,"div",2)(2,"main",3)(3,"div",4),x(4,ri,2,0,"div",5)(5,si,21,4,"div",6),r()()()()),e&2&&(l(4),m("ngIf",i.loading),l(),m("ngIf",!i.loading))},dependencies:[R,Ze],encapsulation:2})};var li=(s,t)=>({"bg-green-400":s,"bg-red-400":t}),di=(s,t,e,i)=>({"bg-purple-100 text-purple-800":s,"bg-blue-100 text-blue-800":t,"bg-yellow-100 text-yellow-800":e,"bg-gray-100 text-gray-800":i}),ci=(s,t)=>({"bg-green-100 text-green-800":s,"bg-red-100 text-red-800":t});function mi(s,t){if(s&1){let e=w();n(0,"div",43)(1,"div",44),h(),n(2,"svg",45),u(3,"path",46),r(),y(),n(4,"div",47)(5,"p",48),a(6),r()(),n(7,"div",49)(8,"button",50),_("click",function(){p(e);let o=c();return g(o.error="")}),h(),n(9,"svg",51),u(10,"path",52),r()()()()()}if(s&2){let e=c();l(6),C(e.error)}}function ui(s,t){s&1&&(n(0,"div",53)(1,"div",54),u(2,"div",55),n(3,"p",56),a(4,"Cargando usuarios..."),r()()())}function pi(s,t){if(s&1){let e=w();n(0,"img",93),_("error",function(o){return p(e),g(o.target.style.display="none")}),r()}if(s&2){let e=c().$implicit,i=c(2);m("src",i.getUserAvatarUrl(e),ge)("alt",e.full_name||"Avatar")}}function gi(s,t){if(s&1&&(n(0,"span",94),a(1),r()),s&2){let e=c().$implicit,i=c(2);l(),v(" ",i.getUserInitials(e)," ")}}function fi(s,t){if(s&1){let e=w();n(0,"button",95),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.deactivateUser(o))}),h(),n(1,"svg",86),u(2,"path",96),r()()}}function _i(s,t){if(s&1){let e=w();n(0,"button",97),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.reactivateUser(o))}),h(),n(1,"svg",86),u(2,"path",98),r()()}}function xi(s,t){if(s&1){let e=w();n(0,"tr",69)(1,"td",70)(2,"div",71)(3,"div",72)(4,"div",73),x(5,pi,1,2,"img",74)(6,gi,2,1,"ng-template",null,1,K),r(),u(8,"div",75),r(),n(9,"div",76)(10,"div",77),a(11),r(),n(12,"div",61),a(13),r()()()(),n(14,"td",70)(15,"div",78),a(16),r()(),n(17,"td",70)(18,"span",79),a(19),r()(),n(20,"td",70)(21,"span",79),h(),n(22,"svg",80),u(23,"circle",81),r(),a(24),r()(),y(),n(25,"td",82),a(26),r(),n(27,"td",83)(28,"div",84)(29,"button",85),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.changeUserAvatar(o))}),h(),n(30,"svg",86),u(31,"path",87)(32,"path",88),r()(),y(),n(33,"button",89),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.openEditModal(o))}),h(),n(34,"svg",86),u(35,"path",90),r()(),x(36,fi,3,0,"button",91)(37,_i,3,0,"button",92),r()()()}if(s&2){let e=t.$implicit,i=Y(7),o=c(2);l(5),m("ngIf",e.avatar_url)("ngIfElse",i),l(3),m("ngClass",ue(13,li,e.status===1,e.status===0)),l(3),C(e.username),l(2),v("ID: ",e.id,""),l(3),C(e.full_name),l(2),m("ngClass",xe(16,di,e.id_perfil===1,e.id_perfil===2,e.id_perfil===3,e.id_perfil===4)),l(),v(" ",o.getPerfilName(e.id_perfil)," "),l(2),m("ngClass",ue(21,ci,e.status===1,e.status===0)),l(3),v(" ",o.getStatusText(e.status)," "),l(2),v(" ",o.formatDate(e.created_at)," "),l(10),m("ngIf",e.status===1),l(),m("ngIf",e.status===0)}}function hi(s,t){if(s&1){let e=w();n(0,"button",107),_("click",function(){p(e);let o=c(3);return g(o.openCreateModal())}),a(1," Crear primer usuario "),r()}}function vi(s,t){if(s&1){let e=w();n(0,"button",108),_("click",function(){p(e);let o=c(3);return g(o.clearFilters())}),a(1," Limpiar filtros "),r()}}function bi(s,t){if(s&1&&(n(0,"div",99),h(),n(1,"svg",100),u(2,"path",101),r(),y(),n(3,"h3",102),a(4,"No hay usuarios"),r(),n(5,"p",103),a(6),r(),n(7,"div",104),x(8,hi,2,0,"button",105)(9,vi,2,0,"button",106),r()()),s&2){let e=c(2);l(6),v(" ",e.usuarios.length===0?"No se encontraron usuarios en la base de datos.":"No se encontraron usuarios con los filtros aplicados."," "),l(2),m("ngIf",e.usuarios.length===0),l(),m("ngIf",e.usuarios.length>0)}}function wi(s,t){if(s&1&&(n(0,"div",57)(1,"div",58)(2,"div",59)(3,"h3",60),a(4),r(),n(5,"span",61),a(6),r()()(),n(7,"div",62)(8,"table",63)(9,"thead",64)(10,"tr")(11,"th",65),a(12," Usuario "),r(),n(13,"th",65),a(14," Nombre Completo "),r(),n(15,"th",65),a(16," Perfil "),r(),n(17,"th",65),a(18," Estado "),r(),n(19,"th",65),a(20," Fecha Creaci\xF3n "),r(),n(21,"th",65),a(22," Acciones "),r()()(),n(23,"tbody",66),x(24,xi,38,24,"tr",67),r()(),x(25,bi,10,3,"div",68),r()()),s&2){let e=c();l(4),N(" Lista de Usuarios (",e.filteredUsuarios.length," de ",e.usuarios.length,") "),l(2),N(" Mostrando ",e.filteredUsuarios.length," resultado",e.filteredUsuarios.length!==1?"s":""," "),l(18),m("ngForOf",e.filteredUsuarios)("ngForTrackBy",e.trackByUserId),l(),m("ngIf",e.filteredUsuarios.length===0&&!e.loading)}}function yi(s,t){if(s&1){let e=w();n(0,"img",93),_("error",function(o){return p(e),g(o.target.style.display="none")}),r()}if(s&2){let e=c(3);m("src",e.getUserAvatarUrl(e.userForm),ge)("alt",e.userForm.full_name||"Avatar")}}function Ci(s,t){if(s&1&&(n(0,"span",147),a(1),r()),s&2){let e=c(3);l(),v(" ",e.getUserInitials(e.userForm)," ")}}function Si(s,t){if(s&1){let e=w();n(0,"div",143)(1,"div",20)(2,"div",144),x(3,yi,1,2,"img",74)(4,Ci,2,1,"ng-template",null,2,K),r(),n(6,"button",145),_("click",function(){p(e);let o=Y(11);return g(o.click())}),h(),n(7,"svg",146),u(8,"path",87)(9,"path",88),r()(),y(),n(10,"input",42,3),_("change",function(o){p(e);let d=c(2);return g(d.onAvatarSelected(o))}),r()()()}if(s&2){let e=Y(5),i=c(2);l(3),m("ngIf",i.userForm.avatar_url)("ngIfElse",e)}}function Mi(s,t){s&1&&(n(0,"span",125),a(1,"*"),r())}function Ei(s,t){if(s&1&&(n(0,"div",148)(1,"div",44),h(),n(2,"svg",45),u(3,"path",46),r(),y(),n(4,"div",47)(5,"p",48),a(6),r()()()()),s&2){let e=c(2);l(6),C(e.error)}}function ki(s,t){s&1&&(h(),n(0,"svg",149),u(1,"path",12),r())}function Ti(s,t){if(s&1){let e=w();n(0,"div",109)(1,"div",110)(2,"div",111),_("click",function(){p(e);let o=c();return g(o.closeModal())}),r(),n(3,"span",112),a(4,"\u200B"),r(),n(5,"div",113)(6,"div",114)(7,"div",115)(8,"div",116),h(),n(9,"svg",117),u(10,"path",118),r()(),y(),n(11,"div",119)(12,"h3",60),a(13),r(),n(14,"div",120)(15,"p",61),a(16),r()()()()(),n(17,"div",121)(18,"form",122),x(19,Si,12,2,"div",123),n(20,"div")(21,"label",124),a(22," Nombre de Usuario "),n(23,"span",125),a(24,"*"),r()(),n(25,"input",126),T("ngModelChange",function(o){p(e);let d=c();return k(d.userForm.username,o)||(d.userForm.username=o),g(o)}),r(),n(26,"p",127),a(27," Solo letras, n\xFAmeros, puntos, guiones y guiones bajos "),r()(),n(28,"div")(29,"label",128),a(30," Nombre Completo "),n(31,"span",125),a(32,"*"),r()(),n(33,"input",129),T("ngModelChange",function(o){p(e);let d=c();return k(d.userForm.full_name,o)||(d.userForm.full_name=o),g(o)}),r()(),n(34,"div")(35,"label",130),a(36),x(37,Mi,2,0,"span",131),r(),n(38,"input",132),T("ngModelChange",function(o){p(e);let d=c();return k(d.userForm.password,o)||(d.userForm.password=o),g(o)}),r(),n(39,"p",127),a(40),r()(),n(41,"div")(42,"label",133),a(43," Perfil de Usuario "),r(),n(44,"select",134),T("ngModelChange",function(o){p(e);let d=c();return k(d.userForm.id_perfil,o)||(d.userForm.id_perfil=o),g(o)}),n(45,"option",32),a(46,"Administrador"),r(),n(47,"option",33),a(48,"Usuario"),r(),n(49,"option",34),a(50,"Supervisor"),r(),n(51,"option",35),a(52,"Invitado"),r()()(),n(53,"div")(54,"label",135),a(55," Estado "),r(),n(56,"select",136),T("ngModelChange",function(o){p(e);let d=c();return k(d.userForm.status,o)||(d.userForm.status=o),g(o)}),n(57,"option",32),a(58,"Activo"),r(),n(59,"option",137),a(60,"Inactivo"),r()()()(),x(61,Ei,7,1,"div",138),r(),n(62,"div",139)(63,"button",140),_("click",function(){p(e);let o=c();return g(o.saveUser())}),x(64,ki,2,0,"svg",141),a(65),r(),n(66,"button",142),_("click",function(){p(e);let o=c();return g(o.closeModal())}),a(67," Cancelar "),r()()()()()}if(s&2){let e=c();l(13),v(" ",e.modalMode==="create"?"Crear Nuevo Usuario":"Editar Usuario"," "),l(3),v(" ",e.modalMode==="create"?"Complete los datos para crear un nuevo usuario.":"Modifique los datos del usuario seleccionado."," "),l(3),m("ngIf",e.modalMode==="edit"),l(6),E("ngModel",e.userForm.username),l(8),E("ngModel",e.userForm.full_name),l(3),v(" ",e.modalMode==="create"?"Contrase\xF1a":"Nueva Contrase\xF1a (opcional)"," "),l(),m("ngIf",e.modalMode==="create"),l(),E("ngModel",e.userForm.password),m("placeholder",e.modalMode==="create"?"M\xEDnimo 6 caracteres":"Dejar vac\xEDo para no cambiar"),l(2),v(" ",e.modalMode==="create"?"M\xEDnimo 6 caracteres":"Dejar vac\xEDo si no desea cambiar la contrase\xF1a"," "),l(4),E("ngModel",e.userForm.id_perfil),l(12),E("ngModel",e.userForm.status),l(5),m("ngIf",e.error),l(2),m("disabled",!e.userForm.username||!e.userForm.full_name||e.modalMode==="create"&&!e.userForm.password),l(),m("ngIf",e.loading),l(),v(" ",e.modalMode==="create"?"Crear Usuario":"Guardar Cambios"," ")}}var Ke=class s{constructor(t,e){this.supabaseService=t;this.authService=e}usuarios=[];filteredUsuarios=[];loading=!0;error="";searchTerm="";showModal=!1;modalMode="create";selectedUser=null;selectedUserForAvatar=null;userForm={username:"",full_name:"",password:"",status:1,id_perfil:2,avatar_url:""};statusFilter="all";perfilFilter="all";ngOnInit(){return b(this,null,function*(){console.log("UsuariosComponent inicializado"),yield this.loadUsuarios()})}loadUsuarios(){return b(this,null,function*(){this.loading=!0,this.error="";try{console.log("Cargando usuarios desde la base de datos...");let t=yield this.supabaseService.getData("profiles");console.log("Datos recibidos:",t),this.usuarios=t||[],this.filteredUsuarios=[...this.usuarios],this.applyFilters(),console.log("Usuarios cargados exitosamente:",this.usuarios.length)}catch(t){console.error("Error cargando usuarios:",t),this.error="Error al cargar los usuarios. Verifique la conexi\xF3n a la base de datos."}finally{this.loading=!1}})}applyFilters(){let t=[...this.usuarios];if(this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.username?.toLowerCase().includes(e)||i.full_name?.toLowerCase().includes(e))}this.statusFilter==="active"?t=t.filter(e=>e.status===1):this.statusFilter==="inactive"&&(t=t.filter(e=>e.status===0)),this.perfilFilter!=="all"&&(t=t.filter(e=>e.id_perfil===parseInt(this.perfilFilter))),this.filteredUsuarios=t,console.log("Usuarios filtrados:",this.filteredUsuarios.length)}onSearch(){this.applyFilters()}onFilterChange(){this.applyFilters()}openCreateModal(){console.log("Abriendo modal para crear usuario"),this.modalMode="create",this.userForm={username:"",full_name:"",password:"",status:1,id_perfil:2,avatar_url:""},this.error="",this.showModal=!0}openEditModal(t){console.log("Abriendo modal para editar usuario:",t.username),this.modalMode="edit",this.selectedUser=t,this.userForm=Ie(ce({},t),{password:""}),this.error="",this.showModal=!0}closeModal(){console.log("Cerrando modal"),this.showModal=!1,this.selectedUser=null,this.error=""}deactivateUser(t){return b(this,null,function*(){let e=`\xBFEst\xE1 seguro de desactivar al usuario "${t.username}"?`;if(confirm(e))try{console.log("Desactivando usuario:",t.username),yield this.supabaseService.updateData("profiles",t.id.toString(),{status:0}),yield this.loadUsuarios(),console.log("Usuario desactivado exitosamente")}catch(i){console.error("Error desactivando usuario:",i),this.error="Error al desactivar el usuario",setTimeout(()=>this.error="",5e3)}})}reactivateUser(t){return b(this,null,function*(){let e=`\xBFEst\xE1 seguro de reactivar al usuario "${t.username}"?`;if(confirm(e))try{console.log("Reactivando usuario:",t.username),yield this.supabaseService.updateData("profiles",t.id.toString(),{status:1}),yield this.loadUsuarios(),console.log("Usuario reactivado exitosamente")}catch(i){console.error("Error reactivando usuario:",i),this.error="Error al reactivar el usuario",setTimeout(()=>this.error="",5e3)}})}getPerfilName(t){switch(t){case 1:return"Administrador";case 2:return"Usuario";case 3:return"Supervisor";case 4:return"Invitado";default:return"Sin asignar"}}getStatusText(t){return t===1?"Activo":"Inactivo"}getStatusColor(t){return t===1?"green":"red"}formatDate(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(e){return console.error("Error formateando fecha:",e),"Fecha inv\xE1lida"}}refreshUsers(){return b(this,null,function*(){console.log("Refrescando lista de usuarios"),yield this.loadUsuarios()})}clearFilters(){console.log("Limpiando filtros"),this.searchTerm="",this.statusFilter="all",this.perfilFilter="all",this.applyFilters()}trackByUserId(t,e){return e.id||t}changeUserAvatar(t){this.selectedUserForAvatar=t;let e=document.querySelector("#userAvatarFileInput");e&&e.click()}onUserAvatarSelected(t){return b(this,null,function*(){let e=t.target;e.files&&e.files[0]&&this.selectedUserForAvatar&&(yield this.updateUserAvatar(this.selectedUserForAvatar,e.files[0]),e.value="",this.selectedUserForAvatar=null)})}onAvatarSelected(t){return b(this,null,function*(){let e=t.target;if(e.files&&e.files[0]){let i=e.files[0],o=this.validateImageFile(i);if(!o.valid){this.error=o.error||"Archivo inv\xE1lido";return}try{let d=yield this.fileToBase64(i);this.userForm.avatar_url=d,console.log("Avatar seleccionado para el formulario")}catch(d){console.error("Error procesando imagen:",d),this.error="Error al procesar la imagen"}e.value=""}})}updateUserAvatar(t,e){return b(this,null,function*(){try{let i=this.validateImageFile(e);if(!i.valid){alert(i.error||"Archivo inv\xE1lido");return}let o=yield this.fileToBase64(e),d={avatar_url:o};yield this.supabaseService.updateData("profiles",t.id.toString(),d);let f=this.usuarios.findIndex(S=>S.id===t.id);f!==-1&&(this.usuarios[f]=Ie(ce({},this.usuarios[f]),{avatar_url:o}),this.applyFilters()),console.log("Avatar actualizado exitosamente para:",t.username)}catch(i){console.error("Error actualizando avatar:",i),alert("Error al actualizar la foto de perfil")}})}validateImageFile(t){return["image/jpeg","image/jpg","image/png","image/gif"].includes(t.type)?t.size>5242880?{valid:!1,error:"El archivo es demasiado grande. M\xE1ximo 5MB."}:{valid:!0}:{valid:!1,error:"Tipo de archivo no permitido. Use JPG, PNG o GIF."}}fileToBase64(t){return new Promise((e,i)=>{let o=new FileReader;o.readAsDataURL(t),o.onload=()=>e(o.result),o.onerror=d=>i(d)})}resizeImage(t,e=300,i=300,o=.8){return new Promise((d,f)=>{let S=document.createElement("canvas"),P=S.getContext("2d"),M=new Image;M.onload=()=>{let{width:U,height:I}=M;U>I?U>e&&(I=I*e/U,U=e):I>i&&(U=U*i/I,I=i),S.width=U,S.height=I,P?.drawImage(M,0,0,U,I);let B=S.toDataURL(t.type,o);d(B)},M.onerror=f,M.src=URL.createObjectURL(t)})}getUserAvatarUrl(t){return this.authService.getAvatarUrl(t)}getUserInitials(t){return this.authService.getUserInitials(t)}getAvatarColor(t){let e=["bg-indigo-600","bg-green-600","bg-yellow-600","bg-red-600","bg-purple-600","bg-pink-600","bg-blue-600","bg-cyan-600","bg-orange-600"];if(!t.full_name)return"bg-gray-600";let i=t.full_name.charCodeAt(0);return e[i%e.length]}onUserAvatarUpdated(t){let e=this.usuarios.findIndex(i=>i.id===t.id);e!==-1&&(this.usuarios[e]=Ie(ce({},this.usuarios[e]),{avatar_url:t.avatar_url}),this.applyFilters()),console.log("Avatar actualizado para usuario:",t.username)}saveUser(){return b(this,null,function*(){try{if(console.log("Guardando usuario:",this.userForm),this.error="",!this.userForm.username||!this.userForm.full_name){this.error="Nombre de usuario y nombre completo son requeridos";return}if(this.userForm.username.length<3){this.error="El nombre de usuario debe tener al menos 3 caracteres";return}if(!/^[a-zA-Z0-9_.-]+$/.test(this.userForm.username)){this.error="El nombre de usuario solo puede contener letras, n\xFAmeros, guiones, puntos y guiones bajos";return}if(this.modalMode==="create"){if(!this.userForm.password){this.error="La contrase\xF1a es requerida para crear un usuario";return}if(this.userForm.password.length<6){this.error="La contrase\xF1a debe tener al menos 6 caracteres";return}console.log("Verificando si el username existe...");let e=yield this.supabaseService.client.from("profiles").select("username").eq("username",this.userForm.username);if(e.data&&e.data.length>0){this.error="El nombre de usuario ya existe";return}let i={username:this.userForm.username,full_name:this.userForm.full_name,password:this.userForm.password,status:this.userForm.status,id_perfil:this.userForm.id_perfil,avatar_url:this.userForm.avatar_url||null};console.log("Creando usuario:",i),yield this.supabaseService.insertData("profiles",i),console.log("Usuario creado exitosamente")}else{let e={username:this.userForm.username,full_name:this.userForm.full_name,status:this.userForm.status,id_perfil:this.userForm.id_perfil,avatar_url:this.userForm.avatar_url};if(this.userForm.password&&this.userForm.password.length>0){if(this.userForm.password.length<6){this.error="La nueva contrase\xF1a debe tener al menos 6 caracteres";return}e.password=this.userForm.password}console.log("Actualizando usuario:",e),yield this.supabaseService.updateData("profiles",this.selectedUser.id.toString(),e),console.log("Usuario actualizado exitosamente")}yield this.loadUsuarios(),this.closeModal()}catch(t){console.error("Error guardando usuario:",t),this.error="Error al guardar el usuario. Intente nuevamente."}})}static \u0275fac=function(e){return new(e||s)(O(Q),O(L))};static \u0275cmp=D({type:s,selectors:[["app-usuarios"]],standalone:!1,decls:60,vars:8,consts:[["userAvatarFileInput",""],["userInitialsTemplate",""],["modalInitialsTemplate",""],["avatarFileInput",""],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],["title","Refrescar lista",1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"md:col-span-2"],["for","search",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],["id","search","type","text","placeholder","Buscar por nombre o usuario...",1,"block","w-full","pl-10","pr-3","py-2","border","border-gray-300","rounded-md","leading-5","bg-white","placeholder-gray-500","focus:outline-none","focus:placeholder-gray-400","focus:ring-1","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","input","ngModel"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["for","statusFilter",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","statusFilter",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","change","ngModel"],["value","all"],["value","active"],["value","inactive"],["for","perfilFilter",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","perfilFilter",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","change","ngModel"],["value","1"],["value","2"],["value","3"],["value","4"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-indigo-600","hover:text-indigo-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","bg-white shadow overflow-hidden sm:rounded-md",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"ml-auto","pl-3"],[1,"text-red-400","hover:text-red-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","justify-center","items-center","h-64"],[1,"text-center"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-indigo-600","mx-auto"],[1,"mt-4","text-gray-600"],[1,"bg-white","shadow","overflow-hidden","sm:rounded-md"],[1,"px-4","py-5","sm:px-6","border-b","border-gray-200"],[1,"flex","justify-between","items-center"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50 transition-colors duration-150",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-12",4,"ngIf"],[1,"hover:bg-gray-50","transition-colors","duration-150"],[1,"px-6","py-4","whitespace-nowrap"],[1,"flex","items-center"],[1,"h-10","w-10","flex-shrink-0","relative"],[1,"h-10","w-10","rounded-full","overflow-hidden","bg-gradient-to-br","from-blue-500","to-purple-600","flex","items-center","justify-center","shadow-lg"],["class","w-full h-full object-cover",3,"src","alt","error",4,"ngIf","ngIfElse"],[1,"absolute","-bottom-0","-right-0","h-3","w-3","rounded-full","border-2","border-white",3,"ngClass"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-900"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["fill","currentColor","viewBox","0 0 8 8",1,"w-2","h-2","mr-1"],["cx","4","cy","4","r","3"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","justify-end","space-x-2"],["title","Cambiar foto de perfil",1,"text-blue-600","hover:text-blue-900","p-1","rounded","hover:bg-blue-50","transition-colors","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 13a3 3 0 11-6 0 3 3 0 016 0z"],["title","Editar usuario",1,"text-indigo-600","hover:text-indigo-900","p-1","rounded","hover:bg-indigo-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["class","text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50 transition-colors duration-150","title","Desactivar usuario",3,"click",4,"ngIf"],["class","text-green-600 hover:text-green-900 p-1 rounded hover:bg-green-50 transition-colors duration-150","title","Reactivar usuario",3,"click",4,"ngIf"],[1,"w-full","h-full","object-cover",3,"error","src","alt"],[1,"text-sm","font-medium","text-white"],["title","Desactivar usuario",1,"text-red-600","hover:text-red-900","p-1","rounded","hover:bg-red-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636"],["title","Reactivar usuario",1,"text-green-600","hover:text-green-900","p-1","rounded","hover:bg-green-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-indigo-600","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-end","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-lg","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-indigo-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-indigo-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"mt-2"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"space-y-4"],["class","flex justify-center",4,"ngIf"],["for","username",1,"block","text-sm","font-medium","text-gray-700"],[1,"text-red-500"],["id","username","type","text","name","username","required","","placeholder","Ej: juan.perez",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"mt-1","text-xs","text-gray-500"],["for","fullName",1,"block","text-sm","font-medium","text-gray-700"],["id","fullName","type","text","name","fullName","required","","placeholder","Ej: Juan P\xE9rez Garc\xEDa",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","password",1,"block","text-sm","font-medium","text-gray-700"],["class","text-red-500",4,"ngIf"],["id","password","type","password","name","password",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel","placeholder"],["for","perfil",1,"block","text-sm","font-medium","text-gray-700"],["id","perfil","name","perfil",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","status",1,"block","text-sm","font-medium","text-gray-700"],["id","status","name","status",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"ngModelChange","ngModel"],["value","0"],["class","mt-4 bg-red-50 border border-red-200 rounded-md p-3",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-indigo-600","text-base","font-medium","text-white","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","animate-spin -ml-1 mr-3 h-5 w-5 text-white","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","sm:mt-0","sm:ml-3","sm:w-auto","sm:text-sm",3,"click"],[1,"flex","justify-center"],[1,"h-20","w-20","rounded-full","overflow-hidden","bg-gradient-to-br","from-blue-500","to-purple-600","flex","items-center","justify-center","shadow-lg"],["type","button","title","Cambiar foto",1,"absolute","bottom-0","right-0","bg-blue-500","hover:bg-blue-600","text-white","rounded-full","p-1","shadow-lg","transition-all","duration-200","transform","hover:scale-110",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],[1,"text-lg","font-medium","text-white"],[1,"mt-4","bg-red-50","border","border-red-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"]],template:function(e,i){if(e&1){let o=w();n(0,"div",4)(1,"div",5)(2,"div",6)(3,"div")(4,"h1",7),a(5,"Gesti\xF3n de Usuarios"),r(),n(6,"p",8),a(7),r()(),n(8,"div",9)(9,"button",10),_("click",function(){return p(o),g(i.refreshUsers())}),h(),n(10,"svg",11),u(11,"path",12),r(),a(12," Refrescar "),r(),y(),n(13,"button",13),_("click",function(){return p(o),g(i.openCreateModal())}),h(),n(14,"svg",14),u(15,"path",15),r(),a(16," Nuevo Usuario "),r()()()(),y(),n(17,"div",16)(18,"div",17)(19,"div",18)(20,"label",19),a(21," Buscar "),r(),n(22,"div",20)(23,"input",21),T("ngModelChange",function(f){return p(o),k(i.searchTerm,f)||(i.searchTerm=f),g(f)}),_("input",function(){return p(o),g(i.onSearch())}),r(),n(24,"div",22),h(),n(25,"svg",23),u(26,"path",24),r()()()(),y(),n(27,"div")(28,"label",25),a(29," Estado "),r(),n(30,"select",26),T("ngModelChange",function(f){return p(o),k(i.statusFilter,f)||(i.statusFilter=f),g(f)}),_("change",function(){return p(o),g(i.onFilterChange())}),n(31,"option",27),a(32,"Todos"),r(),n(33,"option",28),a(34,"Activos"),r(),n(35,"option",29),a(36,"Inactivos"),r()()(),n(37,"div")(38,"label",30),a(39," Perfil "),r(),n(40,"select",31),T("ngModelChange",function(f){return p(o),k(i.perfilFilter,f)||(i.perfilFilter=f),g(f)}),_("change",function(){return p(o),g(i.onFilterChange())}),n(41,"option",27),a(42,"Todos"),r(),n(43,"option",32),a(44,"Administrador"),r(),n(45,"option",33),a(46,"Usuario"),r(),n(47,"option",34),a(48,"Supervisor"),r(),n(49,"option",35),a(50,"Invitado"),r()()()(),n(51,"div",36)(52,"button",37),_("click",function(){return p(o),g(i.clearFilters())}),a(53," Limpiar filtros "),r()()(),x(54,mi,11,1,"div",38)(55,ui,5,0,"div",39)(56,wi,26,7,"div",40),r(),x(57,Ti,68,16,"div",41),n(58,"input",42,0),_("change",function(f){return p(o),g(i.onUserAvatarSelected(f))}),r()}e&2&&(l(7),v(" Administra los usuarios del sistema - Total: ",i.usuarios.length," "),l(16),E("ngModel",i.searchTerm),l(7),E("ngModel",i.statusFilter),l(10),E("ngModel",i.perfilFilter),l(14),m("ngIf",i.error),l(),m("ngIf",i.loading),l(),m("ngIf",!i.loading),l(),m("ngIf",i.showModal))},dependencies:[$,z,R,te,ne,re,W,ie,G,ee,ve,H,se],styles:[`.table-container[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}.user-row[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.user-row[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.modal-backdrop[_ngcontent-%COMP%]{backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px)}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .75rem;border-radius:9999px;font-size:.75rem;font-weight:500;line-height:1}.badge-status[_ngcontent-%COMP%]{gap:.25rem}.action-button[_ngcontent-%COMP%]{transition:all .15s ease-in-out;border-radius:.375rem;padding:.25rem}.action-button[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin:0 auto 1rem;color:#9ca3af}@media (max-width: 640px){.table-container[_ngcontent-%COMP%]{font-size:.875rem}.user-avatar[_ngcontent-%COMP%]{width:2rem;height:2rem}.action-buttons[_ngcontent-%COMP%]{flex-direction:column;gap:.25rem}}.filter-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9);border:1px solid #e2e8f0}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:16rem}.loading-spinner[_ngcontent-%COMP%]{width:3rem;height:3rem;border:2px solid #e5e7eb;border-top:2px solid #4f46e5;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.error-message[_ngcontent-%COMP%]{background-color:#fef2f2;border:1px solid #fecaca;color:#dc2626;padding:1rem;border-radius:.5rem;margin-bottom:1.5rem}.error-icon[_ngcontent-%COMP%]{flex-shrink:0;width:1.25rem;height:1.25rem;color:#f87171}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:50;background-color:#00000080;display:flex;align-items:center;justify-content:center;padding:1rem}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;box-shadow:0 25px 50px -12px #00000040;max-width:32rem;width:100%;max-height:90vh;overflow-y:auto}.form-input[_ngcontent-%COMP%]{transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-input[_ngcontent-%COMP%]:focus{border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e51a;outline:none}.form-select[_ngcontent-%COMP%]{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");background-position:right .5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:2.5rem}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.shadow-subtle[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}.shadow-hover[_ngcontent-%COMP%]{transition:box-shadow .15s ease-in-out}.shadow-hover[_ngcontent-%COMP%]:hover{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}`]})};function Pi(s,t){if(s&1&&(n(0,"li"),u(1,"i",110),a(2),r()),s&2){let e=t.$implicit;l(2),v("",e," ")}}function Ii(s,t){if(s&1){let e=w();n(0,"div",103)(1,"div",104)(2,"div",105),u(3,"i"),r(),n(4,"h3",106),a(5),r(),n(6,"p",64),a(7),r(),n(8,"ul",107),x(9,Pi,3,1,"li",108),r(),n(10,"button",109),_("click",function(){let o=p(e).$implicit,d=c();return g(d.showMoreInfo(o))}),a(11," M\xE1s informaci\xF3n \u2192 "),r()()()}if(s&2){let e=t.$implicit;l(3),A(e.icon+" text-white text-2xl"),l(2),C(e.title),l(2),C(e.description),l(2),m("ngForOf",e.features)}}function Oi(s,t){if(s&1&&(n(0,"div",111)(1,"div",104),u(2,"img",112),n(3,"h4",113),a(4),r(),n(5,"p",114),a(6),r(),n(7,"p",115),a(8),r(),n(9,"p",116),a(10),r()()()),s&2){let e=t.$implicit;l(2),m("src",e.image,ge)("alt",e.name),l(2),C(e.name),l(2),C(e.role),l(2),C(e.specialization),l(2),v(" ",e.experience," ")}}function Vi(s,t){s&1&&(n(0,"div",126)(1,"span",127),a(2," M\xE1s Popular "),r()())}function Fi(s,t){if(s&1&&(n(0,"li",43),u(1,"i",128),n(2,"span",129),a(3),r()()),s&2){let e=t.$implicit;l(3),C(e)}}function Di(s,t){if(s&1){let e=w();n(0,"div"),x(1,Vi,3,0,"div",117),n(2,"div",118)(3,"div",104)(4,"h3",119),a(5),r(),n(6,"div",120)(7,"span",121),a(8),r(),n(9,"span",122),a(10),r()(),n(11,"ul",123),x(12,Fi,4,1,"li",124),r(),n(13,"button",125),_("click",function(){p(e);let o=c();return g(o.bookAppointment())}),a(14),r()()()()}if(s&2){let e=t.$implicit;A("relative bg-white rounded-2xl shadow-lg border "+(e.popular?"border-red-500 ring-2 ring-red-500":"border-gray-200")),l(),m("ngIf",e.popular),l(4),C(e.name),l(3),C(e.price),l(2),C(e.period),l(2),m("ngForOf",e.features),l(),A("w-full py-3 px-6 rounded-lg font-medium transition-colors "+(e.popular?"bg-red-600 text-white hover:bg-red-700":"bg-gray-100 text-gray-900 hover:bg-gray-200")),l(),v(" ",e.buttonText," ")}}var Le=class s{constructor(t){this.router=t}services=[{icon:"fas fa-walking",title:"Evaluaci\xF3n fisioterap\xE9utica personalizada",description:"Realizamos una valoraci\xF3n integral mediante test ortop\xE9dicos, an\xE1lisis de rangos de movimiento, patrones de marcha y pruebas funcionales. Nuestro objetivo es identificar tu condici\xF3n actual, emitir un diagn\xF3stico fisioterap\xE9utico preciso y establecer el mejor plan de tratamiento basado en tus necesidades.",features:["Terapia manual","Ejercicios terap\xE9uticos","Reeducaci\xF3n postural"]},{icon:"fas fa-heartbeat",title:"Fisioterapia Deportiva",description:"Tratamiento especializado para la prevenci\xF3n, recuperaci\xF3n y readaptaci\xF3n de lesiones deportivas. Nos enfocamos en restaurar el movimiento funcional, reducir el dolor y optimizar el rendimiento f\xEDsico mediante ejercicio terap\xE9utico, t\xE9cnicas manuales y programaci\xF3n espec\xEDfica seg\xFAn tu disciplina deportiva.",features:["Prevenci\xF3n de lesiones","Recuperaci\xF3n deportiva","Acondicionamiento f\xEDsico"]},{icon:"fas fa-user-md",title:"Fisioterapia geri\xE1trica",description:"Dise\xF1amos programas de ejercicio seguros y eficaces para personas mayores, basados en herramientas de evaluaci\xF3n cl\xEDnica y funcional. Nuestro enfoque est\xE1 en mejorar fuerza, equilibrio, resistencia y capacidad aer\xF3bica, promoviendo una vejez activa, aut\xF3noma y con prop\xF3sito desde etapas tempranas.",features:["Evaluaci\xF3n completa","Seguimiento continuo","Planes personalizados"]},{icon:"fas fa-spa",title:"Programaci\xF3n de movilidad",description:"A trav\xE9s de ejercicios de movilidad articular, control motor y fuerza, buscamos aumentar tu rango de movimiento y mejorar la calidad del mismo. Ideal para personas con rigidez, dolor, sobrecargas o para quienes desean moverse mejor en su d\xEDa a d\xEDa o actividad f\xEDsica.",features:["Masoterapia","Electroterapia","Termoterapia"]},{icon:"fas fa-spa",title:"Programaci\xF3n de ejercicios funcionales",description:"Creamos un plan de entrenamiento adaptado a tus objetivos individuales: ya sea ganar fuerza, mejorar la postura, prevenir lesiones o aumentar tu rendimiento. Utilizamos movimientos funcionales y progresiones terap\xE9uticas para que alcances tus metas de forma segura, eficiente y sostenible.",features:["Masoterapia","Electroterapia","Termoterapia"]}];pricingPlans=[{name:"B\xE1sico",price:"Q275",period:"por sesi\xF3n",features:["Gu\xEDa de ejercicios","Sesi\xF3n de 45 a 60 minutos","Seguimiento personalizado"],popular:!1,buttonText:"Reservar Cita"},{name:"Profesional",price:"Q1,125",period:"paquete 5 sesiones",features:["Gu\xEDa de ejercicios","Sesiones de 45 a 60 minutos","Seguimiento personalizado"],popular:!0,buttonText:"M\xE1s Popular"},{name:"Premium",price:"Q2,250",period:"paquete 10 sesiones",features:["Gu\xEDa de ejercicios","Sesiones de 45 a 60 minutos","Seguimiento personalizado"],popular:!1,buttonText:"Mejor Valor"}];team=[{name:"Lic. Estuardo Ponciano",role:"Fisioterapeuta Principal",specialization:"Licenciado en fisioterapia",image:"/lucciuki.png",experience:"5 a\xF1os de experiencia"}];ngOnInit(){}scrollToSection(t){let e=document.getElementById(t);e&&e.scrollIntoView({behavior:"smooth"})}goToLogin(){this.router.navigate(["/login"])}contactUs(){this.scrollToSection("contacto")}bookAppointment(){alert("\xA1Pronto podr\xE1s reservar tu cita online! Por ahora cont\xE1ctanos directamente.")}showMoreInfo(t){alert(`M\xE1s informaci\xF3n sobre: ${t.title}

${t.description}`)}getTeamGridClasses(){let t=this.team.length;return t===1?"grid grid-cols-1 justify-items-center":t===2?"grid grid-cols-1 md:grid-cols-2 justify-items-center":"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 justify-items-center"}static \u0275fac=function(e){return new(e||s)(O(be))};static \u0275cmp=D({type:s,selectors:[["app-landing"]],standalone:!1,decls:264,vars:4,consts:[[1,"min-h-screen","bg-white"],[1,"fixed","top-0","w-full","bg-white/95","backdrop-blur-sm","shadow-sm","z-50"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","items-center","h-16"],[1,"flex","items-center"],[1,"flex-shrink-0","flex","items-center"],[1,"h-8","w-8","bg-red-600","rounded-lg","flex","items-center","justify-center","mr-3"],[1,"fas","fa-heartbeat","text-white"],[1,"text-xl","font-bold","text-gray-900"],[1,"hidden","md:block"],[1,"ml-10","flex","items-baseline","space-x-8"],[1,"text-gray-900","hover:text-red-600","cursor-pointer","transition-colors",3,"click"],[1,"text-gray-700","hover:text-red-600","cursor-pointer","transition-colors",3,"click"],[1,"flex","items-center","space-x-4"],[1,"bg-red-600","text-white","px-4","py-2","rounded-md","hover:bg-red-700","transition-colors",3,"click"],[1,"fas","fa-sign-in-alt","mr-2"],["id","inicio",1,"pt-16","bg-gradient-to-br","from-gray-900","via-gray-800","to-black"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-20"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-12","items-center"],[1,"text-3xl","md:text-6xl","font-bold","text-white","mb-6"],[1,"text-red-500"],[1,"text-xl","text-gray-300","mb-8"],[1,"flex","flex-col","sm:flex-row","gap-4"],[1,"bg-red-600","text-white","px-8","py-3","rounded-lg","hover:bg-red-700","transition-colors","flex","items-center","justify-center",3,"click"],[1,"fas","fa-calendar-check","mr-2"],[1,"border","border-red-600","text-red-500","px-8","py-3","rounded-lg","hover:bg-red-600","hover:text-white","transition-colors",3,"click"],[1,"relative"],[1,"bg-white","rounded-2xl","shadow-2xl","p-8","transform","rotate-3","hover:rotate-0","transition-transform","duration-300"],["src","https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=600&h=400&fit=crop","alt","Fisioterapia",1,"rounded-xl","w-full","h-64","object-cover"],[1,"mt-4"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-gray-600"],["id","servicios",1,"py-20","bg-white"],[1,"max-w-7xl","mx-auto","px-5","sm:px-6","lg:px-8"],[1,"text-center","mb-16"],[1,"text-3xl","md:text-4xl","font-bold","text-gray-900","mb-4"],[1,"text-xl","text-gray-600","max-w-2xl","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-8"],["class","bg-gray-50 rounded-xl p-6 hover:shadow-lg transition-shadow duration-300 hover:border-red-200 border border-transparent",4,"ngFor","ngForOf"],["id","nosotros",1,"py-20","bg-gray-100"],[1,"text-3xl","md:text-4xl","font-bold","text-gray-900","mb-6"],[1,"text-lg","text-gray-600","mb-6"],[1,"space-y-4"],[1,"flex","items-start"],[1,"w-8","h-8","bg-red-600","rounded-full","flex","items-center","justify-center","mr-4","mt-1"],[1,"fas","fa-award","text-white","text-sm"],[1,"font-semibold","text-gray-900"],[1,"fas","fa-heart","text-white","text-sm"],[1,"fas","fa-cogs","text-white","text-sm"],["src","https://images.unsplash.com/photo-1576091160399-112ba8d25d1f?w=600&h=500&fit=crop","alt","Equipo m\xE9dico",1,"rounded-2xl","shadow-2xl"],[1,"absolute","-bottom-6","-left-6","bg-white","rounded-xl","p-6","shadow-lg"],[1,"w-12","h-12","bg-red-100","rounded-full","flex","items-center","justify-center","mr-4"],[1,"fas","fa-users","text-red-600","text-xl"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"mt-20"],[1,"text-2xl","md:text-3xl","font-bold","text-gray-900","text-center","mb-12"],[1,"flex","justify-center"],[1,"gap-8","max-w-4xl",3,"ngClass"],["class","bg-white rounded-xl p-8 shadow-lg hover:shadow-xl transition-shadow border border-gray-200 hover:border-red-200",4,"ngFor","ngForOf"],["id","precios",1,"py-20","bg-white"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-8"],[3,"class",4,"ngFor","ngForOf"],[1,"text-center","mt-12"],[1,"text-gray-600","mb-4"],[1,"text-red-600","hover:text-red-800","font-medium",3,"click"],["id","contacto",1,"py-20","bg-gray-100"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-12"],[1,"space-y-8"],[1,"w-12","h-12","bg-red-600","rounded-full","flex","items-center","justify-center","mr-4"],[1,"fas","fa-map-marker-alt","text-white"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"fas","fa-phone","text-white"],[1,"fas","fa-envelope","text-white"],[1,"fas","fa-clock","text-white"],[1,"bg-white","rounded-2xl","shadow-lg","p-8"],[1,"text-2xl","font-bold","text-gray-900","mb-6"],[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-red-500","focus:border-transparent"],["type","email",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-red-500","focus:border-transparent"],["type","tel",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-red-500","focus:border-transparent"],["rows","4",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-red-500","focus:border-transparent"],["type","submit",1,"w-full","bg-red-600","text-white","py-3","px-6","rounded-lg","hover:bg-red-700","transition-colors"],[1,"fas","fa-paper-plane","mr-2"],[1,"bg-gray-900","text-white","py-12"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-8"],[1,"flex","items-center","mb-4"],[1,"text-xl","font-bold"],[1,"text-gray-400"],[1,"font-semibold","mb-4"],[1,"space-y-2","text-gray-400"],["href","#",1,"hover:text-red-400","transition-colors"],[1,"hover:text-red-400","transition-colors","cursor-pointer",3,"click"],[1,"flex","space-x-4"],["href","https://www.facebook.com/RehabiMovementGT","target","_blank",1,"w-10","h-10","bg-red-600","rounded-full","flex","items-center","justify-center","hover:bg-red-700","transition-colors"],[1,"fab","fa-facebook-f"],["href","https://www.instagram.com/rehabimovementgt/","target","_blank",1,"w-10","h-10","bg-red-600","rounded-full","flex","items-center","justify-center","hover:bg-red-700","transition-colors"],[1,"fab","fa-instagram"],["href","#","target","_blank",1,"w-10","h-10","b]g-red-600","rounded-full","flex","items-center","justify-center","hover:bg-red-700","transition-colors"],[1,"fab","fa-whatsapp"],[1,"border-t","border-gray-800","mt-12","pt-8","text-center","text-gray-400"],[1,"bg-gray-50","rounded-xl","p-6","hover:shadow-lg","transition-shadow","duration-300","hover:border-red-200","border","border-transparent"],[1,"text-center"],[1,"w-16","h-16","bg-red-600","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"text-xl","font-semibold","text-gray-900","mb-3"],[1,"text-sm","text-gray-500","space-y-1"],[4,"ngFor","ngForOf"],[1,"mt-4","text-red-600","hover:text-red-800","font-medium",3,"click"],[1,"fas","fa-check","text-red-600","mr-2"],[1,"bg-white","rounded-xl","p-8","shadow-lg","hover:shadow-xl","transition-shadow","border","border-gray-200","hover:border-red-200"],[1,"w-32","h-32","rounded-full","mx-auto","mb-6","object-cover","border-4","border-red-100",3,"src","alt"],[1,"text-2xl","font-semibold","text-gray-900","mb-2"],[1,"text-red-600","font-medium","text-lg","mb-3"],[1,"text-gray-600","mb-2"],[1,"text-gray-500","text-sm","bg-gray-50","px-4","py-2","rounded-full","inline-block"],["class","absolute -top-4 left-1/2 transform -translate-x-1/2",4,"ngIf"],[1,"p-8"],[1,"text-2xl","font-bold","text-gray-900","mb-4"],[1,"mb-6"],[1,"text-4xl","font-bold","text-red-600"],[1,"text-gray-600","ml-2"],[1,"space-y-3","mb-8"],["class","flex items-start",4,"ngFor","ngForOf"],[3,"click"],[1,"absolute","-top-4","left-1/2","transform","-translate-x-1/2"],[1,"bg-red-600","text-white","px-4","py-1","rounded-full","text-sm","font-medium"],[1,"fas","fa-check","text-red-600","mr-3","mt-1"],[1,"text-gray-700"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"nav",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),u(7,"i",7),r(),n(8,"span",8),a(9,"RehabiMovement"),r()()(),n(10,"div",9)(11,"div",10)(12,"a",11),_("click",function(){return i.scrollToSection("inicio")}),a(13,"Inicio"),r(),n(14,"a",12),_("click",function(){return i.scrollToSection("servicios")}),a(15,"Servicios"),r(),n(16,"a",12),_("click",function(){return i.scrollToSection("nosotros")}),a(17,"Nosotros"),r(),n(18,"a",12),_("click",function(){return i.scrollToSection("precios")}),a(19,"Precios"),r(),n(20,"a",12),_("click",function(){return i.scrollToSection("contacto")}),a(21,"Contacto"),r()()(),n(22,"div",13)(23,"button",14),_("click",function(){return i.goToLogin()}),u(24,"i",15),a(25,"Login "),r()()()()(),n(26,"section",16)(27,"div",17)(28,"div",18)(29,"div")(30,"h1",19),a(31," Recupera y optimiza "),n(32,"span",20),a(33,"Tu Movimiento"),r()(),n(34,"p",21),a(35," Fisioterapia especializada en Guatemala. El movimiento es vida. Nosotros te ayudamos a recuperarlo. Devolvemos calidad de vida a nuestros pacientes a trav\xE9s de tratamientos personalizados que combinan ejercicio terap\xE9utico, atenci\xF3n cercana y rehabilitaci\xF3n basada en evidencia. Dise\xF1amos planes \xFAnicos para cada etapa de la vida, enfoc\xE1ndonos en el movimiento, la funcionalidad y tu bienestar integral. "),r(),n(36,"div",22)(37,"button",23),_("click",function(){return i.bookAppointment()}),u(38,"i",24),a(39," Reservar Cita "),r(),n(40,"button",25),_("click",function(){return i.scrollToSection("servicios")}),a(41," Conocer Servicios "),r()()(),n(42,"div",26)(43,"div",27),u(44,"img",28),n(45,"div",29)(46,"h3",30),a(47,"Tratamiento Profesional"),r(),n(48,"p",31),a(49,"Con equipos de \xFAltima generaci\xF3n"),r()()()()()()(),n(50,"section",32)(51,"div",33)(52,"div",34)(53,"h2",35),a(54," Nuestros Servicios "),r(),n(55,"p",36),a(56," Ofrecemos una amplia gama de servicios especializaos para tu recuperaci\xF3n y bienestar "),r()(),n(57,"div",37),x(58,Ii,12,5,"div",38),r()()(),n(59,"section",39)(60,"div",2)(61,"div",18)(62,"div")(63,"h2",40),a(64," Qui\xE9nes Somos "),r(),n(65,"p",41),a(66," RehabiMovement es una cl\xEDnica de fisioterapia ubicada en zona 15, Ciudad de Guatemala, comprometida con devolver el movimiento y la calidad de vida a nuestros pacientes. Nos especializamos en la atenci\xF3n personalizada a trav\xE9s del ejercicio terap\xE9utico, siendo este el pilar fundamental de nuestros tratamientos. "),r(),n(67,"p",41),a(68," Con m\xE1s de 5 a\xF1os de experiencia cl\xEDnica, hemos acompa\xF1ado a cientos de personas en su proceso de rehabilitaci\xF3n, desde adultos mayores hasta deportistas, ayud\xE1ndoles a recuperar su funcionalidad, reducir el dolor y alcanzar sus objetivos de salud. "),r(),n(69,"p",41),a(70," Creemos firmemente en el poder del movimiento, el trato humano y la planificaci\xF3n basada en evidencia cient\xEDfica. Nuestro equipo est\xE1 en constante formaci\xF3n para ofrecerte lo mejor de la fisioterapia actual, adaptada a tus necesidades espec\xEDficas. "),r(),n(71,"div",42)(72,"div",43)(73,"div",44),u(74,"i",45),r(),n(75,"div")(76,"h4",46),a(77,"Profesionales Certificados"),r(),n(78,"p",31),a(79,"Nuestro equipo cuenta con las mejores certificaciones internacionales"),r()()(),n(80,"div",43)(81,"div",44),u(82,"i",47),r(),n(83,"div")(84,"h4",46),a(85,"Atenci\xF3n Personalizada"),r(),n(86,"p",31),a(87,"Cada paciente recibe un plan de tratamiento \xFAnico y personalizado"),r()()(),n(88,"div",43)(89,"div",44),u(90,"i",48),r(),n(91,"div")(92,"h4",46),a(93,"Tecnolog\xEDa Avanzada"),r(),n(94,"p",31),a(95,"Utilizamos equipos de \xFAltima generaci\xF3n para mejores resultados"),r()()()()(),n(96,"div",26),u(97,"img",49),n(98,"div",50)(99,"div",4)(100,"div",51),u(101,"i",52),r(),n(102,"div")(103,"p",53),a(104,"500+"),r(),n(105,"p",54),a(106,"Pacientes Satisfechos"),r()()()()()(),n(107,"div",55)(108,"h3",56),a(109," Nuestro Equipo "),r(),n(110,"div",57)(111,"div",58),x(112,Oi,11,6,"div",59),r()()()()(),n(113,"section",60)(114,"div",2)(115,"div",34)(116,"h2",35),a(117," Nuestros Precios "),r(),n(118,"p",36),a(119," Planes accesibles para todos los presupuestos. Inversi\xF3n en tu salud y bienestar. "),r()(),n(120,"div",61),x(121,Di,15,10,"div",62),r(),n(122,"div",63)(123,"p",64),a(124," \xBFNecesitas un plan personalizado? "),r(),n(125,"button",65),_("click",function(){return i.contactUs()}),a(126," Cont\xE1ctanos para una consulta gratuita \u2192 "),r()()()(),n(127,"section",66)(128,"div",2)(129,"div",34)(130,"h2",35),a(131," Cont\xE1ctenos "),r(),n(132,"p",36),a(133," Estamos aqu\xED para ayudarte. Cont\xE1ctanos para programar tu consulta inicial. "),r()(),n(134,"div",67)(135,"div")(136,"div",68)(137,"div",43)(138,"div",69),u(139,"i",70),r(),n(140,"div")(141,"h4",71),a(142,"Direcci\xF3n"),r(),n(143,"p",31),a(144," Zona 15, Ciudad de Guatemala"),u(145,"br"),a(146," 19 avenida, 4-02 Vista Hermosa I"),u(147,"br"),a(148," Guatemala, Guatemala "),r()()(),n(149,"div",43)(150,"div",69),u(151,"i",72),r(),n(152,"div")(153,"h4",71),a(154,"Tel\xE9fono"),r(),n(155,"p",31),a(156," +502 5412-1199"),u(157,"br"),a(158," +502 5879-5979 "),r()()(),n(159,"div",43)(160,"div",69),u(161,"i",73),r(),n(162,"div")(163,"h4",71),a(164,"Email"),r(),n(165,"p",31),a(166," rehabimovementgt@gmail.com"),u(167,"br"),r()()(),n(168,"div",43)(169,"div",69),u(170,"i",74),r(),n(171,"div")(172,"h4",71),a(173,"Horarios"),r(),n(174,"p",31),a(175," Lunes a Viernes: 7:00 AM - 8:00 PM"),u(176,"br"),a(177," S\xE1bados: 8:00 AM - 4:00 PM"),u(178,"br"),a(179," Domingos: Cerrado "),r()()()()(),n(180,"div",75)(181,"h3",76),a(182,"Env\xEDanos un mensaje"),r(),n(183,"form",77)(184,"div",78)(185,"div")(186,"label",79),a(187,"Nombre"),r(),u(188,"input",80),r(),n(189,"div")(190,"label",79),a(191,"Apellido"),r(),u(192,"input",80),r()(),n(193,"div")(194,"label",79),a(195,"Email"),r(),u(196,"input",81),r(),n(197,"div")(198,"label",79),a(199,"Tel\xE9fono"),r(),u(200,"input",82),r(),n(201,"div")(202,"label",79),a(203,"Mensaje"),r(),u(204,"textarea",83),r(),n(205,"button",84),u(206,"i",85),a(207," Enviar Mensaje "),r()()()()()(),n(208,"footer",86)(209,"div",2)(210,"div",87)(211,"div")(212,"div",88)(213,"div",6),u(214,"i",7),r(),n(215,"span",89),a(216,"RehabiMovement"),r()(),n(217,"p",90),a(218," Recupera tu movimiento y mejora tu calidad de vida con nuestros tratamientos especializados. "),r()(),n(219,"div")(220,"h4",91),a(221,"Servicios"),r(),n(222,"ul",92)(223,"li")(224,"a",93),a(225,"Rehabilitaci\xF3n Motora"),r()(),n(226,"li")(227,"a",93),a(228,"Fisioterapia Deportiva"),r()(),n(229,"li")(230,"a",93),a(231,"Terapia Personalizada"),r()(),n(232,"li")(233,"a",93),a(234,"Terapias Alternativas"),r()()()(),n(235,"div")(236,"h4",91),a(237,"Enlaces"),r(),n(238,"ul",92)(239,"li")(240,"a",94),_("click",function(){return i.scrollToSection("inicio")}),a(241,"Inicio"),r()(),n(242,"li")(243,"a",94),_("click",function(){return i.scrollToSection("nosotros")}),a(244,"Nosotros"),r()(),n(245,"li")(246,"a",94),_("click",function(){return i.scrollToSection("precios")}),a(247,"Precios"),r()(),n(248,"li")(249,"a",94),_("click",function(){return i.scrollToSection("contacto")}),a(250,"Contacto"),r()()()(),n(251,"div")(252,"h4",91),a(253,"S\xEDguenos"),r(),n(254,"div",95)(255,"a",96),u(256,"i",97),r(),n(257,"a",98),u(258,"i",99),r(),n(259,"a",100),u(260,"i",101),r()()()(),n(261,"div",102)(262,"p"),a(263,"\xA9 2025 RehabiMovement. Todos los derechos reservados."),r()()()()()),e&2&&(l(58),m("ngForOf",i.services),l(53),m("ngClass",i.getTeamGridClasses()),l(),m("ngForOf",i.team),l(9),m("ngForOf",i.pricingPlans))},dependencies:[$,z,R,te,ee,se],styles:['html[_ngcontent-%COMP%]{scroll-behavior:smooth}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}.hero-title[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp 1s ease-out}.hero-subtitle[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp 1s ease-out .2s both}.hero-buttons[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp 1s ease-out .4s both}.hero-image[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp 1s ease-out .6s both}.hero-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_float 3s ease-in-out infinite}.service-card[_ngcontent-%COMP%]{transition:all .3s ease}.service-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;border-color:#dc2626!important}.service-icon[_ngcontent-%COMP%]{transition:all .3s ease}.service-card[_ngcontent-%COMP%]:hover   .service-icon[_ngcontent-%COMP%]{transform:scale(1.1);animation:_ngcontent-%COMP%_pulse 2s infinite}.team-card[_ngcontent-%COMP%]{transition:all .3s ease;max-width:350px}.team-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);border-color:#dc2626!important}.team-avatar[_ngcontent-%COMP%]{transition:all .3s ease}.team-card[_ngcontent-%COMP%]:hover   .team-avatar[_ngcontent-%COMP%]{transform:scale(1.1)}.team-single[_ngcontent-%COMP%]{max-width:400px;margin:0 auto}.team-single[_ngcontent-%COMP%]   .team-avatar[_ngcontent-%COMP%]{width:8rem;height:8rem;border-width:4px}.team-experience-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#e2e8f0);border:1px solid #e2e8f0}.pricing-card[_ngcontent-%COMP%]{transition:all .3s ease}.pricing-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.navbar[_ngcontent-%COMP%]{backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}.nav-link[_ngcontent-%COMP%]{position:relative;transition:all .3s ease}.nav-link[_ngcontent-%COMP%]:hover{color:#dc2626}.nav-link[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-2px;left:0;width:0;height:2px;background-color:#dc2626;transition:width .3s ease}.nav-link[_ngcontent-%COMP%]:hover:after{width:100%}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc2626,#b91c1c);transition:all .3s ease}.btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#b91c1c,#991b1b);transform:translateY(-2px);box-shadow:0 10px 20px #dc26264d}.btn-secondary[_ngcontent-%COMP%]{transition:all .3s ease;border-color:#dc2626;color:#dc2626}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#dc2626;color:#fff;transform:translateY(-2px);box-shadow:0 10px 20px #dc26264d}.form-input[_ngcontent-%COMP%]{transition:all .3s ease}.form-input[_ngcontent-%COMP%]:focus{border-color:#dc2626;box-shadow:0 0 0 3px #dc26261a}.gradient-bg[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#111827)}.gradient-text[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc2626,#991b1b);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.hero-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#111827,#000)}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#dc2626;border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#b91c1c}.text-accent[_ngcontent-%COMP%]{color:#dc2626}.bg-accent[_ngcontent-%COMP%]{background-color:#dc2626}.border-accent[_ngcontent-%COMP%]{border-color:#dc2626}.hover-accent[_ngcontent-%COMP%]:hover{color:#dc2626}@media (max-width: 768px){.hero-title[_ngcontent-%COMP%]{font-size:2.5rem}.section-title[_ngcontent-%COMP%]{font-size:2rem}.mobile-menu[_ngcontent-%COMP%]{display:block}.desktop-menu[_ngcontent-%COMP%]{display:none}}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:-468px 0}to{background-position:468px 0}}.loading-shimmer[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shimmer 1.5s ease-in-out infinite;background:linear-gradient(to right,#f6f7f8,#edeef1 20%,#f6f7f8 40% 100%);background-size:800px 104px}.tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip[_ngcontent-%COMP%]   .tooltiptext[_ngcontent-%COMP%]{visibility:hidden;width:120px;background-color:#1f2937;color:#fff;text-align:center;border-radius:6px;padding:5px 0;position:absolute;z-index:1;bottom:150%;left:50%;margin-left:-60px;opacity:0;transition:opacity .3s}.tooltip[_ngcontent-%COMP%]:hover   .tooltiptext[_ngcontent-%COMP%]{visibility:visible;opacity:1}.card-shadow[_ngcontent-%COMP%]{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.card-shadow-lg[_ngcontent-%COMP%]{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}.card-shadow-xl[_ngcontent-%COMP%]{box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.card-shadow-red[_ngcontent-%COMP%]:hover{box-shadow:0 20px 25px -5px #dc26261a,0 10px 10px -5px #dc26260a}.stat-counter[_ngcontent-%COMP%]{transition:all .3s ease}.stat-counter[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.section-padding[_ngcontent-%COMP%]{padding:5rem 0}@media (max-width: 768px){.section-padding[_ngcontent-%COMP%]{padding:3rem 0}}.image-overlay[_ngcontent-%COMP%]{position:relative;overflow:hidden}.image-overlay[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(45deg,#dc26261a,#b91c1c1a);opacity:0;transition:opacity .3s ease}.image-overlay[_ngcontent-%COMP%]:hover:before{opacity:1}.contact-form[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8fafc)}.contact-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.contact-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#374151;margin-bottom:.5rem;display:block}.contact-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .contact-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:1px solid #d1d5db;border-radius:.5rem;font-size:1rem;transition:all .3s ease}.contact-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .contact-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#dc2626;box-shadow:0 0 0 3px #dc26261a}.footer[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#111827)}.footer-link[_ngcontent-%COMP%]{transition:all .3s ease}.footer-link[_ngcontent-%COMP%]:hover{color:#fca5a5;transform:translate(4px)}.social-btn[_ngcontent-%COMP%]{transition:all .3s ease}.social-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #dc26264d}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.focus-visible[_ngcontent-%COMP%]:focus{outline:2px solid #dc2626;outline-offset:2px}.btn-red[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc2626,#b91c1c);color:#fff;transition:all .3s ease}.btn-red[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#b91c1c,#991b1b);transform:translateY(-2px);box-shadow:0 8px 16px #dc26264d}.btn-red-outline[_ngcontent-%COMP%]{border:2px solid #dc2626;color:#dc2626;background:transparent;transition:all .3s ease}.btn-red-outline[_ngcontent-%COMP%]:hover{background:#dc2626;color:#fff;transform:translateY(-2px)}.dark-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#111827,#000)}.dark-card[_ngcontent-%COMP%]{background:#1f2937cc;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.3)}@media print{.no-print[_ngcontent-%COMP%]{display:none}*[_ngcontent-%COMP%]{-webkit-print-color-adjust:exact!important;color-adjust:exact!important}.card[_ngcontent-%COMP%]{box-shadow:none;border:1px solid #e5e7eb}.text-red-600[_ngcontent-%COMP%], .bg-red-600[_ngcontent-%COMP%]{color:#dc2626!important;background-color:#dc2626!important}}']})};var Rt=s=>[s];function Ai(s,t){if(s&1&&u(0,"i"),s&2){let e=c(2).$implicit;A("flex-shrink-0 w-5 h-5 mr-3 "+e.icono)}}function Ri(s,t){s&1&&(h(),n(0,"svg",55),u(1,"path",56),r())}function ji(s,t){if(s&1&&(h(),n(0,"svg",57),u(1,"path",58),r()),s&2){let e=c(2).$implicit,i=c();A("w-4 h-4 transition-transform duration-200 module-arrow "+(i.isModuleExpanded(e.id_modulo)?"module-expanded":""))}}function Ui(s,t){if(s&1&&u(0,"i"),s&2){let e=c().$implicit;A("flex-shrink-0 w-4 h-4 mr-3 "+e.icono)}}function Li(s,t){s&1&&(h(),n(0,"svg",63),u(1,"path",64),r())}function Ni(s,t){if(s&1){let e=w();n(0,"a",61),_("click",function(){p(e);let o=c(4);return g(o.handleNavigation())}),x(1,Ui,1,2,"i",51)(2,Li,2,0,"svg",62),a(3),r()}if(s&2){let e=t.$implicit;m("routerLink",_t(4,Rt,e.ruta)),l(),m("ngIf",e.icono),l(),m("ngIf",!e.icono),l(),v(" ",e.nombre," ")}}function zi(s,t){if(s&1&&(n(0,"div",59),x(1,Ni,4,6,"a",60),r()),s&2){let e=c(2).$implicit,i=c();l(),m("ngForOf",i.getFilteredChildren(e))}}function Bi(s,t){if(s&1){let e=w();n(0,"div")(1,"button",50),_("click",function(){p(e);let o=c().$implicit,d=c();return g(d.toggleModule(o.id_modulo))}),x(2,Ai,1,2,"i",51)(3,Ri,2,0,"svg",52),n(4,"span"),a(5),r(),x(6,ji,2,2,"svg",53),r(),x(7,zi,2,1,"div",54),r()}if(s&2){let e=c().$implicit,i=c();l(),m("disabled",i.isSidebarCollapsed&&!i.isMobile()),Re("data-tooltip",i.isSidebarCollapsed&&!i.isMobile()?e.nombre:null),l(),m("ngIf",e.icono),l(),m("ngIf",!e.icono),l(),A(i.isSidebarCollapsed&&!i.isMobile()?"hidden":"flex-1 text-left"),l(),C(e.nombre),l(),m("ngIf",!i.isSidebarCollapsed||i.isMobile()),l(),m("ngIf",i.isModuleExpanded(e.id_modulo)&&(!i.isSidebarCollapsed||i.isMobile()))}}function $i(s,t){if(s&1&&u(0,"i"),s&2){let e=c(2).$implicit;A("flex-shrink-0 w-5 h-5 mr-3 "+e.icono)}}function Wi(s,t){s&1&&(h(),n(0,"svg",55),u(1,"path",56),r())}function Gi(s,t){if(s&1){let e=w();n(0,"a",65),_("click",function(){p(e);let o=c(2);return g(o.handleNavigation())}),x(1,$i,1,2,"i",51)(2,Wi,2,0,"svg",52),n(3,"span"),a(4),r()()}if(s&2){let e=c().$implicit,i=c();m("routerLink",_t(7,Rt,e.ruta)),Re("data-tooltip",i.isSidebarCollapsed&&!i.isMobile()?e.nombre:null),l(),m("ngIf",e.icono),l(),m("ngIf",!e.icono),l(),A(i.isSidebarCollapsed&&!i.isMobile()?"hidden":"block"),l(),C(e.nombre)}}function Hi(s,t){if(s&1&&(n(0,"div",12),x(1,Bi,8,9,"div",48)(2,Gi,5,9,"a",49),r()),s&2){let e=t.$implicit,i=c();l(),m("ngIf",e.es_padre&&i.getFilteredChildren(e).length>0),l(),m("ngIf",!e.es_padre||i.getFilteredChildren(e).length===0)}}function qi(s,t){if(s&1){let e=w();n(0,"img",66),_("error",function(o){return p(e),g(o.target.style.display="none")}),r()}if(s&2){let e=c();m("src",e.getCurrentUserAvatarUrl(),ge)("alt",(e.currentUser==null?null:e.currentUser.full_name)||"Avatar")}}function Yi(s,t){if(s&1&&(n(0,"span",67),a(1),r()),s&2){let e=c();l(),v(" ",e.getUserInitials()," ")}}function Qi(s,t){s&1&&(n(0,"div",68),u(1,"div",69),r())}function Ji(s,t){if(s&1){let e=w();n(0,"button",70),_("click",function(){p(e),c();let o=Y(34);return g(o.click())}),h(),n(1,"svg",71),u(2,"path",72)(3,"path",73),r()()}}function Zi(s,t){if(s&1){let e=w();n(0,"button",74),_("click",function(){p(e);let o=c();return g(o.toggleDropdown())}),h(),n(1,"svg",75),u(2,"path",76),r()()}}function Xi(s,t){if(s&1){let e=w();n(0,"button",77),_("click",function(){p(e);let o=c();return g(o.logout())}),h(),n(1,"svg",75),u(2,"path",45),r()()}}function Ki(s,t){if(s&1){let e=w();n(0,"div",78)(1,"button",79),_("click",function(){p(e);let o=c();return g(o.openProfileModal())}),u(2,"i",80),a(3," Mi Perfil "),r(),n(4,"button",79),_("click",function(){p(e);let o=c();return g(o.goToSettings())}),u(5,"i",81),a(6," Configuraci\xF3n "),r(),n(7,"button",79),_("click",function(){p(e);let o=c();return Y(34).click(),g(o.showDropdown=!1)}),u(8,"i",82),a(9," Cambiar Foto "),r(),u(10,"hr",83),n(11,"button",84),_("click",function(){p(e);let o=c();return g(o.logout())}),u(12,"i",85),a(13," Cerrar Sesi\xF3n "),r()()}}function en(s,t){if(s&1){let e=w();n(0,"div",86),_("click",function(){p(e);let o=c();return g(o.closeMobileMenu())}),r()}}function tn(s,t){if(s&1){let e=w();n(0,"button",87),_("click",function(){p(e);let o=c();return g(o.openMobileMenu())}),h(),n(1,"svg",88),u(2,"path",89),r()()}}function nn(s,t){if(s&1){let e=w();n(0,"img",66),_("error",function(o){return p(e),g(o.target.style.display="none")}),r()}if(s&2){let e=c();m("src",e.getCurrentUserAvatarUrl(),ge)("alt",(e.currentUser==null?null:e.currentUser.full_name)||"Avatar")}}function rn(s,t){if(s&1&&(n(0,"span",90),a(1),r()),s&2){let e=c();l(),v(" ",e.getUserInitials()," ")}}var et=class s{constructor(t,e,i,o){this.authService=t;this.permissionsService=e;this.supabaseService=i;this.router=o}currentUser=null;menuItems=[];isSidebarCollapsed=!1;isMobileMenuOpen=!1;currentRoute="";expandedModules=new Set;loading=!1;isMobileView=!1;showDropdown=!1;isUploadingAvatar=!1;stats={totalUsers:0,activeProjects:23,pendingTasks:47,totalReports:156};subscriptions=new Ne;onResize(t){this.checkViewportSize()}ngOnInit(){return b(this,null,function*(){if(console.log("Layout inicializado"),this.checkViewportSize(),this.currentUser=this.authService.getCurrentUser(),!this.currentUser){console.log("No hay usuario autenticado, redirigiendo a login"),this.router.navigate(["/login"]);return}yield this.loadUserMenu(),yield this.loadDashboardStats(),this.subscriptions.add(this.router.events.pipe(ze(t=>t instanceof He)).subscribe(t=>{this.currentRoute=t.urlAfterRedirects,this.isMobileMenuOpen&&this.closeMobileMenu(),console.log("Ruta actual en layout:",this.currentRoute)})),this.currentRoute=this.router.url})}ngOnDestroy(){this.subscriptions.unsubscribe()}checkViewportSize(){let t=this.isMobileView;this.isMobileView=window.innerWidth<=768,t!==this.isMobileView&&(this.isMobileView?(this.isMobileMenuOpen=!1,this.isSidebarCollapsed=!1):this.isMobileMenuOpen=!1)}isMobile(){return this.isMobileView}getSidebarClasses(){let t="sidebar text-white transition-all duration-300 ease-in-out ";return this.isMobile()?t+=this.isMobileMenuOpen?"sidebar-mobile-open":"":t+=this.isSidebarCollapsed?"sidebar-collapsed":"sidebar-expanded",t}getMainContentClasses(){let t="transition-smooth flex flex-col min-h-screen ";return this.isMobile()||(t+=this.isSidebarCollapsed?"main-content-collapsed":"main-content-expanded"),t}loadUserMenu(){return b(this,null,function*(){try{console.log("Cargando men\xFA del usuario en layout..."),this.menuItems=yield this.permissionsService.loadUserMenu(),(!this.menuItems||this.menuItems.length===0)&&(console.log("No se obtuvo men\xFA de la BD, usando men\xFA por defecto"),this.menuItems=this.createDefaultMenu()),this.updateExpandedModules(),console.log("Men\xFA cargado en layout:",this.menuItems)}catch(t){console.error("Error cargando men\xFA:",t),this.menuItems=this.createDefaultMenu(),this.updateExpandedModules()}})}createDefaultMenu(){return[{id_modulo:1,nombre:"Dashboard",descripcion:"Panel principal",icono:"fas fa-tachometer-alt",ruta:"/dashboard",orden:1,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1},{id_modulo:2,nombre:"Mis Rutinas",descripcion:"Gesti\xF3n de rutinas de entrenamiento",icono:"fas fa-dumbbell",ruta:"/rutinas",orden:2,es_padre:!0,modulo_padre_id:null,permisos:["view"],expanded:!1,children:[{id_modulo:7,nombre:"Ver Rutinas",descripcion:"Ver todas mis rutinas",icono:"fas fa-eye",ruta:"/rutinas/lista",orden:1,es_padre:!1,modulo_padre_id:2,permisos:["view"],expanded:!1},{id_modulo:8,nombre:"Crear Rutina",descripcion:"Crear nueva rutina",icono:"fas fa-plus",ruta:"/rutinas/crear",orden:2,es_padre:!1,modulo_padre_id:2,permisos:["create"],expanded:!1},{id_modulo:9,nombre:"Ejercicios",descripcion:"Biblioteca de ejercicios",icono:"fas fa-list",ruta:"/rutinas/ejercicios",orden:3,es_padre:!1,modulo_padre_id:2,permisos:["view"],expanded:!1}]},{id_modulo:3,nombre:"Usuarios",descripcion:"Gesti\xF3n de usuarios",icono:"fas fa-users",ruta:"/usuarios",orden:3,es_padre:!0,modulo_padre_id:null,permisos:["view"],expanded:!1,children:[{id_modulo:10,nombre:"Lista de Usuarios",descripcion:"Ver todos los usuarios",icono:"fas fa-list",ruta:"/usuarios/lista",orden:1,es_padre:!1,modulo_padre_id:3,permisos:["view"],expanded:!1},{id_modulo:11,nombre:"Crear Usuario",descripcion:"Crear nuevo usuario",icono:"fas fa-user-plus",ruta:"/usuarios/crear",orden:2,es_padre:!1,modulo_padre_id:3,permisos:["create"],expanded:!1}]},{id_modulo:4,nombre:"Reportes",descripcion:"Sistema de reportes",icono:"fas fa-chart-bar",ruta:"/reportes",orden:4,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1},{id_modulo:5,nombre:"Configuraci\xF3n",descripcion:"Configuraci\xF3n del sistema",icono:"fas fa-cog",ruta:"/configuracion",orden:5,es_padre:!1,modulo_padre_id:null,permisos:["view"],expanded:!1}]}loadDashboardStats(){return b(this,null,function*(){try{let t=yield this.supabaseService.getData("profiles");this.stats.totalUsers=t?.length||0}catch(t){console.error("Error cargando estad\xEDsticas:",t)}})}updateExpandedModules(){this.menuItems.forEach(t=>{t.expanded===void 0&&(t.expanded=!1),t.children&&t.children.forEach(e=>{e.expanded===void 0&&(e.expanded=!1)})})}toggleSidebar(){this.isMobile()?this.toggleMobileMenu():(this.isSidebarCollapsed=!this.isSidebarCollapsed,console.log("Sidebar colapsado:",this.isSidebarCollapsed),this.isSidebarCollapsed&&(this.expandedModules.clear(),this.menuItems.forEach(t=>{t.expanded=!1})))}toggleMobileMenu(){this.isMobileMenuOpen=!this.isMobileMenuOpen,console.log("Men\xFA m\xF3vil abierto:",this.isMobileMenuOpen),this.isMobileMenuOpen?document.body.style.overflow="hidden":document.body.style.overflow=""}openMobileMenu(){this.isMobile()&&(this.isMobileMenuOpen=!0,document.body.style.overflow="hidden")}closeMobileMenu(){this.isMobileMenuOpen=!1,document.body.style.overflow=""}handleNavigation(){this.isMobile()&&this.isMobileMenuOpen&&this.closeMobileMenu()}toggleModule(t){if(!this.isMobile()&&this.isSidebarCollapsed)return;this.expandedModules.has(t)?this.expandedModules.delete(t):this.expandedModules.add(t);let e=this.menuItems.find(i=>i.id_modulo===t);e&&(e.expanded=this.expandedModules.has(t))}isModuleExpanded(t){return this.expandedModules.has(t)}getFilteredMenuItems(){return this.menuItems.filter(t=>!t.modulo_padre_id)}getFilteredChildren(t){return t.children?t.children:this.menuItems.filter(e=>e.modulo_padre_id===t.id_modulo)}isRouteActive(t){return!t||t==="#"?!1:this.currentRoute===t||this.currentRoute.startsWith(t+"/")}navigateTo(t){t&&t!=="#"&&(console.log("Navegando a:",t),this.router.navigate([t]),this.handleNavigation())}getUserInitials(){if(!this.currentUser?.full_name)return"U";let t=this.currentUser.full_name.split(" ");return t.length>=2?(t[0].charAt(0)+t[1].charAt(0)).toUpperCase():this.currentUser.full_name.charAt(0).toUpperCase()}getUserRole(){switch(this.currentUser?.id_perfil){case 1:return"Administrador";case 2:return"Usuario";case 3:return"Supervisor";case 4:return"Invitado";default:return"Usuario"}}logout(){console.log("Cerrando sesi\xF3n desde layout"),this.permissionsService.clearUserData(),this.currentUser=null,this.menuItems=[],this.expandedModules.clear(),this.isSidebarCollapsed=!1,this.closeMobileMenu(),this.authService.logout()}getPageTitle(){let t={"/dashboard":"Dashboard","/rutinas":"Mis Rutinas","/rutinas/lista":"Ver Rutinas","/rutinas/crear":"Crear Rutina","/rutinas/editar":"Editar Rutina","/rutinas/ejercicios":"Biblioteca de Ejercicios","/usuarios":"Gesti\xF3n de Usuarios","/usuarios/lista":"Lista de Usuarios","/usuarios/crear":"Crear Usuario","/usuarios/editar":"Editar Usuario","/reportes":"Reportes","/configuracion":"Configuraci\xF3n"};if(t[this.currentRoute])return t[this.currentRoute];for(let e in t)if(this.currentRoute.startsWith(e))return t[e];return"Sistema de Gesti\xF3n"}isDashboardRoute(){return this.currentRoute==="/dashboard"}isRutinasRoute(){return this.currentRoute.startsWith("/rutinas")}formatDate(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return"Fecha inv\xE1lida"}}refreshDashboard(){return b(this,null,function*(){this.loading=!0;try{yield this.loadUserMenu(),yield this.loadDashboardStats(),yield this.permissionsService.loadUserPermissions()}catch(t){console.error("Error refrescando dashboard:",t)}finally{this.loading=!1}})}getSidebarState(){return this.isMobile()?this.isMobileMenuOpen?"mobile-open":"mobile-closed":this.isSidebarCollapsed?"collapsed":"expanded"}getTotalRutinas(){return 12}getRutinasCompletadas(){return 8}getEjerciciosFavoritos(){return 25}getModuleIcon(t){return{Dashboard:"fas fa-tachometer-alt","Mis Rutinas":"fas fa-dumbbell",Usuarios:"fas fa-users",Reportes:"fas fa-chart-bar",Configuraci\u00F3n:"fas fa-cog","Ver Rutinas":"fas fa-eye","Crear Rutina":"fas fa-plus",Ejercicios:"fas fa-list"}[t]||"fas fa-circle"}debugSidebarState(){console.log("Debug Sidebar State:",{isMobile:this.isMobile(),isMobileView:this.isMobileView,isSidebarCollapsed:this.isSidebarCollapsed,isMobileMenuOpen:this.isMobileMenuOpen,windowWidth:window.innerWidth,sidebarState:this.getSidebarState()})}closeDropdown(t){t.target.closest(".user-dropdown")||(this.showDropdown=!1)}toggleDropdown(){this.showDropdown=!this.showDropdown}onAvatarFileSelected(t){let e=t.target;e.files&&e.files[0]&&this.uploadAvatar(e.files[0])}uploadAvatar(t){return b(this,null,function*(){if(this.currentUser){this.isUploadingAvatar=!0;try{let e=yield this.authService.updateUserAvatar(t);e.success&&e.user?(this.currentUser=e.user,console.log(e.message),this.showSuccessNotification("Foto de perfil actualizada correctamente")):(console.error(e.message),this.showErrorNotification(e.message))}catch(e){console.error("Error uploading avatar:",e),this.showErrorNotification("Error al subir la imagen")}finally{this.isUploadingAvatar=!1}}})}getCurrentUserAvatarUrl(){return this.authService.getAvatarUrl(this.currentUser||void 0)}showSuccessNotification(t){console.log("Success:",t)}showErrorNotification(t){console.error("Error:",t),alert(t)}openProfileModal(){this.showDropdown=!1,console.log("Abrir modal de perfil")}goToSettings(){this.showDropdown=!1,this.router.navigate(["/configuracion"])}static \u0275fac=function(e){return new(e||s)(O(L),O(Ye),O(Q),O(be))};static \u0275cmp=D({type:s,selectors:[["app-layout"]],hostBindings:function(e,i){e&1&&_("resize",function(d){return i.onResize(d)},!1,wt)("click",function(d){return i.closeDropdown(d)},!1,yt)},standalone:!1,decls:66,vars:29,consts:[["initialsTemplate",""],["fileInput",""],["headerInitialsTemplate",""],[1,"min-h-screen","bg-gray-50"],[1,"sidebar-header","flex","items-center","justify-between","p-4","border-b","border-gray-700"],[1,"text-xl","font-bold"],[1,"text-sm","text-gray-300"],[1,"sidebar-toggle-btn","p-2","rounded-lg","hover:bg-gray-800","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],[1,"nav-scroll-container"],[1,"px-2"],[1,"space-y-1"],["class","space-y-1",4,"ngFor","ngForOf"],[1,"user-section","p-4"],[1,"flex-shrink-0","relative"],[1,"user-avatar","h-10","w-10","rounded-full","overflow-hidden","bg-gradient-to-br","from-blue-500","to-purple-600","flex","items-center","justify-center","shadow-lg","cursor-pointer",3,"click"],["class","w-full h-full object-cover",3,"src","alt","error",4,"ngIf","ngIfElse"],["class","absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center",4,"ngIf"],["class","absolute -bottom-1 -right-1 bg-blue-500 hover:bg-blue-600 text-white rounded-full p-1 shadow-lg transition-all duration-200 transform hover:scale-110","title","Cambiar foto",3,"click",4,"ngIf"],[1,"text-sm","font-medium","text-white","truncate"],[1,"text-xs","text-gray-400","truncate"],[1,"relative"],["class","ml-2 p-1 rounded-lg hover:bg-gray-800 transition-colors duration-200","title","Men\xFA de usuario",3,"click",4,"ngIf"],["class","logout-btn ml-2 p-1 rounded-lg hover:bg-gray-800 transition-colors duration-200","title","Cerrar Sesi\xF3n",3,"click",4,"ngIf"],["class","user-dropdown absolute bottom-full left-0 mb-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-200",4,"ngIf"],["type","file","accept","image/*",1,"hidden",3,"change"],["class","sidebar-overlay show",3,"click",4,"ngIf"],[1,"main-header","bg-white","shadow-sm","border-b","border-gray-200"],[1,"px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","h-16"],[1,"flex","items-center"],["class","mobile-menu-btn mr-3 p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500",3,"click",4,"ngIf"],[1,"text-xl","font-semibold","text-gray-900"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","space-x-3"],[1,"h-8","w-8","rounded-full","overflow-hidden","bg-gradient-to-br","from-blue-500","to-purple-600","flex","items-center","justify-center","shadow-md"],[1,"hidden","md:block"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-gray-100","rounded-lg"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 17h5l-5 5v-5z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 19.5A2.5 2.5 0 01.5 17H4m0 2.5A2.5 2.5 0 006.5 19.5H4m0 2.5V22"],[1,"inline-flex","items-center","px-3","py-2","border","border-transparent","text-sm","leading-4","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"],[1,"hidden","sm:block"],[1,"flex-1","content-area","custom-scrollbar"],[4,"ngIf"],["routerLinkActive","bg-indigo-600 text-white","class","tooltip-collapsed group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 text-gray-300 hover:bg-gray-800 hover:text-white",3,"routerLink","click",4,"ngIf"],[1,"tooltip-collapsed","group","w-full","flex","items-center","px-3","py-2","text-sm","font-medium","text-gray-300","rounded-lg","hover:bg-gray-800","hover:text-white","transition-colors","duration-200",3,"click","disabled"],[3,"class",4,"ngIf"],["class","flex-shrink-0 w-5 h-5 mr-3","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",3,"class",4,"ngIf"],["class","ml-6 space-y-1 submenu-enter submenu-enter-active",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"flex-shrink-0","w-5","h-5","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 00-2 2v2a2 2 0 002 2m0 0h14"],["fill","none","stroke","currentColor","viewBox","0 0 24 24"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"ml-6","space-y-1","submenu-enter","submenu-enter-active"],["routerLinkActive","bg-indigo-600 text-white","class","group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 text-gray-400 hover:bg-gray-800 hover:text-white",3,"routerLink","click",4,"ngFor","ngForOf"],["routerLinkActive","bg-indigo-600 text-white",1,"group","flex","items-center","px-3","py-2","text-sm","font-medium","rounded-lg","transition-colors","duration-200","text-gray-400","hover:bg-gray-800","hover:text-white",3,"click","routerLink"],["class","flex-shrink-0 w-4 h-4 mr-3","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"flex-shrink-0","w-4","h-4","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m3 5.197H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"],["routerLinkActive","bg-indigo-600 text-white",1,"tooltip-collapsed","group","flex","items-center","px-3","py-2","text-sm","font-medium","rounded-lg","transition-colors","duration-200","text-gray-300","hover:bg-gray-800","hover:text-white",3,"click","routerLink"],[1,"w-full","h-full","object-cover",3,"error","src","alt"],[1,"text-sm","font-medium","text-white"],[1,"absolute","inset-0","bg-black","bg-opacity-50","rounded-full","flex","items-center","justify-center"],[1,"animate-spin","rounded-full","h-6","w-6","border-2","border-white","border-t-transparent"],["title","Cambiar foto",1,"absolute","-bottom-1","-right-1","bg-blue-500","hover:bg-blue-600","text-white","rounded-full","p-1","shadow-lg","transition-all","duration-200","transform","hover:scale-110",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 13a3 3 0 11-6 0 3 3 0 016 0z"],["title","Men\xFA de usuario",1,"ml-2","p-1","rounded-lg","hover:bg-gray-800","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["title","Cerrar Sesi\xF3n",1,"logout-btn","ml-2","p-1","rounded-lg","hover:bg-gray-800","transition-colors","duration-200",3,"click"],[1,"user-dropdown","absolute","bottom-full","left-0","mb-2","w-48","bg-white","rounded-md","shadow-lg","py-1","z-50","border","border-gray-200"],[1,"block","w-full","text-left","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100","transition-colors",3,"click"],[1,"fas","fa-user","mr-2"],[1,"fas","fa-cog","mr-2"],[1,"fas","fa-camera","mr-2"],[1,"my-1"],[1,"block","w-full","text-left","px-4","py-2","text-sm","text-red-600","hover:bg-gray-100","transition-colors",3,"click"],[1,"fas","fa-sign-out-alt","mr-2"],[1,"sidebar-overlay","show",3,"click"],[1,"mobile-menu-btn","mr-3","p-2","rounded-md","text-gray-600","hover:text-gray-900","hover:bg-gray-100","focus:outline-none","focus:ring-2","focus:ring-inset","focus:ring-indigo-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],[1,"text-xs","font-medium","text-white"]],template:function(e,i){if(e&1){let o=w();n(0,"div",3)(1,"div")(2,"div",4)(3,"div")(4,"h1",5),a(5,"Rehabimovementgt"),r(),n(6,"p",6),a(7,"Sistema de Gesti\xF3n"),r()(),n(8,"button",7),_("click",function(){return p(o),g(i.toggleSidebar())}),h(),n(9,"svg",8),u(10,"path",9),r()()(),y(),n(11,"div",10)(12,"nav",11)(13,"div",12),x(14,Hi,3,2,"div",13),r()()(),n(15,"div",14)(16,"div")(17,"div",15)(18,"div",16),_("click",function(){return p(o),g(!i.isSidebarCollapsed||i.isMobile()?i.toggleDropdown():null)}),x(19,qi,1,2,"img",17)(20,Yi,2,1,"ng-template",null,0,K)(22,Qi,2,0,"div",18),r(),x(23,Ji,4,0,"button",19),r(),n(24,"div")(25,"p",20),a(26),r(),n(27,"p",21),a(28),r()(),n(29,"div",22),x(30,Zi,3,0,"button",23)(31,Xi,3,0,"button",24)(32,Ki,14,0,"div",25),r(),n(33,"input",26,1),_("change",function(f){return p(o),g(i.onAvatarFileSelected(f))}),r()()()(),x(35,en,1,0,"div",27),n(36,"div")(37,"header",28)(38,"div",29)(39,"div",30)(40,"div",31),x(41,tn,3,0,"button",32),n(42,"h1",33),a(43),r()(),n(44,"div",34)(45,"div",35)(46,"div",36),x(47,nn,1,2,"img",17)(48,rn,2,1,"ng-template",null,2,K),r(),n(50,"div",37)(51,"p",38),a(52),r(),n(53,"p",39),a(54),r()()(),n(55,"button",40),h(),n(56,"svg",8),u(57,"path",41)(58,"path",42),r()(),y(),n(59,"button",43),_("click",function(){return p(o),g(i.logout())}),h(),n(60,"svg",44),u(61,"path",45),r(),y(),n(62,"span",46),a(63,"Cerrar Sesi\xF3n"),r()()()()()(),n(64,"main",47),u(65,"router-outlet"),r()()()}if(e&2){let o=Y(21),d=Y(49);l(),A(i.getSidebarClasses()),l(2),A(i.isSidebarCollapsed&&!i.isMobile()?"hidden":"block"),l(5),Re("title",i.isSidebarCollapsed?"Expandir men\xFA":"Contraer men\xFA"),l(2),Re("d",i.isSidebarCollapsed&&!i.isMobile()?"M9 5l7 7-7 7":i.isMobile()?"M6 18L18 6M6 6l12 12":"M15 19l-7-7 7-7"),l(4),m("ngForOf",i.getFilteredMenuItems()),l(2),A("flex items-center "+(i.isSidebarCollapsed&&!i.isMobile()?"justify-center":"")),l(3),m("ngIf",i.currentUser==null?null:i.currentUser.avatar_url)("ngIfElse",o),l(3),m("ngIf",i.isUploadingAvatar),l(),m("ngIf",(!i.isSidebarCollapsed||i.isMobile())&&!i.isUploadingAvatar),l(),A(i.isSidebarCollapsed&&!i.isMobile()?"hidden":"ml-3 flex-1"),l(2),v(" ",(i.currentUser==null?null:i.currentUser.full_name)||"Usuario"," "),l(2),v(" ",i.getUserRole()," "),l(2),m("ngIf",!i.isSidebarCollapsed||i.isMobile()),l(),m("ngIf",i.isSidebarCollapsed&&!i.isMobile()),l(),m("ngIf",i.showDropdown&&(!i.isSidebarCollapsed||i.isMobile())),l(3),m("ngIf",i.isMobileMenuOpen),l(),A(i.getMainContentClasses()),l(5),m("ngIf",i.isMobile()),l(2),C(i.getPageTitle()),l(4),m("ngIf",i.currentUser==null?null:i.currentUser.avatar_url)("ngIfElse",d),l(5),C(i.currentUser==null?null:i.currentUser.full_name),l(2),C(i.getUserRole())}},dependencies:[z,R,qe,Dt,At],styles:['.layout-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#f9fafb}.sidebar[_ngcontent-%COMP%]{position:fixed;top:0;left:0;height:100vh;z-index:1000;background:linear-gradient(135deg,#1f2937,#111827);transition:width .3s ease-in-out;box-shadow:2px 0 10px #0000001a;overflow:hidden;display:flex;flex-direction:column}.sidebar-collapsed[_ngcontent-%COMP%]{width:4rem}.sidebar-expanded[_ngcontent-%COMP%]{width:16rem}@media (max-width: 768px){.sidebar[_ngcontent-%COMP%]{width:16rem!important;transform:translate(-100%);z-index:1050;transition:transform .3s ease-in-out}.sidebar-mobile-open[_ngcontent-%COMP%]{transform:translate(0)}.sidebar-collapsed[_ngcontent-%COMP%], .sidebar-expanded[_ngcontent-%COMP%]{width:16rem!important}}.main-content[_ngcontent-%COMP%]{transition:margin-left .3s ease-in-out;min-height:100vh;background-color:#f9fafb;display:flex;flex-direction:column}.main-content-expanded[_ngcontent-%COMP%]{margin-left:16rem}.main-content-collapsed[_ngcontent-%COMP%]{margin-left:4rem}@media (max-width: 768px){.main-content-expanded[_ngcontent-%COMP%], .main-content-collapsed[_ngcontent-%COMP%]{margin-left:0!important}}.nav-scroll-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding-bottom:1rem;scrollbar-width:thin;scrollbar-color:#4B5563 #1F2937;height:0;min-height:0}.nav-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.nav-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#1f2937;border-radius:3px}.nav-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#4b5563;border-radius:3px}.nav-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6b7280}.sidebar-header[_ngcontent-%COMP%]{height:72px;border-bottom:1px solid #374151;flex-shrink:0}.user-section[_ngcontent-%COMP%]{height:80px;background:#111827f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-top:1px solid rgba(75,85,99,.3);flex-shrink:0}.nav-item[_ngcontent-%COMP%]{transition:all .2s ease-in-out;border-radius:.5rem}.nav-item[_ngcontent-%COMP%]:hover{background-color:#374151b3;transform:translate(2px)}.nav-item.active[_ngcontent-%COMP%]{background-color:#4f46e5;color:#fff}.nav-item.active[_ngcontent-%COMP%]:hover{background-color:#4338ca}.main-header[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid #e5e7eb;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;position:sticky;top:0;z-index:100;flex-shrink:0}.content-area[_ngcontent-%COMP%]{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;min-height:0}.sidebar-toggle-btn[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.sidebar-toggle-btn[_ngcontent-%COMP%]:hover{background-color:#374151cc;transform:scale(1.05)}.user-avatar[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4f46e5,#7c3aed);transition:transform .2s ease-in-out}.user-avatar[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.sidebar-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;z-index:1040;opacity:0;visibility:hidden;transition:opacity .3s ease-in-out,visibility .3s ease-in-out}.sidebar-overlay.show[_ngcontent-%COMP%]{opacity:1;visibility:visible}@media (max-width: 768px){.main-header[_ngcontent-%COMP%]{padding-left:1rem}.mobile-menu-btn[_ngcontent-%COMP%]{display:block}.sidebar-header[_ngcontent-%COMP%]{height:64px}.user-section[_ngcontent-%COMP%]{height:72px}}@media (min-width: 769px){.mobile-menu-btn[_ngcontent-%COMP%]{display:none}}.module-expanded[_ngcontent-%COMP%]   .module-arrow[_ngcontent-%COMP%]{transform:rotate(90deg)}.submenu-enter[_ngcontent-%COMP%]{max-height:0;overflow:hidden;transition:max-height .3s ease-in-out}.submenu-enter-active[_ngcontent-%COMP%]{max-height:500px}.tooltip-collapsed[_ngcontent-%COMP%]{position:relative}@media (min-width: 769px){.tooltip-collapsed[_ngcontent-%COMP%]:hover:after{content:attr(data-tooltip);position:absolute;left:calc(100% + 10px);top:50%;transform:translateY(-50%);background-color:#1f2937;color:#fff;padding:.5rem .75rem;border-radius:.375rem;font-size:.875rem;white-space:nowrap;z-index:1100;box-shadow:0 4px 6px -1px #0000001a;opacity:0;animation:_ngcontent-%COMP%_tooltipFadeIn .2s ease-in-out forwards}.tooltip-collapsed[_ngcontent-%COMP%]:hover:before{content:"";position:absolute;left:calc(100% + 5px);top:50%;transform:translateY(-50%);border-top:5px solid transparent;border-bottom:5px solid transparent;border-right:5px solid #1f2937;z-index:1100;opacity:0;animation:_ngcontent-%COMP%_tooltipFadeIn .2s ease-in-out forwards}}@keyframes _ngcontent-%COMP%_tooltipFadeIn{0%{opacity:0}to{opacity:1}}.dashboard-card[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;transition:all .2s ease-in-out}.dashboard-card[_ngcontent-%COMP%]:hover{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;transform:translateY(-1px)}.stat-icon[_ngcontent-%COMP%]{border-radius:.375rem;padding:.75rem}.stat-number[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#111827}.stat-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.welcome-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4f46e5,#7c3aed);border-radius:.5rem;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}.welcome-icon[_ngcontent-%COMP%]{background:#fff3;border-radius:50%;padding:.75rem}.quick-action-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:.5rem;padding:1.5rem;transition:all .2s ease-in-out;cursor:pointer}.quick-action-card[_ngcontent-%COMP%]:hover{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;transform:translateY(-2px);border-color:#4f46e5}.quick-action-icon[_ngcontent-%COMP%]{border-radius:.5rem;padding:.75rem;margin-bottom:1rem}.logout-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc2626,#b91c1c);transition:all .2s ease-in-out}.logout-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#b91c1c,#991b1b);transform:translateY(-1px);box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.slide-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-out}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translate(-20px)}to{opacity:1;transform:translate(0)}}.loading-spinner[_ngcontent-%COMP%]{width:3rem;height:3rem;border:2px solid #e5e7eb;border-top:2px solid #4f46e5;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.success-message[_ngcontent-%COMP%]{background-color:#d1fae5;border:1px solid #a7f3d0;color:#065f46;padding:1rem;border-radius:.5rem;margin-bottom:1rem}.error-message[_ngcontent-%COMP%]{background-color:#fee2e2;border:1px solid #fecaca;color:#991b1b;padding:1rem;border-radius:.5rem;margin-bottom:1rem}.user-info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}.user-info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.user-info-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#6b7280}.user-info-value[_ngcontent-%COMP%]{font-size:.875rem;color:#111827}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.transition-smooth[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.shadow-subtle[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}.shadow-moderate[_ngcontent-%COMP%]{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.shadow-strong[_ngcontent-%COMP%]{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}.custom-scrollbar[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#d1d5db #f3f4f6}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f3f4f6;border-radius:4px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:4px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}@media (max-width: 768px){.sidebar[_ngcontent-%COMP%]{-webkit-transform:translateX(-100%);transform:translate(-100%)}.sidebar-mobile-open[_ngcontent-%COMP%]{-webkit-transform:translateX(0);transform:translate(0)}.main-content[_ngcontent-%COMP%]{width:100%;margin-left:0}.nav-scroll-container[_ngcontent-%COMP%]{height:calc(100vh - 136px)}.sidebar-toggle-btn[_ngcontent-%COMP%]{min-width:44px;min-height:44px;display:flex;align-items:center;justify-content:center}.nav-scroll-container[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]{padding:.5rem}.nav-scroll-container[_ngcontent-%COMP%]   .space-y-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:.25rem}.nav-scroll-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .nav-scroll-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-height:44px;display:flex;align-items:center}input[type=text][_ngcontent-%COMP%], input[type=email][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font-size:16px}}@media (max-width: 1024px){.dashboard-stats[_ngcontent-%COMP%], .quick-actions[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 640px){.dashboard-stats[_ngcontent-%COMP%], .quick-actions[_ngcontent-%COMP%], .user-info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.main-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.125rem}.welcome-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}.sidebar-header[_ngcontent-%COMP%], .user-section[_ngcontent-%COMP%], .content-area[_ngcontent-%COMP%]{padding:1rem}}@media (prefers-reduced-motion: reduce){.sidebar[_ngcontent-%COMP%], .main-content[_ngcontent-%COMP%], .sidebar-overlay[_ngcontent-%COMP%], .submenu-enter[_ngcontent-%COMP%], .tooltip-collapsed[_ngcontent-%COMP%]:after, .tooltip-collapsed[_ngcontent-%COMP%]:before{transition:none}.fade-in[_ngcontent-%COMP%], .slide-in[_ngcontent-%COMP%]{animation:none}}.sidebar-toggle-btn[_ngcontent-%COMP%]:focus, .mobile-menu-btn[_ngcontent-%COMP%]:focus, .logout-btn[_ngcontent-%COMP%]:focus{outline:2px solid #4f46e5;outline-offset:2px}.nav-scroll-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus, .nav-scroll-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:2px solid #4f46e5;outline-offset:2px;border-radius:.375rem}@media (prefers-contrast: high){.sidebar[_ngcontent-%COMP%]{background:#000;border-right:2px solid #ffffff}.nav-scroll-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .nav-scroll-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:1px solid #ffffff}.nav-scroll-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .nav-scroll-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#fff;color:#000}}']})};function on(s,t){if(s&1){let e=w();n(0,"button",33),_("click",function(){p(e);let o=c();return g(o.openCreateModal())}),h(),n(1,"svg",34),u(2,"path",35),r(),a(3," Nueva Rutina "),r()}}function an(s,t){if(s&1&&(n(0,"div",36)(1,"div",37),h(),n(2,"svg",38),u(3,"path",39),r(),y(),n(4,"div",40)(5,"p",41),a(6),r()()()()),s&2){let e=c();l(6),C(e.error)}}function sn(s,t){s&1&&(n(0,"div",42),u(1,"div",43),r())}function ln(s,t){if(s&1&&(n(0,"span",70),a(1),r()),s&2){let e=t.$implicit;l(),N(" ",e.nombre," (",e.seccion.ejercicios.length,") ")}}function dn(s,t){if(s&1&&(n(0,"div",66)(1,"div",67),a(2,"Secciones:"),r(),n(3,"div",68),x(4,ln,2,2,"span",69),r()()),s&2){let e=c().$implicit,i=c(2);l(4),m("ngForOf",i.getSeccionesConEjercicios(e))}}function cn(s,t){if(s&1&&(n(0,"span",73),a(1),r()),s&2){let e=t.$implicit;l(),v(" #",e," ")}}function mn(s,t){if(s&1&&(n(0,"div",71)(1,"div",68),x(2,cn,2,1,"span",72),r()()),s&2){let e=c().$implicit;l(2),m("ngForOf",e.tags)}}function un(s,t){if(s&1){let e=w();n(0,"button",74),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.openViewModal(o))}),h(),n(1,"svg",62),u(2,"path",75)(3,"path",76),r()()}}function pn(s,t){if(s&1){let e=w();n(0,"button",77),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.openEditModal(o))}),h(),n(1,"svg",62),u(2,"path",78),r()()}}function gn(s,t){if(s&1){let e=w();n(0,"button",79),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.deleteRutina(o))}),h(),n(1,"svg",62),u(2,"path",80),r()()}}function fn(s,t){if(s&1){let e=w();n(0,"button",81),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.reactivateRutina(o))}),h(),n(1,"svg",62),u(2,"path",82),r()()}}function _n(s,t){if(s&1){let e=w();n(0,"div",46)(1,"div")(2,"div",47)(3,"div",48)(4,"h3",49),a(5),r(),n(6,"p",50),a(7),r()(),n(8,"span"),a(9),r()()(),n(10,"div",51)(11,"div",52)(12,"span",53),a(13),r(),n(14,"span",54),a(15),r()(),x(16,dn,5,1,"div",55),n(17,"div",56),a(18),r(),x(19,mn,3,1,"div",57),n(20,"div",58),x(21,un,4,0,"button",59)(22,pn,3,0,"button",60),n(23,"button",61),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.exportarRutina(o))}),h(),n(24,"svg",62),u(25,"path",63),r()(),x(26,gn,3,0,"button",64)(27,fn,3,0,"button",65),r()()()}if(s&2){let e=t.$implicit,i=c(2);F("opacity-50",e.status===0),l(),A("px-6 py-4 "+(e.status===1?"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-gray-400 to-gray-500")),l(4),C(e.nombre),l(2),C(e.descripcion),l(),A("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+(e.status===1?"bg-green-100 text-green-800":"bg-red-100 text-red-800")),l(),v(" ",e.status===1?"Activo":"Inactivo"," "),l(4),v(" ",e.nivel," "),l(2),C(i.formatDuracion(e.duracion_estimada)),l(),m("ngIf",i.getSeccionesConEjercicios(e).length>0),l(2),v(" Total de ejercicios: ",i.getTotalEjercicios(e)," "),l(),m("ngIf",e.tags&&e.tags.length>0),l(2),m("ngIf",i.canViewRutina()),l(),m("ngIf",e.status===1&&i.canEditRutina()),l(4),m("ngIf",e.status===1&&i.canEditRutina()),l(),m("ngIf",e.status===0&&i.canEditRutina())}}function xn(s,t){if(s&1&&(n(0,"div",44),x(1,_n,28,18,"div",45),r()),s&2){let e=c();l(),m("ngForOf",e.filteredRutinas)("ngForTrackBy",e.trackByRutinaId)}}function hn(s,t){if(s&1){let e=w();n(0,"button",91),_("click",function(){p(e);let o=c(2);return g(o.openCreateModal())}),a(1," Crear primera rutina "),r()}}function vn(s,t){if(s&1){let e=w();n(0,"button",92),_("click",function(){p(e);let o=c(2);return g(o.clearFilters())}),a(1," Limpiar filtros "),r()}}function bn(s,t){if(s&1&&(n(0,"div",83),h(),n(1,"svg",84),u(2,"path",85),r(),y(),n(3,"h3",86),a(4,"No hay rutinas"),r(),n(5,"p",87),a(6),r(),n(7,"div",88),x(8,hn,2,0,"button",89)(9,vn,2,0,"button",90),r()()),s&2){let e=c();l(6),v(" ",e.rutinas.length===0?"No se encontraron rutinas en la base de datos.":"No se encontraron rutinas con los filtros aplicados."," "),l(2),m("ngIf",e.rutinas.length===0&&e.canEditRutina()),l(),m("ngIf",e.rutinas.length>0)}}function wn(s,t){if(s&1){let e=w();n(0,"label",121)(1,"input",122),_("change",function(){let o=p(e).$implicit,d=c(2);return g(d.toggleSeccion(o.key))}),r(),n(2,"span",123),a(3),r()()}if(s&2){let e=t.$implicit,i=c(2);F("bg-red-50",i.isSeccionActiva(e.key))("border-red-300",i.isSeccionActiva(e.key)),l(),m("checked",i.isSeccionActiva(e.key)),l(2),C(e.nombre)}}function yn(s,t){if(s&1){let e=w();n(0,"div",71)(1,"label",13),a(2),r(),n(3,"input",133),_("input",function(o){p(e);let d=c().$implicit,f=c(2);return g(f.updateSeccionDescripcion(d.key,o))}),r()()}if(s&2){let e,i=c().$implicit,o=c(2);l(2),v("Descripci\xF3n de ",i.nombre,""),l(),m("value",((e=o.getSeccionData(o.rutinaForm,i.key))==null?null:e.descripcion)||"")}}function Cn(s,t){if(s&1){let e=w();n(0,"div",134)(1,"div")(2,"label",135),a(3,"Tiempo Total"),r(),n(4,"input",136),_("input",function(o){p(e);let d=c().$implicit,f=c(2);return g(f.updateSeccionTiempoTotal(d.key,o))}),r()(),n(5,"div")(6,"label",135),a(7,"Series"),r(),n(8,"input",137),_("input",function(o){p(e);let d=c().$implicit,f=c(2);return g(f.updateSeccionSeries(d.key,o))}),r()(),n(9,"div")(10,"label",135),a(11,"Time Cap"),r(),n(12,"input",138),_("input",function(o){p(e);let d=c().$implicit,f=c(2);return g(f.updateSeccionTimeCap(d.key,o))}),r()()()}if(s&2){let e,i,o,d=c().$implicit,f=c(2);l(4),m("value",((e=f.getSeccionData(f.rutinaForm,d.key))==null?null:e.tiempo_total)||""),l(4),m("value",((i=f.getSeccionData(f.rutinaForm,d.key))==null?null:i.series)||""),l(4),m("value",((o=f.getSeccionData(f.rutinaForm,d.key))==null?null:o.time_cap)||"")}}function Sn(s,t){if(s&1){let e=w();n(0,"div",139)(1,"div",140)(2,"div",141)(3,"label",142),a(4,"Ejercicio"),r(),n(5,"input",143),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.nombre,o)||(d.nombre=o),g(o)}),r()(),n(6,"div")(7,"label",142),a(8,"Tipo"),r(),n(9,"select",144),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.tipo,o)||(d.tipo=o),g(o)}),n(10,"option",145),a(11,"Resistencia Cardiovascular"),r(),n(12,"option",146),a(13,"Fuerza"),r(),n(14,"option",147),a(15,"Funcional"),r(),n(16,"option",148),a(17,"Core"),r(),n(18,"option",149),a(19,"Movilidad"),r(),n(20,"option",150),a(21,"Activaci\xF3n"),r(),n(22,"option",151),a(23,"Equilibrio/Balance"),r(),n(24,"option",152),a(25,"Coordinaci\xF3n"),r()()(),n(26,"div",153)(27,"button",154),_("click",function(){let o=p(e).index,d=c().$implicit,f=c(2);return g(f.removeEjercicio(d.key,o))}),h(),n(28,"svg",155),u(29,"path",80),r()()()(),y(),n(30,"div",156)(31,"div")(32,"label",142),a(33,"Reps"),r(),n(34,"input",157),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.repeticiones,o)||(d.repeticiones=o),g(o)}),r()(),n(35,"div")(36,"label",142),a(37,"Series"),r(),n(38,"input",158),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.series,o)||(d.series=o),g(o)}),r()(),n(39,"div")(40,"label",142),a(41,"Duraci\xF3n"),r(),n(42,"input",159),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.duracion,o)||(d.duracion=o),g(o)}),r()(),n(43,"div")(44,"label",142),a(45,"Distancia"),r(),n(46,"input",160),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.distancia,o)||(d.distancia=o),g(o)}),r()(),n(47,"div")(48,"label",142),a(49,"RPE"),r(),n(50,"input",161),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.rpe,o)||(d.rpe=o),g(o)}),r()(),n(51,"div")(52,"label",142),a(53,"Peso"),r(),n(54,"input",162),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.peso,o)||(d.peso=o),g(o)}),r()()(),n(55,"div",163)(56,"label",142),a(57,"Observaciones"),r(),n(58,"input",164),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.observaciones,o)||(d.observaciones=o),g(o)}),r()()()}if(s&2){let e=t.$implicit;l(5),E("ngModel",e.nombre),l(4),E("ngModel",e.tipo),l(25),E("ngModel",e.repeticiones),l(4),E("ngModel",e.series),l(4),E("ngModel",e.duracion),l(4),E("ngModel",e.distancia),l(4),E("ngModel",e.rpe),l(4),E("ngModel",e.peso),l(4),E("ngModel",e.observaciones)}}function Mn(s,t){if(s&1){let e=w();n(0,"div",165),h(),n(1,"svg",166),u(2,"path",35),r(),y(),n(3,"p",167),a(4,"No hay ejercicios en esta secci\xF3n"),r(),n(5,"button",168),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.addEjercicio(o.key))}),a(6," Agregar primer ejercicio "),r()()}}function En(s,t){if(s&1){let e=w();n(0,"div",124)(1,"h5",125)(2,"span",126),a(3),r(),a(4),r(),x(5,yn,4,2,"div",57)(6,Cn,13,3,"div",127),n(7,"div",128)(8,"div",129)(9,"h6",67),a(10,"Ejercicios"),r(),n(11,"button",130),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.addEjercicio(o.key))}),a(12," + Agregar Ejercicio "),r()(),x(13,Sn,59,9,"div",131)(14,Mn,7,0,"div",132),r()()}if(s&2){let e,i,o=t.$implicit,d=c(2);F("hidden",!d.isSeccionActiva(o.key)),l(3),C(o.nombre),l(),v(" ",o.descripcion," "),l(),m("ngIf",d.getSeccionData(d.rutinaForm,o.key)),l(),m("ngIf",d.getSeccionData(d.rutinaForm,o.key)),l(7),m("ngForOf",(e=d.getSeccionData(d.rutinaForm,o.key))==null?null:e.ejercicios)("ngForTrackBy",d.trackByEjercicioOrden),l(),m("ngIf",!((i=(i=d.getSeccionData(d.rutinaForm,o.key))==null||i.ejercicios==null?null:i.ejercicios.length)!==null&&i!==void 0&&i))}}function kn(s,t){if(s&1&&(n(0,"div",169)(1,"div",37),h(),n(2,"svg",38),u(3,"path",39),r(),y(),n(4,"div",40)(5,"p",41),a(6),r()()()()),s&2){let e=c(2);l(6),C(e.error)}}function Tn(s,t){s&1&&(h(),n(0,"svg",170),u(1,"path",8),r())}function Pn(s,t){if(s&1){let e=w();n(0,"div",93)(1,"div",94)(2,"div",95),_("click",function(){p(e);let o=c();return g(o.closeModal())}),r(),n(3,"div",96)(4,"div",97)(5,"div",98)(6,"div",99),h(),n(7,"svg",100),u(8,"path",85),r()(),y(),n(9,"div",101)(10,"h3",102),a(11),r()()()(),n(12,"div",103)(13,"div",104)(14,"div")(15,"label",13),a(16," Nombre "),n(17,"span",105),a(18,"*"),r()(),n(19,"input",106),T("ngModelChange",function(o){p(e);let d=c();return k(d.rutinaForm.nombre,o)||(d.rutinaForm.nombre=o),g(o)}),r()(),n(20,"div")(21,"label",13),a(22,"Duraci\xF3n (minutos)"),r(),n(23,"input",107),T("ngModelChange",function(o){p(e);let d=c();return k(d.rutinaForm.duracion_estimada,o)||(d.rutinaForm.duracion_estimada=o),g(o)}),r()(),n(24,"div")(25,"label",13),a(26,"Tipo"),r(),n(27,"select",108),T("ngModelChange",function(o){p(e);let d=c();return k(d.rutinaForm.tipo,o)||(d.rutinaForm.tipo=o),g(o)}),n(28,"option",19),a(29,"Entrenamiento"),r(),n(30,"option",20),a(31,"Recuperaci\xF3n"),r(),n(32,"option",21),a(33,"Evaluaci\xF3n"),r()()(),n(34,"div")(35,"label",13),a(36,"Nivel"),r(),n(37,"select",108),T("ngModelChange",function(o){p(e);let d=c();return k(d.rutinaForm.nivel,o)||(d.rutinaForm.nivel=o),g(o)}),n(38,"option",22),a(39,"Principiante"),r(),n(40,"option",23),a(41,"Intermedio"),r(),n(42,"option",24),a(43,"Avanzado"),r()()(),n(44,"div",12)(45,"label",13),a(46,"Descripci\xF3n"),r(),n(47,"textarea",109),T("ngModelChange",function(o){p(e);let d=c();return k(d.rutinaForm.descripcion,o)||(d.rutinaForm.descripcion=o),g(o)}),r()()(),n(48,"div",110)(49,"h4",111),a(50,"Secciones de la Rutina"),r(),n(51,"div",112),x(52,wn,4,6,"label",113),r(),n(53,"div",114),x(54,En,15,9,"div",115),r()(),x(55,kn,7,1,"div",116),r(),n(56,"div",117)(57,"button",118),_("click",function(){p(e);let o=c();return g(o.saveRutina())}),x(58,Tn,2,0,"svg",119),a(59),r(),n(60,"button",120),_("click",function(){p(e);let o=c();return g(o.closeModal())}),a(61," Cancelar "),r()()()()()}if(s&2){let e=c();l(11),v(" ",e.modalMode==="create"?"Crear Nueva Rutina":"Editar Rutina"," "),l(8),E("ngModel",e.rutinaForm.nombre),l(4),E("ngModel",e.rutinaForm.duracion_estimada),l(4),E("ngModel",e.rutinaForm.tipo),l(10),E("ngModel",e.rutinaForm.nivel),l(10),E("ngModel",e.rutinaForm.descripcion),l(5),m("ngForOf",e.seccionesDisponibles),l(2),m("ngForOf",e.seccionesDisponibles),l(),m("ngIf",e.error),l(2),m("disabled",e.loading),l(),m("ngIf",e.loading),l(),v(" ",e.modalMode==="create"?"Crear Rutina":"Guardar Cambios"," "),l(),m("disabled",e.loading)}}function In(s,t){if(s&1){let e=w();n(0,"button",171),_("click",function(){p(e);let o=c();return g(o.openCreateModal())}),h(),n(1,"svg",172),u(2,"path",35),r()()}}function On(s,t){s&1&&(n(0,"div",192)(1,"div",37),h(),n(2,"svg",193),u(3,"path",82),r(),y(),n(4,"div",40)(5,"p",194),a(6,"\xA1Rutina copiada al portapapeles!"),r()()()())}function Vn(s,t){if(s&1){let e=w();n(0,"div",93)(1,"div",94)(2,"div",95),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),r(),n(3,"div",173)(4,"div",97)(5,"div",98)(6,"div",174),h(),n(7,"svg",175),u(8,"path",75)(9,"path",76),r()(),y(),n(10,"div",101)(11,"h3",102),a(12),r(),n(13,"div",176)(14,"p",54),a(15," Visualizaci\xF3n completa de la rutina en formato de entrenamiento "),r()()()()(),n(16,"div",177)(17,"div",178)(18,"div",179)(19,"div",5),u(20,"div",180)(21,"div",181)(22,"div",182),r(),n(23,"div",183),a(24),r()(),n(25,"pre",184),a(26),r()(),x(27,On,7,0,"div",185),n(28,"div",186)(29,"button",187),_("click",function(){p(e);let o=c();return g(o.copyToClipboard(o.getFormattedRutina(o.selectedViewRutina)))}),h(),n(30,"svg",188),u(31,"path",189),r(),a(32," Copiar "),r(),y(),n(33,"button",190),_("click",function(){p(e);let o=c();return g(o.exportarRutina(o.selectedViewRutina))}),h(),n(34,"svg",188),u(35,"path",63),r(),a(36," Descargar "),r()()(),y(),n(37,"div",117)(38,"button",191),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),a(39," Cerrar "),r()()()()()}if(s&2){let e=c();l(12),v(" ",e.selectedViewRutina==null?null:e.selectedViewRutina.nombre," "),l(12),v(" ",e.getFileName(e.selectedViewRutina)," "),l(2),C(e.getFormattedRutina(e.selectedViewRutina)),l(),m("ngIf",e.copySuccess)}}var tt=class s{constructor(t,e){this.supabaseService=t;this.authService=e}rutinas=[];filteredRutinas=[];tiposSeccion=[];loading=!1;error="";showModal=!1;modalMode="create";selectedRutina=null;showViewModal=!1;selectedViewRutina=null;copySuccess=!1;rutinaForm={nombre:"",descripcion:"",tipo:"entrenamiento",nivel:"intermedio",duracion_estimada:60,tags:[],status:1};seccionesDisponibles=[{key:"warm_up",nombre:"Warm Up",descripcion:"Calentamiento"},{key:"met_con",nombre:"Met-Con",descripcion:"Metabolic Conditioning"},{key:"strength",nombre:"Strength",descripcion:"Entrenamiento de Fuerza"},{key:"core",nombre:"Core",descripcion:"Trabajo de Core"},{key:"extra",nombre:"Extra",descripcion:"Trabajo Adicional"}];searchTerm="";tipoFilter="all";nivelFilter="all";statusFilter="active";seccionesActivas=new Set;ngOnInit(){return b(this,null,function*(){yield this.loadTiposSeccion(),yield this.loadRutinas()})}loadTiposSeccion(){return b(this,null,function*(){try{let t=yield this.supabaseService.getData("tipos_seccion");this.tiposSeccion=t?.filter(e=>e.status===1)||[]}catch(t){console.error("Error cargando tipos de secci\xF3n:",t)}})}loadRutinas(){return b(this,null,function*(){this.loading=!0,this.error="";try{let t=yield this.supabaseService.getData("rutinas");this.rutinas=t||[],this.rutinas=this.rutinas.sort((e,i)=>e.nombre.toLowerCase().localeCompare(i.nombre.toLowerCase())),this.filteredRutinas=[...this.rutinas],this.applyFilters(),console.log("Rutinas cargadas:",this.rutinas.length)}catch(t){console.error("Error cargando rutinas:",t),this.error="Error al cargar las rutinas"}finally{this.loading=!1}})}applyFilters(){let t=[...this.rutinas];if(this.statusFilter==="active"?t=t.filter(e=>e.status===1):this.statusFilter==="inactive"&&(t=t.filter(e=>e.status===0)),this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.nombre.toLowerCase().includes(e)||i.descripcion?.toLowerCase().includes(e)||i.tags?.some(o=>o.toLowerCase().includes(e)))}this.tipoFilter!=="all"&&(t=t.filter(e=>e.tipo===this.tipoFilter)),this.nivelFilter!=="all"&&(t=t.filter(e=>e.nivel===this.nivelFilter)),t=t.sort((e,i)=>e.nombre.toLowerCase().localeCompare(i.nombre.toLowerCase())),this.filteredRutinas=t}openCreateModal(){this.modalMode="create",this.rutinaForm={nombre:"",descripcion:"",tipo:"entrenamiento",nivel:"intermedio",duracion_estimada:60,tags:[],status:1},this.seccionesActivas.clear(),this.error="",this.showModal=!0}openEditModal(t){this.modalMode="edit",this.selectedRutina=t,this.rutinaForm=JSON.parse(JSON.stringify(t)),this.seccionesActivas.clear(),this.seccionesDisponibles.forEach(e=>{this.getSeccionData(this.rutinaForm,e.key)&&this.seccionesActivas.add(e.key)}),this.error="",this.showModal=!0}openViewModal(t){console.log("Abriendo modal de vista para rutina:",t.nombre),this.selectedViewRutina=t,this.showViewModal=!0}closeViewModal(){console.log("Cerrando modal de vista"),this.showViewModal=!1,this.selectedViewRutina=null,this.copySuccess=!1}closeModal(){this.showModal=!1,this.selectedRutina=null,this.error="",this.seccionesActivas.clear()}saveRutina(){return b(this,null,function*(){try{if(this.error="",!this.rutinaForm.nombre.trim()){this.error="El nombre es requerido";return}if(this.seccionesActivas.size===0){this.error="Debe activar al menos una secci\xF3n";return}let t=ce({},this.rutinaForm);this.seccionesDisponibles.forEach(e=>{this.seccionesActivas.has(e.key)||delete t[e.key]}),this.modalMode==="create"?(console.log("Creando rutina:",t),yield this.supabaseService.insertData("rutinas",t)):(t.updated_at=new Date().toISOString(),console.log("Actualizando rutina:",t),yield this.supabaseService.updateData("rutinas",this.selectedRutina.id.toString(),t)),yield this.loadRutinas(),this.closeModal()}catch(t){console.error("Error guardando rutina:",t),this.error="Error al guardar la rutina"}})}deleteRutina(t){return b(this,null,function*(){let e=`\xBFEst\xE1 seguro de eliminar la rutina "${t.nombre}"?`;if(confirm(e))try{yield this.supabaseService.updateData("rutinas",t.id.toString(),{status:0}),yield this.loadRutinas()}catch(i){console.error("Error eliminando rutina:",i),this.error="Error al eliminar la rutina"}})}reactivateRutina(t){return b(this,null,function*(){let e=`\xBFEst\xE1 seguro de reactivar la rutina "${t.nombre}"?`;if(confirm(e))try{yield this.supabaseService.updateData("rutinas",t.id.toString(),{status:1}),yield this.loadRutinas()}catch(i){console.error("Error reactivando rutina:",i),this.error="Error al reactivar la rutina"}})}toggleSeccion(t){this.seccionesActivas.has(t)?(this.seccionesActivas.delete(t),this.setSeccionData(this.rutinaForm,t,void 0)):(this.seccionesActivas.add(t),this.setSeccionData(this.rutinaForm,t,{descripcion:"",ejercicios:[]}))}isSeccionActiva(t){return this.seccionesActivas.has(t)}getSeccionData(t,e){return t[e]}setSeccionData(t,e,i){t[e]=i}updateSeccionDescripcion(t,e){let i=this.getSeccionData(this.rutinaForm,t);i&&(i.descripcion=e.target.value)}updateSeccionTiempoTotal(t,e){let i=this.getSeccionData(this.rutinaForm,t);i&&(i.tiempo_total=e.target.value)}updateSeccionSeries(t,e){let i=this.getSeccionData(this.rutinaForm,t);i&&(i.series=parseInt(e.target.value)||void 0)}updateSeccionTimeCap(t,e){let i=this.getSeccionData(this.rutinaForm,t);i&&(i.time_cap=e.target.value)}addEjercicio(t){let e=this.getSeccionData(this.rutinaForm,t);if(e&&e.ejercicios){let i={orden:e.ejercicios.length+1,nombre:"",tipo:"funcional"};e.ejercicios.push(i)}}removeEjercicio(t,e){let i=this.getSeccionData(this.rutinaForm,t);i&&i.ejercicios&&(i.ejercicios.splice(e,1),i.ejercicios.forEach((o,d)=>{o.orden=d+1}))}addTag(t){let e=t.target,i=e.value.trim();i&&t.key==="Enter"&&(this.rutinaForm.tags||(this.rutinaForm.tags=[]),this.rutinaForm.tags.includes(i)||this.rutinaForm.tags.push(i),e.value="",t.preventDefault())}removeTag(t){this.rutinaForm.tags&&this.rutinaForm.tags.splice(t,1)}getSeccionNombre(t){let e=this.seccionesDisponibles.find(i=>i.key===t);return e?e.nombre:t}getSeccionesConEjercicios(t){let e=[];return this.seccionesDisponibles.forEach(i=>{let o=this.getSeccionData(t,i.key);o&&o.ejercicios&&o.ejercicios.length>0&&e.push({key:i.key,nombre:i.nombre,seccion:o})}),e}formatDuracion(t){if(!t)return"N/A";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getTotalEjercicios(t){let e=0;return this.seccionesDisponibles.forEach(i=>{let o=this.getSeccionData(t,i.key);o&&o.ejercicios&&(e+=o.ejercicios.length)}),e}onSearch(){this.applyFilters()}onFilterChange(){this.applyFilters()}clearFilters(){this.searchTerm="",this.tipoFilter="all",this.nivelFilter="all",this.statusFilter="active",this.applyFilters()}refreshRutinas(){return b(this,null,function*(){yield this.loadRutinas()})}trackByRutinaId(t,e){return e.id||t}trackByEjercicioOrden(t,e){return e.orden||t}getFormattedRutina(t){if(!t)return"";let e=`${t.nombre}
`;return e+=`${t.descripcion||"Rutina de entrenamiento"}
`,e+=`Nivel: ${t.nivel} | Duraci\xF3n: ${this.formatDuracion(t.duracion_estimada)}

`,["warm_up","met_con","strength","core","extra"].forEach(o=>{let d=this.seccionesDisponibles.find(S=>S.key===o),f=this.getSeccionData(t,o);if(f&&f.ejercicios&&f.ejercicios.length>0&&d){e+=`${d.nombre.toUpperCase()}
`,f.descripcion&&(e+=`${f.descripcion}
`);let S=[];f.tiempo_total&&S.push(`Tiempo: ${f.tiempo_total}`),f.series&&S.push(`Series: ${f.series}`),f.time_cap&&S.push(`Time Cap: ${f.time_cap}`),S.length>0&&(e+=`${S.join(" | ")}
`),f.ejercicios.forEach(P=>{let M=P.nombre,U=[];P.repeticiones&&U.push(`${P.repeticiones} reps`),P.series&&U.push(`x ${P.series}`),P.duracion&&U.push(`${P.duracion}`),P.distancia&&U.push(`${P.distancia}`),P.peso&&U.push(`${P.peso}`),U.length>0&&(M+=` - ${U.join(" ")}`),P.rpe&&(M+=` (RPE ${P.rpe})`),P.observaciones&&(M+=` - ${P.observaciones}`),e+=`${M}
`}),e+=`
`}}),t.tags&&t.tags.length>0&&(e+=`Tags: ${t.tags.map(o=>`#${o}`).join(" ")}
`),e}copyToClipboard(t){return b(this,null,function*(){try{yield navigator.clipboard.writeText(t),this.copySuccess=!0,console.log("Texto copiado al portapapeles"),setTimeout(()=>{this.copySuccess=!1},2e3)}catch(e){console.error("Error al copiar al portapapeles:",e),this.fallbackCopyTextToClipboard(t)}})}fallbackCopyTextToClipboard(t){let e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")&&(this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3))}catch(i){console.error("Fallback: Error al copiar al portapapeles:",i)}document.body.removeChild(e)}canViewRutina(){return this.authService.isAuthenticated()}canEditRutina(){return this.authService.isAdmin()||this.authService.hasProfile(3)}exportarRutina(t){let e=this.getFormattedRutina(t),i=new Blob([e],{type:"text/plain;charset=utf-8"}),o=window.URL.createObjectURL(i),d=document.createElement("a");d.href=o,d.download=`${t.nombre.replace(/\s+/g,"_")}.txt`,d.click(),window.URL.revokeObjectURL(o),console.log("Rutina exportada:",t.nombre)}getFileName(t){return!t||!t.nombre?"rutina.txt":t.nombre.replace(/\s+/g,"_")+".txt"}static \u0275fac=function(e){return new(e||s)(O(Q),O(L))};static \u0275cmp=D({type:s,selectors:[["app-rutinas"]],standalone:!1,decls:64,vars:13,consts:[[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["class","inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4"],[1,"md:col-span-2"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Buscar rutinas...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","input","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","change","ngModel"],["value","all"],["value","active"],["value","inactive"],["value","entrenamiento"],["value","recuperacion"],["value","evaluacion"],["value","principiante"],["value","intermedio"],["value","avanzado"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-red-600","hover:text-red-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],["class","md:hidden fixed bottom-6 right-6 w-14 h-14 bg-red-600 text-white rounded-full shadow-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 z-40","title","Crear nueva rutina",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-red-600"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300",3,"opacity-50",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-white","rounded-lg","shadow-lg","overflow-hidden","hover:shadow-xl","transition-shadow","duration-300"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"text-xl","font-bold","text-white"],[1,"text-red-100","text-sm"],[1,"p-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-red-100","text-red-800"],[1,"text-sm","text-gray-500"],["class","space-y-2 mb-4",4,"ngIf"],[1,"text-sm","text-gray-600","mb-4"],["class","mb-4",4,"ngIf"],[1,"flex","justify-end","space-x-2"],["class","text-blue-600 hover:text-blue-900 p-2 rounded-full hover:bg-blue-50 transition-colors duration-150","title","Ver rutina completa",3,"click",4,"ngIf"],["class","text-red-600 hover:text-red-900 p-2 rounded-full hover:bg-red-50 transition-colors duration-150","title","Editar rutina",3,"click",4,"ngIf"],["title","Descargar rutina",1,"text-green-600","hover:text-green-900","p-2","rounded-full","hover:bg-green-50","transition-colors","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["class","text-red-600 hover:text-red-900 p-2 rounded-full hover:bg-red-50 transition-colors duration-150","title","Desactivar rutina",3,"click",4,"ngIf"],["class","text-green-600 hover:text-green-900 p-2 rounded-full hover:bg-green-50 transition-colors duration-150","title","Reactivar rutina",3,"click",4,"ngIf"],[1,"space-y-2","mb-4"],[1,"text-sm","font-medium","text-gray-900"],[1,"flex","flex-wrap","gap-1"],["class","inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800",4,"ngFor","ngForOf"],[1,"inline-flex","items-center","px-2","py-1","rounded-md","text-xs","font-medium","bg-gray-100","text-gray-800"],[1,"mb-4"],["class","inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",4,"ngFor","ngForOf"],[1,"inline-flex","items-center","px-2","py-1","rounded-md","text-xs","font-medium","bg-blue-100","text-blue-800"],["title","Ver rutina completa",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Editar rutina",1,"text-red-600","hover:text-red-900","p-2","rounded-full","hover:bg-red-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Desactivar rutina",1,"text-red-600","hover:text-red-900","p-2","rounded-full","hover:bg-red-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],["title","Reactivar rutina",1,"text-green-600","hover:text-green-900","p-2","rounded-full","hover:bg-green-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-6xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"bg-white","px-4","pb-4","sm:px-6","max-h-96","overflow-y-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"text-red-500"],["type","text","placeholder","Nombre de la rutina",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","number","placeholder","60",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["rows","3","placeholder","Descripci\xF3n de la rutina",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"border-t","pt-6"],[1,"text-lg","font-medium","text-gray-900","mb-4"],[1,"grid","grid-cols-2","md:grid-cols-5","gap-2","mb-6"],["class","flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",3,"bg-red-50","border-red-300",4,"ngFor","ngForOf"],[1,"space-y-6"],["class","border border-gray-200 rounded-lg p-4",3,"hidden",4,"ngFor","ngForOf"],["class","mt-4 bg-red-50 border border-red-200 rounded-md p-3",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","animate-spin -ml-1 mr-3 h-5 w-5 text-white","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:mt-0","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50",3,"click","disabled"],[1,"flex","items-center","p-3","border","border-gray-300","rounded-lg","cursor-pointer","hover:bg-gray-50"],["type","checkbox",1,"h-4","w-4","text-red-600","focus:ring-red-500","border-gray-300","rounded",3,"change","checked"],[1,"ml-2","text-sm","font-medium","text-gray-900"],[1,"border","border-gray-200","rounded-lg","p-4"],[1,"text-md","font-medium","text-gray-900","mb-3","flex","items-center"],[1,"bg-red-100","text-red-800","px-2","py-1","rounded","text-sm","mr-2"],["class","grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",4,"ngIf"],[1,"space-y-3"],[1,"flex","justify-between","items-center"],["type","button",1,"inline-flex","items-center","px-2","py-1","border","border-transparent","text-xs","font-medium","rounded","text-red-700","bg-red-100","hover:bg-red-200",3,"click"],["class","border border-gray-200 rounded-lg p-3 bg-gray-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-8 text-gray-500",4,"ngIf"],["type","text","placeholder","Ej: AMRAP 20:00, 3 Series, etc.",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"input","value"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","placeholder","20:00",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"input","value"],["type","number","placeholder","3",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"input","value"],["type","text","placeholder","10:00",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"input","value"],[1,"border","border-gray-200","rounded-lg","p-3","bg-gray-50"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-3"],[1,"lg:col-span-2"],[1,"block","text-xs","font-medium","text-gray-700","mb-1"],["type","text","placeholder","Nombre del ejercicio",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["value","cardio"],["value","fuerza"],["value","funcional"],["value","core"],["value","movilidad"],["value","activacion"],["value","equilibrio"],["value","coordinaci\xF3n"],[1,"flex","items-end"],["type","button","title","Eliminar ejercicio",1,"text-red-600","hover:text-red-800","p-1",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],[1,"grid","grid-cols-2","md:grid-cols-4","lg:grid-cols-6","gap-3","mt-3"],["type","number","placeholder","12",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","number","placeholder","3",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","text","placeholder","2:00",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","text","placeholder","800m",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","number","min","1","max","10","placeholder","7",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","text","placeholder","20kg",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"mt-3"],["type","text","placeholder","Notas adicionales sobre el ejercicio",1,"block","w-full","px-2","py-1","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"text-center","py-8","text-gray-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-8","w-8","text-gray-400","mb-2"],[1,"text-sm"],["type","button",1,"mt-2","text-red-600","hover:text-red-800","text-sm",3,"click"],[1,"mt-4","bg-red-50","border","border-red-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["title","Crear nueva rutina",1,"md:hidden","fixed","bottom-6","right-6","w-14","h-14","bg-red-600","text-white","rounded-full","shadow-lg","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-500","focus:ring-offset-2","transition-all","duration-200","z-40",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","mx-auto"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-5xl","sm:w-full"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],[1,"mt-2"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-900","text-green-400","rounded-lg","p-6","font-mono","text-sm","overflow-auto","max-h-96","relative",2,"font-family","'Courier New', monospace","line-height","1.6"],[1,"flex","items-center","justify-between","mb-4","pb-2","border-b","border-gray-700"],[1,"w-3","h-3","bg-red-500","rounded-full"],[1,"w-3","h-3","bg-yellow-500","rounded-full"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-gray-400","text-xs"],[1,"whitespace-pre-wrap","text-white"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"inline-flex","items-center","px-3","py-2","border","border-transparent","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],[1,"text-sm","text-green-700"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),a(5,"Gesti\xF3n de Rutinas"),r(),n(6,"p",4),a(7),r()(),n(8,"div",5)(9,"button",6),_("click",function(){return i.refreshRutinas()}),h(),n(10,"svg",7),u(11,"path",8),r(),a(12," Refrescar "),r(),x(13,on,4,0,"button",9),r()()(),y(),n(14,"div",10)(15,"div",11)(16,"div",12)(17,"label",13),a(18,"Buscar"),r(),n(19,"input",14),T("ngModelChange",function(d){return k(i.searchTerm,d)||(i.searchTerm=d),d}),_("input",function(){return i.onSearch()}),r()(),n(20,"div")(21,"label",13),a(22,"Estado"),r(),n(23,"select",15),T("ngModelChange",function(d){return k(i.statusFilter,d)||(i.statusFilter=d),d}),_("change",function(){return i.onFilterChange()}),n(24,"option",16),a(25,"Todos"),r(),n(26,"option",17),a(27,"Activos"),r(),n(28,"option",18),a(29,"Inactivos"),r()()(),n(30,"div")(31,"label",13),a(32,"Tipo"),r(),n(33,"select",15),T("ngModelChange",function(d){return k(i.tipoFilter,d)||(i.tipoFilter=d),d}),_("change",function(){return i.onFilterChange()}),n(34,"option",16),a(35,"Todos"),r(),n(36,"option",19),a(37,"Entrenamiento"),r(),n(38,"option",20),a(39,"Recuperaci\xF3n"),r(),n(40,"option",21),a(41,"Evaluaci\xF3n"),r()()(),n(42,"div")(43,"label",13),a(44,"Nivel"),r(),n(45,"select",15),T("ngModelChange",function(d){return k(i.nivelFilter,d)||(i.nivelFilter=d),d}),_("change",function(){return i.onFilterChange()}),n(46,"option",16),a(47,"Todos"),r(),n(48,"option",22),a(49,"Principiante"),r(),n(50,"option",23),a(51,"Intermedio"),r(),n(52,"option",24),a(53,"Avanzado"),r()()()(),n(54,"div",25)(55,"button",26),_("click",function(){return i.clearFilters()}),a(56," Limpiar filtros "),r()()(),x(57,an,7,1,"div",27)(58,sn,2,0,"div",28)(59,xn,2,2,"div",29)(60,bn,10,3,"div",30),r(),x(61,Pn,62,13,"div",31)(62,In,3,0,"button",32)(63,Vn,40,4,"div",31)),e&2&&(l(7),v(" Crea y administra rutinas de entrenamiento - Total: ",i.rutinas.length," "),l(6),m("ngIf",i.canEditRutina()),l(6),E("ngModel",i.searchTerm),l(4),E("ngModel",i.statusFilter),l(10),E("ngModel",i.tipoFilter),l(12),E("ngModel",i.nivelFilter),l(12),m("ngIf",i.error&&!i.showModal&&!i.showViewModal),l(),m("ngIf",i.loading),l(),m("ngIf",!i.loading),l(),m("ngIf",!i.loading&&i.filteredRutinas.length===0),l(),m("ngIf",i.showModal),l(),m("ngIf",!i.showModal&&!i.showViewModal&&i.canEditRutina()),l(),m("ngIf",i.showViewModal))},dependencies:[z,R,ne,re,W,Ee,ie,G,Te,ke,H],styles:['.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.slide-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.rutina-card[_ngcontent-%COMP%]{transition:all .3s ease}.rutina-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}.btn-floating[_ngcontent-%COMP%]{box-shadow:0 4px 20px #ef444466;transition:all .3s ease}.btn-floating[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 6px 25px #ef444499}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#dc2626;border-radius:10px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#b91c1c}.tag[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tagAppear .2s ease-out}@keyframes _ngcontent-%COMP%_tagAppear{0%{transform:scale(.8);opacity:0}to{transform:scale(1);opacity:1}}.custom-spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #dc2626;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.form-input[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 3px #ef44441a;border-color:#dc2626}.rutinas-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}@media (max-width: 640px){.rutinas-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.checkbox-seccion[_ngcontent-%COMP%]{transform:scale(1.2);transition:transform .2s ease}.checkbox-seccion[_ngcontent-%COMP%]:checked{transform:scale(1.3)}.empty-state[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .5s ease-out}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.gradient-red[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc2626,#b91c1c)}.gradient-gray[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563)}.badge-status[_ngcontent-%COMP%]{position:relative;overflow:hidden}.badge-status[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.badge-status[_ngcontent-%COMP%]:hover:before{left:100%}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);background-color:#0009}.action-btn[_ngcontent-%COMP%]{position:relative;overflow:hidden;transition:all .3s ease}.action-btn[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;background-color:#fff3;border-radius:50%;transform:translate(-50%,-50%);transition:width .6s,height .6s}.action-btn[_ngcontent-%COMP%]:hover:before{width:300px;height:300px}.tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip[_ngcontent-%COMP%]   .tooltiptext[_ngcontent-%COMP%]{visibility:hidden;width:120px;background-color:#374151;color:#fff;text-align:center;border-radius:6px;padding:5px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-60px;opacity:0;transition:opacity .3s;font-size:12px}.tooltip[_ngcontent-%COMP%]:hover   .tooltiptext[_ngcontent-%COMP%]{visibility:visible;opacity:1}@media (max-width: 768px){.modal-content[_ngcontent-%COMP%]{max-height:90vh}.grid-responsive[_ngcontent-%COMP%]{grid-template-columns:1fr}.text-responsive[_ngcontent-%COMP%]{font-size:.875rem}}@media (prefers-color-scheme: dark){.card-dark[_ngcontent-%COMP%]{background-color:#1f2937;border-color:#374151}.text-dark[_ngcontent-%COMP%]{color:#f9fafb}}@media print{.no-print[_ngcontent-%COMP%]{display:none!important}.print-only[_ngcontent-%COMP%]{display:block!important}}.focus-visible[_ngcontent-%COMP%]:focus{outline:2px solid #dc2626;outline-offset:2px}@media (prefers-contrast: high){.btn-primary[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]{border:2px solid #000}}']})};var Fn=(s,t)=>({"bg-green-100 text-green-800":s,"bg-red-100 text-red-800":t});function Dn(s,t){if(s&1){let e=w();n(0,"div",32)(1,"div",33),h(),n(2,"svg",34),u(3,"path",35),r(),y(),n(4,"div",36)(5,"p",37),a(6),r()(),n(7,"div",38)(8,"button",39),_("click",function(){p(e);let o=c();return g(o.error="")}),h(),n(9,"svg",40),u(10,"path",41),r()()()()()}if(s&2){let e=c();l(6),C(e.error)}}function An(s,t){s&1&&(n(0,"div",42)(1,"div",43),u(2,"div",44),n(3,"p",45),a(4,"Cargando tipos de secci\xF3n..."),r()()())}function Rn(s,t){if(s&1&&u(0,"i"),s&2){let e=c().$implicit;A(e.icono+" text-red-600 text-2xl")}}function jn(s,t){s&1&&(h(),n(0,"svg",68),u(1,"path",69),r())}function Un(s,t){if(s&1){let e=w();n(0,"button",70),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.deleteTipo(o))}),h(),n(1,"svg",64),u(2,"path",71),r(),a(3," Desactivar "),r()}}function Ln(s,t){if(s&1){let e=w();n(0,"button",72),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.reactivateTipo(o))}),h(),n(1,"svg",64),u(2,"path",73),r(),a(3," Reactivar "),r()}}function Nn(s,t){if(s&1){let e=w();n(0,"div",49)(1,"div",50)(2,"div",51),x(3,Rn,1,2,"i",52)(4,jn,2,0,"svg",53),r(),n(5,"h3",54),a(6),r(),n(7,"p",55),a(8),r(),n(9,"div",56)(10,"span",57),h(),n(11,"svg",58),u(12,"circle",59),r(),a(13),r()(),y(),n(14,"p",60),a(15),r()(),n(16,"div",61)(17,"div",62)(18,"button",63),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.openEditModal(o))}),h(),n(19,"svg",64),u(20,"path",65),r(),a(21," Editar "),r(),x(22,Un,4,0,"button",66)(23,Ln,4,0,"button",67),r()()()}if(s&2){let e=t.$implicit,i=c(2);l(3),m("ngIf",e.icono),l(),m("ngIf",!e.icono),l(2),C(e.descripcion),l(2),C(e.nombre),l(2),m("ngClass",ue(9,Fn,e.status===1,e.status===0)),l(3),v(" ",i.getStatusText(e.status)," "),l(2),v(" Creado: ",i.formatDate(e.created_at)," "),l(7),m("ngIf",e.status===1),l(),m("ngIf",e.status===0)}}function zn(s,t){if(s&1){let e=w();n(0,"button",81),_("click",function(){p(e);let o=c(3);return g(o.openCreateModal())}),a(1," Crear primer tipo "),r()}}function Bn(s,t){if(s&1){let e=w();n(0,"button",82),_("click",function(){p(e);let o=c(3);return g(o.clearFilters())}),a(1," Limpiar filtros "),r()}}function $n(s,t){if(s&1&&(n(0,"div",74),h(),n(1,"svg",75),u(2,"path",69),r(),y(),n(3,"h3",76),a(4,"No hay tipos de secci\xF3n"),r(),n(5,"p",77),a(6),r(),n(7,"div",78),x(8,zn,2,0,"button",79)(9,Bn,2,0,"button",80),r()()),s&2){let e=c(2);l(6),v(" ",e.tiposSecciones.length===0?"No se encontraron tipos de secci\xF3n.":"No se encontraron resultados con los filtros aplicados."," "),l(2),m("ngIf",e.tiposSecciones.length===0),l(),m("ngIf",e.tiposSecciones.length>0)}}function Wn(s,t){if(s&1&&(n(0,"div",46),x(1,Nn,24,12,"div",47)(2,$n,10,3,"div",48),r()),s&2){let e=c();l(),m("ngForOf",e.filteredTiposSecciones)("ngForTrackBy",e.trackByTipoId),l(),m("ngIf",e.filteredTiposSecciones.length===0)}}function Gn(s,t){if(s&1){let e=w();n(0,"div",116)(1,"div",117),u(2,"i"),n(3,"span",118),a(4),r(),n(5,"button",119),_("click",function(){p(e);let o=c(2);return g(o.clearIcon())}),h(),n(6,"svg",120),u(7,"path",41),r()()()()}if(s&2){let e=c(2);l(2),A(e.tipoForm.icono+" text-red-600 text-2xl mr-3"),l(2),C(e.tipoForm.icono)}}function Hn(s,t){if(s&1){let e=w();n(0,"button",121),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.selectIcon(o.clase))}),u(1,"i"),r()}if(s&2){let e=t.$implicit,i=c(2);A(i.getIconButtonClass(e.clase)),m("title",e.nombre),l(),A(e.clase)}}function qn(s,t){if(s&1&&(n(0,"div",122)(1,"div",33),h(),n(2,"svg",34),u(3,"path",35),r(),y(),n(4,"div",36)(5,"p",37),a(6),r()()()()),s&2){let e=c(2);l(6),C(e.error)}}function Yn(s,t){if(s&1){let e=w();n(0,"div",83)(1,"div",84)(2,"div",85),_("click",function(){p(e);let o=c();return g(o.closeModal())}),r(),n(3,"span",86),a(4,"\u200B"),r(),n(5,"div",87)(6,"div",88)(7,"div",89)(8,"div",90),h(),n(9,"svg",91),u(10,"path",69),r()(),y(),n(11,"div",92)(12,"h3",93),a(13),r(),n(14,"div",94)(15,"p",95),a(16),r()()()()(),n(17,"div",96)(18,"form",97)(19,"div")(20,"label",98),a(21," Nombre (Identificador) "),n(22,"span",99),a(23,"*"),r()(),n(24,"input",100),T("ngModelChange",function(o){p(e);let d=c();return k(d.tipoForm.nombre,o)||(d.tipoForm.nombre=o),g(o)}),r(),n(25,"p",101),a(26," Se convertir\xE1 autom\xE1ticamente a formato snake_case (ej: warm_up) "),r()(),n(27,"div")(28,"label",102),a(29," Descripci\xF3n "),n(30,"span",99),a(31,"*"),r()(),n(32,"input",103),T("ngModelChange",function(o){p(e);let d=c();return k(d.tipoForm.descripcion,o)||(d.tipoForm.descripcion=o),g(o)}),r()(),n(33,"div")(34,"label",104),a(35," Icono "),r(),x(36,Gn,8,3,"div",105),n(37,"div",106),x(38,Hn,2,5,"button",107),r(),n(39,"p",101),a(40," Selecciona un icono de la lista o deja vac\xEDo para usar el icono por defecto "),r()(),n(41,"div")(42,"label",108),a(43," Estado "),r(),n(44,"select",109),T("ngModelChange",function(o){p(e);let d=c();return k(d.tipoForm.status,o)||(d.tipoForm.status=o),g(o)}),n(45,"option",110),a(46,"Activo"),r(),n(47,"option",111),a(48,"Inactivo"),r()()()(),x(49,qn,7,1,"div",112),r(),n(50,"div",113)(51,"button",114),_("click",function(){p(e);let o=c();return g(o.saveTipo())}),a(52),r(),n(53,"button",115),_("click",function(){p(e);let o=c();return g(o.closeModal())}),a(54," Cancelar "),r()()()()()}if(s&2){let e=c();l(13),v(" ",e.modalMode==="create"?"Crear Nuevo Tipo de Secci\xF3n":"Editar Tipo de Secci\xF3n"," "),l(3),v(" ",e.modalMode==="create"?"Complete los datos para crear un nuevo tipo de secci\xF3n.":"Modifique los datos del tipo de secci\xF3n seleccionado."," "),l(8),E("ngModel",e.tipoForm.nombre),l(8),E("ngModel",e.tipoForm.descripcion),l(4),m("ngIf",e.tipoForm.icono),l(2),m("ngForOf",e.iconosDisponibles),l(6),E("ngModel",e.tipoForm.status),l(5),m("ngIf",e.error),l(2),m("disabled",!e.isFormValid()),l(),v(" ",e.modalMode==="create"?"Crear Tipo":"Guardar Cambios"," ")}}var it=class s{constructor(t,e){this.supabaseService=t;this.authService=e}tiposSecciones=[];filteredTiposSecciones=[];loading=!1;error="";showModal=!1;modalMode="create";selectedTipo=null;tipoForm={nombre:"",descripcion:"",icono:"",status:1};searchTerm="";statusFilter="active";iconosDisponibles=[{clase:"fas fa-fire",nombre:"Fuego - Intensidad"},{clase:"fas fa-heartbeat",nombre:"Cardio"},{clase:"fas fa-dumbbell",nombre:"Pesas"},{clase:"fas fa-circle-dot",nombre:"Core"},{clase:"fas fa-plus-circle",nombre:"Extra"},{clase:"fas fa-running",nombre:"Corriendo"},{clase:"fas fa-hand-paper",nombre:"Flexibilidad"},{clase:"fas fa-spa",nombre:"Recuperaci\xF3n"},{clase:"fas fa-bolt",nombre:"Potencia"},{clase:"fas fa-star",nombre:"Destacado"},{clase:"fas fa-shield-alt",nombre:"Resistencia"},{clase:"fas fa-stopwatch",nombre:"Tiempo"},{clase:"fas fa-trophy",nombre:"Competici\xF3n"},{clase:"fas fa-chart-line",nombre:"Progreso"},{clase:"fas fa-weight-hanging",nombre:"Peso"},{clase:"fas fa-bicycle",nombre:"Ciclismo"},{clase:"fas fa-swimming-pool",nombre:"Nataci\xF3n"},{clase:"fas fa-hiking",nombre:"Funcional"},{clase:"fas fa-mountain",nombre:"Resistencia"},{clase:"fas fa-thermometer-half",nombre:"Calentamiento"}];ngOnInit(){return b(this,null,function*(){if(!this.authService.isAdmin()){this.error="No tienes permisos para acceder a esta secci\xF3n";return}yield this.loadTiposSecciones()})}loadTiposSecciones(){return b(this,null,function*(){this.loading=!0,this.error="";try{console.log("Cargando tipos de secci\xF3n...");let t=yield this.supabaseService.getData("tipos_seccion");this.tiposSecciones=t||[],this.filteredTiposSecciones=[...this.tiposSecciones],this.applyFilters(),console.log("Tipos de secci\xF3n cargados:",this.tiposSecciones.length)}catch(t){console.error("Error cargando tipos de secci\xF3n:",t),this.error="Error al cargar los tipos de secci\xF3n. Verifique la conexi\xF3n a la base de datos."}finally{this.loading=!1}})}applyFilters(){let t=[...this.tiposSecciones];if(this.statusFilter==="active"?t=t.filter(e=>e.status===1):this.statusFilter==="inactive"&&(t=t.filter(e=>e.status===0)),this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.nombre.toLowerCase().includes(e)||i.descripcion.toLowerCase().includes(e))}this.filteredTiposSecciones=t}openCreateModal(){this.modalMode="create",this.tipoForm={nombre:"",descripcion:"",icono:"",status:1},this.error="",this.showModal=!0}openEditModal(t){this.modalMode="edit",this.selectedTipo=t,this.tipoForm=ce({},t),this.error="",this.showModal=!0}closeModal(){this.showModal=!1,this.selectedTipo=null,this.error=""}saveTipo(){return b(this,null,function*(){try{if(this.error="",!this.tipoForm.nombre?.trim()){this.error="El nombre es requerido";return}if(!this.tipoForm.descripcion?.trim()){this.error="La descripci\xF3n es requerida";return}if(this.tipoForm.nombre.trim().length>50){this.error="El nombre no puede exceder 50 caracteres";return}if(this.tipoForm.descripcion.trim().length>100){this.error="La descripci\xF3n no puede exceder 100 caracteres";return}let t=this.tipoForm.nombre;if(this.tipoForm.nombre=this.tipoForm.nombre.toLowerCase().trim().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,""),!this.tipoForm.nombre){this.error="El nombre debe contener al menos una letra o n\xFAmero v\xE1lido";return}if(console.log(`Nombre convertido de "${t}" a "${this.tipoForm.nombre}"`),this.tiposSecciones.some(i=>i.nombre.toLowerCase()===this.tipoForm.nombre.toLowerCase()&&(this.modalMode==="create"||i.id!==this.selectedTipo?.id))){this.error="Ya existe un tipo de secci\xF3n con ese nombre";return}this.tipoForm.icono?.trim()||(this.tipoForm.icono=""),this.modalMode==="create"?(console.log("Creando tipo de secci\xF3n:",this.tipoForm),yield this.supabaseService.insertData("tipos_seccion",this.tipoForm),console.log("Tipo de secci\xF3n creado exitosamente")):(console.log("Actualizando tipo de secci\xF3n:",this.tipoForm),yield this.supabaseService.updateData("tipos_seccion",this.selectedTipo.id.toString(),this.tipoForm),console.log("Tipo de secci\xF3n actualizado exitosamente")),yield this.loadTiposSecciones(),this.closeModal()}catch(t){console.error("Error guardando tipo de secci\xF3n:",t),this.error="Error al guardar el tipo de secci\xF3n. Intente nuevamente."}})}deleteTipo(t){return b(this,null,function*(){let e=`\xBFEst\xE1 seguro de desactivar el tipo de secci\xF3n "${t.descripcion}"?`;if(confirm(e))try{console.log("Desactivando tipo de secci\xF3n:",t.nombre),yield this.supabaseService.updateData("tipos_seccion",t.id.toString(),{status:0}),yield this.loadTiposSecciones(),console.log("Tipo de secci\xF3n desactivado exitosamente")}catch(i){console.error("Error desactivando tipo de secci\xF3n:",i),this.error="Error al desactivar el tipo de secci\xF3n",setTimeout(()=>this.error="",5e3)}})}reactivateTipo(t){return b(this,null,function*(){let e=`\xBFEst\xE1 seguro de reactivar el tipo de secci\xF3n "${t.descripcion}"?`;if(confirm(e))try{console.log("Reactivando tipo de secci\xF3n:",t.nombre),yield this.supabaseService.updateData("tipos_seccion",t.id.toString(),{status:1}),yield this.loadTiposSecciones(),console.log("Tipo de secci\xF3n reactivado exitosamente")}catch(i){console.error("Error reactivando tipo de secci\xF3n:",i),this.error="Error al reactivar el tipo de secci\xF3n",setTimeout(()=>this.error="",5e3)}})}getStatusText(t){return t===1?"Activo":"Inactivo"}getStatusColor(t){return t===1?"green":"red"}formatDate(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(e){return console.error("Error formateando fecha:",e),"Fecha inv\xE1lida"}}onSearch(){this.applyFilters()}onFilterChange(){this.applyFilters()}clearFilters(){this.searchTerm="",this.statusFilter="active",this.applyFilters()}refreshTipos(){return b(this,null,function*(){console.log("Refrescando tipos de secci\xF3n"),yield this.loadTiposSecciones()})}selectIcon(t){this.tipoForm.icono=t,console.log("Icono seleccionado:",t)}trackByTipoId(t,e){return e.id||t}isIconSelected(t){return this.tipoForm.icono===t}clearIcon(){this.tipoForm.icono=""}isFormValid(){return!!(this.tipoForm.nombre?.trim()&&this.tipoForm.descripcion?.trim())}getIconButtonClass(t){let e="p-2 rounded-md border transition-colors duration-150 hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-500";return this.isIconSelected(t)?`${e} border-red-500 bg-red-50`:`${e} border-gray-200`}static \u0275fac=function(e){return new(e||s)(O(Q),O(L))};static \u0275cmp=D({type:s,selectors:[["app-tipos-seccion"]],standalone:!1,decls:44,vars:7,consts:[[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],["title","Refrescar lista",1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"md:col-span-2"],["for","search",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],["id","search","type","text","placeholder","Buscar por nombre o descripci\xF3n...",1,"block","w-full","pl-10","pr-3","py-2","border","border-gray-300","rounded-md","leading-5","bg-white","placeholder-gray-500","focus:outline-none","focus:placeholder-gray-400","focus:ring-1","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","input","ngModel"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["for","statusFilter",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","statusFilter",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","change","ngModel"],["value","all"],["value","active"],["value","inactive"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-red-600","hover:text-red-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"ml-auto","pl-3"],[1,"text-red-400","hover:text-red-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","justify-center","items-center","h-64"],[1,"text-center"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-red-600","mx-auto"],[1,"mt-4","text-gray-600"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-6"],["class","bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 border border-gray-200",4,"ngFor","ngForOf","ngForTrackBy"],["class","col-span-full text-center py-12",4,"ngIf"],[1,"bg-white","rounded-lg","shadow-md","hover:shadow-lg","transition-shadow","duration-200","border","border-gray-200"],[1,"p-6","text-center"],[1,"mx-auto","h-16","w-16","bg-red-100","rounded-full","flex","items-center","justify-center","mb-4"],[3,"class",4,"ngIf"],["class","h-8 w-8 text-red-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-sm","text-gray-500","mb-3"],[1,"mb-4"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["fill","currentColor","viewBox","0 0 8 8",1,"w-2","h-2","mr-1"],["cx","4","cy","4","r","3"],[1,"text-xs","text-gray-400","mb-4"],[1,"px-6","pb-6"],[1,"flex","justify-center","space-x-2"],["title","Editar tipo",1,"flex-1","inline-flex","items-center","justify-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["class","flex-1 inline-flex items-center justify-center px-3 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-red-50 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500","title","Desactivar",3,"click",4,"ngIf"],["class","flex-1 inline-flex items-center justify-center px-3 py-2 border border-green-300 shadow-sm text-sm font-medium rounded-md text-green-700 bg-green-50 hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500","title","Reactivar",3,"click",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-8","w-8","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 00-2 2v2a2 2 0 002 2m0 0h14"],["title","Desactivar",1,"flex-1","inline-flex","items-center","justify-center","px-3","py-2","border","border-red-300","shadow-sm","text-sm","font-medium","rounded-md","text-red-700","bg-red-50","hover:bg-red-100","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636"],["title","Reactivar",1,"flex-1","inline-flex","items-center","justify-center","px-3","py-2","border","border-green-300","shadow-sm","text-sm","font-medium","rounded-md","text-green-700","bg-green-50","hover:bg-green-100","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-green-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"col-span-full","text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-end","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-2xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"text-sm","text-gray-500"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"space-y-4"],["for","nombre",1,"block","text-sm","font-medium","text-gray-700"],[1,"text-red-500"],["id","nombre","type","text","name","nombre","required","","placeholder","Ej: warm_up, strength, cardio",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-red-500","focus:border-red-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"mt-1","text-xs","text-gray-500"],["for","descripcion",1,"block","text-sm","font-medium","text-gray-700"],["id","descripcion","type","text","name","descripcion","required","","placeholder","Ej: Calentamiento, Entrenamiento de Fuerza, Cardiovascular",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-red-500","focus:border-red-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["class","mb-3 p-3 bg-gray-50 rounded-md",4,"ngIf"],[1,"grid","grid-cols-5","sm:grid-cols-8","gap-2","max-h-48","overflow-y-auto","border","border-gray-200","rounded-md","p-3"],["type","button",3,"class","title","click",4,"ngFor","ngForOf"],["for","status",1,"block","text-sm","font-medium","text-gray-700"],["id","status","name","status",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-red-500","focus:border-red-500","sm:text-sm",3,"ngModelChange","ngModel"],["value","1"],["value","0"],["class","mt-4 bg-red-50 border border-red-200 rounded-md p-3",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:mt-0","sm:ml-3","sm:w-auto","sm:text-sm",3,"click"],[1,"mb-3","p-3","bg-gray-50","rounded-md"],[1,"flex","items-center"],[1,"text-sm","text-gray-700"],["type","button","title","Limpiar icono",1,"ml-auto","text-red-600","hover:text-red-800",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["type","button",3,"click","title"],[1,"mt-4","bg-red-50","border","border-red-200","rounded-md","p-3"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),a(5,"Gesti\xF3n de Tipos de Secci\xF3n"),r(),n(6,"p",4),a(7),r()(),n(8,"div",5)(9,"button",6),_("click",function(){return i.refreshTipos()}),h(),n(10,"svg",7),u(11,"path",8),r(),a(12," Refrescar "),r(),y(),n(13,"button",9),_("click",function(){return i.openCreateModal()}),h(),n(14,"svg",10),u(15,"path",11),r(),a(16," Nuevo Tipo "),r()()()(),y(),n(17,"div",12)(18,"div",13)(19,"div",14)(20,"label",15),a(21," Buscar "),r(),n(22,"div",16)(23,"input",17),T("ngModelChange",function(d){return k(i.searchTerm,d)||(i.searchTerm=d),d}),_("input",function(){return i.onSearch()}),r(),n(24,"div",18),h(),n(25,"svg",19),u(26,"path",20),r()()()(),y(),n(27,"div")(28,"label",21),a(29," Estado "),r(),n(30,"select",22),T("ngModelChange",function(d){return k(i.statusFilter,d)||(i.statusFilter=d),d}),_("change",function(){return i.onFilterChange()}),n(31,"option",23),a(32,"Todos"),r(),n(33,"option",24),a(34,"Activos"),r(),n(35,"option",25),a(36,"Inactivos"),r()()()(),n(37,"div",26)(38,"button",27),_("click",function(){return i.clearFilters()}),a(39," Limpiar filtros "),r()()(),x(40,Dn,11,1,"div",28)(41,An,5,0,"div",29)(42,Wn,3,3,"div",30),r(),x(43,Yn,55,10,"div",31)),e&2&&(l(7),v(" Administra los tipos de secci\xF3n para entrenamientos - Total: ",i.tiposSecciones.length," "),l(16),E("ngModel",i.searchTerm),l(7),E("ngModel",i.statusFilter),l(10),m("ngIf",i.error),l(),m("ngIf",i.loading),l(),m("ngIf",!i.loading),l(),m("ngIf",i.showModal))},dependencies:[$,z,R,te,ne,re,W,ie,G,ee,ve,H,se],styles:['.tipo-card[_ngcontent-%COMP%]{transition:all .3s ease}.tipo-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.icon-grid[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#e5e7eb #f9fafb}.icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f9fafb;border-radius:3px}.icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#e5e7eb;border-radius:3px}.icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#d1d5db}.icon-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;transition:all .2s ease}.icon-button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.icon-button.selected[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #dc2626}.card-enter[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_cardEnter .3s ease-out}@keyframes _ngcontent-%COMP%_cardEnter{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-weight:500;font-size:.75rem;padding:.25rem .5rem;border-radius:9999px}.status-active[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.status-inactive[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b}.action-button[_ngcontent-%COMP%]{transition:all .2s ease}.action-button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 8px #0000001a}@media (max-width: 768px){.icon-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}.icon-button[_ngcontent-%COMP%]{width:36px;height:36px}}.focus-ring[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 2px #dc2626}.icon-preview[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.75rem;background-color:#f9fafb;border-radius:.375rem;margin-bottom:.75rem}.icon-preview[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.75rem;font-size:1.5rem;color:#dc2626}.error-message[_ngcontent-%COMP%]{background-color:#fef2f2;border:1px solid #fecaca;color:#991b1b;padding:.75rem;border-radius:.375rem;font-size:.875rem;margin-top:1rem}.tooltip[_ngcontent-%COMP%]{position:relative}.tooltip[_ngcontent-%COMP%]:hover:after{content:attr(title);position:absolute;bottom:100%;left:50%;transform:translate(-50%);background-color:#1f2937;color:#fff;padding:.25rem .5rem;border-radius:.25rem;font-size:.75rem;white-space:nowrap;z-index:10;margin-bottom:.25rem}.button-loading[_ngcontent-%COMP%]{opacity:.7;cursor:not-allowed}.button-loading[_ngcontent-%COMP%]:before{content:"";width:1rem;height:1rem;border:2px solid transparent;border-top:2px solid currentColor;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-right:.5rem;display:inline-block}']})};var Qn=(s,t,e,i,o)=>({"bg-green-100 text-green-800":s,"bg-blue-100 text-blue-800":t,"bg-yellow-100 text-yellow-800":e,"bg-red-100 text-red-800":i,"bg-gray-100 text-gray-600":o}),Jn=(s,t,e,i)=>({"bg-gray-100 text-gray-800":s,"bg-yellow-100 text-yellow-800":t,"bg-green-100 text-green-800":e,"bg-red-100 text-red-800":i});function Zn(s,t){if(s&1){let e=w();n(0,"button",34),_("click",function(){p(e);let o=c();return g(o.openAsignarModal())}),h(),n(1,"svg",35),u(2,"path",36),r(),a(3," Asignar Rutina "),r()}}function Xn(s,t){if(s&1&&(n(0,"option",37),a(1),r()),s&2){let e=t.$implicit;m("value",e.nombre),l(),v(" ",e.nombre," ")}}function Kn(s,t){if(s&1&&(n(0,"div",38)(1,"div",39),h(),n(2,"svg",40),u(3,"path",41),r(),y(),n(4,"div",42)(5,"p",43),a(6),r()()()()),s&2){let e=c();l(6),C(e.error)}}function er(s,t){s&1&&(n(0,"div",44),u(1,"div",45),r())}function tr(s,t){if(s&1&&(n(0,"span",78),a(1),r()),s&2){let e=c(2).$implicit,i=c(2);l(),v(" ",i.getDiasRestantes(e.fecha_fin_programada)," d\xEDas restantes ")}}function ir(s,t){s&1&&(n(0,"span",79),a(1," Vence hoy "),r())}function nr(s,t){if(s&1&&(n(0,"div",75),x(1,tr,2,1,"span",76)(2,ir,2,0,"span",77),r()),s&2){let e=c().$implicit,i=c(2);l(),m("ngIf",i.getDiasRestantes(e.fecha_fin_programada)>0),l(),m("ngIf",i.getDiasRestantes(e.fecha_fin_programada)===0)}}function rr(s,t){s&1&&(n(0,"div",80),a(1," Vencida "),r())}function or(s,t){if(s&1){let e=w();n(0,"button",81),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.cancelarAsignacion(o.asignacion_id))}),h(),n(1,"svg",73),u(2,"path",82),r()()}}function ar(s,t){if(s&1){let e=w();n(0,"tr",56)(1,"td",57)(2,"div")(3,"div",58),a(4),r(),n(5,"div",59),a(6),r()()(),n(7,"td",57)(8,"div",60),h(),n(9,"svg",61),u(10,"path",62),r(),y(),n(11,"span",58),a(12),r(),n(13,"span",63),a(14,"usuarios"),r()()(),n(15,"td",64)(16,"div")(17,"div"),a(18),r(),n(19,"div",65),a(20),r(),x(21,nr,3,2,"div",66)(22,rr,2,0,"div",67),r()(),n(23,"td",57)(24,"span",68),u(25,"i"),a(26),r()(),n(27,"td",57)(28,"div",69),a(29),r(),n(30,"div",59),a(31),r()(),n(32,"td",70)(33,"div",71)(34,"button",72),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.openVerModal(o))}),h(),n(35,"svg",73),u(36,"path",10)(37,"path",11),r()(),x(38,or,3,0,"button",74),r()()()}if(s&2){let e=t.$implicit,i=c(2);F("opacity-50",!e.es_activa)("bg-gray-50",!e.es_activa),l(3),F("text-gray-500",!e.es_activa),l(),v(" ",e.rutina_nombre," "),l(2),C(e.rutina_descripcion),l(5),F("text-gray-500",!e.es_activa),l(),v(" ",e.usuarios_count," "),l(4),F("text-gray-500",!e.es_activa),l(2),C(i.formatDate(e.fecha_inicio_programada)),l(2),C(i.formatDate(e.fecha_fin_programada)),l(),m("ngIf",e.es_activa),l(),m("ngIf",!e.es_activa&&i.isVencida(e.fecha_fin_programada)),l(2),m("ngClass",De(30,Qn,e.estado_asignacion==="activa"&&e.es_activa,e.estado_asignacion==="completada",e.estado_asignacion==="pausada",e.estado_asignacion==="cancelada"||e.estado_asignacion==="expirada",!e.es_activa)),l(),A(i.getEstadoIcon(e.estado_asignacion)+" mr-1"),l(),v(" ",!e.es_activa&&e.estado_asignacion==="activa"?"expirada":e.estado_asignacion," "),l(2),F("text-gray-500",!e.es_activa),l(),v(" ",e.asignado_por_nombre," "),l(2),C(i.formatDate(e.fecha_asignacion)),l(3),F("text-gray-400",!e.es_activa)("hover:text-gray-600",!e.es_activa),l(4),m("ngIf",e.es_activa&&e.estado_asignacion==="activa"&&i.canAssignRoutines())}}function sr(s,t){s&1&&(fe(0),a(1," No se han creado asignaciones a\xFAn. "),_e())}function lr(s,t){s&1&&a(0," No se encontraron asignaciones con los filtros aplicados. ")}function dr(s,t){if(s&1){let e=w();n(0,"button",92),_("click",function(){p(e);let o=c(3);return g(o.openAsignarModal())}),a(1," Crear primera asignaci\xF3n "),r()}}function cr(s,t){if(s&1){let e=w();n(0,"button",93),_("click",function(){p(e);let o=c(3);return g(o.clearFilters())}),a(1," Limpiar filtros "),r()}}function mr(s,t){if(s&1&&(n(0,"div",83),h(),n(1,"svg",84),u(2,"path",85),r(),y(),n(3,"h3",86),a(4,"No hay asignaciones"),r(),n(5,"p",87),x(6,sr,2,0,"ng-container",88)(7,lr,1,0,"ng-template",null,0,K),r(),n(9,"div",89),x(10,dr,2,0,"button",90)(11,cr,2,0,"button",91),r()()),s&2){let e=Y(8),i=c(2);l(6),m("ngIf",i.asignaciones.length===0)("ngIfElse",e),l(4),m("ngIf",i.asignaciones.length===0&&i.canAssignRoutines()),l(),m("ngIf",i.asignaciones.length>0)}}function ur(s,t){if(s&1&&(n(0,"div",46)(1,"div",47)(2,"h3",48),a(3),r()(),n(4,"div",49)(5,"table",50)(6,"thead",51)(7,"tr")(8,"th",52),a(9," Rutina "),r(),n(10,"th",52),a(11," Usuarios "),r(),n(12,"th",52),a(13," Fechas / Duraci\xF3n "),r(),n(14,"th",52),a(15," Estado "),r(),n(16,"th",52),a(17," Asignado por "),r(),n(18,"th",52),a(19," Acciones "),r()()(),n(20,"tbody",53),x(21,ar,39,36,"tr",54),r()(),x(22,mr,12,4,"div",55),r()()),s&2){let e=c();l(3),v(" Asignaciones Realizadas (",e.filteredAsignaciones.length,") "),l(18),m("ngForOf",e.filteredAsignaciones)("ngForTrackBy",e.trackByAsignacionId),l(),m("ngIf",e.filteredAsignaciones.length===0)}}function pr(s,t){if(s&1&&(n(0,"option",37),a(1),r()),s&2){let e=t.$implicit;m("value",e.id),l(),N(" ",e.nombre," - ",e.nivel," ")}}function gr(s,t){if(s&1&&(n(0,"div",130)(1,"div",60),h(),n(2,"svg",131),u(3,"path",132),r(),y(),n(4,"div",133)(5,"span",134),a(6,"Fecha de finalizaci\xF3n:"),r(),n(7,"span",135),a(8),r()()()()),s&2){let e=c(2);l(8),C(e.formatDate(e.calcularFechaFin(e.asignacionForm.fecha_inicio)))}}function fr(s,t){if(s&1){let e=w();n(0,"label",136)(1,"input",137),_("change",function(){let o=p(e).$implicit,d=c(2);return g(d.toggleUsuario(o.id))}),r(),n(2,"div",138)(3,"div",58),a(4),r(),n(5,"div",139),a(6),r()()()}if(s&2){let e=t.$implicit,i=c(2);F("bg-red-50",i.isUsuarioSelected(e.id)),l(),m("checked",i.isUsuarioSelected(e.id)),l(3),C(e.full_name),l(2),v("@",e.username,"")}}function _r(s,t){s&1&&(n(0,"span"),a(1," usuario seleccionado"),r())}function xr(s,t){s&1&&a(0," usuarios seleccionados")}function hr(s,t){if(s&1&&(n(0,"div",140)(1,"div",39),h(),n(2,"svg",40),u(3,"path",41),r(),y(),n(4,"div",42)(5,"p",43),a(6),r()()()()),s&2){let e=c(2);l(6),C(e.error)}}function vr(s,t){s&1&&(h(),n(0,"svg",141),u(1,"path",12),r())}function br(s,t){if(s&1){let e=w();n(0,"div",94)(1,"div",95)(2,"div",96),_("click",function(){p(e);let o=c();return g(o.closeAsignarModal())}),r(),n(3,"span",97),a(4,"\u200B"),r(),n(5,"div",98)(6,"div",99)(7,"div",100)(8,"div",101),h(),n(9,"svg",102),u(10,"path",36),r()(),y(),n(11,"div",103)(12,"h3",48),a(13," Asignar Rutina a Usuarios "),r(),n(14,"div",104)(15,"p",59),a(16," Selecciona una rutina y los usuarios. La asignaci\xF3n durar\xE1 autom\xE1ticamente 1 mes. "),r()()()()(),n(17,"div",105)(18,"form",106)(19,"div")(20,"label",17),a(21," Rutina "),n(22,"span",107),a(23,"*"),r()(),n(24,"select",108),T("ngModelChange",function(o){p(e);let d=c();return k(d.asignacionForm.id_rutina,o)||(d.asignacionForm.id_rutina=o),g(o)}),n(25,"option",109),a(26,"Selecciona una rutina"),r(),x(27,pr,2,3,"option",26),r()(),n(28,"div",110)(29,"div")(30,"label",17),a(31," Fecha de Inicio "),n(32,"span",107),a(33,"*"),r()(),n(34,"input",111),T("ngModelChange",function(o){p(e);let d=c();return k(d.asignacionForm.fecha_inicio,o)||(d.asignacionForm.fecha_inicio=o),g(o)}),r()(),n(35,"div")(36,"label",17),a(37," Duraci\xF3n "),r(),n(38,"div",112),h(),n(39,"svg",113),u(40,"path",114),r(),y(),n(41,"span",115),a(42,"1 mes (autom\xE1tico)"),r()()()(),x(43,gr,9,1,"div",116),n(44,"div")(45,"label",17),a(46," Notas (Opcional) "),r(),n(47,"textarea",117),T("ngModelChange",function(o){p(e);let d=c();return k(d.asignacionForm.notas,o)||(d.asignacionForm.notas=o),g(o)}),r()(),n(48,"div")(49,"div",118)(50,"label",119),a(51," Usuarios "),n(52,"span",107),a(53,"*"),r()(),n(54,"div",7)(55,"button",120),_("click",function(){p(e);let o=c();return g(o.selectAllUsuarios())}),a(56," Seleccionar todos "),r(),n(57,"button",121),_("click",function(){p(e);let o=c();return g(o.clearAllUsuarios())}),a(58," Limpiar selecci\xF3n "),r()()(),n(59,"div",122)(60,"div",123),x(61,fr,7,5,"label",124),r()(),n(62,"div",6)(63,"span"),a(64),r(),x(65,_r,2,0,"span",88)(66,xr,1,0,"ng-template",null,1,K),r()()(),x(68,hr,7,1,"div",125),r(),n(69,"div",126)(70,"button",127),_("click",function(){p(e);let o=c();return g(o.asignarRutina())}),x(71,vr,2,0,"svg",128),a(72," Asignar por 1 mes "),r(),n(73,"button",129),_("click",function(){p(e);let o=c();return g(o.closeAsignarModal())}),a(74," Cancelar "),r()()()()()}if(s&2){let e=Y(67),i=c();l(24),E("ngModel",i.asignacionForm.id_rutina),l(3),m("ngForOf",i.rutinas)("ngForTrackBy",i.trackByRutinaId),l(7),E("ngModel",i.asignacionForm.fecha_inicio),l(9),m("ngIf",i.asignacionForm.fecha_inicio),l(4),E("ngModel",i.asignacionForm.notas),l(14),m("ngForOf",i.usuarios)("ngForTrackBy",i.trackByUserId),l(3),C(i.asignacionForm.usuarios_seleccionados.length),l(),m("ngIf",i.asignacionForm.usuarios_seleccionados.length===1)("ngIfElse",e),l(3),m("ngIf",i.error),l(2),m("disabled",i.loading||!i.asignacionForm.id_rutina||i.asignacionForm.usuarios_seleccionados.length===0),l(),m("ngIf",i.loading),l(2),m("disabled",i.loading)}}function wr(s,t){s&1&&(n(0,"span",156),a(1," (Asignaci\xF3n vencida) "),r())}function yr(s,t){if(s&1&&(n(0,"span",78),a(1),r()),s&2){let e=c(3);l(),v(" ",e.getDiasRestantes(e.selectedAsignacion.fecha_fin_programada)," d\xEDas restantes ")}}function Cr(s,t){s&1&&(n(0,"span",79),a(1," Vence hoy "),r())}function Sr(s,t){s&1&&(n(0,"span",158),a(1," Asignaci\xF3n vencida "),r())}function Mr(s,t){if(s&1&&(n(0,"div",75),x(1,yr,2,1,"span",76)(2,Cr,2,0,"span",77)(3,Sr,2,0,"span",157),r()),s&2){let e=c(2);l(),m("ngIf",e.selectedAsignacion.es_activa&&e.getDiasRestantes(e.selectedAsignacion.fecha_fin_programada)>0),l(),m("ngIf",e.selectedAsignacion.es_activa&&e.getDiasRestantes(e.selectedAsignacion.fecha_fin_programada)===0),l(),m("ngIf",!e.selectedAsignacion.es_activa)}}function Er(s,t){if(s&1){let e=w();n(0,"div",104)(1,"input",171),_("input",function(o){p(e);let d=c().$implicit,f=c(2);return g(f.actualizarProgreso(d.seguimiento_id,o))}),r()()}if(s&2){let e=c().$implicit;l(),m("value",e.progreso)}}function kr(s,t){s&1&&(n(0,"div",172),a(1," Progreso final "),r())}function Tr(s,t){if(s&1&&(n(0,"div")(1,"strong"),a(2,"Inicio:"),r(),a(3),r()),s&2){let e=c().$implicit,i=c(2);l(3),v(" ",i.formatDate(e.fecha_inicio_real)," ")}}function Pr(s,t){if(s&1&&(n(0,"div")(1,"strong"),a(2,"Fin:"),r(),a(3),r()),s&2){let e=c().$implicit,i=c(2);l(3),v(" ",i.formatDate(e.fecha_fin_real)," ")}}function Ir(s,t){s&1&&(n(0,"div",65),a(1," Sin fechas registradas "),r())}function Or(s,t){if(s&1){let e=w();n(0,"button",173),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.editarNotasIndividuales(o))}),h(),n(1,"svg",73),u(2,"path",174),r()()}}function Vr(s,t){s&1&&(n(0,"span",175),a(1," Solo lectura "),r())}function Fr(s,t){if(s&1&&(n(0,"tr",56)(1,"td",57)(2,"div",60)(3,"div",159)(4,"span",160),a(5),r()(),n(6,"div")(7,"div",58),a(8),r(),n(9,"div",59),a(10),r()()()(),n(11,"td",57)(12,"div",60)(13,"div",161),u(14,"div",162),r(),n(15,"span",58),a(16),r()(),x(17,Er,2,1,"div",163)(18,kr,2,0,"div",164),r(),n(19,"td",57)(20,"span",68),a(21),r()(),n(22,"td",64),x(23,Tr,4,1,"div",165)(24,Pr,4,1,"div",165)(25,Ir,2,0,"div",166),r(),n(26,"td",167)(27,"div",168),a(28),r()(),n(29,"td",70)(30,"div",71),x(31,Or,3,0,"button",169)(32,Vr,2,0,"span",170),r()()()),s&2){let e=t.$implicit,i=c(2);l(5),v(" ",(e.full_name||"U").charAt(0).toUpperCase()," "),l(3),C(e.full_name),l(2),v("@",e.username,""),l(4),X("width",e.progreso,"%"),l(2),v("",e.progreso,"%"),l(),m("ngIf",i.canAssignRoutines()&&(i.selectedAsignacion==null?null:i.selectedAsignacion.es_activa)),l(),m("ngIf",!(i.selectedAsignacion!=null&&i.selectedAsignacion.es_activa)),l(2),m("ngClass",xe(16,Jn,e.estado_individual==="pendiente",e.estado_individual==="en_progreso",e.estado_individual==="completada",e.estado_individual==="cancelada")),l(),v(" ",e.estado_individual," "),l(2),m("ngIf",e.fecha_inicio_real),l(),m("ngIf",e.fecha_fin_real),l(),m("ngIf",!e.fecha_inicio_real&&!e.fecha_fin_real),l(3),v(" ",e.notas_individuales||"-"," "),l(3),m("ngIf",i.canAssignRoutines()&&(i.selectedAsignacion==null?null:i.selectedAsignacion.es_activa)),l(),m("ngIf",!(i.selectedAsignacion!=null&&i.selectedAsignacion.es_activa))}}function Dr(s,t){s&1&&(n(0,"div",176),h(),n(1,"svg",177),u(2,"path",178),r(),y(),n(3,"h3",86),a(4,"Sin seguimiento disponible"),r(),n(5,"p",87),a(6," No se encontraron datos de seguimiento para esta asignaci\xF3n. "),r()())}function Ar(s,t){if(s&1&&(n(0,"div",179)(1,"h4",180),a(2,"Resumen del Progreso"),r(),n(3,"div",181)(4,"div")(5,"div",182),a(6),r(),n(7,"div",139),a(8,"Pendientes"),r()(),n(9,"div")(10,"div",183),a(11),r(),n(12,"div",139),a(13,"En Progreso"),r()(),n(14,"div")(15,"div",184),a(16),r(),n(17,"div",139),a(18,"Completadas"),r()(),n(19,"div")(20,"div",185),a(21),r(),n(22,"div",139),a(23,"Progreso Promedio"),r()()()()),s&2){let e=c(2);l(6),v(" ",e.getEstadisticasProgreso().pendientes," "),l(5),v(" ",e.getEstadisticasProgreso().enProgreso," "),l(5),v(" ",e.getEstadisticasProgreso().completadas," "),l(5),v(" ",e.getEstadisticasProgreso().promedioProgreso,"% ")}}function Rr(s,t){if(s&1){let e=w();n(0,"div",94)(1,"div",95)(2,"div",96),_("click",function(){p(e);let o=c();return g(o.closeVerModal())}),r(),n(3,"span",97),a(4,"\u200B"),r(),n(5,"div",142)(6,"div",99)(7,"div",100)(8,"div",143),h(),n(9,"svg",144),u(10,"path",145),r()(),y(),n(11,"div",103)(12,"h3",48),a(13),r(),n(14,"div",104)(15,"p",59),a(16," Progreso individual de cada usuario asignado "),x(17,wr,2,0,"span",146),r()()()()(),n(18,"div",147)(19,"div",148)(20,"div",149)(21,"div")(22,"span",150),a(23,"Per\xEDodo:"),r(),n(24,"div",151),a(25),r(),x(26,Mr,4,3,"div",66),r(),n(27,"div")(28,"span",150),a(29,"Total usuarios:"),r(),n(30,"div",151),a(31),r()(),n(32,"div")(33,"span",150),a(34,"Asignado por:"),r(),n(35,"div",151),a(36),r()()()(),n(37,"div",49)(38,"table",50)(39,"thead",51)(40,"tr")(41,"th",52),a(42," Usuario "),r(),n(43,"th",52),a(44," Progreso "),r(),n(45,"th",52),a(46," Estado "),r(),n(47,"th",52),a(48," Fechas Reales "),r(),n(49,"th",52),a(50," Notas "),r(),n(51,"th",52),a(52," Acciones "),r()()(),n(53,"tbody",53),x(54,Fr,33,21,"tr",152),r()(),x(55,Dr,7,0,"div",153),r(),x(56,Ar,24,4,"div",154),r(),n(57,"div",126)(58,"button",155),_("click",function(){p(e);let o=c();return g(o.closeVerModal())}),a(59," Cerrar "),r()()()()()}if(s&2){let e=c();l(13),v(" Seguimiento: ",e.selectedAsignacion==null?null:e.selectedAsignacion.rutina_nombre," "),l(4),m("ngIf",e.selectedAsignacion&&!e.selectedAsignacion.es_activa),l(2),F("bg-red-50",e.selectedAsignacion&&!e.selectedAsignacion.es_activa),l(6),N(" ",e.formatDate((e.selectedAsignacion==null?null:e.selectedAsignacion.fecha_inicio_programada)||"")," - ",e.formatDate((e.selectedAsignacion==null?null:e.selectedAsignacion.fecha_fin_programada)||"")," "),l(),m("ngIf",e.selectedAsignacion),l(5),C(e.selectedAsignacion==null?null:e.selectedAsignacion.usuarios_count),l(5),C(e.selectedAsignacion==null?null:e.selectedAsignacion.asignado_por_nombre),l(18),m("ngForOf",e.seguimientoDetalle)("ngForTrackBy",e.trackByUserId),l(),m("ngIf",e.seguimientoDetalle.length===0),l(),m("ngIf",e.seguimientoDetalle.length>0)}}function jr(s,t){if(s&1){let e=w();n(0,"button",186),_("click",function(){p(e);let o=c();return g(o.openAsignarModal())}),h(),n(1,"svg",187),u(2,"path",36),r()()}}var nt=class s{constructor(t,e){this.supabaseService=t;this.authService=e}rutinas=[];usuarios=[];asignaciones=[];loading=!1;error="";showAsignarModal=!1;showVerModal=!1;selectedAsignacion=null;seguimientoDetalle=[];asignacionForm={id_rutina:0,usuarios_seleccionados:[],fecha_inicio:"",notas:""};searchTerm="";estadoFilter="all";rutinaFilter="all";mostrarInactivas=!0;ngOnInit(){return b(this,null,function*(){yield this.loadInitialData(),yield this.procesarAsignacionesVencidas()})}loadInitialData(){return b(this,null,function*(){this.loading=!0;try{yield Promise.all([this.loadRutinas(),this.loadUsuarios(),this.loadAsignaciones()])}catch(t){console.error("Error cargando datos iniciales:",t),this.error="Error al cargar los datos"}finally{this.loading=!1}})}loadRutinas(){return b(this,null,function*(){try{let t=yield this.supabaseService.getData("rutinas");this.rutinas=t?.filter(e=>e.status===1)||[]}catch(t){console.error("Error cargando rutinas:",t)}})}loadUsuarios(){return b(this,null,function*(){try{let t=yield this.supabaseService.getData("profiles");this.usuarios=t?.filter(e=>e.status===1)||[]}catch(t){console.error("Error cargando usuarios:",t)}})}loadAsignaciones(){return b(this,null,function*(){try{let t=this.supabaseService.client.from("rutina_asignaciones_masivas").select(`
          id,
          id_rutina,
          usuarios_asignados,
          fecha_inicio,
          fecha_fin,
          estado,
          notas,
          created_at,
          status,
          rutinas(nombre, descripcion),
          profiles!rutina_asignaciones_masivas_asignado_por_fkey(full_name)
        `);this.mostrarInactivas||(t=t.eq("status",1));let{data:e,error:i}=yield t.order("created_at",{ascending:!1});if(i)throw i;this.asignaciones=(e||[]).map(o=>{let d=new Date(o.fecha_fin),f=new Date,S=o.status===1&&d>=f;return{asignacion_id:o.id,rutina_nombre:o.rutinas?.nombre||"Rutina no encontrada",rutina_descripcion:o.rutinas?.descripcion||"",fecha_inicio_programada:o.fecha_inicio,fecha_fin_programada:o.fecha_fin,usuarios_count:o.usuarios_asignados?.length||0,estado_asignacion:o.estado,asignado_por_nombre:o.profiles?.full_name||"Usuario no encontrado",fecha_asignacion:o.created_at,notas_asignacion:o.notas,status:o.status,es_activa:S}})}catch(t){console.error("Error cargando asignaciones:",t),yield this.loadAsignacionesAlternativo()}})}loadAsignacionesAlternativo(){return b(this,null,function*(){try{let[t,e,i]=yield Promise.all([this.supabaseService.getData("rutina_asignaciones_masivas"),this.supabaseService.getData("rutinas"),this.supabaseService.getData("profiles")]),o=t||[];this.mostrarInactivas||(o=o.filter(d=>d.status===1)),this.asignaciones=o.map(d=>{let f=e?.find(I=>I.id===d.id_rutina),S=i?.find(I=>I.id===d.asignado_por),P=new Date(d.fecha_fin),M=new Date,U=d.status===1&&P>=M;return{asignacion_id:d.id,rutina_nombre:f?.nombre||"Rutina no encontrada",rutina_descripcion:f?.descripcion||"",fecha_inicio_programada:d.fecha_inicio,fecha_fin_programada:d.fecha_fin,usuarios_count:d.usuarios_asignados?.length||0,estado_asignacion:d.estado,asignado_por_nombre:S?.full_name||"Usuario no encontrado",fecha_asignacion:d.created_at,notas_asignacion:d.notas,status:d.status,es_activa:U}})}catch(t){console.error("Error en m\xE9todo alternativo:",t),this.asignaciones=[]}})}procesarAsignacionesVencidas(){return b(this,null,function*(){try{let e=new Date().toISOString().split("T")[0],{data:i,error:o}=yield this.supabaseService.client.from("rutina_asignaciones_masivas").select("id").eq("status",1).lt("fecha_fin",e);if(o){console.error("Error buscando asignaciones vencidas:",o);return}if(i&&i.length>0){let d=i.map(S=>S.id),{error:f}=yield this.supabaseService.client.from("rutina_asignaciones_masivas").update({status:0,estado:"expirada",updated_at:new Date().toISOString()}).in("id",d);f?console.error("Error actualizando asignaciones vencidas:",f):console.log(`${d.length} asignaciones marcadas como vencidas`)}}catch(t){console.error("Error procesando asignaciones vencidas:",t)}})}openAsignarModal(){this.asignacionForm={id_rutina:0,usuarios_seleccionados:[],fecha_inicio:this.getTomorrowDate(),notas:""},this.error="",this.showAsignarModal=!0}closeAsignarModal(){this.showAsignarModal=!1,this.error=""}openVerModal(t){return b(this,null,function*(){this.selectedAsignacion=t,yield this.loadSeguimientoDetalle(t.asignacion_id),this.showVerModal=!0})}closeVerModal(){this.showVerModal=!1,this.selectedAsignacion=null,this.seguimientoDetalle=[]}loadSeguimientoDetalle(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.client.from("v_rutinas_asignadas_usuarios").select("*").eq("asignacion_id",t).order("full_name");if(!i&&e){this.seguimientoDetalle=e;return}let{data:o,error:d}=yield this.supabaseService.client.from("rutina_seguimiento_individual").select(`
          id,
          id_asignacion_masiva,
          id_profile,
          progreso,
          estado_individual,
          fecha_inicio_real,
          fecha_fin_real,
          notas_individuales,
          profiles(username, full_name)
        `).eq("id_asignacion_masiva",t);if(d)throw d;this.seguimientoDetalle=(o||[]).map(f=>({seguimiento_id:f.id,asignacion_id:f.id_asignacion_masiva,id_profile:f.id_profile,username:f.profiles?.username||"N/A",full_name:f.profiles?.full_name||"Usuario no encontrado",progreso:f.progreso,estado_individual:f.estado_individual,fecha_inicio_real:f.fecha_inicio_real,fecha_fin_real:f.fecha_fin_real,notas_individuales:f.notas_individuales}))}catch(e){console.error("Error cargando seguimiento detalle:",e),this.seguimientoDetalle=[]}})}toggleUsuario(t){let e=this.asignacionForm.usuarios_seleccionados.indexOf(t);e>-1?this.asignacionForm.usuarios_seleccionados.splice(e,1):this.asignacionForm.usuarios_seleccionados.push(t)}isUsuarioSelected(t){return this.asignacionForm.usuarios_seleccionados.includes(t)}selectAllUsuarios(){this.asignacionForm.usuarios_seleccionados=this.usuarios.map(t=>t.id)}clearAllUsuarios(){this.asignacionForm.usuarios_seleccionados=[]}calcularFechaFin(t){if(!t)return"";let e=new Date(t);return e.setMonth(e.getMonth()+1),e.toISOString().split("T")[0]}asignarRutina(){return b(this,null,function*(){try{if(this.error="",!this.asignacionForm.id_rutina){this.error="Debe seleccionar una rutina";return}if(this.asignacionForm.usuarios_seleccionados.length===0){this.error="Debe seleccionar al menos un usuario";return}if(!this.asignacionForm.fecha_inicio){this.error="Debe especificar la fecha de inicio";return}this.loading=!0;let t=this.authService.getCurrentUser();if(!t?.id)throw new Error("Usuario no autenticado");let e=this.calcularFechaFin(this.asignacionForm.fecha_inicio),i;try{let{data:o,error:d}=yield this.supabaseService.client.rpc("asignar_rutina_a_usuarios",{p_id_rutina:this.asignacionForm.id_rutina,p_usuarios_ids:this.asignacionForm.usuarios_seleccionados,p_asignado_por:t.id,p_fecha_inicio:this.asignacionForm.fecha_inicio,p_fecha_fin:e,p_notas:this.asignacionForm.notas||null});if(d)throw d;i=o}catch{console.log("Funci\xF3n RPC no disponible, usando m\xE9todo manual");let d={id_rutina:this.asignacionForm.id_rutina,usuarios_asignados:this.asignacionForm.usuarios_seleccionados,asignado_por:t.id,fecha_inicio:this.asignacionForm.fecha_inicio,fecha_fin:e,notas:this.asignacionForm.notas||null,estado:"activa"},{data:f,error:S}=yield this.supabaseService.client.from("rutina_asignaciones_masivas").insert(d).select().single();if(S)throw S;i=f.id;let P=this.asignacionForm.usuarios_seleccionados.map(U=>({id_asignacion_masiva:i,id_profile:U,id_rutina:this.asignacionForm.id_rutina,progreso:0,estado_individual:"pendiente"})),{error:M}=yield this.supabaseService.client.from("rutina_seguimiento_individual").insert(P);if(M)throw M}console.log("Rutina asignada exitosamente, ID:",i),yield this.loadAsignaciones(),this.closeAsignarModal(),alert(`Rutina asignada exitosamente a ${this.asignacionForm.usuarios_seleccionados.length} usuarios por 1 mes`)}catch(t){console.error("Error asignando rutina:",t),this.error=t instanceof Error?t.message:"Error al asignar la rutina"}finally{this.loading=!1}})}cancelarAsignacion(t){return b(this,null,function*(){if(confirm("\xBFEst\xE1 seguro de cancelar esta asignaci\xF3n? Esta acci\xF3n afectar\xE1 a todos los usuarios asignados."))try{let{error:i}=yield this.supabaseService.client.from("rutina_asignaciones_masivas").update({estado:"cancelada",status:0,updated_at:new Date().toISOString()}).eq("id",t);if(i)throw i;yield this.loadAsignaciones(),alert("Asignaci\xF3n cancelada exitosamente")}catch(i){console.error("Error cancelando asignaci\xF3n:",i),alert("Error al cancelar la asignaci\xF3n")}})}actualizarProgreso(t,e){return b(this,null,function*(){try{let i=parseInt(e.target?.value||e)||0;if(i<0||i>100){alert("El progreso debe estar entre 0 y 100");return}let o={progreso:i,updated_at:new Date().toISOString()};if(i===0)o.estado_individual="pendiente";else if(i<100){o.estado_individual="en_progreso";let f=this.seguimientoDetalle.find(S=>S.seguimiento_id===t);f&&!f.fecha_inicio_real&&(o.fecha_inicio_real=new Date().toISOString().split("T")[0])}else o.estado_individual="completada",o.fecha_fin_real=new Date().toISOString().split("T")[0];let{error:d}=yield this.supabaseService.client.from("rutina_seguimiento_individual").update(o).eq("id",t);if(d)throw d;this.selectedAsignacion&&(yield this.loadSeguimientoDetalle(this.selectedAsignacion.asignacion_id))}catch(i){console.error("Error actualizando progreso:",i),alert("Error al actualizar el progreso")}})}editarNotasIndividuales(t){return b(this,null,function*(){let e=prompt("Ingrese las notas para este usuario:",t.notas_individuales||"");if(e!==null)try{let{error:i}=yield this.supabaseService.client.from("rutina_seguimiento_individual").update({notas_individuales:e,updated_at:new Date().toISOString()}).eq("id",t.seguimiento_id);if(i)throw i;this.selectedAsignacion&&(yield this.loadSeguimientoDetalle(this.selectedAsignacion.asignacion_id))}catch(i){console.error("Error actualizando notas:",i),alert("Error al actualizar las notas")}})}getEstadisticasProgreso(){if(!this.seguimientoDetalle||this.seguimientoDetalle.length===0)return{pendientes:0,enProgreso:0,completadas:0,promedioProgreso:0};let t=this.seguimientoDetalle.filter(f=>f.estado_individual==="pendiente").length,e=this.seguimientoDetalle.filter(f=>f.estado_individual==="en_progreso").length,i=this.seguimientoDetalle.filter(f=>f.estado_individual==="completada").length,o=this.seguimientoDetalle.reduce((f,S)=>f+(S.progreso||0),0),d=Math.round(o/this.seguimientoDetalle.length);return{pendientes:t,enProgreso:e,completadas:i,promedioProgreso:d}}toggleMostrarInactivas(){return b(this,null,function*(){this.mostrarInactivas=!this.mostrarInactivas,yield this.loadAsignaciones()})}getRutinaNombre(t){return this.rutinas.find(i=>i.id===t)?.nombre||"Rutina no encontrada"}getUserName(t){let e=this.usuarios.find(i=>i.id===t);return e?.full_name||e?.username||"Usuario no encontrado"}getEstadoColor(t,e=!0){if(!e)return"gray";switch(t){case"activa":return"green";case"completada":return"blue";case"pausada":return"yellow";case"cancelada":case"expirada":return"red";default:return"gray"}}getEstadoIcon(t){switch(t){case"activa":return"fas fa-play-circle";case"completada":return"fas fa-check-circle";case"pausada":return"fas fa-pause-circle";case"cancelada":return"fas fa-times-circle";case"expirada":return"fas fa-clock";default:return"fas fa-circle"}}formatDate(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}getTomorrowDate(){let t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}getDiasRestantes(t){let e=new Date(t),i=new Date,o=e.getTime()-i.getTime();return Math.ceil(o/(1e3*60*60*24))}isVencida(t){return this.getDiasRestantes(t)<0}get filteredAsignaciones(){let t=[...this.asignaciones];if(this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.rutina_nombre.toLowerCase().includes(e)||i.asignado_por_nombre.toLowerCase().includes(e))}return this.estadoFilter!=="all"&&(t=t.filter(e=>e.estado_asignacion===this.estadoFilter)),this.rutinaFilter!=="all"&&(t=t.filter(e=>e.rutina_nombre===this.rutinaFilter)),t}clearFilters(){this.searchTerm="",this.estadoFilter="all",this.rutinaFilter="all"}refreshData(){return b(this,null,function*(){yield this.procesarAsignacionesVencidas(),yield this.loadAsignaciones()})}canAssignRoutines(){return this.authService.isAdmin()||this.authService.hasProfile(3)}trackByAsignacionId(t,e){return e.asignacion_id}trackByUserId(t,e){return e.id}trackByRutinaId(t,e){return e.id}static \u0275fac=function(e){return new(e||s)(O(Q),O(L))};static \u0275cmp=D({type:s,selectors:[["app-rutinas-usuario"]],standalone:!1,decls:57,vars:16,consts:[["filtrosAplicados",""],["pluralUsuarios",""],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["class","inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"md:col-span-2"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Buscar por rutina o asignador...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["value","all"],["value","activa"],["value","completada"],["value","pausada"],["value","cancelada"],["value","expirada"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-red-600","hover:text-red-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","bg-white shadow overflow-hidden sm:rounded-md",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],["class","md:hidden fixed bottom-6 right-6 w-14 h-14 bg-red-600 text-white rounded-full shadow-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 z-40","title","Asignar rutina",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[3,"value"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-red-600"],[1,"bg-white","shadow","overflow-hidden","sm:rounded-md"],[1,"px-4","py-5","sm:px-6","border-b","border-gray-200"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50",3,"opacity-50","bg-gray-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-12",4,"ngIf"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","text-gray-400","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"text-sm","text-gray-500","ml-1"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"text-gray-500"],["class","text-xs mt-1",4,"ngIf"],["class","text-xs text-red-500 mt-1",4,"ngIf"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","justify-end","space-x-2"],["title","Ver seguimiento",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["class","text-red-600 hover:text-red-900 p-2 rounded-full hover:bg-red-50","title","Cancelar asignaci\xF3n",3,"click",4,"ngIf"],[1,"text-xs","mt-1"],["class","text-green-600",4,"ngIf"],["class","text-yellow-600",4,"ngIf"],[1,"text-green-600"],[1,"text-yellow-600"],[1,"text-xs","text-red-500","mt-1"],["title","Cancelar asignaci\xF3n",1,"text-red-600","hover:text-red-900","p-2","rounded-full","hover:bg-red-50",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[4,"ngIf","ngIfElse"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-4xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"mt-2"],[1,"bg-white","px-4","pb-4","sm:px-6","max-h-96","overflow-y-auto"],[1,"space-y-6"],[1,"text-red-500"],["name","rutina",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["value","0"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["type","date","name","fechaInicio",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"flex","items-center","h-10","px-3","py-2","border","border-gray-200","rounded-md","bg-gray-50"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","text-gray-400","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-gray-600","font-medium"],["class","bg-blue-50 border border-blue-200 rounded-md p-3",4,"ngIf"],["name","notas","rows","3","placeholder","Notas adicionales sobre la asignaci\xF3n...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"flex","justify-between","items-center","mb-3"],[1,"block","text-sm","font-medium","text-gray-700"],["type","button",1,"text-xs","text-red-600","hover:text-red-800",3,"click"],["type","button",1,"text-xs","text-gray-600","hover:text-gray-800",3,"click"],[1,"border","border-gray-300","rounded-md","p-3","max-h-48","overflow-y-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-2"],["class","flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer",3,"bg-red-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","mt-4 bg-red-50 border border-red-200 rounded-md p-3",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","animate-spin -ml-1 mr-3 h-5 w-5 text-white","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:mt-0","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50",3,"click","disabled"],[1,"bg-blue-50","border","border-blue-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-blue-400","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm"],[1,"font-medium","text-blue-800"],[1,"text-blue-700","ml-1"],[1,"flex","items-center","p-2","hover:bg-gray-50","rounded","cursor-pointer"],["type","checkbox",1,"h-4","w-4","text-red-600","focus:ring-red-500","border-gray-300","rounded",3,"change","checked"],[1,"ml-3","flex-1"],[1,"text-xs","text-gray-500"],[1,"mt-4","bg-red-50","border","border-red-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-6xl","sm:w-full"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],["class","text-red-500 font-medium ml-2",4,"ngIf"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900"],["class","hover:bg-gray-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-8",4,"ngIf"],["class","mt-6 bg-gray-50 rounded-lg p-4",4,"ngIf"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"text-red-500","font-medium","ml-2"],["class","text-red-600",4,"ngIf"],[1,"text-red-600"],[1,"h-8","w-8","bg-gray-300","rounded-full","flex","items-center","justify-center","mr-3"],[1,"text-xs","font-medium","text-gray-700"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-3"],[1,"bg-blue-600","h-2","rounded-full"],["class","mt-2",4,"ngIf"],["class","mt-2 text-xs text-gray-500",4,"ngIf"],[4,"ngIf"],["class","text-gray-500",4,"ngIf"],[1,"px-6","py-4"],[1,"text-sm","text-gray-900","max-w-xs"],["class","text-indigo-600 hover:text-indigo-900 p-1 rounded hover:bg-indigo-50","title","Editar notas",3,"click",4,"ngIf"],["class","text-xs text-gray-400 px-2 py-1",4,"ngIf"],["type","range","min","0","max","100",1,"w-full","h-2","bg-gray-200","rounded-lg","appearance-none","cursor-pointer","slider",3,"input","value"],[1,"mt-2","text-xs","text-gray-500"],["title","Editar notas",1,"text-indigo-600","hover:text-indigo-900","p-1","rounded","hover:bg-indigo-50",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"text-xs","text-gray-400","px-2","py-1"],[1,"text-center","py-8"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-8","w-8","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"mt-6","bg-gray-50","rounded-lg","p-4"],[1,"text-sm","font-medium","text-gray-900","mb-3"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4","text-center"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-2xl","font-bold","text-yellow-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-2xl","font-bold","text-blue-600"],["title","Asignar rutina",1,"md:hidden","fixed","bottom-6","right-6","w-14","h-14","bg-red-600","text-white","rounded-full","shadow-lg","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-500","focus:ring-offset-2","transition-all","duration-200","z-40",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","mx-auto"]],template:function(e,i){e&1&&(n(0,"div",2)(1,"div",3)(2,"div",4)(3,"div")(4,"h1",5),a(5,"Asignaci\xF3n de Rutinas a Usuarios"),r(),n(6,"p",6),a(7),r()(),n(8,"div",7)(9,"button",8),_("click",function(){return i.toggleMostrarInactivas()}),h(),n(10,"svg",9),u(11,"path",10)(12,"path",11),r(),a(13),r(),y(),n(14,"button",8),_("click",function(){return i.refreshData()}),h(),n(15,"svg",9),u(16,"path",12),r(),a(17," Refrescar "),r(),x(18,Zn,4,0,"button",13),r()()(),y(),n(19,"div",14)(20,"div",15)(21,"div",16)(22,"label",17),a(23,"Buscar"),r(),n(24,"input",18),T("ngModelChange",function(d){return k(i.searchTerm,d)||(i.searchTerm=d),d}),r()(),n(25,"div")(26,"label",17),a(27,"Estado"),r(),n(28,"select",19),T("ngModelChange",function(d){return k(i.estadoFilter,d)||(i.estadoFilter=d),d}),n(29,"option",20),a(30,"Todos los estados"),r(),n(31,"option",21),a(32,"Activa"),r(),n(33,"option",22),a(34,"Completada"),r(),n(35,"option",23),a(36,"Pausada"),r(),n(37,"option",24),a(38,"Cancelada"),r(),n(39,"option",25),a(40,"Expirada"),r()()(),n(41,"div")(42,"label",17),a(43,"Rutina"),r(),n(44,"select",19),T("ngModelChange",function(d){return k(i.rutinaFilter,d)||(i.rutinaFilter=d),d}),n(45,"option",20),a(46,"Todas las rutinas"),r(),x(47,Xn,2,2,"option",26),r()()(),n(48,"div",27)(49,"button",28),_("click",function(){return i.clearFilters()}),a(50," Limpiar filtros "),r()()(),x(51,Kn,7,1,"div",29)(52,er,2,0,"div",30)(53,ur,23,4,"div",31),r(),x(54,br,75,15,"div",32)(55,Rr,60,13,"div",32)(56,jr,3,0,"button",33)),e&2&&(l(7),v(" Gestiona las asignaciones masivas de rutinas (duraci\xF3n: 1 mes) - Total: ",i.asignaciones.length," "),l(2),F("bg-gray-200",i.mostrarInactivas),l(4),v(" ",i.mostrarInactivas?"Ocultar":"Mostrar"," vencidas "),l(5),m("ngIf",i.canAssignRoutines()),l(6),E("ngModel",i.searchTerm),l(4),E("ngModel",i.estadoFilter),l(16),E("ngModel",i.rutinaFilter),l(3),m("ngForOf",i.rutinas)("ngForTrackBy",i.trackByRutinaId),l(4),m("ngIf",i.error&&!i.showAsignarModal&&!i.showVerModal),l(),m("ngIf",i.loading&&!i.showAsignarModal&&!i.showVerModal),l(),m("ngIf",!i.loading),l(),m("ngIf",i.showAsignarModal),l(),m("ngIf",i.showVerModal),l(),m("ngIf",!i.showAsignarModal&&!i.showVerModal&&i.canAssignRoutines()))},dependencies:[$,z,R,te,ne,re,W,ie,G,ee,H,se],styles:['.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.modal-panel[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .3s ease-out}.asignacion-card[_ngcontent-%COMP%]{transition:all .3s ease}.asignacion-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000001a}.checkbox-usuario[_ngcontent-%COMP%]{transition:all .2s ease}.checkbox-usuario[_ngcontent-%COMP%]:checked{transform:scale(1.1)}.progress-bar[_ngcontent-%COMP%]{transition:width .8s ease-in-out;background:linear-gradient(90deg,#ef4444,#dc2626)}.progress-container[_ngcontent-%COMP%]{background-color:#f3f4f6;border-radius:9999px;overflow:hidden}.estado-activa[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);color:#fff}.estado-completada[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff}.estado-pausada[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b,#d97706);color:#fff}.estado-cancelada[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff}.btn-action[_ngcontent-%COMP%]{transition:all .2s ease}.btn-action[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}.estado-badge[_ngcontent-%COMP%]{position:relative;overflow:hidden}.estado-badge[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.estado-badge[_ngcontent-%COMP%]:hover:before{left:100%}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@media (max-width: 768px){.tabla-responsive[_ngcontent-%COMP%]{display:block;overflow-x:auto;white-space:nowrap}.tabla-responsive[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{min-width:600px}}.input-focus[_ngcontent-%COMP%]:focus{outline:none;ring:2px;ring-color:#ef4444;border-color:#ef4444;box-shadow:0 0 0 3px #ef44441a}.usuario-seleccionado[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef2f2,#fee2e2);border:2px solid #ef4444;transform:scale(1.02)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideInDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.tooltip[_ngcontent-%COMP%]{position:relative}.tooltip[_ngcontent-%COMP%]:hover:after{content:attr(data-tooltip);position:absolute;bottom:100%;left:50%;transform:translate(-50%);background:#1f2937;color:#fff;padding:4px 8px;border-radius:4px;font-size:12px;white-space:nowrap;z-index:1000}.seguimiento-table[_ngcontent-%COMP%]{border-collapse:separate;border-spacing:0}.seguimiento-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .seguimiento-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb}.seguimiento-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.progress-input[_ngcontent-%COMP%]{transition:all .2s ease}.progress-input[_ngcontent-%COMP%]:focus{border-color:#ef4444;box-shadow:0 0 0 3px #ef44441a}.tiempo-vigente[_ngcontent-%COMP%]{color:#059669;font-weight:600}.tiempo-vencido[_ngcontent-%COMP%]{color:#dc2626;font-weight:600}.tiempo-pendiente[_ngcontent-%COMP%]{color:#d97706;font-weight:600}.stat-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8fafc);border:1px solid #e2e8f0;transition:all .3s ease}.stat-card[_ngcontent-%COMP%]:hover{border-color:#ef4444;box-shadow:0 8px 25px #ef44441a}@media (max-width: 640px){.modal-panel[_ngcontent-%COMP%]{margin:0;max-height:100vh;border-radius:0}.grid-responsive[_ngcontent-%COMP%]{grid-template-columns:1fr}.flex-responsive[_ngcontent-%COMP%]{flex-direction:column;gap:8px}}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-out}.slide-in-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .5s ease-out}.slide-in-down[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInDown .5s ease-out}.loading-skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}']})};var rt=class s{constructor(t,e){this.supabaseService=t;this.authService=e}getRutinasUsuarioSimple(){return b(this,null,function*(){try{let t=this.authService.getCurrentUser();if(!t?.id)throw new Error("Usuario no autenticado");let{data:e,error:i}=yield this.supabaseService.client.from("rutina_seguimiento_individual").select(`
          id,
          id_asignacion_masiva,
          id_profile,
          id_rutina,
          progreso,
          estado_individual,
          fecha_inicio_real,
          fecha_fin_real,
          notas_individuales,
          rutina_asignaciones_masivas!inner(
            fecha_inicio,
            fecha_fin,
            estado,
            notas,
            status
          ),
          rutinas!inner(
            id,
            nombre,
            descripcion,
            tipo,
            nivel,
            duracion_estimada,
            warm_up,
            met_con,
            strength,
            core,
            extra,
            tags,
            status
          )
        `).eq("id_profile",t.id).eq("rutina_asignaciones_masivas.status",1).eq("rutinas.status",1).order("id",{ascending:!1});if(i)throw i;return e||[]}catch(t){return console.error("Error obteniendo rutinas del usuario:",t),[]}})}actualizarProgresoSimple(t,e){return b(this,null,function*(){try{let i={progreso:e,updated_at:new Date().toISOString()};if(e===0)i.estado_individual="pendiente";else if(e<100){i.estado_individual="en_progreso";let{data:d}=yield this.supabaseService.client.from("rutina_seguimiento_individual").select("fecha_inicio_real").eq("id",t).single();d&&!d.fecha_inicio_real&&(i.fecha_inicio_real=new Date().toISOString().split("T")[0])}else i.estado_individual="completada",i.fecha_fin_real=new Date().toISOString().split("T")[0];let{error:o}=yield this.supabaseService.client.from("rutina_seguimiento_individual").update(i).eq("id",t);if(o)throw o;return!0}catch(i){return console.error("Error actualizando progreso:",i),!1}})}calcularEstadoTemporal(t,e){let i=new Date,o=new Date(t),d=new Date(e),f;i<o?f="pendiente":i>d?f="vencida":f="vigente";let S=Math.ceil((d.getTime()-i.getTime())/(1e3*3600*24));return{estado:f,diasRestantes:S}}static \u0275fac=function(e){return new(e||s)(Ce(Q),Ce(L))};static \u0275prov=Ve({token:s,factory:s.\u0275fac,providedIn:"root"})};function Lr(s,t){if(s&1&&(n(0,"div",29),a(1),r()),s&2){let e=t.$implicit;l(),v(" ",e," ")}}function Nr(s,t){s&1&&u(0,"div",37)}function zr(s,t){if(s&1){let e=w();n(0,"div",38),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.onClickRutina(o))}),n(1,"div",3)(2,"span",39),a(3),r(),u(4,"div",40),r(),n(5,"div",41)(6,"span",42),a(7),r()()()}if(s&2){let e=t.$implicit,i=c(2);m("ngClass",i.getColorByTipo(e.tipoEvento))("title",e.seguimiento.rutina_nombre+" - "+e.tipoEvento),l(3),v(" ",e.seguimiento.rutina_nombre," "),l(),m("ngClass",i.getColorByEstado(e.seguimiento.estado_temporal)),l(3),v(" \u{1F4C5} Inicia hoy (",e.seguimiento.progreso,"%) ")}}function Br(s,t){if(s&1&&(n(0,"div",43),a(1),r()),s&2){let e=c().$implicit;l(),v(" +",e.rutinas.length-3," m\xE1s ")}}function $r(s,t){if(s&1&&(n(0,"div",30)(1,"div",31)(2,"span",32),a(3),r(),x(4,Nr,1,0,"div",33),r(),n(5,"div",34),x(6,zr,8,5,"div",35),r(),x(7,Br,2,1,"div",36),r()),s&2){let e=t.$implicit,i=c();F("bg-gray-50",!e.esMesActual)("bg-blue-50",i.esHoy(e.fecha)),l(2),F("text-gray-400",!e.esMesActual)("text-gray-900",e.esMesActual&&!i.esHoy(e.fecha))("text-blue-600",i.esHoy(e.fecha))("font-bold",i.esHoy(e.fecha)),l(),v(" ",e.fecha.getDate()," "),l(),m("ngIf",i.esHoy(e.fecha)),l(2),m("ngForOf",e.rutinas)("ngForTrackBy",i.trackByRutina),l(),m("ngIf",e.rutinas.length>3)}}function Wr(s,t){s&1&&(n(0,"div",44),h(),n(1,"svg",45),u(2,"path",46),r(),y(),n(3,"h3",47),a(4,"No hay rutinas para mostrar"),r(),n(5,"p",48),a(6," No tienes rutinas asignadas para mostrar en el calendario. "),r()())}function Gr(s,t){s&1&&(n(0,"div",87)(1,"div",88),h(),n(2,"svg",89),u(3,"path",90),r(),y(),n(4,"div",91)(5,"p",92),a(6,"\xA1Rutina copiada al portapapeles!"),r()()()())}function Hr(s,t){if(s&1){let e=w();n(0,"button",93),_("click",function(){p(e);let o=c(2);return g(o.exportarRutina(o.selectedRutina,o.selectedSeguimiento||void 0))}),h(),n(1,"svg",5),u(2,"path",94),r(),a(3," Descargar "),r()}}function qr(s,t){if(s&1){let e=w();n(0,"div",49)(1,"div",50)(2,"div",51),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),r(),n(3,"span",52),a(4,"\u200B"),r(),n(5,"div",53)(6,"div",54)(7,"div",55)(8,"div",56),h(),n(9,"svg",57),u(10,"path",46),r()(),y(),n(11,"div",58)(12,"h3",59),a(13),r(),n(14,"div",60)(15,"p",61),a(16),r()()()()(),n(17,"div",62)(18,"div",63)(19,"div",64)(20,"div")(21,"span",65),a(22,"Mi Progreso:"),r(),n(23,"div",66)(24,"div",67),u(25,"div",68),r(),a(26),r()(),n(27,"div")(28,"span",65),a(29,"Estado:"),r(),n(30,"div",69),a(31),r()(),n(32,"div")(33,"span",65),a(34,"Per\xEDodo:"),r(),n(35,"div",69),a(36),r()(),n(37,"div")(38,"span",65),a(39,"D\xEDas restantes:"),r(),n(40,"div",69),a(41),r()()()(),n(42,"div",70)(43,"div",71),u(44,"img",72),r(),n(45,"div",73)(46,"div",74),u(47,"div",75)(48,"div",76)(49,"div",77),r(),n(50,"div",78),a(51),r()(),n(52,"pre",79),a(53),r()(),x(54,Gr,7,0,"div",80),n(55,"div",81)(56,"button",82),_("click",function(){p(e);let o=c();return g(o.copyToClipboard(o.getFormattedRutina(o.selectedRutina,o.selectedSeguimiento||void 0)))}),h(),n(57,"svg",5),u(58,"path",83),r(),a(59," Copiar "),r(),x(60,Hr,4,0,"button",84),r()(),y(),n(61,"div",85)(62,"button",86),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),a(63," Cerrar "),r()()()()()}if(s&2){let e=c();l(13),v(" ",e.selectedRutina==null?null:e.selectedRutina.nombre," "),l(3),v(" Rutina desde calendario - Progreso: ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(9),X("width",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"%"),l(),v(" ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(5),C(e.selectedSeguimiento==null?null:e.selectedSeguimiento.estado_individual),l(5),N(" ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_inicio_programada)," - ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_fin_programada)," "),l(4),F("text-green-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>7)("text-yellow-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=7&&((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0)("text-red-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=0),l(),v(" ",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0?e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes:"Vencida"," "),l(10),v(" ",e.getFileName()," "),l(2),C(e.getFormattedRutina(e.selectedRutina,e.selectedSeguimiento||void 0)),l(),m("ngIf",e.copySuccess),l(6),m("ngIf",e.selectedRutina)}}var ot=class s{rutinas=[];volverAVista=new Fe;abrirRutina=new Fe;fechaActual=new Date;mesActual=new Date;diasCalendario=[];showViewModal=!1;selectedRutina=null;selectedSeguimiento=null;copySuccess=!1;seccionesDisponibles=[{key:"warm_up",nombre:"Warm Up",descripcion:"Calentamiento"},{key:"met_con",nombre:"Met-Con",descripcion:"Metabolic Conditioning"},{key:"strength",nombre:"Strength",descripcion:"Entrenamiento de Fuerza"},{key:"core",nombre:"Core",descripcion:"Trabajo de Core"},{key:"extra",nombre:"Extra",descripcion:"Trabajo Adicional"}];meses=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];diasSemana=["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"];constructor(){}ngOnInit(){this.generarCalendario()}ngOnChanges(){this.generarCalendario()}generarCalendario(){this.diasCalendario=[];let t=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth(),1),e=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()+1,0),i=t.getDay();for(let d=i-1;d>=0;d--){let f=new Date(t);f.setDate(f.getDate()-(d+1)),this.diasCalendario.push({fecha:new Date(f),esMesActual:!1,rutinas:this.getRutinasDelDia(f)})}for(let d=1;d<=e.getDate();d++){let f=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth(),d);this.diasCalendario.push({fecha:new Date(f),esMesActual:!0,rutinas:this.getRutinasDelDia(f)})}let o=42-this.diasCalendario.length;for(let d=1;d<=o;d++){let f=new Date(e);f.setDate(f.getDate()+d),this.diasCalendario.push({fecha:new Date(f),esMesActual:!1,rutinas:this.getRutinasDelDia(f)})}}getRutinasDelDia(t){let e=[],i=this.formatDateForComparison(t);return console.log(`\u{1F5D3}\uFE0F Verificando rutinas para fecha: ${i}`),this.rutinas.forEach(o=>{let d=new Date(o.fecha_inicio_programada),f=this.formatDateForComparison(d);console.log(`   \u{1F50D} Rutina: ${o.rutina_nombre}, Inicio: ${f}, Comparando con: ${i}`),f===i?(console.log(`   \u2705 COINCIDENCIA! Agregando rutina: ${o.rutina_nombre}`),e.push({seguimiento:o,tipoEvento:"inicio",enRango:!0})):console.log("   \u274C No coincide. Saltando rutina.")}),console.log(`\u{1F4CA} Total rutinas para ${i}: ${e.length}`),e}formatDateForComparison(t){let e=t.getFullYear(),i=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0");return`${e}-${i}-${o}`}mesAnterior(){this.mesActual=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()-1,1),this.generarCalendario()}mesSiguiente(){this.mesActual=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()+1,1),this.generarCalendario()}irAHoy(){this.mesActual=new Date,this.generarCalendario()}onVolverAVista(){this.volverAVista.emit()}onClickRutina(t){this.abrirModalRutina(t.seguimiento)}abrirModalRutina(t){this.selectedSeguimiento=t,this.selectedRutina=t.rutina_completa||null,this.showViewModal=!0}closeViewModal(){this.showViewModal=!1,this.selectedRutina=null,this.selectedSeguimiento=null,this.copySuccess=!1}getSeccionData(t,e){return t[e]}getTotalEjercicios(t){let e=0;return this.seccionesDisponibles.forEach(i=>{let o=this.getSeccionData(t,i.key);o&&o.ejercicios&&(e+=o.ejercicios.length)}),e}esHoy(t){let e=new Date;return t.toDateString()===e.toDateString()}getColorByEstado(t){switch(t){case"vigente":return"bg-green-500";case"pendiente":return"bg-blue-500";case"vencida":return"bg-red-500";default:return"bg-gray-500"}}getColorByTipo(t){return"border-green-500 bg-green-100"}formatDate(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"Fecha inv\xE1lida"}}formatDuracion(t){if(!t)return"N/A";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getFileName(){if(!this.selectedRutina||!this.selectedRutina.nombre)return"rutina_calendario_rehabimovement.txt";let t=this.selectedRutina.nombre.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"_").substring(0,30),e=new Date().toISOString().split("T")[0];return`${t}_calendario_${e}_rehabimovement.txt`}getFormattedRutina(t,e){if(console.log("\u{1F3A8} Formateando rutina CALENDARIO con NUEVO FORMATO:",t?.nombre),!t)return"";let i="";i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+`\u{1F3CB}\uFE0F  ${t.nombre.toUpperCase()}`.padEnd(78)+`\u2551
`,i+="\u255A"+"\u2550".repeat(78)+`\u255D
`,i+=`${t.descripcion||"Rutina de entrenamiento completa"}

`;let o=`Nivel: ${t.nivel.toUpperCase()}`,d=`Duraci\xF3n: ${this.formatDuracion(t.duracion_estimada)}`,f=`Tipo: ${t.tipo.toUpperCase()}`;if(i+=`\u{1F3AF} ${o} | \u23F1\uFE0F  ${d} | \u{1F4CB} ${f}

`,e){i+="\u250C"+"\u2500".repeat(78)+`\u2510
`,i+="\u2502"+"\u{1F4CA} MI PROGRESO".padEnd(78)+`\u2502
`,i+="\u2514"+"\u2500".repeat(78)+`\u2518
`;let I=e.progreso||0,B=40,J=Math.round(I/100*B),j=B-J,me="\u2588".repeat(J)+"\u2591".repeat(j);if(i+=`Estado: ${e.estado_individual.toUpperCase()} (${I}%)
`,i+=`Progreso: [${me}] ${I}%
`,i+=`Per\xEDodo: ${this.formatDate(e.fecha_inicio_programada)} \u2192 ${this.formatDate(e.fecha_fin_programada)}
`,e.estado_temporal==="vigente"){let Z=e.dias_restantes>7?"\u{1F7E2}":e.dias_restantes>0?"\u{1F7E1}":"\u{1F534}";i+=`${Z} D\xEDas restantes: ${e.dias_restantes}
`}e.fecha_inicio_real&&(i+=`\u2705 Iniciado: ${this.formatDate(e.fecha_inicio_real)}
`),e.fecha_fin_real&&(i+=`\u{1F389} Completado: ${this.formatDate(e.fecha_fin_real)}
`),i+=`
`}i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+"\u{1F4AA} PLAN DE ENTRENAMIENTO".padEnd(78)+`\u2551
`,i+="\u255A"+"\u2550".repeat(78)+`\u255D

`;let S={warm_up:"\u{1F525}",met_con:"\u{1F4A8}",strength:"\u{1F3CB}\uFE0F",core:"\u{1F3AF}",extra:"\u2728"},P=["warm_up","met_con","strength","core","extra"],M=0;P.forEach((I,B)=>{let J=this.seccionesDisponibles.find(me=>me.key===I),j=this.getSeccionData(t,I);if(j&&j.ejercicios&&j.ejercicios.length>0&&J){M++,console.log(`\u{1F4CB} Procesando secci\xF3n CALENDARIO: ${J.nombre}`);let me=S[I]||"\u{1F4CB}";i+="\u250C"+"\u2500".repeat(76)+`\u2510
`,i+="\u2502 "+`${me} ${J.nombre.toUpperCase()}`.padEnd(75)+`\u2502
`,i+="\u2514"+"\u2500".repeat(76)+`\u2518
`,j.descripcion&&(i+=`\u{1F4DD} ${j.descripcion}
`);let Z=[];j.tiempo_total&&Z.push(`\u23F1\uFE0F  Tiempo: ${j.tiempo_total}`),j.series&&Z.push(`\u{1F504} Series: ${j.series}`),j.time_cap&&Z.push(`\u23F0 Time Cap: ${j.time_cap}`);let we=j;we.rest_between_exercises&&Z.push(`\u23F8\uFE0F  Descanso: ${we.rest_between_exercises}`),we.rest_between_sets&&Z.push(`\u{1F4A4} Descanso series: ${we.rest_between_sets}`),Z.length>0&&(i+=`${Z.join(" | ")}
`),i+="\u2500".repeat(78)+`
`,j.ejercicios.forEach((V,Ae)=>{i+=`${(Ae+1).toString().padStart(2,"0")}. \u{1F539} ${V.nombre||"Ejercicio"}
`;let oe=[];V.repeticiones&&oe.push(`\u{1F522} ${V.repeticiones} reps`),V.series&&oe.push(`\u{1F504} ${V.series} series`),V.peso&&oe.push(`\u2696\uFE0F  ${V.peso}`),V.distancia&&oe.push(`\u{1F4CF} ${V.distancia}`),V.tiempo&&oe.push(`\u23F1\uFE0F  ${V.tiempo}`),V.duracion&&oe.push(`\u23F3 ${V.duracion}`),oe.length>0&&(i+=`    \u2514\u2500 ${oe.join(" \u2022 ")}
`),V.rpe&&(i+=`    \u{1F4AA} RPE: ${V.rpe}/10
`),V.descanso&&(i+=`    \u23F8\uFE0F  Descanso: ${V.descanso}
`),V.observaciones&&(i+=`    \u{1F4DD} ${V.observaciones}
`),V.notas&&(i+=`    \u{1F4A1} ${V.notas}
`),Ae<j.ejercicios.length-1&&(i+=`
`)}),B<P.length-1&&M>0&&(i+=`
`+"\u2550".repeat(78)+`

`)}}),M===0&&(console.log("\u26A0\uFE0F No se encontraron secciones con ejercicios en CALENDARIO"),i+=`\u250C${"\u2500".repeat(76)}\u2510
`,i+=`\u2502 \u2139\uFE0F  RUTINA EN DESARROLLO${" ".repeat(51)}\u2502
`,i+=`\u2514${"\u2500".repeat(76)}\u2518
`,i+=`Esta rutina est\xE1 siendo desarrollada.
`,i+=`Los ejercicios ser\xE1n agregados pr\xF3ximamente.

`),e?.notas_individuales&&(i+="\u250C"+"\u2500".repeat(78)+`\u2510
`,i+="\u2502"+"\u{1F4DD} MIS NOTAS PERSONALES".padEnd(78)+`\u2502
`,i+="\u2514"+"\u2500".repeat(78)+`\u2518
`,i+=`${e.notas_individuales}

`),t.tags&&t.tags.length>0&&(i+=`\u{1F3F7}\uFE0F  Tags: ${t.tags.map(I=>`#${I}`).join(" ")}

`),i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+"\u{1F4F1} rehabiMovement - Sistema de Entrenamiento".padEnd(78)+`\u2551
`,i+="\u2560"+"\u2550".repeat(78)+`\u2563
`;let U=this.getTotalEjercicios(t);return i+="\u2551"+`\u{1F4C8} RESUMEN: ${U} ejercicios total`.padEnd(78)+`\u2551
`,t.duracion_estimada&&(i+="\u2551"+`\u23F1\uFE0F  Duraci\xF3n estimada: ${this.formatDuracion(t.duracion_estimada)}`.padEnd(78)+`\u2551
`),i+="\u2551"+`\u{1F4C5} Generado: ${this.formatDate(new Date().toISOString())}`.padEnd(78)+`\u2551
`,i+="\u2551"+`\u{1F194} ID Rutina: ${t.id||"N/A"}`.padEnd(78)+`\u2551
`,e&&(i+="\u2551"+`\u{1F464} Atleta: ${e.full_name||e.username||"N/A"}`.padEnd(78)+`\u2551
`),i+="\u255A"+"\u2550".repeat(78)+`\u255D
`,console.log("\u2705 Nuevo formato CALENDARIO aplicado exitosamente!"),i}copyToClipboard(t){return b(this,null,function*(){try{yield navigator.clipboard.writeText(t),this.copySuccess=!0,console.log("Texto copiado al portapapeles desde calendario"),setTimeout(()=>{this.copySuccess=!1},2e3)}catch(e){console.error("Error al copiar al portapapeles:",e),this.fallbackCopyTextToClipboard(t)}})}fallbackCopyTextToClipboard(t){let e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")&&(this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3))}catch(i){console.error("Fallback: Error al copiar al portapapeles:",i)}document.body.removeChild(e)}exportarRutina(t,e){if(!t){console.warn("No hay rutina para exportar desde calendario");return}let i=this.getFormattedRutina(t,e);if(!i){console.warn("No se pudo generar el contenido para exportar");return}let o=new Blob([i],{type:"text/plain;charset=utf-8"}),d=window.URL.createObjectURL(o),f=document.createElement("a");f.href=d,f.download=this.getFileName(),f.click(),window.URL.revokeObjectURL(d),console.log("Rutina exportada desde calendario:",t.nombre)}trackByDate(t,e){return e.fecha.getTime()}trackByRutina(t,e){return e.seguimiento.seguimiento_id}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=D({type:s,selectors:[["app-calendario-rutinas"]],inputs:{rutinas:"rutinas"},outputs:{volverAVista:"volverAVista",abrirRutina:"abrirRutina"},standalone:!1,features:[$e],decls:44,vars:7,consts:[[1,"max-w-7xl","mx-auto"],[1,"bg-white","rounded-lg","shadow","mb-6"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"flex","items-center","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"flex","items-center","space-x-4"],[1,"p-2","rounded-full","hover:bg-gray-100","focus:outline-none","focus:ring-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-xl","font-semibold","text-gray-900","min-w-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"inline-flex","items-center","px-3","py-2","border","border-red-300","rounded-md","shadow-sm","text-sm","font-medium","text-red-700","bg-red-50","hover:bg-red-100","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],[1,"px-6","py-3","bg-gray-50"],[1,"flex","flex-wrap","items-center","gap-4","text-sm"],[1,"flex","items-center"],[1,"w-3","h-3","bg-green-500","rounded-full","mr-2"],[1,"text-gray-700"],[1,"w-3","h-3","bg-blue-500","rounded-full","mr-2"],[1,"w-3","h-3","bg-red-500","rounded-full","mr-2"],[1,"w-3","h-3","border-2","border-green-500","bg-green-100","rounded","mr-2"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],[1,"grid","grid-cols-7","gap-0","bg-gray-50","border-b","border-gray-200"],["class","px-4 py-3 text-center text-sm font-medium text-gray-700 border-r border-gray-200 last:border-r-0",4,"ngFor","ngForOf"],[1,"grid","grid-cols-7","gap-0"],["class","min-h-32 border-r border-b border-gray-200 last:border-r-0 p-2 relative",3,"bg-gray-50","bg-blue-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-12",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],[1,"px-4","py-3","text-center","text-sm","font-medium","text-gray-700","border-r","border-gray-200","last:border-r-0"],[1,"min-h-32","border-r","border-b","border-gray-200","last:border-r-0","p-2","relative"],[1,"flex","justify-between","items-start","mb-1"],[1,"text-sm","font-medium"],["class","w-2 h-2 bg-blue-600 rounded-full",4,"ngIf"],[1,"space-y-1"],["class","text-xs p-1 rounded border cursor-pointer hover:shadow-sm transition-all duration-150",3,"ngClass","title","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-xs text-gray-500 mt-1 text-center",4,"ngIf"],[1,"w-2","h-2","bg-blue-600","rounded-full"],[1,"text-xs","p-1","rounded","border","cursor-pointer","hover:shadow-sm","transition-all","duration-150",3,"click","ngClass","title"],[1,"truncate","flex-1","font-medium"],[1,"w-2","h-2","rounded-full","ml-1","flex-shrink-0",3,"ngClass"],[1,"text-gray-600","mt-1"],[1,"text-green-700"],[1,"text-xs","text-gray-500","mt-1","text-center"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3a2 2 0 012-2h8a2 2 0 012 2v4m-4 0V3m-4 4h8m-8 0H6a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-2"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-5xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"text-sm","text-gray-500"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900","flex","items-center"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-2"],[1,"bg-blue-600","h-2","rounded-full"],[1,"text-gray-900"],[1,"bg-gray-900","text-green-400","rounded-lg","p-6","font-mono","text-sm","overflow-auto","max-h-96","relative",2,"font-family","'Courier New', monospace","line-height","1.6"],[1,"absolute","inset-15","flex","items-center","justify-center","pointer-events-none","opacity-25"],["src","/rh.png","alt","RehabiMovement",1,"max-w-50","max-h-50","object-contain","transform","rotate-12","select-none"],[1,"flex","items-center","justify-between","mb-4","pb-2","border-b","border-gray-700","relative","z-10"],[1,"flex","space-x-2"],[1,"w-3","h-3","bg-red-500","rounded-full"],[1,"w-3","h-3","bg-yellow-500","rounded-full"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-gray-400","text-xs"],[1,"whitespace-pre-wrap","text-white","relative","z-10"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],["class","inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",3,"click",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-green-700"],[1,"inline-flex","items-center","px-3","py-2","border","border-transparent","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),_("click",function(){return i.onVolverAVista()}),h(),n(5,"svg",5),u(6,"path",6),r(),a(7," Volver a tarjetas "),r(),y(),n(8,"div",7)(9,"button",8),_("click",function(){return i.mesAnterior()}),h(),n(10,"svg",9),u(11,"path",10),r()(),y(),n(12,"h2",11),a(13),r(),n(14,"button",8),_("click",function(){return i.mesSiguiente()}),h(),n(15,"svg",9),u(16,"path",12),r()()(),y(),n(17,"button",13),_("click",function(){return i.irAHoy()}),a(18," Hoy "),r()()(),n(19,"div",14)(20,"div",15)(21,"div",16),u(22,"div",17),n(23,"span",18),a(24,"Rutinas Vigentes"),r()(),n(25,"div",16),u(26,"div",19),n(27,"span",18),a(28,"Rutinas Pendientes"),r()(),n(29,"div",16),u(30,"div",20),n(31,"span",18),a(32,"Rutinas Vencidas"),r()(),n(33,"div",16),u(34,"div",21),n(35,"span",18),a(36,"D\xEDa de Inicio"),r()()()()(),n(37,"div",22)(38,"div",23),x(39,Lr,2,1,"div",24),r(),n(40,"div",25),x(41,$r,8,17,"div",26),r()(),x(42,Wr,7,0,"div",27),r(),x(43,qr,64,19,"div",28)),e&2&&(l(13),N(" ",i.meses[i.mesActual.getMonth()]," ",i.mesActual.getFullYear()," "),l(26),m("ngForOf",i.diasSemana),l(2),m("ngForOf",i.diasCalendario)("ngForTrackBy",i.trackByDate),l(),m("ngIf",i.rutinas.length===0),l(),m("ngIf",i.showViewModal))},dependencies:[$,z,R],styles:[".calendar-transition[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.calendar-cell[_ngcontent-%COMP%]{min-height:120px;transition:all .2s ease-in-out}.calendar-cell[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.rutina-item[_ngcontent-%COMP%]{transition:all .15s ease-in-out;transform:scale(1)}.rutina-item[_ngcontent-%COMP%]:hover{transform:scale(1.02);box-shadow:0 2px 8px #0000001a}.evento-inicio[_ngcontent-%COMP%]{border-left:4px solid #10b981;background:linear-gradient(90deg,#d1fae5,#ecfdf5)}.evento-fin[_ngcontent-%COMP%]{border-left:4px solid #ef4444;background:linear-gradient(90deg,#fee2e2,#fef2f2)}.evento-progreso[_ngcontent-%COMP%]{border-left:4px solid #3b82f6;background:linear-gradient(90deg,#dbeafe,#eff6ff)}.dia-actual[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border:2px solid #3b82f6}.indicador-hoy[_ngcontent-%COMP%]{background:#3b82f6;box-shadow:0 0 0 2px #bfdbfe;animation:_ngcontent-%COMP%_pulse-blue 2s infinite}@keyframes _ngcontent-%COMP%_pulse-blue{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}.nav-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.nav-button[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;transform:scale(1.05)}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.terminal[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#111827);box-shadow:inset 0 0 20px #00000080,0 0 20px #0000004d}.terminal-header[_ngcontent-%COMP%]{background:linear-gradient(90deg,#374151,#4b5563)}.terminal-button[_ngcontent-%COMP%]{box-shadow:inset 0 1px #fff3,0 1px 2px #00000080}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#1f2937;border-radius:4px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#4b5563;border-radius:4px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6b7280}.watermark[_ngcontent-%COMP%]{opacity:.1;filter:grayscale(100%) brightness(150%);-webkit-user-select:none;user-select:none;pointer-events:none}.rutina-entrada[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInFromLeft .3s ease-out}@keyframes _ngcontent-%COMP%_slideInFromLeft{0%{transform:translate(-10px);opacity:0}to{transform:translate(0);opacity:1}}@media (max-width: 768px){.calendar-cell[_ngcontent-%COMP%]{min-height:100px;font-size:.875rem}.rutina-item[_ngcontent-%COMP%]{padding:.25rem;font-size:.75rem}.nav-button[_ngcontent-%COMP%]{padding:.5rem}}@media (max-width: 640px){.calendar-cell[_ngcontent-%COMP%]{min-height:80px;padding:.25rem}.rutina-item[_ngcontent-%COMP%]{padding:.125rem;font-size:.625rem}}.leyenda-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.25rem .5rem;border-radius:.375rem;transition:background-color .2s ease-in-out}.leyenda-item[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.estado-vigente[_ngcontent-%COMP%]{background-color:#10b981;box-shadow:0 0 8px #10b9814d}.estado-pendiente[_ngcontent-%COMP%]{background-color:#3b82f6;box-shadow:0 0 8px #3b82f64d}.estado-vencida[_ngcontent-%COMP%]{background-color:#ef4444;box-shadow:0 0 8px #ef44444d}.mes-titulo[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.mes-titulo.changing[_ngcontent-%COMP%]{transform:scale(.95);opacity:.7}.loading-calendario[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInOut 1.5s ease-in-out infinite}@keyframes _ngcontent-%COMP%_fadeInOut{0%,to{opacity:.4}50%{opacity:.8}}"]})};var Qr=(s,t,e,i)=>({"bg-gray-100 text-gray-800":s,"bg-yellow-100 text-yellow-800":t,"bg-green-100 text-green-800":e,"bg-red-100 text-red-800":i});function Jr(s,t){if(s&1){let e=w();n(0,"div")(1,"app-calendario-rutinas",17),_("volverAVista",function(){p(e);let o=c();return g(o.onVolverDeCalendario())})("abrirRutina",function(o){p(e);let d=c();return g(d.onAbrirRutinaDesdeCalendario(o))}),r()()}if(s&2){let e=c();l(),m("rutinas",e.filteredRutinas)}}function Zr(s,t){if(s&1&&(n(0,"div",39)(1,"div",40),h(),n(2,"svg",41),u(3,"path",42),r(),y(),n(4,"div",43)(5,"p",44),a(6),r()()()()),s&2){let e=c(2);l(6),C(e.error)}}function Xr(s,t){s&1&&(n(0,"div",45),u(1,"div",46),r())}function Kr(s,t){if(s&1&&(n(0,"span",83),a(1),r()),s&2){let e=t.$implicit;l(),v(" #",e," ")}}function eo(s,t){if(s&1&&(n(0,"div",56)(1,"div",81),x(2,Kr,2,1,"span",82),r()()),s&2){let e=c().$implicit;l(2),m("ngForOf",e.rutina_tags)}}function to(s,t){if(s&1&&(n(0,"div"),a(1),r()),s&2){let e=c(2).$implicit,i=c(3);l(),v(" Iniciado: ",i.formatDate(e.fecha_inicio_real)," ")}}function io(s,t){if(s&1&&(n(0,"div"),a(1),r()),s&2){let e=c(2).$implicit,i=c(3);l(),v(" Completado: ",i.formatDate(e.fecha_fin_real)," ")}}function no(s,t){if(s&1&&(n(0,"div",84),x(1,to,2,1,"div",15)(2,io,2,1,"div",15),r()),s&2){let e=c().$implicit;l(),m("ngIf",e.fecha_inicio_real),l(),m("ngIf",e.fecha_fin_real)}}function ro(s,t){if(s&1&&(n(0,"div",85)(1,"p",86)(2,"strong"),a(3,"Mis notas:"),r(),a(4),r()()),s&2){let e=c().$implicit;l(4),v(" ",e.notas_individuales," ")}}function oo(s,t){if(s&1){let e=w();n(0,"div",49)(1,"div")(2,"div",50)(3,"div",51)(4,"h3",52),a(5),r(),n(6,"p",53),a(7),r()(),n(8,"span",54),a(9),r()()(),n(10,"div",55)(11,"div",56)(12,"div",57)(13,"span",58),a(14,"Mi Progreso"),r(),n(15,"span",59),a(16),r()(),n(17,"div",60),u(18,"div",61),r(),n(19,"div",62)(20,"input",63),_("input",function(o){let d=p(e).$implicit,f=c(3);return g(f.actualizarMiProgreso(d,+o.target.value))}),r()()(),n(21,"div",64)(22,"span",65),a(23),r(),n(24,"span",66),a(25),r()(),n(26,"div",67)(27,"div",68)(28,"span"),a(29,"Inicio:"),r(),n(30,"span"),a(31),r()(),n(32,"div",68)(33,"span"),a(34,"Fin:"),r(),n(35,"span"),a(36),r()(),n(37,"div",69)(38,"span"),a(39,"D\xEDas restantes:"),r(),n(40,"span"),a(41),r()()(),n(42,"div",64)(43,"span",70),a(44),r(),n(45,"span",66),a(46),r()(),x(47,eo,3,1,"div",71)(48,no,3,2,"div",72)(49,ro,5,1,"div",73),n(50,"div",74)(51,"button",75),_("click",function(){let o=p(e).$implicit,d=c(3);return g(d.openViewModal(o))}),h(),n(52,"svg",76),u(53,"path",77)(54,"path",78),r()(),y(),n(55,"button",79),_("click",function(){let o=p(e).$implicit,d=c(3);return g(d.safeExportRutina(o))}),h(),n(56,"svg",76),u(57,"path",80),r()()()()()}if(s&2){let e=t.$implicit,i=c(3);F("border-green-500",e.estado_temporal==="vigente")("border-blue-500",e.estado_temporal==="pendiente")("border-red-500",e.estado_temporal==="vencida"),l(),A("px-6 py-4 "+(e.estado_temporal==="vigente"?"bg-gradient-to-r from-green-500 to-green-600":e.estado_temporal==="pendiente"?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gradient-to-r from-red-500 to-red-600")),l(4),C(e.rutina_nombre),l(2),C(e.rutina_descripcion),l(2),v(" ",e.estado_temporal," "),l(7),v("",e.progreso,"%"),l(2),X("width",e.progreso,"%"),F("bg-gray-400",e.progreso===0)("bg-red-400",e.progreso>0&&e.progreso<30)("bg-yellow-400",e.progreso>=30&&e.progreso<70)("bg-green-400",e.progreso>=70),l(2),m("value",e.progreso),l(2),m("ngClass",xe(40,Qr,e.estado_individual==="pendiente",e.estado_individual==="en_progreso",e.estado_individual==="completada",e.estado_individual==="abandonada")),l(),v(" ",e.estado_individual," "),l(2),C(e.rutina_nivel),l(6),C(i.formatDate(e.fecha_inicio_programada)),l(5),C(i.formatDate(e.fecha_fin_programada)),l(),F("text-green-600",e.dias_restantes>7)("text-yellow-600",e.dias_restantes<=7&&e.dias_restantes>0)("text-red-600",e.dias_restantes<=0),l(4),C(e.dias_restantes>0?e.dias_restantes:"Vencida"),l(3),v(" ",e.rutina_tipo," "),l(2),C(i.formatDuracion(e.rutina_duracion)),l(),m("ngIf",e.rutina_tags&&e.rutina_tags.length>0),l(),m("ngIf",e.fecha_inicio_real||e.fecha_fin_real),l(),m("ngIf",e.notas_individuales)}}function ao(s,t){if(s&1&&(n(0,"div",47),x(1,oo,58,45,"div",48),r()),s&2){let e=c(2);l(),m("ngForOf",e.filteredRutinas)("ngForTrackBy",e.trackByRutinaId)}}function so(s,t){s&1&&(fe(0),a(1," No tienes rutinas asignadas en este momento. "),_e())}function lo(s,t){s&1&&a(0," No se encontraron rutinas con los filtros aplicados. ")}function co(s,t){if(s&1){let e=w();n(0,"button",95),_("click",function(){p(e);let o=c(3);return g(o.clearFilters())}),a(1," Limpiar filtros "),r()}}function mo(s,t){if(s&1&&(n(0,"div",87),h(),n(1,"svg",88),u(2,"path",89),r(),y(),n(3,"h3",90),a(4,"No hay rutinas asignadas"),r(),n(5,"p",91),x(6,so,2,0,"ng-container",92)(7,lo,1,0,"ng-template",null,0,K),r(),n(9,"div",93),x(10,co,2,0,"button",94),r()()),s&2){let e=Y(8),i=c(2);l(6),m("ngIf",i.misRutinas.length===0)("ngIfElse",e),l(4),m("ngIf",i.misRutinas.length>0)}}function uo(s,t){if(s&1){let e=w();n(0,"div")(1,"div",18)(2,"div",19)(3,"div",20)(4,"label",21),a(5,"Buscar"),r(),n(6,"input",22),T("ngModelChange",function(o){p(e);let d=c();return k(d.searchTerm,o)||(d.searchTerm=o),g(o)}),_("input",function(){p(e);let o=c();return g(o.onSearch())}),r()(),n(7,"div")(8,"label",21),a(9,"Per\xEDodo"),r(),n(10,"select",23),T("ngModelChange",function(o){p(e);let d=c();return k(d.estadoFilter,o)||(d.estadoFilter=o),g(o)}),_("change",function(){p(e);let o=c();return g(o.onFilterChange())}),n(11,"option",24),a(12,"Todos"),r(),n(13,"option",25),a(14,"Vigentes"),r(),n(15,"option",26),a(16,"Pendientes"),r(),n(17,"option",27),a(18,"Vencidas"),r()()(),n(19,"div")(20,"label",21),a(21,"Mi Estado"),r(),n(22,"select",23),T("ngModelChange",function(o){p(e);let d=c();return k(d.estadoIndividualFilter,o)||(d.estadoIndividualFilter=o),g(o)}),_("change",function(){p(e);let o=c();return g(o.onFilterChange())}),n(23,"option",24),a(24,"Todos"),r(),n(25,"option",26),a(26,"Pendiente"),r(),n(27,"option",28),a(28,"En Progreso"),r(),n(29,"option",29),a(30,"Completada"),r(),n(31,"option",30),a(32,"Abandonada"),r()()(),n(33,"div")(34,"label",21),a(35,"Progreso"),r(),n(36,"select",23),T("ngModelChange",function(o){p(e);let d=c();return k(d.progresoFilter,o)||(d.progresoFilter=o),g(o)}),_("change",function(){p(e);let o=c();return g(o.onFilterChange())}),n(37,"option",24),a(38,"Todos"),r(),n(39,"option",31),a(40,"Sin Iniciar (0%)"),r(),n(41,"option",28),a(42,"En Progreso (1-99%)"),r(),n(43,"option",32),a(44,"Completado (100%)"),r()()()(),n(45,"div",33)(46,"button",34),_("click",function(){p(e);let o=c();return g(o.clearFilters())}),a(47," Limpiar filtros "),r()()(),x(48,Zr,7,1,"div",35)(49,Xr,2,0,"div",36)(50,ao,2,2,"div",37)(51,mo,11,3,"div",38),r()}if(s&2){let e=c();l(6),E("ngModel",e.searchTerm),l(4),E("ngModel",e.estadoFilter),l(12),E("ngModel",e.estadoIndividualFilter),l(14),E("ngModel",e.progresoFilter),l(12),m("ngIf",e.error&&!e.showViewModal),l(),m("ngIf",e.loading),l(),m("ngIf",!e.loading),l(),m("ngIf",!e.loading&&e.filteredRutinas.length===0)}}function po(s,t){s&1&&(n(0,"div",133)(1,"div",40),h(),n(2,"svg",134),u(3,"path",135),r(),y(),n(4,"div",43)(5,"p",136),a(6,"\xA1Rutina copiada al portapapeles!"),r()()()())}function go(s,t){if(s&1){let e=w();n(0,"button",137),_("click",function(){p(e);let o=c(2);return g(o.exportarRutina(o.selectedRutina,o.selectedSeguimiento||void 0))}),h(),n(1,"svg",128),u(2,"path",80),r(),a(3," Descargar "),r()}}function fo(s,t){if(s&1){let e=w();n(0,"div",96)(1,"div",97)(2,"div",98),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),r(),n(3,"span",99),a(4,"\u200B"),r(),n(5,"div",100)(6,"div",101)(7,"div",102)(8,"div",103),h(),n(9,"svg",104),u(10,"path",77)(11,"path",78),r()(),y(),n(12,"div",105)(13,"h3",106),a(14),r(),n(15,"div",107)(16,"p",66),a(17),r()()()()(),n(18,"div",108)(19,"div",109)(20,"div",110)(21,"div")(22,"span",111),a(23,"Mi Progreso:"),r(),n(24,"div",112)(25,"div",113),u(26,"div",114),r(),a(27),r()(),n(28,"div")(29,"span",111),a(30,"Estado:"),r(),n(31,"div",115),a(32),r()(),n(33,"div")(34,"span",111),a(35,"Per\xEDodo:"),r(),n(36,"div",115),a(37),r()(),n(38,"div")(39,"span",111),a(40,"D\xEDas restantes:"),r(),n(41,"div",115),a(42),r()()()(),n(43,"div",116)(44,"div",117),u(45,"img",118),r(),n(46,"div",119)(47,"div",6),u(48,"div",120)(49,"div",121)(50,"div",122),r(),n(51,"div",123),a(52),r()(),n(53,"pre",124),a(54),r()(),x(55,po,7,0,"div",125),n(56,"div",126)(57,"button",127),_("click",function(){p(e);let o=c();return g(o.copyToClipboard(o.getFormattedRutina(o.selectedRutina,o.selectedSeguimiento||void 0)))}),h(),n(58,"svg",128),u(59,"path",129),r(),a(60," Copiar "),r(),x(61,go,4,0,"button",130),r()(),y(),n(62,"div",131)(63,"button",132),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),a(64," Cerrar "),r()()()()()}if(s&2){let e=c();l(14),v(" ",e.selectedRutina==null?null:e.selectedRutina.nombre," "),l(3),v(" Mi rutina asignada - Progreso: ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(9),X("width",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"%"),l(),v(" ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(5),C(e.selectedSeguimiento==null?null:e.selectedSeguimiento.estado_individual),l(5),N(" ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_inicio_programada)," - ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_fin_programada)," "),l(4),F("text-green-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>7)("text-yellow-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=7&&((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0)("text-red-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=0),l(),v(" ",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0?e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes:"Vencida"," "),l(10),v(" ",e.getFileName(e.selectedRutina)," "),l(2),C(e.getFormattedRutina(e.selectedRutina,e.selectedSeguimiento||void 0)),l(),m("ngIf",e.copySuccess),l(6),m("ngIf",e.selectedRutina)}}var at=class s{constructor(t,e,i){this.supabaseService=t;this.authService=e;this.simpleRutinasService=i}vistaActual="calendario";misRutinas=[];filteredRutinas=[];estadisticasPersonales;loading=!1;error="";showViewModal=!1;selectedRutina=null;selectedSeguimiento=null;copySuccess=!1;searchTerm="";estadoFilter="all";estadoIndividualFilter="all";progresoFilter="all";seccionesDisponibles=[{key:"warm_up",nombre:"Warm Up",descripcion:"Calentamiento"},{key:"met_con",nombre:"Met-Con",descripcion:"Metabolic Conditioning"},{key:"strength",nombre:"Strength",descripcion:"Entrenamiento de Fuerza"},{key:"core",nombre:"Core",descripcion:"Trabajo de Core"},{key:"extra",nombre:"Extra",descripcion:"Trabajo Adicional"}];ngOnInit(){return b(this,null,function*(){yield Promise.all([this.loadMisRutinas(),this.loadEstadisticasPersonales()])})}cambiarVista(t){console.log("Cambiando vista a:",t),this.vistaActual=t}get mostrarVistaTarjetas(){return this.vistaActual==="tarjetas"}get mostrarVistaCalendario(){return this.vistaActual==="calendario"}onVolverDeCalendario(){this.cambiarVista("tarjetas")}onAbrirRutinaDesdeCalendario(t){this.openViewModal(t)}loadMisRutinas(){return b(this,null,function*(){this.loading=!0,this.error="";try{console.log("Cargando rutinas asignadas al usuario...");let t=yield this.simpleRutinasService.getRutinasUsuarioSimple();this.misRutinas=t.map(e=>{let i=e.rutina_asignaciones_masivas,o=e.rutinas,{estado:d,diasRestantes:f}=this.simpleRutinasService.calcularEstadoTemporal(i.fecha_inicio,i.fecha_fin);return{seguimiento_id:e.id,asignacion_id:e.id_asignacion_masiva,id_profile:e.id_profile,username:this.authService.getCurrentUser()?.username||"",full_name:this.authService.getCurrentUser()?.full_name||"",rutina_nombre:o.nombre,rutina_id:o.id,rutina_descripcion:o.descripcion,rutina_tipo:o.tipo,rutina_nivel:o.nivel,rutina_duracion:o.duracion_estimada,rutina_tags:o.tags,rutina_completa:o,progreso:e.progreso,estado_individual:e.estado_individual,fecha_inicio_real:e.fecha_inicio_real,fecha_fin_real:e.fecha_fin_real,fecha_inicio_programada:i.fecha_inicio,fecha_fin_programada:i.fecha_fin,notas_individuales:e.notas_individuales,estado_temporal:d,dias_restantes:f}}),this.filteredRutinas=[...this.misRutinas],this.applyFilters(),console.log("Mis rutinas cargadas:",this.misRutinas.length)}catch(t){console.error("Error cargando mis rutinas:",t),this.error="Error al cargar tus rutinas asignadas",this.misRutinas=[],this.filteredRutinas=[]}finally{this.loading=!1}})}loadEstadisticasPersonales(){return b(this,null,function*(){try{if(this.misRutinas.length===0)return;let t=this.misRutinas.length,e=this.misRutinas.filter(M=>M.estado_temporal==="vigente").length,i=this.misRutinas.filter(M=>M.estado_individual==="completada").length,o=this.misRutinas.filter(M=>M.estado_individual==="en_progreso").length,d=this.misRutinas.filter(M=>M.estado_individual==="pendiente").length,f=this.misRutinas.filter(M=>M.estado_temporal==="vencida").length,S=this.misRutinas.reduce((M,U)=>M+U.progreso,0),P=t>0?Math.round(S/t):0;this.estadisticasPersonales={total_rutinas_asignadas:t,rutinas_vigentes:e,rutinas_completadas:i,rutinas_en_progreso:o,rutinas_pendientes:d,rutinas_vencidas:f,progreso_promedio:P,racha_actual:0,mejor_racha:0}}catch(t){console.error("Error calculando estad\xEDsticas personales:",t)}})}applyFilters(){let t=[...this.misRutinas];if(this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.rutina_nombre.toLowerCase().includes(e)||i.rutina_descripcion?.toLowerCase().includes(e)||i.rutina_tags?.some(o=>o.toLowerCase().includes(e)))}if(this.estadoFilter!=="all"&&(t=t.filter(e=>e.estado_temporal===this.estadoFilter)),this.estadoIndividualFilter!=="all"&&(t=t.filter(e=>e.estado_individual===this.estadoIndividualFilter)),this.progresoFilter!=="all")switch(this.progresoFilter){case"sin_iniciar":t=t.filter(e=>e.progreso===0);break;case"en_progreso":t=t.filter(e=>e.progreso>0&&e.progreso<100);break;case"completado":t=t.filter(e=>e.progreso===100);break}this.filteredRutinas=t}openViewModal(t){return b(this,null,function*(){if(console.log("Abriendo modal para ver rutina:",t.rutina_nombre),this.selectedSeguimiento=t,t.rutina_completa)this.selectedRutina=t.rutina_completa;else try{let{data:e,error:i}=yield this.supabaseService.client.from("rutinas").select("*").eq("id",t.rutina_id).single();if(i)throw i;this.selectedRutina=e}catch(e){console.error("Error cargando rutina completa:",e),this.error="Error al cargar los detalles de la rutina";return}this.showViewModal=!0})}closeViewModal(){console.log("Cerrando modal de vista"),this.showViewModal=!1,this.selectedRutina=null,this.selectedSeguimiento=null,this.copySuccess=!1}actualizarMiProgreso(t,e){return b(this,null,function*(){try{(yield this.simpleRutinasService.actualizarProgresoSimple(t.seguimiento_id,e))&&(t.progreso=e,e===0?t.estado_individual="pendiente":e<100?(t.estado_individual="en_progreso",t.fecha_inicio_real||(t.fecha_inicio_real=new Date().toISOString().split("T")[0])):(t.estado_individual="completada",t.fecha_fin_real=new Date().toISOString().split("T")[0]),yield this.loadEstadisticasPersonales())}catch(i){console.error("Error actualizando progreso:",i),this.error="Error al actualizar el progreso",setTimeout(()=>this.error="",5e3)}})}getSeccionData(t,e){return t[e]}getSeccionesConEjercicios(t){let e=[];return this.seccionesDisponibles.forEach(i=>{let o=this.getSeccionData(t,i.key);o&&o.ejercicios&&o.ejercicios.length>0&&e.push({key:i.key,nombre:i.nombre,seccion:o})}),e}formatDuracion(t){if(!t)return"N/A";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getTotalEjercicios(t){let e=0;return this.seccionesDisponibles.forEach(i=>{let o=this.getSeccionData(t,i.key);o&&o.ejercicios&&(e+=o.ejercicios.length)}),e}getFormattedRutina(t,e){if(console.log("\u{1F3A8} Formateando rutina con NUEVO FORMATO:",t?.nombre),!t)return"";let i="";i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+`\u{1F3CB}\uFE0F  ${t.nombre.toUpperCase()}`.padEnd(78)+`\u2551
`,i+="\u255A"+"\u2550".repeat(78)+`\u255D
`,i+=`${t.descripcion||"Rutina de entrenamiento completa"}

`;let o=`Nivel: ${t.nivel.toUpperCase()}`,d=`Duraci\xF3n: ${this.formatDuracion(t.duracion_estimada)}`,f=`Tipo: ${t.tipo.toUpperCase()}`;if(i+=`\u{1F3AF} ${o} | \u23F1\uFE0F  ${d} | \u{1F4CB} ${f}

`,e){i+="\u250C"+"\u2500".repeat(78)+`\u2510
`,i+="\u2502"+"\u{1F4CA} MI PROGRESO".padEnd(78)+`\u2502
`,i+="\u2514"+"\u2500".repeat(78)+`\u2518
`;let I=e.progreso||0,B=40,J=Math.round(I/100*B),j=B-J,me="\u2588".repeat(J)+"\u2591".repeat(j);if(i+=`Estado: ${e.estado_individual.toUpperCase()} (${I}%)
`,i+=`Progreso: [${me}] ${I}%
`,i+=`Per\xEDodo: ${this.formatDate(e.fecha_inicio_programada)} \u2192 ${this.formatDate(e.fecha_fin_programada)}
`,e.estado_temporal==="vigente"){let Z=e.dias_restantes>7?"\u{1F7E2}":e.dias_restantes>0?"\u{1F7E1}":"\u{1F534}";i+=`${Z} D\xEDas restantes: ${e.dias_restantes}
`}e.fecha_inicio_real&&(i+=`\u2705 Iniciado: ${this.formatDate(e.fecha_inicio_real)}
`),e.fecha_fin_real&&(i+=`\u{1F389} Completado: ${this.formatDate(e.fecha_fin_real)}
`),i+=`
`}i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+"\u{1F4AA} PLAN DE ENTRENAMIENTO".padEnd(78)+`\u2551
`,i+="\u255A"+"\u2550".repeat(78)+`\u255D

`;let S={warm_up:"\u{1F525}",met_con:"\u{1F4A8}",strength:"\u{1F3CB}\uFE0F",core:"\u{1F3AF}",extra:"\u2728"},P=["warm_up","met_con","strength","core","extra"],M=0;P.forEach((I,B)=>{let J=this.seccionesDisponibles.find(me=>me.key===I),j=this.getSeccionData(t,I);if(j&&j.ejercicios&&j.ejercicios.length>0&&J){M++,console.log(`\u{1F4CB} Procesando secci\xF3n: ${J.nombre}`);let me=S[I]||"\u{1F4CB}";i+="\u250C"+"\u2500".repeat(76)+`\u2510
`,i+="\u2502 "+`${me} ${J.nombre.toUpperCase()}`.padEnd(75)+`\u2502
`,i+="\u2514"+"\u2500".repeat(76)+`\u2518
`,j.descripcion&&(i+=`\u{1F4DD} ${j.descripcion}
`);let Z=[];j.tiempo_total&&Z.push(`\u23F1\uFE0F  Tiempo: ${j.tiempo_total}`),j.series&&Z.push(`\u{1F504} Series: ${j.series}`),j.time_cap&&Z.push(`\u23F0 Time Cap: ${j.time_cap}`);let we=j;we.rest_between_exercises&&Z.push(`\u23F8\uFE0F  Descanso: ${we.rest_between_exercises}`),we.rest_between_sets&&Z.push(`\u{1F4A4} Descanso series: ${we.rest_between_sets}`),Z.length>0&&(i+=`${Z.join(" | ")}
`),i+="\u2500".repeat(78)+`
`,j.ejercicios.forEach((V,Ae)=>{i+=`${(Ae+1).toString().padStart(2,"0")}. \u{1F539} ${V.nombre||"Ejercicio"}
`;let oe=[];V.repeticiones&&oe.push(`\u{1F522} ${V.repeticiones} reps`),V.series&&oe.push(`\u{1F504} ${V.series} series`),V.peso&&oe.push(`\u2696\uFE0F  ${V.peso}`),V.distancia&&oe.push(`\u{1F4CF} ${V.distancia}`),V.tiempo&&oe.push(`\u23F1\uFE0F  ${V.tiempo}`),V.duracion&&oe.push(`\u23F3 ${V.duracion}`),oe.length>0&&(i+=`    \u2514\u2500 ${oe.join(" \u2022 ")}
`),V.rpe&&(i+=`    \u{1F4AA} RPE: ${V.rpe}/10
`),V.descanso&&(i+=`    \u23F8\uFE0F  Descanso: ${V.descanso}
`),V.observaciones&&(i+=`    \u{1F4DD} ${V.observaciones}
`),V.notas&&(i+=`    \u{1F4A1} ${V.notas}
`),Ae<j.ejercicios.length-1&&(i+=`
`)}),B<P.length-1&&M>0&&(i+=`
`+"\u2550".repeat(78)+`

`)}}),M===0&&(console.log("\u26A0\uFE0F No se encontraron secciones con ejercicios"),i+=`\u250C${"\u2500".repeat(76)}\u2510
`,i+=`\u2502 \u2139\uFE0F  RUTINA EN DESARROLLO${" ".repeat(51)}\u2502
`,i+=`\u2514${"\u2500".repeat(76)}\u2518
`,i+=`Esta rutina est\xE1 siendo desarrollada.
`,i+=`Los ejercicios ser\xE1n agregados pr\xF3ximamente.

`),e?.notas_individuales&&(i+="\u250C"+"\u2500".repeat(78)+`\u2510
`,i+="\u2502"+"\u{1F4DD} MIS NOTAS PERSONALES".padEnd(78)+`\u2502
`,i+="\u2514"+"\u2500".repeat(78)+`\u2518
`,i+=`${e.notas_individuales}

`),t.tags&&t.tags.length>0&&(i+=`\u{1F3F7}\uFE0F  Tags: ${t.tags.map(I=>`#${I}`).join(" ")}

`),i+="\u2554"+"\u2550".repeat(78)+`\u2557
`,i+="\u2551"+"\u{1F4F1} rehabiMovement - Sistema de Entrenamiento".padEnd(78)+`\u2551
`,i+="\u2560"+"\u2550".repeat(78)+`\u2563
`;let U=this.getTotalEjercicios(t);return i+="\u2551"+`\u{1F4C8} RESUMEN: ${U} ejercicios total`.padEnd(78)+`\u2551
`,t.duracion_estimada&&(i+="\u2551"+`\u23F1\uFE0F  Duraci\xF3n estimada: ${this.formatDuracion(t.duracion_estimada)}`.padEnd(78)+`\u2551
`),i+="\u2551"+`\u{1F4C5} Generado: ${this.formatDate(new Date().toISOString())}`.padEnd(78)+`\u2551
`,i+="\u2551"+`\u{1F194} ID Rutina: ${t.id||"N/A"}`.padEnd(78)+`\u2551
`,e&&(i+="\u2551"+`\u{1F464} Atleta: ${e.full_name||e.username||"N/A"}`.padEnd(78)+`\u2551
`),i+="\u255A"+"\u2550".repeat(78)+`\u255D
`,console.log("\u2705 Nuevo formato aplicado exitosamente!"),i}copyToClipboard(t){return b(this,null,function*(){try{yield navigator.clipboard.writeText(t),this.copySuccess=!0,console.log("Texto copiado al portapapeles"),setTimeout(()=>{this.copySuccess=!1},2e3)}catch(e){console.error("Error al copiar al portapapeles:",e),this.fallbackCopyTextToClipboard(t)}})}fallbackCopyTextToClipboard(t){let e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")&&(this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3))}catch(i){console.error("Fallback: Error al copiar al portapapeles:",i)}document.body.removeChild(e)}safeExportRutina(t){let e=t.rutina_completa||this.selectedRutina;e?this.exportarRutina(e,t):console.warn("No hay rutina disponible para exportar")}safeCopyToClipboard(t){let e=t.rutina_completa||this.selectedRutina;if(e){let i=this.getFormattedRutina(e,t);this.copyToClipboard(i)}else console.warn("No hay rutina disponible para copiar")}exportarRutina(t,e){if(!t){console.warn("No hay rutina para exportar");return}let i=this.getFormattedRutina(t,e);if(!i){console.warn("No se pudo generar el contenido para exportar");return}let o=new Blob([i],{type:"text/plain;charset=utf-8"}),d=window.URL.createObjectURL(o),f=document.createElement("a");f.href=d,f.download=`${t.nombre.replace(/\s+/g,"_")}_mi_rutina.txt`,f.click(),window.URL.revokeObjectURL(d),console.log("Mi rutina exportada:",t.nombre)}onSearch(){this.applyFilters()}onFilterChange(){this.applyFilters()}clearFilters(){this.searchTerm="",this.estadoFilter="all",this.estadoIndividualFilter="all",this.progresoFilter="all",this.applyFilters()}refreshMisRutinas(){return b(this,null,function*(){yield Promise.all([this.loadMisRutinas(),this.loadEstadisticasPersonales()])})}getEstadoTemporalColor(t){switch(t){case"vigente":return"green";case"pendiente":return"blue";case"vencida":return"red";default:return"gray"}}getEstadoIndividualColor(t){switch(t){case"pendiente":return"gray";case"en_progreso":return"yellow";case"completada":return"green";case"abandonada":return"red";default:return"gray"}}getProgresoColor(t){return t===0?"gray":t<30?"red":t<70?"yellow":"green"}formatDate(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"Fecha inv\xE1lida"}}getFileName(t){if(!t||!t.nombre)return"mi_rutina_rehabimovement.txt";let e=t.nombre.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"_").substring(0,30),i=t.tipo?`_${t.tipo}`:"",o=t.nivel?`_${t.nivel}`:"",d=new Date().toISOString().split("T")[0];return`${e}${i}${o}_${d}_rehabimovement.txt`}trackByRutinaId(t,e){return e.seguimiento_id||t}static \u0275fac=function(e){return new(e||s)(O(Q),O(L),O(rt))};static \u0275cmp=D({type:s,selectors:[["app-mis-rutinas"]],standalone:!1,decls:25,vars:20,consts:[["filtrosAplicados",""],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],[1,"flex","bg-gray-100","rounded-lg","p-1"],[1,"px-3","py-2","rounded-md","text-sm","font-medium","transition-colors","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1","inline"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3a2 2 0 012-2h8a2 2 0 012 2v4m-4 0V3m-4 4h8m-8 0H6a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-2"],["title","Refrescar lista",1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],[3,"volverAVista","abrirRutina","rutinas"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4"],[1,"md:col-span-2"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Buscar rutinas...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","input","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","change","ngModel"],["value","all"],["value","vigente"],["value","pendiente"],["value","vencida"],["value","en_progreso"],["value","completada"],["value","abandonada"],["value","sin_iniciar"],["value","completado"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-red-600","hover:text-red-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf"],["class","text-center py-12",4,"ngIf"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-red-600"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 border-l-4",3,"border-green-500","border-blue-500","border-red-500",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-white","rounded-lg","shadow-lg","overflow-hidden","hover:shadow-xl","transition-shadow","duration-300","border-l-4"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"text-xl","font-bold","text-white"],[1,"text-white","text-opacity-90","text-sm"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-white","bg-opacity-20","text-white"],[1,"p-6"],[1,"mb-4"],[1,"flex","justify-between","items-center","mb-2"],[1,"text-sm","font-medium","text-gray-700"],[1,"text-sm","font-bold","text-gray-900"],[1,"w-full","bg-gray-200","rounded-full","h-3"],[1,"h-3","rounded-full","transition-all","duration-300"],[1,"mt-3"],["type","range","min","0","max","100","step","5","title","Desliza para actualizar tu progreso",1,"w-full","h-2","bg-gray-200","rounded-lg","appearance-none","cursor-pointer","slider",3,"input","value"],[1,"flex","justify-between","items-center","mb-4"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-600","mb-4"],[1,"flex","justify-between"],[1,"flex","justify-between","font-medium"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-red-100","text-red-800"],["class","mb-4",4,"ngIf"],["class","text-xs text-gray-500 mb-4",4,"ngIf"],["class","mb-4 p-3 bg-gray-50 rounded-md",4,"ngIf"],[1,"flex","justify-end","space-x-2"],["title","Ver rutina completa",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50","transition-colors","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Descargar mi rutina",1,"text-green-600","hover:text-green-900","p-2","rounded-full","hover:bg-green-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"flex","flex-wrap","gap-1"],["class","inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",4,"ngFor","ngForOf"],[1,"inline-flex","items-center","px-2","py-1","rounded-md","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"text-xs","text-gray-500","mb-4"],[1,"mb-4","p-3","bg-gray-50","rounded-md"],[1,"text-sm","text-gray-700"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[4,"ngIf","ngIfElse"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-5xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900","flex","items-center"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-2"],[1,"bg-blue-600","h-2","rounded-full"],[1,"text-gray-900"],[1,"bg-gray-900","text-green-400","rounded-lg","p-6","font-mono","text-sm","overflow-auto","max-h-96","relative",2,"font-family","'Courier New', monospace","line-height","1.6"],[1,"absolute","inset-15","flex","items-center","justify-center","pointer-events-none","opacity-25"],["src","/rh.png","alt","RehabiMovement",1,"max-w-50","max-h-50","object-contain","transform","rotate-12","select-none"],[1,"flex","items-center","justify-between","mb-4","pb-2","border-b","border-gray-700","relative","z-10"],[1,"w-3","h-3","bg-red-500","rounded-full"],[1,"w-3","h-3","bg-yellow-500","rounded-full"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-gray-400","text-xs"],[1,"whitespace-pre-wrap","text-white","relative","z-10"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],["class","inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",3,"click",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-green-700"],[1,"inline-flex","items-center","px-3","py-2","border","border-transparent","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"]],template:function(e,i){e&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"h1",4),a(5,"Mis Rutinas Asignadas"),r(),n(6,"p",5),a(7),r()(),n(8,"div",6)(9,"div",7)(10,"button",8),_("click",function(){return i.cambiarVista("tarjetas")}),h(),n(11,"svg",9),u(12,"path",10),r(),a(13," Tarjetas "),r(),y(),n(14,"button",8),_("click",function(){return i.cambiarVista("calendario")}),h(),n(15,"svg",9),u(16,"path",11),r(),a(17," Calendario "),r()(),y(),n(18,"button",12),_("click",function(){return i.refreshMisRutinas()}),h(),n(19,"svg",13),u(20,"path",14),r(),a(21," Refrescar "),r()()()(),x(22,Jr,2,1,"div",15)(23,uo,52,8,"div",15),r(),x(24,fo,65,19,"div",16)),e&2&&(l(7),v(" Rutinas que me han sido asignadas - Total: ",i.misRutinas.length," "),l(3),F("bg-white",i.mostrarVistaTarjetas)("text-gray-900",i.mostrarVistaTarjetas)("shadow-sm",i.mostrarVistaTarjetas)("text-gray-500",!i.mostrarVistaTarjetas),l(4),F("bg-white",i.mostrarVistaCalendario)("text-gray-900",i.mostrarVistaCalendario)("shadow-sm",i.mostrarVistaCalendario)("text-gray-500",!i.mostrarVistaCalendario),l(8),m("ngIf",i.mostrarVistaCalendario),l(),m("ngIf",i.mostrarVistaTarjetas),l(),m("ngIf",i.showViewModal))},dependencies:[$,z,R,ne,re,W,ie,G,H,ot],styles:[".slider[_ngcontent-%COMP%]{-webkit-appearance:none;appearance:none;background:linear-gradient(to right,#ef4444,#f59e0b,#10b981);outline:none;opacity:.7;transition:opacity .2s}.slider[_ngcontent-%COMP%]:hover{opacity:1}.slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;border-radius:50%;background:#fff;border:2px solid #ef4444;cursor:pointer;box-shadow:0 2px 4px #0003}.slider[_ngcontent-%COMP%]::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:#fff;border:2px solid #ef4444;cursor:pointer;box-shadow:0 2px 4px #0003}.rutina-card[_ngcontent-%COMP%]{transition:all .3s ease}.rutina-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.rutina-card.vigente[_ngcontent-%COMP%]{border-left:4px solid #10b981}.rutina-card.pendiente[_ngcontent-%COMP%]{border-left:4px solid #3b82f6}.rutina-card.vencida[_ngcontent-%COMP%]{border-left:4px solid #ef4444}.progress-bar[_ngcontent-%COMP%]{transition:width .5s ease-in-out}.estado-vigente[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669)}.estado-pendiente[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb)}.estado-vencida[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626)}@media (max-width: 768px){.grid-cols-3[_ngcontent-%COMP%], .md\\:grid-cols-2[_ngcontent-%COMP%]{grid-template-columns:repeat(1,minmax(0,1fr))}}.terminal[_ngcontent-%COMP%]{font-family:Courier New,Monaco,Menlo,monospace;background-color:#1a1a1a;color:#0f0;border-radius:8px;padding:1rem;max-height:400px;overflow-y:auto}.terminal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid #333}.terminal-dots[_ngcontent-%COMP%]{display:flex;gap:.5rem}.terminal-dot[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%}.terminal-dot.red[_ngcontent-%COMP%]{background-color:#ff5f56}.terminal-dot.yellow[_ngcontent-%COMP%]{background-color:#ffbd2e}.terminal-dot.green[_ngcontent-%COMP%]{background-color:#27ca3f}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.terminal[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#777}.action-button[_ngcontent-%COMP%]{transition:all .2s ease}.action-button[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.badge-pendiente[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151}.badge-en-progreso[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.badge-completada[_ngcontent-%COMP%]{background-color:#d1fae5;color:#065f46}.badge-abandonada[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b}.progress-circle[_ngcontent-%COMP%]{transform:rotate(-90deg)}.progress-circle[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{fill:none;stroke-width:8;stroke-linecap:round}.progress-circle[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]{stroke:#e5e7eb}.progress-circle[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{stroke:#10b981;stroke-dasharray:251.2;stroke-dashoffset:251.2;transition:stroke-dashoffset .5s ease}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.notas-box[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#e2e8f0);border-left:4px solid #3b82f6}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.dias-restantes-ok[_ngcontent-%COMP%]{color:#10b981;font-weight:600}.dias-restantes-warning[_ngcontent-%COMP%]{color:#f59e0b;font-weight:600}.dias-restantes-danger[_ngcontent-%COMP%]{color:#ef4444;font-weight:600}@media (min-width: 768px) and (max-width: 1024px){.grid-cols-3[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}.modal-overlay[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-panel[_ngcontent-%COMP%]{max-height:90vh;overflow-y:auto}.tag[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .5rem;border-radius:.375rem;font-size:.75rem;font-weight:500;background-color:#dbeafe;color:#1e40af}.modal-panel[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.modal-panel[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.modal-panel[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.modal-panel[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}"]})};var Pe=class s{constructor(t){this.supabaseService=t}getTerapias(){return b(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("terapias").select("*").eq("status",1).order("created_at",{ascending:!1});if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener terapias:",t),t}})}getTerapiaById(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapias").select("*").eq("id",t).eq("status",1).single();if(i)throw i;return e}catch(e){throw console.error("Error al obtener terapia:",e),e}})}createTerapia(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapias").insert([t]).select().single();if(i)throw i;return e}catch(e){throw console.error("Error al crear terapia:",e),e}})}updateTerapia(t,e){return b(this,null,function*(){try{let{data:i,error:o}=yield this.supabaseService.supabase.from("terapias").update(Ie(ce({},e),{updated_at:new Date().toISOString()})).eq("id",t).select().single();if(o)throw o;return i}catch(i){throw console.error("Error al actualizar terapia:",i),i}})}deleteTerapia(t){return b(this,null,function*(){try{let{error:e}=yield this.supabaseService.supabase.from("terapias").update({status:0}).eq("id",t);if(e)throw e}catch(e){throw console.error("Error al eliminar terapia:",e),e}})}getTiposEjerciciosTerapeuticos(){return b(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("tipos_ejercicios_terapeuticos").select("*").eq("status",1).order("nombre");if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener tipos de ejercicios:",t),t}})}getInformacionMedicaUsuario(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").select("*").eq("usuario_id",t).single();if(i&&i.code!=="PGRST116")throw i;return e}catch(e){throw console.error("Error al obtener informaci\xF3n m\xE9dica:",e),e}})}createOrUpdateInformacionMedica(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").upsert(t,{onConflict:"usuario_id"}).select().single();if(i)throw i;return e}catch(e){throw console.error("Error al guardar informaci\xF3n m\xE9dica:",e),e}})}asignarTerapiaAUsuarios(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.rpc("asignar_terapia_a_usuarios",{p_id_terapia:t.id_terapia,p_usuarios_ids:t.usuarios_ids,p_asignado_por:yield this.getCurrentUserId(),p_fecha_inicio:t.fecha_inicio.toISOString().split("T")[0],p_fecha_fin:t.fecha_fin.toISOString().split("T")[0],p_terapeuta_responsable:t.terapeuta_responsable||null,p_sesiones_por_semana:t.sesiones_por_semana,p_duracion_sesion:t.duracion_sesion,p_tipo_asignacion:t.tipo_asignacion,p_notas:t.notas||null,p_objetivos_grupales:t.objetivos_grupales||null});if(i)throw i;return e}catch(e){throw console.error("Error al asignar terapia:",e),e}})}getTerapiasAsignadasUsuarios(){return b(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").order("fecha_asignacion",{ascending:!1});if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener terapias asignadas:",t),t}})}getTerapiasUsuario(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.rpc("get_terapias_usuario",{p_user_id:t});if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener terapias del usuario:",e),e}})}actualizarProgresoTerapia(t,e){return b(this,null,function*(){try{let{data:i,error:o}=yield this.supabaseService.supabase.rpc("actualizar_progreso_terapia",{p_seguimiento_id:t,p_progreso:e.progreso||null,p_estado_individual:e.estado_individual||null,p_sesiones_completadas:e.sesiones_completadas||null,p_adherencia_porcentaje:e.adherencia_porcentaje||null,p_nivel_dolor_actual:e.nivel_dolor_actual||null,p_nivel_funcionalidad_actual:e.nivel_funcionalidad_actual||null,p_notas_individuales:e.notas_individuales||null,p_objetivos_individuales:e.objetivos_individuales||null});if(o)throw o;return i}catch(i){throw console.error("Error al actualizar progreso:",i),i}})}registrarSesionTerapia(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.rpc("registrar_sesion_terapia",{p_seguimiento_id:t.seguimiento_id,p_numero_sesion:t.numero_sesion,p_fecha_sesion:t.fecha_sesion.toISOString().split("T")[0],p_estado_sesion:t.estado_sesion||"completada",p_hora_inicio:t.hora_inicio||null,p_hora_fin:t.hora_fin||null,p_terapeuta_id:t.terapeuta_id||null,p_ejercicios_realizados:t.ejercicios_realizados||null,p_dolor_inicio:t.dolor_inicio||null,p_dolor_fin:t.dolor_fin||null,p_nivel_fatiga:t.nivel_fatiga||null,p_nivel_esfuerzo:t.nivel_esfuerzo||null,p_adherencia_sesion:t.adherencia_sesion||null,p_observaciones_usuario:t.observaciones_usuario||null,p_observaciones_terapeuta:t.observaciones_terapeuta||null});if(i)throw i;return e}catch(e){throw console.error("Error al registrar sesi\xF3n:",e),e}})}getSesionesUsuario(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapia_registro_sesiones").select(`
          *,
          terapeuta:terapeuta_id(full_name)
        `).eq("id_seguimiento",t).order("numero_sesion");if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener sesiones:",e),e}})}getEstadisticasTerapias(){return b(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.rpc("get_estadisticas_terapias_asignadas");if(e)throw e;return t[0]||{total_asignaciones:0,asignaciones_activas:0,asignaciones_grupales:0,asignaciones_individuales:0,usuarios_con_terapias:0,terapias_mas_asignadas:0,promedio_progreso:0,promedio_adherencia:0,sesiones_totales_completadas:0,sesiones_totales_programadas:0}}catch(t){throw console.error("Error al obtener estad\xEDsticas:",t),t}})}getUsuarios(){return b(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("profiles").select("id, username, full_name, email, id_perfil").eq("status",1).order("full_name");if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener usuarios:",t),t}})}getTerapeutas(){return b(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("profiles").select("id, username, full_name, email").eq("id_perfil",3).eq("status",1).order("full_name");if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener terapeutas:",t),t}})}updatePerfilCompleto(t,e){return b(this,null,function*(){try{let i={full_name:e.full_name,username:e.username,email:e.email},{error:o}=yield this.supabaseService.supabase.from("profiles").update(i).eq("id",t);if(o)throw o;let d={usuario_id:t,fecha_nacimiento:e.fecha_nacimiento,genero:e.genero,telefono:e.telefono,direccion:e.direccion,diagnostico_principal:e.diagnostico_principal,diagnosticos_secundarios:e.diagnosticos_secundarios,historial_medico:e.historial_medico,medicamentos_actuales:e.medicamentos_actuales,alergias:e.alergias,limitaciones_fisicas:e.limitaciones_fisicas,observaciones_generales:e.observaciones_generales,contacto_emergencia_nombre:e.contacto_emergencia_nombre,contacto_emergencia_telefono:e.contacto_emergencia_telefono,contacto_emergencia_relacion:e.contacto_emergencia_relacion,peso:e.peso,altura:e.altura,imc:e.peso&&e.altura?e.peso/(e.altura/100)**2:void 0,nivel_dolor_inicial:e.nivel_dolor_inicial,nivel_funcionalidad_inicial:e.nivel_funcionalidad_inicial,objetivos_paciente:e.objetivos_paciente,updated_at:new Date().toISOString()};yield this.createOrUpdateInformacionMedica(d)}catch(i){throw console.error("Error al actualizar perfil completo:",i),i}})}getPerfilCompleto(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("profiles").select("username, full_name, email").eq("id",t).single();if(i)throw i;let o=yield this.getInformacionMedicaUsuario(t);return{username:e.username,full_name:e.full_name,email:e.email,fecha_nacimiento:o?.fecha_nacimiento,genero:o?.genero,telefono:o?.telefono,direccion:o?.direccion,diagnostico_principal:o?.diagnostico_principal,diagnosticos_secundarios:o?.diagnosticos_secundarios,historial_medico:o?.historial_medico,medicamentos_actuales:o?.medicamentos_actuales,alergias:o?.alergias,limitaciones_fisicas:o?.limitaciones_fisicas,observaciones_generales:o?.observaciones_generales,contacto_emergencia_nombre:o?.contacto_emergencia_nombre,contacto_emergencia_telefono:o?.contacto_emergencia_telefono,contacto_emergencia_relacion:o?.contacto_emergencia_relacion,peso:o?.peso,altura:o?.altura,nivel_dolor_inicial:o?.nivel_dolor_inicial,nivel_funcionalidad_inicial:o?.nivel_funcionalidad_inicial,objetivos_paciente:o?.objetivos_paciente}}catch(e){throw console.error("Error al obtener perfil completo:",e),e}})}getTerapiasByTipo(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapias").select("*").eq("tipo",t).eq("status",1).order("nombre");if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener terapias por tipo:",e),e}})}getTerapiasByArea(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapias").select("*").eq("area_especializacion",t).eq("status",1).order("nombre");if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener terapias por \xE1rea:",e),e}})}duplicarTerapia(t,e){return b(this,null,function*(){try{let i=yield this.getTerapiaById(t);if(!i)throw new Error("Terapia no encontrada");let o=Ie(ce({},i),{id:void 0,nombre:e,created_at:void 0,updated_at:void 0});return yield this.createTerapia(o)}catch(i){throw console.error("Error al duplicar terapia:",i),i}})}buscarTerapias(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapias").select("*").or(`nombre.ilike.%${t}%,descripcion.ilike.%${t}%,area_especializacion.ilike.%${t}%`).eq("status",1).order("nombre");if(i)throw i;return e||[]}catch(e){throw console.error("Error al buscar terapias:",e),e}})}getSeguimientoDetalladoUsuario(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("terapia_seguimiento_individual").select(`
          *,
          terapia:id_terapia(*),
          asignacion:id_asignacion_masiva(*),
          profile:id_profile(*)
        `).eq("id_profile",t);if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener seguimiento detallado:",e),e}})}getAsignacionesPorTerapeuta(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").eq("terapeuta_responsable",t).order("fecha_asignacion",{ascending:!1});if(i)throw i;return e||[]}catch(e){throw console.error("Error al obtener asignaciones por terapeuta:",e),e}})}getProximasSesionesTeruapeuta(t,e=7){return b(this,null,function*(){try{let i=new Date().toISOString().split("T")[0],o=new Date(Date.now()+e*24*60*60*1e3).toISOString().split("T")[0],{data:d,error:f}=yield this.supabaseService.supabase.rpc("get_proximas_sesiones_terapeuta",{p_terapeuta_id:t,p_fecha_inicio:i,p_dias:e});if(f)throw f;return d||[]}catch(i){throw console.error("Error al obtener pr\xF3ximas sesiones:",i),i}})}calcularAdherenciaUsuario(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.rpc("calcular_adherencia_usuario",{p_usuario_id:t});if(i)throw i;return e[0]||null}catch(e){throw console.error("Error al calcular adherencia:",e),e}})}getReporteProgresoPorArea(){return b(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("v_progreso_por_area").select("*");if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener reporte por \xE1rea:",t),t}})}getDashboardTerapeuta(t){return b(this,null,function*(){try{let e=this.supabaseService.supabase.from("v_dashboard_terapeutas").select("*");t&&(e=e.eq("terapeuta_id",t));let{data:i,error:o}=yield e;if(o)throw o;return i||[]}catch(e){throw console.error("Error al obtener dashboard de terapeuta:",e),e}})}getUsuariosQueNecesitanSeguimiento(){return b(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").eq("estado_individual","en_progreso").or("adherencia_porcentaje.lt.70,progreso.lt.30").order("ultima_actualizacion",{ascending:!0}).limit(10);if(e)throw e;return t||[]}catch(t){throw console.error("Error al obtener usuarios que necesitan seguimiento:",t),t}})}validarAsignacionTerapia(t,e){return b(this,null,function*(){try{let{data:i,error:o}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").eq("id_profile",t).eq("id_terapia",e).in("estado_individual",["pendiente","en_progreso"]);if(o)throw o;return i&&i.length>0?{valido:!1,mensaje:"El usuario ya tiene esta terapia asignada y activa"}:(yield this.getInformacionMedicaUsuario(t))?{valido:!0}:{valido:!1,mensaje:"El usuario no tiene informaci\xF3n m\xE9dica registrada"}}catch(i){return console.error("Error validando asignaci\xF3n:",i),{valido:!1,mensaje:"Error al validar la asignaci\xF3n"}}})}getHistorialCambiosEstado(t){return b(this,null,function*(){try{return[]}catch(e){throw console.error("Error al obtener historial de cambios:",e),e}})}exportarSeguimientoCSV(t){let e=["Usuario","Terapia","Estado","Progreso","Adherencia","Sesiones Completadas","Sesiones Programadas","Terapeuta","Fecha Inicio","Fecha Fin","\xDAltima Actualizaci\xF3n"],i=t.map(d=>[d.full_name,d.terapia_nombre,d.estado_individual,`${d.progreso}%`,`${d.adherencia_porcentaje}%`,d.sesiones_completadas,d.sesiones_programadas,d.terapeuta_nombre||"Sin asignar",this.formatearFecha(d.fecha_inicio_programada),this.formatearFecha(d.fecha_fin_programada),this.formatearFecha(d.ultima_actualizacion)]);return[e,...i].map(d=>d.map(f=>`"${f}"`).join(",")).join(`
`)}formatearFecha(t){return new Date(t).toLocaleDateString("es-ES")}generarReportePDF(t){return b(this,null,function*(){return new Blob(["Reporte PDF no implementado"],{type:"application/pdf"})})}getAlertasTerapeuta(t){return b(this,null,function*(){try{let e=[],{data:i}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").eq("terapeuta_responsable",t).lt("adherencia_porcentaje",70).eq("estado_individual","en_progreso");i&&i.forEach(d=>{e.push({tipo:"baja_adherencia",mensaje:`${d.full_name} tiene baja adherencia (${d.adherencia_porcentaje}%) en ${d.terapia_nombre}`,prioridad:"alta",asignacion:d})});let{data:o}=yield this.supabaseService.supabase.from("v_terapias_asignadas_usuarios").select("*").eq("terapeuta_responsable",t).lte("dias_restantes",7).eq("estado_individual","en_progreso");return o&&o.forEach(d=>{e.push({tipo:"proxima_vencer",mensaje:`La terapia de ${d.full_name} vence en ${d.dias_restantes} d\xEDas`,prioridad:"media",asignacion:d})}),e}catch(e){return console.error("Error al obtener alertas:",e),[]}})}marcarAlertaLeida(t){return b(this,null,function*(){console.log(`Alerta ${t} marcada como le\xEDda`)})}getCurrentUserId(){return b(this,null,function*(){try{let{data:{user:t}}=yield this.supabaseService.supabase.auth.getUser();if(!t)throw new Error("Usuario no autenticado");let{data:e,error:i}=yield this.supabaseService.supabase.from("profiles").select("id").eq("user_id",t.id).single();if(i)throw i;return e.id}catch(t){throw console.error("Error al obtener ID del usuario actual:",t),t}})}calcularIMC(t,e){if(!t||!e)return 0;let i=e/100;return Math.round(t/i**2*100)/100}formatearDuracion(t){if(t<60)return`${t} min`;{let e=Math.floor(t/60),i=t%60;return i>0?`${e}h ${i}min`:`${e}h`}}getColorNivelDolor(t){return t<=2?"text-green-600":t<=4?"text-yellow-600":t<=6?"text-orange-600":"text-red-600"}getColorProgreso(t){return t>=80?"text-green-600":t>=60?"text-blue-600":t>=40?"text-yellow-600":"text-red-600"}getColorAdherencia(t){return t>=90?"text-green-600":t>=70?"text-blue-600":t>=50?"text-yellow-600":"text-red-600"}formatearFechaLegible(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}formatearFechaCorta(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}calcularDiasEntre(t,e){let i=new Date(t),d=new Date(e).getTime()-i.getTime();return Math.ceil(d/(1e3*60*60*24))}calcularProgresoTemporal(t,e){let i=new Date(t),o=new Date(e),d=new Date;if(d<i)return 0;if(d>o)return 100;let f=this.calcularDiasEntre(i,o),S=this.calcularDiasEntre(i,d);return Math.round(S/f*100)}validarEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}validarTelefono(t){return/^[\+]?[0-9\s\-\(\)]{8,20}$/.test(t)}generarCodigoAleatorio(t=6){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i="";for(let o=0;o<t;o++)i+=e.charAt(Math.floor(Math.random()*e.length));return i}limpiarTexto(t){return t.trim().replace(/\s+/g," ")}toTitleCase(t){return t.toLowerCase().replace(/\b\w/g,e=>e.toUpperCase())}truncarTexto(t,e){return t.length<=e?t:t.substring(0,e)+"..."}obtenerIniciales(t){return t.split(" ").map(e=>e.charAt(0).toUpperCase()).join("").substring(0,2)}generarColorAvatar(t){let e=["bg-red-500","bg-blue-500","bg-green-500","bg-yellow-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-gray-500"],i=0;for(let o=0;o<t.length;o++)i=t.charCodeAt(o)+((i<<5)-i);return e[Math.abs(i)%e.length]}descargarCSV(t,e){let i=new Blob([t],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");if(o.download!==void 0){let d=URL.createObjectURL(i);o.setAttribute("href",d),o.setAttribute("download",e),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}descargarJSON(t,e){let i=JSON.stringify(t,null,2),o=new Blob([i],{type:"application/json;charset=utf-8;"}),d=document.createElement("a");if(d.download!==void 0){let f=URL.createObjectURL(o);d.setAttribute("href",f),d.setAttribute("download",e),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)}}mostrarExito(t){console.log("\xC9xito:",t)}mostrarError(t){console.error("Error:",t)}mostrarInfo(t){console.info("Info:",t)}debug(){console.log("=== TerapiasService Debug ==="),console.log("Supabase conectado:",!!this.supabaseService.supabase),console.log("============================")}static \u0275fac=function(e){return new(e||s)(Ce(Q))};static \u0275prov=Ve({token:s,factory:s.\u0275fac,providedIn:"root"})};var _o=(s,t,e,i,o)=>({"bg-blue-100 text-blue-800":s,"bg-green-100 text-green-800":t,"bg-purple-100 text-purple-800":e,"bg-yellow-100 text-yellow-800":i,"bg-red-100 text-red-800":o});function xo(s,t){if(s&1){let e=w();n(0,"button",30),_("click",function(){p(e);let o=c();return g(o.openCreateModal())}),h(),n(1,"svg",31),u(2,"path",32),r(),a(3," Nueva Terapia "),r()}}function ho(s,t){if(s&1&&(n(0,"div",33)(1,"div",34),h(),n(2,"svg",35),u(3,"path",36),r(),y(),n(4,"div",37)(5,"p",38),a(6),r()()()()),s&2){let e=c();l(6),C(e.error)}}function vo(s,t){if(s&1&&(n(0,"option",39),a(1),r()),s&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function bo(s,t){if(s&1&&(n(0,"option",39),a(1),he(2,"titlecase"),r()),s&2){let e=t.$implicit;m("value",e),l(),v(" ",Se(2,2,e)," ")}}function wo(s,t){if(s&1&&(n(0,"option",39),a(1),r()),s&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function yo(s,t){s&1&&(n(0,"div",40),h(),n(1,"svg",41),u(2,"path",42),r(),y(),n(3,"p",43),a(4,"Cargando terapias..."),r()())}function Co(s,t){if(s&1&&(n(0,"p",66),a(1),r()),s&2){let e=c().$implicit;l(),v(" ",e.descripcion," ")}}function So(s,t){if(s&1&&(n(0,"span"),a(1),he(2,"titlecase"),r()),s&2){let e=c().$implicit;l(),v(" ",Se(2,1,e.area_especializacion)," ")}}function Mo(s,t){if(s&1&&(n(0,"span"),a(1),r()),s&2){let e=c().$implicit,i=c(2);l(),v(" ",i.getTotalEjercicios(e)," ejercicios ")}}function Eo(s,t){if(s&1&&(n(0,"span",69),a(1),r()),s&2){let e=t.$implicit;l(),v(" #",e," ")}}function ko(s,t){if(s&1&&(n(0,"div",67),x(1,Eo,2,1,"span",68),r()),s&2){let e=c().$implicit;l(),m("ngForOf",e.tags)}}function To(s,t){if(s&1){let e=w();n(0,"button",70),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.openEditModal(o))}),h(),n(1,"svg",61),u(2,"path",71),r()()}}function Po(s,t){if(s&1){let e=w();n(0,"button",72),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.deleteTerapia(o))}),h(),n(1,"svg",61),u(2,"path",73),r()()}}function Io(s,t){if(s&1){let e=w();n(0,"li",46)(1,"div",47)(2,"div",48)(3,"div",49)(4,"div",50)(5,"div",51)(6,"p",52),a(7),r(),x(8,Co,2,1,"p",53),n(9,"div",54)(10,"span",55),a(11),r(),x(12,So,3,3,"span",56),n(13,"span",57),a(14),r(),n(15,"span"),a(16),r(),x(17,Mo,2,1,"span",56),r(),x(18,ko,2,1,"div",58),r()()(),n(19,"div",59)(20,"button",60),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.openViewModal(o))}),h(),n(21,"svg",61),u(22,"path",62)(23,"path",63),r()(),x(24,To,3,0,"button",64)(25,Po,3,0,"button",65),r()()()()}if(s&2){let e=t.$implicit,i=c(2);l(7),v(" ",e.nombre," "),l(),m("ngIf",e.descripcion),l(2),m("ngClass",De(11,_o,e.tipo==="fisica",e.tipo==="ocupacional",e.tipo==="respiratoria",e.tipo==="neurologica",e.tipo==="cardiaca")),l(),v(" ",i.getTipoLabel(e.tipo)," "),l(),m("ngIf",e.area_especializacion),l(2),C(e.nivel),l(2),C(i.formatDuracion(e.duracion_estimada)),l(),m("ngIf",i.hasEjercicios(e)),l(),m("ngIf",e.tags&&e.tags.length>0),l(6),m("ngIf",i.canEditTerapia()),l(),m("ngIf",i.canEditTerapia())}}function Oo(s,t){if(s&1&&(n(0,"ul",44),x(1,Io,26,17,"li",45),r()),s&2){let e=c();l(),m("ngForOf",e.filteredTerapias)}}function Vo(s,t){if(s&1){let e=w();n(0,"button",82),_("click",function(){p(e);let o=c(2);return g(o.openCreateModal())}),a(1," Crear primera terapia "),r()}}function Fo(s,t){if(s&1){let e=w();n(0,"button",83),_("click",function(){p(e);let o=c(2);return g(o.clearFilters())}),a(1," Limpiar filtros "),r()}}function Do(s,t){if(s&1&&(n(0,"div",74),h(),n(1,"svg",75),u(2,"path",76),r(),y(),n(3,"h3",77),a(4,"No hay terapias"),r(),n(5,"p",78),a(6),r(),n(7,"div",79),x(8,Vo,2,0,"button",80)(9,Fo,2,0,"button",81),r()()),s&2){let e=c();l(6),v(" ",e.terapias.length===0?"No se encontraron terapias en la base de datos.":"No se encontraron terapias con los filtros aplicados."," "),l(2),m("ngIf",e.terapias.length===0&&e.canEditTerapia()),l(),m("ngIf",e.terapias.length>0)}}function Ao(s,t){if(s&1&&(n(0,"option",39),a(1),r()),s&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function Ro(s,t){if(s&1&&(n(0,"option",39),a(1),he(2,"titlecase"),r()),s&2){let e=t.$implicit;m("value",e),l(),v(" ",Se(2,2,e)," ")}}function jo(s,t){if(s&1&&(n(0,"option",39),a(1),r()),s&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function Uo(s,t){if(s&1){let e=w();n(0,"span",132),a(1),n(2,"button",133),_("click",function(){let o=p(e).index,d=c(3);return g(d.removeTag(o))}),h(),n(3,"svg",134),u(4,"path",135),r()()()}if(s&2){let e=t.$implicit;l(),v(" #",e," ")}}function Lo(s,t){if(s&1&&(n(0,"div",130),x(1,Uo,5,1,"span",131),r()),s&2){let e=c(2);l(),m("ngForOf",e.terapiaForm.tags)}}function No(s,t){if(s&1){let e=w();n(0,"div",136)(1,"label",137)(2,"input",138),_("change",function(){let o=p(e).$implicit,d=c(2);return g(d.toggleSeccion(o.key))}),r(),n(3,"div",37)(4,"div",139),a(5),r(),n(6,"div",23),a(7),r()()()()}if(s&2){let e=t.$implicit,i=c(2);l(2),m("checked",i.seccionesActivas.has(e.key)),l(3),C(e.nombre),l(2),C(e.descripcion)}}function zo(s,t){if(s&1&&(n(0,"option",39),a(1),r()),s&2){let e=t.$implicit;m("value",e.nombre),l(),v(" ",e.nombre," ")}}function Bo(s,t){if(s&1&&(n(0,"option",39),a(1),r()),s&2){let e=t.$implicit;m("value",e.value),l(),v(" ",e.label," ")}}function $o(s,t){if(s&1){let e=w();n(0,"div",153)(1,"div",154)(2,"span",155),a(3),r(),n(4,"div",156)(5,"button",157),_("click",function(){let o=p(e).index,d=c(3).$implicit,f=c(2);return g(f.moveEjercicio(d,o,o-1))}),h(),n(6,"svg",158),u(7,"path",159),r()(),y(),n(8,"button",160),_("click",function(){let o=p(e).index,d=c(3).$implicit,f=c(2);return g(f.moveEjercicio(d,o,o+1))}),h(),n(9,"svg",158),u(10,"path",161),r()(),y(),n(11,"button",162),_("click",function(){let o=p(e).index,d=c(3).$implicit,f=c(2);return g(f.removeEjercicio(d,o))}),h(),n(12,"svg",158),u(13,"path",73),r()()()(),y(),n(14,"div",163)(15,"div",98)(16,"label",164),a(17,"Nombre *"),r(),n(18,"input",165),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.nombre,o)||(d.nombre=o),g(o)}),r()(),n(19,"div")(20,"label",164),a(21,"Tipo"),r(),n(22,"select",166),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.tipo,o)||(d.tipo=o),g(o)}),x(23,zo,2,2,"option",16),r()(),n(24,"div")(25,"label",164),a(26,"Intensidad"),r(),n(27,"select",166),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.intensidad,o)||(d.intensidad=o),g(o)}),x(28,Bo,2,2,"option",16),r()(),n(29,"div")(30,"label",164),a(31,"Repeticiones"),r(),n(32,"input",167),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.repeticiones,o)||(d.repeticiones=o),g(o)}),r()(),n(33,"div")(34,"label",164),a(35,"Series"),r(),n(36,"input",167),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.series,o)||(d.series=o),g(o)}),r()(),n(37,"div")(38,"label",164),a(39,"Duraci\xF3n"),r(),n(40,"input",168),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.duracion,o)||(d.duracion=o),g(o)}),r()(),n(41,"div",98)(42,"label",164),a(43,"Descripci\xF3n"),r(),n(44,"textarea",169),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.descripcion,o)||(d.descripcion=o),g(o)}),r()(),n(45,"div",98)(46,"label",164),a(47,"Precauciones"),r(),n(48,"textarea",170),T("ngModelChange",function(o){let d=p(e).$implicit;return k(d.precauciones,o)||(d.precauciones=o),g(o)}),r()()()()}if(s&2){let e=t.$implicit,i=t.index,o=c(2).ngIf,d=c().$implicit,f=c(2);l(3),v("Ejercicio ",i+1,""),l(2),m("disabled",i===0),l(3),m("disabled",i===o.ejercicios.length-1),l(10),E("ngModel",e.nombre),m("name","ejercicio_nombre_"+d+"_"+i),l(4),E("ngModel",e.tipo),m("name","ejercicio_tipo_"+d+"_"+i),l(),m("ngForOf",f.tiposEjercicios),l(4),E("ngModel",e.intensidad),m("name","ejercicio_intensidad_"+d+"_"+i),l(),m("ngForOf",f.intensidadesDisponibles),l(4),E("ngModel",e.repeticiones),m("name","ejercicio_repeticiones_"+d+"_"+i),l(4),E("ngModel",e.series),m("name","ejercicio_series_"+d+"_"+i),l(4),E("ngModel",e.duracion),m("name","ejercicio_duracion_"+d+"_"+i),l(4),E("ngModel",e.descripcion),m("name","ejercicio_descripcion_"+d+"_"+i),l(4),E("ngModel",e.precauciones),m("name","ejercicio_precauciones_"+d+"_"+i)}}function Wo(s,t){if(s&1&&(n(0,"div",151),x(1,$o,49,21,"div",152),r()),s&2){let e=c().ngIf;l(),m("ngForOf",e.ejercicios)}}function Go(s,t){if(s&1){let e=w();n(0,"div",171)(1,"p",23),a(2,"No hay ejercicios en esta secci\xF3n"),r(),n(3,"button",172),_("click",function(){p(e);let o=c(2).$implicit,d=c(2);return g(d.addEjercicio(o))}),a(4," Agregar primer ejercicio "),r()()}}function Ho(s,t){if(s&1){let e=w();fe(0),n(1,"h5",141),a(2),r(),n(3,"div",142)(4,"div")(5,"label",143),a(6,"Descripci\xF3n"),r(),n(7,"textarea",144),T("ngModelChange",function(o){let d=p(e).ngIf;return k(d.descripcion,o)||(d.descripcion=o),g(o)}),r()(),n(8,"div")(9,"label",143),a(10,"Tiempo Total"),r(),n(11,"input",145),T("ngModelChange",function(o){let d=p(e).ngIf;return k(d.tiempo_total,o)||(d.tiempo_total=o),g(o)}),r()(),n(12,"div")(13,"div",146)(14,"label",143),a(15,"Ejercicios"),r(),n(16,"button",147),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.addEjercicio(o))}),h(),n(17,"svg",148),u(18,"path",32),r(),a(19," Agregar Ejercicio "),r()(),x(20,Wo,2,1,"div",149)(21,Go,5,0,"div",150),r()(),_e()}if(s&2){let e=t.ngIf,i=c().$implicit,o=c(2);l(2),v(" ",o.getSeccionNombre(i)," "),l(5),E("ngModel",e.descripcion),m("name","descripcion_"+i),l(4),E("ngModel",e.tiempo_total),m("name","tiempo_"+i),l(9),m("ngIf",e.ejercicios&&e.ejercicios.length>0),l(),m("ngIf",!e.ejercicios||e.ejercicios.length===0)}}function qo(s,t){if(s&1&&(n(0,"div",140),x(1,Ho,22,7,"ng-container",56),r()),s&2){let e=t.$implicit,i=c(2);l(),m("ngIf",i.getSeccionData(e))}}function Yo(s,t){s&1&&(h(),n(0,"svg",173),u(1,"path",42),r())}function Qo(s,t){if(s&1){let e=w();n(0,"div",84)(1,"div",85)(2,"div",86),_("click",function(){p(e);let o=c();return g(o.closeModal())}),r(),n(3,"div",87)(4,"div",88)(5,"div",89)(6,"div",90),h(),n(7,"svg",91),u(8,"path",76),r()(),y(),n(9,"div",92)(10,"h3",93),a(11),r(),n(12,"div",67)(13,"p",23),a(14),r()()()()(),n(15,"div",94)(16,"form",95),_("ngSubmit",function(){p(e);let o=c();return g(o.saveTerapia())}),n(17,"div",96)(18,"div",97)(19,"div",98)(20,"label",99),a(21," Nombre de la Terapia * "),r(),n(22,"input",100),T("ngModelChange",function(o){p(e);let d=c();return k(d.terapiaForm.nombre,o)||(d.terapiaForm.nombre=o),g(o)}),r()(),n(23,"div",98)(24,"label",101),a(25," Descripci\xF3n "),r(),n(26,"textarea",102),T("ngModelChange",function(o){p(e);let d=c();return k(d.terapiaForm.descripcion,o)||(d.terapiaForm.descripcion=o),g(o)}),r()(),n(27,"div")(28,"label",103),a(29," Tipo de Terapia * "),r(),n(30,"select",104),T("ngModelChange",function(o){p(e);let d=c();return k(d.terapiaForm.tipo,o)||(d.terapiaForm.tipo=o),g(o)}),x(31,Ao,2,2,"option",16),r()(),n(32,"div")(33,"label",105),a(34," \xC1rea de Especializaci\xF3n "),r(),n(35,"select",106),T("ngModelChange",function(o){p(e);let d=c();return k(d.terapiaForm.area_especializacion,o)||(d.terapiaForm.area_especializacion=o),g(o)}),n(36,"option",107),a(37,"Seleccionar \xE1rea"),r(),x(38,Ro,3,4,"option",16),r()(),n(39,"div")(40,"label",108),a(41," Nivel * "),r(),n(42,"select",109),T("ngModelChange",function(o){p(e);let d=c();return k(d.terapiaForm.nivel,o)||(d.terapiaForm.nivel=o),g(o)}),x(43,jo,2,2,"option",16),r()(),n(44,"div")(45,"label",110),a(46," Duraci\xF3n Estimada (minutos) "),r(),n(47,"input",111),T("ngModelChange",function(o){p(e);let d=c();return k(d.terapiaForm.duracion_estimada,o)||(d.terapiaForm.duracion_estimada=o),g(o)}),r()()(),n(48,"div")(49,"label",112),a(50," Objetivo Principal "),r(),n(51,"textarea",113),T("ngModelChange",function(o){p(e);let d=c();return k(d.terapiaForm.objetivo_principal,o)||(d.terapiaForm.objetivo_principal=o),g(o)}),r()(),n(52,"div")(53,"label",114),a(54," Contraindicaciones "),r(),n(55,"textarea",115),T("ngModelChange",function(o){p(e);let d=c();return k(d.terapiaForm.contraindicaciones,o)||(d.terapiaForm.contraindicaciones=o),g(o)}),r()(),n(56,"div")(57,"label",116),a(58," Criterios de Progresi\xF3n "),r(),n(59,"textarea",117),T("ngModelChange",function(o){p(e);let d=c();return k(d.terapiaForm.criterios_progresion,o)||(d.terapiaForm.criterios_progresion=o),g(o)}),r()(),n(60,"div")(61,"label",118),a(62," Tags "),r(),n(63,"div",119)(64,"input",120),_("keydown.enter",function(o){return p(e),c().addTag(o),g(o.preventDefault())}),r(),x(65,Lo,2,1,"div",121),r()(),n(66,"div")(67,"h4",122),a(68,"Secciones de Ejercicios"),r(),n(69,"div",123),x(70,No,8,3,"div",124),r(),x(71,qo,2,1,"div",125),r()()()(),n(72,"div",126)(73,"button",127),_("click",function(){p(e);let o=c();return g(o.saveTerapia())}),x(74,Yo,2,0,"svg",128),a(75),r(),n(76,"button",129),_("click",function(){p(e);let o=c();return g(o.closeModal())}),a(77," Cancelar "),r()()()()()}if(s&2){let e=c();l(11),v(" ",e.modalMode==="create"?"Crear Terapia":"Editar Terapia"," "),l(3),v(" ",e.modalMode==="create"?"Complete la informaci\xF3n para crear una nueva terapia de rehabilitaci\xF3n.":"Modifique la informaci\xF3n de la terapia seleccionada."," "),l(8),E("ngModel",e.terapiaForm.nombre),l(4),E("ngModel",e.terapiaForm.descripcion),l(4),E("ngModel",e.terapiaForm.tipo),l(),m("ngForOf",e.tiposDisponibles),l(4),E("ngModel",e.terapiaForm.area_especializacion),l(3),m("ngForOf",e.areasEspecializacion),l(4),E("ngModel",e.terapiaForm.nivel),l(),m("ngForOf",e.nivelesDisponibles),l(4),E("ngModel",e.terapiaForm.duracion_estimada),l(4),E("ngModel",e.terapiaForm.objetivo_principal),l(4),E("ngModel",e.terapiaForm.contraindicaciones),l(4),E("ngModel",e.terapiaForm.criterios_progresion),l(6),m("ngIf",e.terapiaForm.tags&&e.terapiaForm.tags.length>0),l(5),m("ngForOf",e.seccionesDisponibles),l(),m("ngForOf",e.Array.from(e.seccionesActivas)),l(2),m("disabled",e.loading),l(),m("ngIf",e.loading),l(),v(" ",e.modalMode==="create"?"Crear Terapia":"Guardar Cambios"," "),l(),m("disabled",e.loading)}}function Jo(s,t){if(s&1){let e=w();n(0,"button",174),_("click",function(){p(e);let o=c();return g(o.openCreateModal())}),h(),n(1,"svg",175),u(2,"path",32),r()()}}function Zo(s,t){s&1&&(n(0,"button",189),h(),n(1,"svg",185),u(2,"path",190),r()())}function Xo(s,t){s&1&&(n(0,"div",199)(1,"div",34),h(),n(2,"svg",200),u(3,"path",201),r(),y(),n(4,"div",37)(5,"p",202),a(6,"\xA1Terapia copiada al portapapeles!"),r()()()())}function Ko(s,t){if(s&1){let e=w();n(0,"div")(1,"div",191)(2,"div",192),a(3),r(),n(4,"pre",193),a(5),r()(),x(6,Xo,7,0,"div",194),n(7,"div",195)(8,"button",196),_("click",function(){p(e);let o=c(2);return g(o.copyToClipboard())}),h(),n(9,"svg",31),u(10,"path",186),r(),a(11," Copiar "),r(),y(),n(12,"button",197),_("click",function(){p(e);let o=c(2);return g(o.exportarTerapia(o.selectedViewTerapia))}),h(),n(13,"svg",31),u(14,"path",198),r(),a(15," Descargar "),r()()()}if(s&2){let e=c(2);l(3),v(" ",e.getFileNameSafe(e.selectedViewTerapia.nombre),".txt "),l(2),C(e.getFormattedTerapia(e.selectedViewTerapia)),l(),m("ngIf",e.copySuccess)}}function ea(s,t){if(s&1){let e=w();n(0,"div",84)(1,"div",85)(2,"div",86),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),r(),n(3,"div",176)(4,"div",88)(5,"div",89)(6,"div",177),h(),n(7,"svg",178),u(8,"path",179),r()(),y(),n(9,"div",180)(10,"h3",93),a(11),r(),n(12,"div",181)(13,"p",23),a(14," Vista previa de la terapia "),r(),n(15,"div",182),x(16,Zo,3,0,"button",183),n(17,"button",184),_("click",function(){p(e);let o=c();return g(o.copyToClipboard())}),h(),n(18,"svg",185),u(19,"path",186),r()()()()()()(),y(),n(20,"div",187),x(21,Ko,16,3,"div",56),r(),n(22,"div",126)(23,"button",188),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),a(24," Cerrar "),r()()()()()}if(s&2){let e=c();l(11),v(" ",e.selectedViewTerapia==null?null:e.selectedViewTerapia.nombre," "),l(5),m("ngIf",e.copySuccess),l(5),m("ngIf",e.selectedViewTerapia)}}var st=class s{constructor(t,e){this.terapiasService=t;this.authService=e}terapias=[];filteredTerapias=[];tiposEjercicios=[];loading=!1;error="";showModal=!1;showViewModal=!1;modalMode="create";selectedTerapia=null;selectedViewTerapia=null;copySuccess=!1;Array=Array;terapiaForm={nombre:"",descripcion:"",tipo:"fisica",area_especializacion:"",nivel:"principiante",duracion_estimada:60,objetivo_principal:"",contraindicaciones:"",criterios_progresion:"",tags:[],status:1,ejercicios:{}};seccionesDisponibles=[{key:"calentamiento",nombre:"Calentamiento",descripcion:"Ejercicios de preparaci\xF3n y movilizaci\xF3n"},{key:"fortalecimiento",nombre:"Fortalecimiento",descripcion:"Ejercicios de fortalecimiento muscular"},{key:"equilibrio",nombre:"Equilibrio",descripcion:"Ejercicios de equilibrio y propiocepci\xF3n"},{key:"coordinacion",nombre:"Coordinaci\xF3n",descripcion:"Ejercicios de coordinaci\xF3n motora"},{key:"estiramiento",nombre:"Estiramiento",descripcion:"Ejercicios de flexibilidad y relajaci\xF3n"},{key:"respiracion",nombre:"Respiraci\xF3n",descripcion:"Ejercicios respiratorios y relajaci\xF3n"}];searchTerm="";tipoFilter="all";areaFilter="all";nivelFilter="all";statusFilter="active";seccionesActivas=new Set;tiposDisponibles=[{value:"fisica",label:"Fisioterapia"},{value:"ocupacional",label:"Terapia Ocupacional"},{value:"respiratoria",label:"Respiratoria"},{value:"neurologica",label:"Neurol\xF3gica"},{value:"cardiaca",label:"Card\xEDaca"}];nivelesDisponibles=[{value:"principiante",label:"Principiante"},{value:"intermedio",label:"Intermedio"},{value:"avanzado",label:"Avanzado"}];areasEspecializacion=["hombro","codo","mu\xF1eca","cadera","rodilla","tobillo","columna_cervical","columna_lumbar","core","respiratoria","neurologica","cardiaca","pediatrica","geriatrica"];intensidadesDisponibles=[{value:"muy_baja",label:"Muy Baja"},{value:"baja",label:"Baja"},{value:"moderada",label:"Moderada"},{value:"alta",label:"Alta"},{value:"muy_alta",label:"Muy Alta"}];ngOnInit(){return b(this,null,function*(){yield this.loadTiposEjercicios(),yield this.loadTerapias()})}loadTiposEjercicios(){return b(this,null,function*(){try{this.tiposEjercicios=yield this.terapiasService.getTiposEjerciciosTerapeuticos()}catch(t){console.error("Error cargando tipos de ejercicios:",t),this.tiposEjercicios=[]}})}loadTerapias(){return b(this,null,function*(){try{this.loading=!0,this.terapias=yield this.terapiasService.getTerapias(),this.applyFilters()}catch(t){console.error("Error cargando terapias:",t),this.error="Error al cargar las terapias",this.terapias=[]}finally{this.loading=!1}})}applyFilters(){this.filteredTerapias=this.terapias.filter(t=>{let e=!this.searchTerm||t.nombre.toLowerCase().includes(this.searchTerm.toLowerCase())||t.descripcion?.toLowerCase().includes(this.searchTerm.toLowerCase())||t.area_especializacion?.toLowerCase().includes(this.searchTerm.toLowerCase()),i=this.tipoFilter==="all"||t.tipo===this.tipoFilter,o=this.areaFilter==="all"||t.area_especializacion===this.areaFilter,d=this.nivelFilter==="all"||t.nivel===this.nivelFilter,f=this.statusFilter==="all"||this.statusFilter==="active"&&t.status===1||this.statusFilter==="inactive"&&t.status===0;return e&&i&&o&&d&&f})}clearFilters(){this.searchTerm="",this.tipoFilter="all",this.areaFilter="all",this.nivelFilter="all",this.statusFilter="active",this.applyFilters()}getTipoLabel(t){let e=this.tiposDisponibles.find(i=>i.value===t);return e?e.label:t}getSeccionNombre(t){let e=this.seccionesDisponibles.find(i=>i.key===t);return e?e.nombre:t}getTipoEjercicioNombre(t){let e=this.tiposEjercicios.find(i=>i.nombre===t);return e?e.nombre:t}getIntensidadLabel(t){let e=this.intensidadesDisponibles.find(i=>i.value===t);return e?e.label:t}exportarTerapia(t){let e=this.getFormattedTerapia(t),i=new Blob([e],{type:"text/plain;charset=utf-8"}),o=window.URL.createObjectURL(i),d=document.createElement("a");d.href=o,d.download=`${this.getFileNameSafe(t.nombre)}.txt`,d.click(),window.URL.revokeObjectURL(o),console.log("Terapia exportada:",t.nombre)}openCreateModal(){this.modalMode="create",this.selectedTerapia=null,this.resetForm(),this.showModal=!0}openEditModal(t){this.modalMode="edit",this.selectedTerapia=t,this.terapiaForm=JSON.parse(JSON.stringify(t)),this.seccionesActivas.clear(),this.terapiaForm.ejercicios&&this.seccionesDisponibles.forEach(e=>{this.terapiaForm.ejercicios[e.key]&&this.seccionesActivas.add(e.key)}),this.error="",this.showModal=!0}openViewModal(t){console.log("Abriendo modal de vista para terapia:",t.nombre),this.selectedViewTerapia=t,this.showViewModal=!0}closeModal(){this.showModal=!1,this.selectedTerapia=null,this.error="",this.resetForm()}closeViewModal(){console.log("Cerrando modal de vista"),this.showViewModal=!1,this.selectedViewTerapia=null,this.copySuccess=!1}resetForm(){this.terapiaForm={nombre:"",descripcion:"",tipo:"fisica",area_especializacion:"",nivel:"principiante",duracion_estimada:60,objetivo_principal:"",contraindicaciones:"",criterios_progresion:"",tags:[],status:1,ejercicios:{}},this.seccionesActivas.clear()}toggleSeccion(t){this.seccionesActivas.has(t)?(this.seccionesActivas.delete(t),this.terapiaForm.ejercicios&&delete this.terapiaForm.ejercicios[t]):(this.seccionesActivas.add(t),this.terapiaForm.ejercicios||(this.terapiaForm.ejercicios={}),this.terapiaForm.ejercicios[t]||(this.terapiaForm.ejercicios[t]={descripcion:"",tiempo_total:"",objetivos:[],ejercicios:[]}))}getSeccionData(t){return!this.terapiaForm.ejercicios||!this.terapiaForm.ejercicios[t]?this.seccionesActivas.has(t)?(this.terapiaForm.ejercicios||(this.terapiaForm.ejercicios={}),this.terapiaForm.ejercicios[t]={descripcion:"",tiempo_total:"",objetivos:[],ejercicios:[]},this.terapiaForm.ejercicios[t]):null:this.terapiaForm.ejercicios[t]}updateSeccionData(t,e){this.terapiaForm.ejercicios||(this.terapiaForm.ejercicios={}),this.terapiaForm.ejercicios[t]=e}addEjercicio(t){let e=this.getSeccionData(t);if(!e)return;let i={orden:e.ejercicios.length+1,nombre:"",tipo:"movilidad",repeticiones:10,series:2,duracion:"2:00",descripcion:"",intensidad:"moderada",precauciones:""};e.ejercicios.push(i),this.updateSeccionData(t,e)}removeEjercicio(t,e){let i=this.getSeccionData(t);i&&(i.ejercicios.splice(e,1),i.ejercicios.forEach((o,d)=>{o.orden=d+1}),this.updateSeccionData(t,i))}moveEjercicio(t,e,i){let o=this.getSeccionData(t);if(!o||i<0||i>=o.ejercicios.length)return;let d=o.ejercicios.splice(e,1)[0];o.ejercicios.splice(i,0,d),o.ejercicios.forEach((f,S)=>{f.orden=S+1}),this.updateSeccionData(t,o)}saveTerapia(){return b(this,null,function*(){try{if(this.error="",this.loading=!0,!this.terapiaForm.nombre.trim()){this.error="El nombre es requerido";return}if(this.seccionesActivas.size===0){this.error="Debe activar al menos una secci\xF3n con ejercicios";return}let t=!1;for(let o of this.seccionesActivas){let d=this.getSeccionData(o);if(d&&d.ejercicios.length>0){t=!0;break}}if(!t){this.error="Debe agregar al menos un ejercicio en alguna secci\xF3n";return}let e=ce({},this.terapiaForm),i={};this.seccionesActivas.forEach(o=>{let d=this.getSeccionData(o);d&&d.ejercicios.length>0&&(i[o]=d)}),e.ejercicios=i,this.modalMode==="create"?yield this.terapiasService.createTerapia(e):yield this.terapiasService.updateTerapia(this.selectedTerapia.id,e),yield this.loadTerapias(),this.closeModal()}catch(t){console.error("Error guardando terapia:",t),this.error="Error al guardar la terapia. Intente nuevamente."}finally{this.loading=!1}})}deleteTerapia(t){return b(this,null,function*(){if(confirm(`\xBFEst\xE1 seguro de eliminar la terapia "${t.nombre}"?`))try{this.loading=!0,yield this.terapiasService.deleteTerapia(t.id),yield this.loadTerapias()}catch(e){console.error("Error eliminando terapia:",e),this.error="Error al eliminar la terapia"}finally{this.loading=!1}})}canEditTerapia(){return this.authService.isAdmin()||this.authService.hasProfile(3)}formatDuracion(t){if(!t)return"Sin especificar";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getAreasUnicas(){let t=new Set;return this.terapias.forEach(e=>{e.area_especializacion&&t.add(e.area_especializacion)}),Array.from(t).sort()}getFileNameSafe(t){return t?t.replace(/\s+/g,"_"):"terapia"}copyToClipboard(){return b(this,null,function*(){if(this.selectedViewTerapia)try{let t=this.getFormattedTerapia(this.selectedViewTerapia);yield navigator.clipboard.writeText(t),this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3)}catch(t){console.error("Error al copiar:",t);let e=document.createElement("textarea");e.value=this.getFormattedTerapia(this.selectedViewTerapia),document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy"),this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3)}catch(i){console.error("Error en fallback de copia:",i)}document.body.removeChild(e)}})}getFormattedTerapia(t){if(!t)return"";let e=`${t.nombre}
`;return e+=`${t.descripcion||"Terapia de rehabilitaci\xF3n"}
`,e+=`Nivel: ${t.nivel||"No especificado"} | Duraci\xF3n: ${this.formatDuracion(t.duracion_estimada)}

`,t.objetivo_principal&&(e+=`Objetivo: ${t.objetivo_principal}
`),t.area_especializacion&&(e+=`\xC1rea: ${t.area_especializacion}
`),e+=`
`,this.hasEjercicios(t)?this.getSeccionesConEjercicios(t).forEach(o=>{let d=t.ejercicios[o];if(d&&d.ejercicios&&d.ejercicios.length>0){let f=this.getNombreSeccion(o);e+=`${f.toUpperCase()}
`,d.descripcion&&(e+=`${d.descripcion}
`),d.ejercicios.forEach((S,P)=>{e+=`${P+1}. ${S?.nombre||"Ejercicio sin nombre"}
`,S?.descripcion&&(e+=`   ${S.descripcion}
`),S?.repeticiones&&S?.series&&(e+=`   ${S.series} series x ${S.repeticiones} repeticiones
`),S?.duracion&&(e+=`   Duraci\xF3n: ${S.duracion}
`),S?.precauciones&&(e+=`   \u26A0\uFE0F ${S.precauciones}
`),e+=`
`})}}):e+=`No se han definido ejercicios para esta terapia

`,t.contraindicaciones&&(e+=`CONTRAINDICACIONES
${t.contraindicaciones}

`),t.criterios_progresion&&(e+=`CRITERIOS DE PROGRESI\xD3N
${t.criterios_progresion}
`),e}getNombreSeccion(t){return{calentamiento:"Calentamiento",fortalecimiento:"Fortalecimiento",equilibrio:"Equilibrio",coordinacion:"Coordinaci\xF3n",estiramiento:"Estiramiento",respiracion:"Respiraci\xF3n"}[t]||t.charAt(0).toUpperCase()+t.slice(1)}hasEjercicios(t){return!t||!t.ejercicios?!1:Object.keys(t.ejercicios).some(e=>{let i=t.ejercicios[e];return i&&i.ejercicios&&Array.isArray(i.ejercicios)&&i.ejercicios.length>0})}getTotalEjercicios(t){if(!t||!t.ejercicios)return 0;let e=0;return Object.keys(t.ejercicios).forEach(i=>{let o=t.ejercicios[i];o&&o.ejercicios&&Array.isArray(o.ejercicios)&&(e+=o.ejercicios.length)}),e}getSeccionesConEjercicios(t){return!t||!t.ejercicios?[]:Object.keys(t.ejercicios).filter(e=>{let i=t.ejercicios[e];return i&&i.ejercicios&&Array.isArray(i.ejercicios)&&i.ejercicios.length>0})}addTag(t){let e=t.target.value.trim();e&&!this.terapiaForm.tags?.includes(e)&&(this.terapiaForm.tags||(this.terapiaForm.tags=[]),this.terapiaForm.tags.push(e),t.target.value="")}removeTag(t){this.terapiaForm.tags&&this.terapiaForm.tags.splice(t,1)}static \u0275fac=function(e){return new(e||s)(O(Pe),O(L))};static \u0275cmp=D({type:s,selectors:[["app-terapias"]],standalone:!1,decls:50,vars:17,consts:[[1,"container","mx-auto","px-4","py-6"],[1,"mb-6"],[1,"sm:flex","sm:items-center","sm:justify-between"],[1,"text-2xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-700"],[1,"mt-4","sm:mt-0"],["class","hidden md:inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],["class","mb-6 bg-red-50 border border-red-200 rounded-md p-4",4,"ngIf"],[1,"mb-6","bg-white","shadow","rounded-lg","p-4"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-2","lg:grid-cols-5"],[1,"lg:col-span-2"],["for","search",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","search","placeholder","Nombre, descripci\xF3n o \xE1rea...",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","input","ngModel"],["for","tipo-filter",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","tipo-filter",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","change","ngModel"],["value","all"],[3,"value",4,"ngFor","ngForOf"],["for","area-filter",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","area-filter",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","change","ngModel"],["for","nivel-filter",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","nivel-filter",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","change","ngModel"],[1,"mt-4","flex","justify-between","items-center"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"text-sm","text-gray-500"],[1,"bg-white","shadow","overflow-hidden","sm:rounded-md"],["class","p-8 text-center",4,"ngIf"],["class","divide-y divide-gray-200",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],["class","md:hidden fixed bottom-6 right-6 w-14 h-14 bg-red-600 text-white rounded-full shadow-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 z-40","title","Crear nueva terapia",3,"click",4,"ngIf"],[1,"hidden","md:inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"mb-6","bg-red-50","border","border-red-200","rounded-md","p-4"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[3,"value"],[1,"p-8","text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"animate-spin","h-8","w-8","text-red-600","mx-auto"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"mt-2","text-sm","text-gray-500"],[1,"divide-y","divide-gray-200"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50"],[1,"px-4","py-4","sm:px-6"],[1,"flex","items-center","justify-between"],[1,"flex-1","min-w-0"],[1,"flex","items-center","space-x-3"],[1,"flex-1"],[1,"text-lg","font-medium","text-gray-900","truncate"],["class","text-sm text-gray-500 mt-1",4,"ngIf"],[1,"mt-2","flex","items-center","space-x-4","text-sm","text-gray-500"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[4,"ngIf"],[1,"capitalize"],["class","mt-2",4,"ngIf"],[1,"ml-4","flex-shrink-0","flex","items-center","space-x-2"],["title","Ver terapia",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["class","text-indigo-600 hover:text-indigo-900 p-2 rounded-full hover:bg-indigo-50","title","Editar terapia",3,"click",4,"ngIf"],["class","text-red-600 hover:text-red-900 p-2 rounded-full hover:bg-red-50","title","Eliminar terapia",3,"click",4,"ngIf"],[1,"text-sm","text-gray-500","mt-1"],[1,"mt-2"],["class","inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded mr-1",4,"ngFor","ngForOf"],[1,"inline-block","bg-gray-100","text-gray-800","text-xs","px-2","py-1","rounded","mr-1"],["title","Editar terapia",1,"text-indigo-600","hover:text-indigo-900","p-2","rounded-full","hover:bg-indigo-50",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Eliminar terapia",1,"text-red-600","hover:text-red-900","p-2","rounded-full","hover:bg-red-50",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-6xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"bg-white","px-4","pb-4","sm:px-6","sm:pb-6","max-h-96","overflow-y-auto"],[3,"ngSubmit"],[1,"space-y-6"],[1,"grid","grid-cols-1","gap-6","sm:grid-cols-2"],[1,"sm:col-span-2"],["for","nombre",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","nombre","name","nombre","required","","placeholder","Ej: Rehabilitaci\xF3n de hombro post-cirug\xEDa",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","descripcion",1,"block","text-sm","font-medium","text-gray-700"],["id","descripcion","name","descripcion","rows","3","placeholder","Descripci\xF3n detallada de la terapia...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","tipo",1,"block","text-sm","font-medium","text-gray-700"],["id","tipo","name","tipo","required","",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","area_especializacion",1,"block","text-sm","font-medium","text-gray-700"],["id","area_especializacion","name","area_especializacion",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","ngModel"],["value",""],["for","nivel",1,"block","text-sm","font-medium","text-gray-700"],["id","nivel","name","nivel","required","",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","duracion_estimada",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","duracion_estimada","name","duracion_estimada","min","1","max","300",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","objetivo_principal",1,"block","text-sm","font-medium","text-gray-700"],["id","objetivo_principal","name","objetivo_principal","rows","2","placeholder","Objetivo principal de la terapia...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","contraindicaciones",1,"block","text-sm","font-medium","text-gray-700"],["id","contraindicaciones","name","contraindicaciones","rows","2","placeholder","Contraindicaciones y precauciones...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","criterios_progresion",1,"block","text-sm","font-medium","text-gray-700"],["id","criterios_progresion","name","criterios_progresion","rows","2","placeholder","Criterios para avanzar en la terapia...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","ngModel"],["for","tags",1,"block","text-sm","font-medium","text-gray-700"],[1,"mt-1"],["type","text","id","tags","placeholder","Presione Enter para agregar tags...",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"keydown.enter"],["class","mt-2 flex flex-wrap gap-2",4,"ngIf"],[1,"text-lg","font-medium","text-gray-900","mb-4"],[1,"grid","grid-cols-1","gap-4","sm:grid-cols-2","lg:grid-cols-3","mb-6"],["class","relative",4,"ngFor","ngForOf"],["class","bg-gray-50 rounded-lg p-4 mb-4",4,"ngFor","ngForOf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","animate-spin -ml-1 mr-3 h-5 w-5 text-white","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:mt-0","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50",3,"click","disabled"],[1,"mt-2","flex","flex-wrap","gap-2"],["class","inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",4,"ngFor","ngForOf"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-800"],["type","button",1,"flex-shrink-0","ml-1","h-4","w-4","rounded-full","inline-flex","items-center","justify-center","text-gray-400","hover:bg-gray-200","hover:text-gray-500",3,"click"],["stroke","currentColor","fill","none","viewBox","0 0 8 8",1,"h-2","w-2"],["stroke-linecap","round","d","m1 1 6 6m0-6-6 6"],[1,"relative"],[1,"flex","items-start"],["type","checkbox",1,"mt-1","h-4","w-4","text-red-600","focus:ring-red-500","border-gray-300","rounded",3,"change","checked"],[1,"text-sm","font-medium","text-gray-900"],[1,"bg-gray-50","rounded-lg","p-4","mb-4"],[1,"text-md","font-medium","text-gray-900","mb-3"],[1,"space-y-4"],[1,"block","text-sm","font-medium","text-gray-700"],["rows","2","placeholder","Descripci\xF3n de esta secci\xF3n...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","ngModel","name"],["type","text","placeholder","Ej: 15:00, 10-15 min",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","sm:text-sm",3,"ngModelChange","ngModel","name"],[1,"flex","justify-between","items-center","mb-3"],["type","button",1,"inline-flex","items-center","px-2","py-1","border","border-transparent","text-xs","font-medium","rounded","text-red-700","bg-red-100","hover:bg-red-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-3","w-3","mr-1"],["class","space-y-3",4,"ngIf"],["class","text-center py-4 bg-gray-100 rounded-lg",4,"ngIf"],[1,"space-y-3"],["class","bg-white border border-gray-200 rounded-lg p-3",4,"ngFor","ngForOf"],[1,"bg-white","border","border-gray-200","rounded-lg","p-3"],[1,"flex","justify-between","items-start","mb-3"],[1,"text-sm","font-medium","text-gray-500"],[1,"flex","space-x-1"],["type","button","title","Mover arriba",1,"text-gray-400","hover:text-gray-600","disabled:opacity-30",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 15l7-7 7 7"],["type","button","title","Mover abajo",1,"text-gray-400","hover:text-gray-600","disabled:opacity-30",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["type","button","title","Eliminar ejercicio",1,"text-red-400","hover:text-red-600",3,"click"],[1,"grid","grid-cols-1","gap-3","sm:grid-cols-2"],[1,"block","text-xs","font-medium","text-gray-700"],["type","text","required","","placeholder","Nombre del ejercicio",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm",3,"ngModelChange","ngModel","name"],[1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm",3,"ngModelChange","ngModel","name"],["type","number","min","1",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm",3,"ngModelChange","ngModel","name"],["type","text","placeholder","Ej: 2:00, 30 seg",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm",3,"ngModelChange","ngModel","name"],["rows","2","placeholder","Descripci\xF3n del ejercicio...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm",3,"ngModelChange","ngModel","name"],["rows","2","placeholder","Precauciones espec\xEDficas...",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-red-500","focus:ring-red-500","text-sm",3,"ngModelChange","ngModel","name"],[1,"text-center","py-4","bg-gray-100","rounded-lg"],["type","button",1,"mt-2","text-red-600","hover:text-red-800","text-sm","font-medium",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["title","Crear nueva terapia",1,"md:hidden","fixed","bottom-6","right-6","w-14","h-14","bg-red-600","text-white","rounded-full","shadow-lg","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-500","focus:ring-offset-2","transition-all","duration-200","z-40",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","mx-auto"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-5xl","sm:w-full"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","flex-1"],[1,"mt-1","flex","items-center","justify-between"],[1,"flex","items-center","space-x-2"],["class","text-green-500","title","\xA1Copiado!",4,"ngIf"],["title","Copiar terapia",1,"text-gray-400","hover:text-gray-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"bg-white","px-4","pb-4","sm:px-6","sm:pb-6","max-h-[70vh]","overflow-y-auto"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],["title","\xA1Copiado!",1,"text-green-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"bg-black","rounded-lg","p-4","font-mono","text-sm"],[1,"text-gray-400","text-xs","mb-2"],[1,"whitespace-pre-wrap","text-green-400"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],[1,"inline-flex","items-center","px-3","py-2","border","border-transparent","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-green-700"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),a(5,"Gesti\xF3n de Terapias"),r(),n(6,"p",4),a(7," Administra las terapias de rehabilitaci\xF3n disponibles en el sistema. "),r()(),n(8,"div",5),x(9,xo,4,0,"button",6),r()()(),x(10,ho,7,1,"div",7),n(11,"div",8)(12,"div",9)(13,"div",10)(14,"label",11),a(15,"Buscar"),r(),n(16,"input",12),T("ngModelChange",function(d){return k(i.searchTerm,d)||(i.searchTerm=d),d}),_("input",function(){return i.applyFilters()}),r()(),n(17,"div")(18,"label",13),a(19,"Tipo"),r(),n(20,"select",14),T("ngModelChange",function(d){return k(i.tipoFilter,d)||(i.tipoFilter=d),d}),_("change",function(){return i.applyFilters()}),n(21,"option",15),a(22,"Todos los tipos"),r(),x(23,vo,2,2,"option",16),r()(),n(24,"div")(25,"label",17),a(26,"\xC1rea"),r(),n(27,"select",18),T("ngModelChange",function(d){return k(i.areaFilter,d)||(i.areaFilter=d),d}),_("change",function(){return i.applyFilters()}),n(28,"option",15),a(29,"Todas las \xE1reas"),r(),x(30,bo,3,4,"option",16),r()(),n(31,"div")(32,"label",19),a(33,"Nivel"),r(),n(34,"select",20),T("ngModelChange",function(d){return k(i.nivelFilter,d)||(i.nivelFilter=d),d}),_("change",function(){return i.applyFilters()}),n(35,"option",15),a(36,"Todos los niveles"),r(),x(37,wo,2,2,"option",16),r()()(),n(38,"div",21)(39,"button",22),_("click",function(){return i.clearFilters()}),a(40," Limpiar filtros "),r(),n(41,"span",23),a(42),r()()(),n(43,"div",24),x(44,yo,5,0,"div",25)(45,Oo,2,1,"ul",26)(46,Do,10,3,"div",27),r()(),x(47,Qo,78,21,"div",28)(48,Jo,3,0,"button",29)(49,ea,25,3,"div",28)),e&2&&(l(9),m("ngIf",i.canEditTerapia()),l(),m("ngIf",i.error),l(6),E("ngModel",i.searchTerm),l(4),E("ngModel",i.tipoFilter),l(3),m("ngForOf",i.tiposDisponibles),l(4),E("ngModel",i.areaFilter),l(3),m("ngForOf",i.getAreasUnicas()),l(4),E("ngModel",i.nivelFilter),l(3),m("ngForOf",i.nivelesDisponibles),l(5),N(" ",i.filteredTerapias.length," de ",i.terapias.length," terapias "),l(2),m("ngIf",i.loading),l(),m("ngIf",!i.loading&&i.filteredTerapias.length>0),l(),m("ngIf",!i.loading&&i.filteredTerapias.length===0),l(),m("ngIf",i.showModal),l(),m("ngIf",!i.showModal&&!i.showViewModal&&i.canEditTerapia()),l(),m("ngIf",i.showViewModal))},dependencies:[$,z,R,te,ne,re,W,Ee,ie,G,ee,ve,Te,ke,H,se,Ge],encapsulation:2})};var ta=(s,t,e,i)=>({"bg-green-100 text-green-800":s,"bg-blue-100 text-blue-800":t,"bg-yellow-100 text-yellow-800":e,"bg-red-100 text-red-800":i}),ia=(s,t,e,i,o)=>({"bg-gray-100 text-gray-800":s,"bg-yellow-100 text-yellow-800":t,"bg-green-100 text-green-800":e,"bg-red-100 text-red-800":i,"bg-purple-100 text-purple-800":o});function na(s,t){if(s&1){let e=w();n(0,"button",32),_("click",function(){p(e);let o=c();return g(o.openAsignarModal())}),h(),n(1,"svg",33),u(2,"path",34),r(),a(3," Asignar Terapia "),r()}}function ra(s,t){if(s&1&&(n(0,"div",35)(1,"div",36),h(),n(2,"svg",37),u(3,"path",38),r(),y(),n(4,"div",39)(5,"p",40),a(6),r()()()()),s&2){let e=c();l(6),C(e.error)}}function oa(s,t){s&1&&(n(0,"div",41),u(1,"div",42),r())}function aa(s,t){if(s&1&&(n(0,"div",75),a(1),r()),s&2){let e=c().$implicit;l(),v(" ",e.area_especializacion," ")}}function sa(s,t){if(s&1&&(n(0,"div",62),a(1),r()),s&2){let e=c().$implicit;l(),v(" ",e.terapeuta_nombre," ")}}function la(s,t){if(s&1){let e=w();n(0,"button",76),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.cancelarAsignacion(o.asignacion_id))}),h(),n(1,"svg",71),u(2,"path",77),r()()}}function da(s,t){if(s&1){let e=w();n(0,"tr",53)(1,"td",54)(2,"div")(3,"div",55),a(4),r(),n(5,"div",56),a(6),he(7,"titlecase"),r(),x(8,aa,2,1,"div",57),r()(),n(9,"td",54)(10,"div",58),h(),n(11,"svg",59),u(12,"path",60),r(),y(),n(13,"span",55),a(14),r(),n(15,"span",61),a(16,"usuarios"),r()(),n(17,"div",62),a(18),he(19,"titlecase"),r()(),n(20,"td",63)(21,"div"),a(22),r(),n(23,"div",64),a(24),r()(),n(25,"td",63)(26,"div"),a(27),r(),n(28,"div",64),a(29),r(),x(30,sa,2,1,"div",65),r(),n(31,"td",54)(32,"span",66),u(33,"i"),a(34),r()(),n(35,"td",54)(36,"div",67),a(37),r(),n(38,"div",56),a(39),r()(),n(40,"td",68)(41,"div",69)(42,"button",70),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.openVerModal(o))}),h(),n(43,"svg",71),u(44,"path",72)(45,"path",73),r()(),x(46,la,3,0,"button",74),r()()()}if(s&2){let e=t.$implicit,i=c(2);l(4),C(e.terapia_nombre),l(2),C(Se(7,17,e.terapia_tipo)),l(2),m("ngIf",e.area_especializacion),l(6),C(e.usuarios_count),l(4),v(" ",Se(19,19,e.tipo_asignacion)," "),l(4),C(i.formatDate(e.fecha_inicio_programada)),l(2),C(i.formatDate(e.fecha_fin_programada)),l(3),v("",e.sesiones_por_semana,"/semana"),l(2),v("",i.formatDuracion(e.duracion_sesion),"/sesi\xF3n"),l(),m("ngIf",e.terapeuta_nombre),l(2),m("ngClass",xe(21,ta,e.estado_asignacion==="activa",e.estado_asignacion==="completada",e.estado_asignacion==="pausada",e.estado_asignacion==="cancelada")),l(),A(i.getEstadoIcon(e.estado_asignacion)+" mr-1"),l(),v(" ",e.estado_asignacion," "),l(3),C(e.asignado_por_nombre),l(2),C(i.formatDate(e.fecha_asignacion)),l(7),m("ngIf",e.estado_asignacion==="activa"&&i.canAssignTerapias())}}function ca(s,t){s&1&&(fe(0),a(1," No se han creado asignaciones a\xFAn. "),_e())}function ma(s,t){s&1&&a(0," No se encontraron asignaciones con los filtros aplicados. ")}function ua(s,t){if(s&1){let e=w();n(0,"button",87),_("click",function(){p(e);let o=c(3);return g(o.openAsignarModal())}),a(1," Crear primera asignaci\xF3n "),r()}}function pa(s,t){if(s&1){let e=w();n(0,"button",88),_("click",function(){p(e);let o=c(3);return g(o.clearFilters())}),a(1," Limpiar filtros "),r()}}function ga(s,t){if(s&1&&(n(0,"div",78),h(),n(1,"svg",79),u(2,"path",80),r(),y(),n(3,"h3",81),a(4,"No hay asignaciones"),r(),n(5,"p",82),x(6,ca,2,0,"ng-container",83)(7,ma,1,0,"ng-template",null,0,K),r(),n(9,"div",84),x(10,ua,2,0,"button",85)(11,pa,2,0,"button",86),r()()),s&2){let e=Y(8),i=c(2);l(6),m("ngIf",i.asignaciones.length===0)("ngIfElse",e),l(4),m("ngIf",i.asignaciones.length===0&&i.canAssignTerapias()),l(),m("ngIf",i.asignaciones.length>0)}}function fa(s,t){if(s&1&&(n(0,"div",43)(1,"div",44)(2,"h3",45),a(3),r()(),n(4,"div",46)(5,"table",47)(6,"thead",48)(7,"tr")(8,"th",49),a(9," Terapia "),r(),n(10,"th",49),a(11," Usuarios "),r(),n(12,"th",49),a(13," Fechas "),r(),n(14,"th",49),a(15," Configuraci\xF3n "),r(),n(16,"th",49),a(17," Estado "),r(),n(18,"th",49),a(19," Asignado por "),r(),n(20,"th",49),a(21," Acciones "),r()()(),n(22,"tbody",50),x(23,da,47,26,"tr",51),r()(),x(24,ga,12,4,"div",52),r()()),s&2){let e=c();l(3),v(" Asignaciones Realizadas (",e.filteredAsignaciones.length,") "),l(20),m("ngForOf",e.filteredAsignaciones)("ngForTrackBy",e.trackByAsignacionId),l(),m("ngIf",e.filteredAsignaciones.length===0)}}function _a(s,t){if(s&1&&(n(0,"option",109),a(1),he(2,"titlecase"),r()),s&2){let e=t.$implicit;m("value",e.id),l(),St(" ",e.nombre," - ",Se(2,4,e.tipo)," (",e.nivel,") ")}}function xa(s,t){if(s&1&&(n(0,"option",109),a(1),r()),s&2){let e=t.$implicit;m("value",e.id),l(),v(" ",e.full_name," ")}}function ha(s,t){if(s&1){let e=w();n(0,"div")(1,"label",15),a(2," Objetivos Grupales "),r(),n(3,"textarea",129),T("ngModelChange",function(o){p(e);let d=c(2);return k(d.asignacionForm.objetivos_grupales,o)||(d.asignacionForm.objetivos_grupales=o),g(o)}),r()()}if(s&2){let e=c(2);l(3),E("ngModel",e.asignacionForm.objetivos_grupales)}}function va(s,t){if(s&1){let e=w();n(0,"label",130)(1,"input",131),_("change",function(){let o=p(e).$implicit,d=c(2);return g(d.toggleUsuario(o.id))}),r(),n(2,"div",132)(3,"div",55),a(4),r(),n(5,"div",133),a(6),r()()()}if(s&2){let e=t.$implicit,i=c(2);F("bg-red-50",i.isUsuarioSelected(e.id)),l(),m("checked",i.isUsuarioSelected(e.id)),l(3),C(e.full_name),l(2),v("@",e.username,"")}}function ba(s,t){s&1&&(n(0,"span"),a(1," usuario seleccionado"),r())}function wa(s,t){s&1&&a(0," usuarios seleccionados")}function ya(s,t){if(s&1&&(n(0,"div",134)(1,"div",36),h(),n(2,"svg",37),u(3,"path",38),r(),y(),n(4,"div",39)(5,"p",40),a(6),r()()()()),s&2){let e=c(2);l(6),C(e.error)}}function Ca(s,t){s&1&&(h(),n(0,"svg",135),u(1,"path",10),r())}function Sa(s,t){if(s&1){let e=w();n(0,"div",89)(1,"div",90)(2,"div",91),_("click",function(){p(e);let o=c();return g(o.closeAsignarModal())}),r(),n(3,"span",92),a(4,"\u200B"),r(),n(5,"div",93)(6,"div",94)(7,"div",95)(8,"div",96),h(),n(9,"svg",97),u(10,"path",80),r()(),y(),n(11,"div",98)(12,"h3",45),a(13," Asignar Terapia a Usuarios "),r(),n(14,"div",99)(15,"p",56),a(16," Selecciona una terapia y los usuarios a los que deseas asignarla. "),r()()()()(),n(17,"div",100)(18,"form",101)(19,"div")(20,"label",15),a(21," Terapia "),n(22,"span",102),a(23,"*"),r()(),n(24,"select",103),T("ngModelChange",function(o){p(e);let d=c();return k(d.asignacionForm.id_terapia,o)||(d.asignacionForm.id_terapia=o),g(o)}),n(25,"option",104),a(26,"Selecciona una terapia"),r(),x(27,_a,3,6,"option",105),r()(),n(28,"div",106)(29,"div")(30,"label",15),a(31," Tipo de Asignaci\xF3n "),r(),n(32,"select",107),T("ngModelChange",function(o){p(e);let d=c();return k(d.asignacionForm.tipo_asignacion,o)||(d.asignacionForm.tipo_asignacion=o),g(o)}),n(33,"option",23),a(34,"Individual"),r(),n(35,"option",24),a(36,"Grupal"),r()()(),n(37,"div")(38,"label",15),a(39," Terapeuta Responsable "),r(),n(40,"select",108),T("ngModelChange",function(o){p(e);let d=c();return k(d.asignacionForm.terapeuta_responsable,o)||(d.asignacionForm.terapeuta_responsable=o),g(o)}),n(41,"option",109),a(42,"Sin asignar"),r(),x(43,xa,2,2,"option",110),r()()(),n(44,"div",106)(45,"div")(46,"label",15),a(47," Fecha de Inicio "),n(48,"span",102),a(49,"*"),r()(),n(50,"input",111),T("ngModelChange",function(o){p(e);let d=c();return k(d.asignacionForm.fecha_inicio,o)||(d.asignacionForm.fecha_inicio=o),g(o)}),r()(),n(51,"div")(52,"label",15),a(53," Fecha de Fin "),n(54,"span",102),a(55,"*"),r()(),n(56,"input",112),T("ngModelChange",function(o){p(e);let d=c();return k(d.asignacionForm.fecha_fin,o)||(d.asignacionForm.fecha_fin=o),g(o)}),r()()(),n(57,"div",106)(58,"div")(59,"label",15),a(60," Sesiones por Semana "),r(),n(61,"input",113),T("ngModelChange",function(o){p(e);let d=c();return k(d.asignacionForm.sesiones_por_semana,o)||(d.asignacionForm.sesiones_por_semana=o),g(o)}),r()(),n(62,"div")(63,"label",15),a(64," Duraci\xF3n por Sesi\xF3n (minutos) "),r(),n(65,"input",114),T("ngModelChange",function(o){p(e);let d=c();return k(d.asignacionForm.duracion_sesion,o)||(d.asignacionForm.duracion_sesion=o),g(o)}),r()()(),n(66,"div")(67,"label",15),a(68," Notas (Opcional) "),r(),n(69,"textarea",115),T("ngModelChange",function(o){p(e);let d=c();return k(d.asignacionForm.notas,o)||(d.asignacionForm.notas=o),g(o)}),r()(),x(70,ha,4,1,"div",116),n(71,"div")(72,"div",117)(73,"label",118),a(74," Usuarios "),n(75,"span",102),a(76,"*"),r()(),n(77,"div",7)(78,"button",119),_("click",function(){p(e);let o=c();return g(o.selectAllUsuarios())}),a(79," Seleccionar todos "),r(),n(80,"button",120),_("click",function(){p(e);let o=c();return g(o.clearAllUsuarios())}),a(81," Limpiar selecci\xF3n "),r()()(),n(82,"div",121)(83,"div",122),x(84,va,7,5,"label",123),r()(),n(85,"div",6)(86,"span"),a(87),r(),x(88,ba,2,0,"span",83)(89,wa,1,0,"ng-template",null,1,K),r()()(),x(91,ya,7,1,"div",124),r(),n(92,"div",125)(93,"button",126),_("click",function(){p(e);let o=c();return g(o.asignarTerapia())}),x(94,Ca,2,0,"svg",127),a(95," Asignar Terapia "),r(),n(96,"button",128),_("click",function(){p(e);let o=c();return g(o.closeAsignarModal())}),a(97," Cancelar "),r()()()()()}if(s&2){let e=Y(90),i=c();l(24),E("ngModel",i.asignacionForm.id_terapia),l(3),m("ngForOf",i.terapias)("ngForTrackBy",i.trackByTerapiaId),l(5),E("ngModel",i.asignacionForm.tipo_asignacion),l(8),E("ngModel",i.asignacionForm.terapeuta_responsable),l(),m("value",void 0),l(2),m("ngForOf",i.terapeutas),l(7),E("ngModel",i.asignacionForm.fecha_inicio),l(6),E("ngModel",i.asignacionForm.fecha_fin),l(5),E("ngModel",i.asignacionForm.sesiones_por_semana),l(4),E("ngModel",i.asignacionForm.duracion_sesion),l(4),E("ngModel",i.asignacionForm.notas),l(),m("ngIf",i.asignacionForm.tipo_asignacion==="grupal"),l(14),m("ngForOf",i.usuarios)("ngForTrackBy",i.trackByUserId),l(3),C(i.asignacionForm.usuarios_seleccionados.length),l(),m("ngIf",i.asignacionForm.usuarios_seleccionados.length===1)("ngIfElse",e),l(3),m("ngIf",i.error),l(2),m("disabled",i.loading||!i.asignacionForm.id_terapia||i.asignacionForm.usuarios_seleccionados.length===0),l(),m("ngIf",i.loading),l(2),m("disabled",i.loading)}}function Ma(s,t){if(s&1&&(n(0,"div",133),a(1),r()),s&2){let e=c(2);l(),v(" Terapeuta: ",e.selectedAsignacion==null?null:e.selectedAsignacion.terapeuta_nombre," ")}}function Ea(s,t){if(s&1){let e=w();n(0,"div",99)(1,"input",160),_("input",function(o){p(e);let d=c().$implicit,f=c(2);return g(f.actualizarProgreso(d.seguimiento_id,o))}),r()()}if(s&2){let e=c().$implicit;l(),m("value",e.progreso)}}function ka(s,t){if(s&1&&(n(0,"div")(1,"strong"),a(2,"Inicio:"),r(),a(3),r()),s&2){let e=c().$implicit,i=c(2);l(3),v(" ",i.formatDate(e.fecha_inicio_real)," ")}}function Ta(s,t){if(s&1&&(n(0,"div")(1,"strong"),a(2,"Fin:"),r(),a(3),r()),s&2){let e=c().$implicit,i=c(2);l(3),v(" ",i.formatDate(e.fecha_fin_real)," ")}}function Pa(s,t){s&1&&(n(0,"div",64),a(1," Sin fechas registradas "),r())}function Ia(s,t){if(s&1){let e=w();n(0,"button",161),_("click",function(){p(e);let o=c().$implicit,d=c(2);return g(d.editarNotasIndividuales(o))}),h(),n(1,"svg",71),u(2,"path",162),r()()}}function Oa(s,t){if(s&1&&(n(0,"tr",53)(1,"td",54)(2,"div",58)(3,"div",149)(4,"span",150),a(5),r()(),n(6,"div")(7,"div",55),a(8),r(),n(9,"div",56),a(10),r()()()(),n(11,"td",54)(12,"div",58)(13,"div",151),u(14,"div",152),r(),n(15,"span",55),a(16),r()(),x(17,Ea,2,1,"div",153),r(),n(18,"td",54)(19,"span",66),a(20),r()(),n(21,"td",63)(22,"div"),a(23),r(),n(24,"div",133),a(25),r()(),n(26,"td",54)(27,"div",58)(28,"div",154),u(29,"div",155),r(),n(30,"span",55),a(31),r()()(),n(32,"td",63),x(33,ka,4,1,"div",116)(34,Ta,4,1,"div",116)(35,Pa,2,0,"div",156),r(),n(36,"td",157)(37,"div",158),a(38),r()(),n(39,"td",68)(40,"div",69),x(41,Ia,3,0,"button",159),r()()()),s&2){let e=t.$implicit,i=c(2);l(5),v(" ",(e.full_name||"U").charAt(0).toUpperCase()," "),l(3),C(e.full_name),l(2),v("@",e.username,""),l(4),X("width",e.progreso,"%"),l(2),v("",e.progreso,"%"),l(),m("ngIf",i.canAssignTerapias()),l(2),m("ngClass",De(20,ia,e.estado_individual==="pendiente",e.estado_individual==="en_progreso",e.estado_individual==="completada",e.estado_individual==="cancelada"||e.estado_individual==="abandonada",e.estado_individual==="pausada")),l(),v(" ",e.estado_individual," "),l(3),N("",e.sesiones_completadas||0," / ",e.sesiones_programadas||0,""),l(2),v(" ",e.sesiones_programadas>0?i.Math.round((e.sesiones_completadas||0)/e.sesiones_programadas*100):0,"% completado "),l(4),X("width",e.adherencia_porcentaje||0,"%"),l(2),v("",e.adherencia_porcentaje||0,"%"),l(2),m("ngIf",e.fecha_inicio_real),l(),m("ngIf",e.fecha_fin_real),l(),m("ngIf",!e.fecha_inicio_real&&!e.fecha_fin_real),l(3),v(" ",e.notas_individuales||"-"," "),l(3),m("ngIf",i.canAssignTerapias())}}function Va(s,t){s&1&&(n(0,"div",163),h(),n(1,"svg",164),u(2,"path",165),r(),y(),n(3,"h3",81),a(4,"Sin seguimiento disponible"),r(),n(5,"p",82),a(6," No se encontraron datos de seguimiento para esta asignaci\xF3n. "),r()())}function Fa(s,t){if(s&1&&(n(0,"div",166)(1,"h4",167),a(2,"Resumen del Progreso"),r(),n(3,"div",168)(4,"div")(5,"div",169),a(6),r(),n(7,"div",133),a(8,"Pendientes"),r()(),n(9,"div")(10,"div",170),a(11),r(),n(12,"div",133),a(13,"En Progreso"),r()(),n(14,"div")(15,"div",171),a(16),r(),n(17,"div",133),a(18,"Completadas"),r()(),n(19,"div")(20,"div",172),a(21),r(),n(22,"div",133),a(23,"Progreso Promedio"),r()(),n(24,"div")(25,"div",173),a(26),r(),n(27,"div",133),a(28,"Adherencia Promedio"),r()()()()),s&2){let e=c(2);l(6),v(" ",e.getEstadisticasProgreso().pendientes," "),l(5),v(" ",e.getEstadisticasProgreso().enProgreso," "),l(5),v(" ",e.getEstadisticasProgreso().completadas," "),l(5),v(" ",e.getEstadisticasProgreso().promedioProgreso,"% "),l(5),v(" ",e.getEstadisticasProgreso().promedioAdherencia,"% ")}}function Da(s,t){if(s&1){let e=w();n(0,"div",89)(1,"div",90)(2,"div",91),_("click",function(){p(e);let o=c();return g(o.closeVerModal())}),r(),n(3,"span",92),a(4,"\u200B"),r(),n(5,"div",136)(6,"div",94)(7,"div",95)(8,"div",137),h(),n(9,"svg",138),u(10,"path",139),r()(),y(),n(11,"div",98)(12,"h3",45),a(13),r(),n(14,"div",99)(15,"p",56),a(16," Progreso individual de cada usuario asignado "),r()()()()(),n(17,"div",140)(18,"div",141)(19,"div",142)(20,"div")(21,"span",143),a(22,"Per\xEDodo:"),r(),n(23,"div",144),a(24),r()(),n(25,"div")(26,"span",143),a(27,"Total usuarios:"),r(),n(28,"div",144),a(29),r()(),n(30,"div")(31,"span",143),a(32,"Configuraci\xF3n:"),r(),n(33,"div",144),a(34),r()(),n(35,"div")(36,"span",143),a(37,"Asignado por:"),r(),n(38,"div",144),a(39),r(),x(40,Ma,2,1,"div",145),r()()(),n(41,"div",46)(42,"table",47)(43,"thead",48)(44,"tr")(45,"th",49),a(46," Usuario "),r(),n(47,"th",49),a(48," Progreso "),r(),n(49,"th",49),a(50," Estado "),r(),n(51,"th",49),a(52," Sesiones "),r(),n(53,"th",49),a(54," Adherencia "),r(),n(55,"th",49),a(56," Fechas Reales "),r(),n(57,"th",49),a(58," Notas "),r(),n(59,"th",49),a(60," Acciones "),r()()(),n(61,"tbody",50),x(62,Oa,42,26,"tr",51),r()(),x(63,Va,7,0,"div",146),r(),x(64,Fa,29,5,"div",147),r(),n(65,"div",125)(66,"button",148),_("click",function(){p(e);let o=c();return g(o.closeVerModal())}),a(67," Cerrar "),r()()()()()}if(s&2){let e=c();l(13),v(" Seguimiento: ",e.selectedAsignacion==null?null:e.selectedAsignacion.terapia_nombre," "),l(11),N(" ",e.formatDate((e.selectedAsignacion==null?null:e.selectedAsignacion.fecha_inicio_programada)||"")," - ",e.formatDate((e.selectedAsignacion==null?null:e.selectedAsignacion.fecha_fin_programada)||"")," "),l(5),C(e.selectedAsignacion==null?null:e.selectedAsignacion.usuarios_count),l(5),N(" ",e.selectedAsignacion==null?null:e.selectedAsignacion.sesiones_por_semana,"/sem - ",e.formatDuracion(e.selectedAsignacion==null?null:e.selectedAsignacion.duracion_sesion)," "),l(5),C(e.selectedAsignacion==null?null:e.selectedAsignacion.asignado_por_nombre),l(),m("ngIf",e.selectedAsignacion==null?null:e.selectedAsignacion.terapeuta_nombre),l(22),m("ngForOf",e.seguimientoDetalle)("ngForTrackBy",e.trackByUserId),l(),m("ngIf",e.seguimientoDetalle.length===0),l(),m("ngIf",e.seguimientoDetalle.length>0)}}function Aa(s,t){if(s&1){let e=w();n(0,"button",174),_("click",function(){p(e);let o=c();return g(o.openAsignarModal())}),h(),n(1,"svg",175),u(2,"path",34),r()()}}var lt=class s{constructor(t,e){this.supabaseService=t;this.authService=e}terapias=[];usuarios=[];terapeutas=[];asignaciones=[];loading=!1;error="";showAsignarModal=!1;showVerModal=!1;selectedAsignacion=null;seguimientoDetalle=[];asignacionForm={id_terapia:0,usuarios_seleccionados:[],terapeuta_responsable:void 0,fecha_inicio:"",fecha_fin:"",sesiones_por_semana:3,duracion_sesion:60,tipo_asignacion:"individual",notas:"",objetivos_grupales:""};searchTerm="";estadoFilter="all";terapiaFilter="all";tipoFilter="all";Math;ngOnInit(){return b(this,null,function*(){yield this.loadInitialData()})}loadInitialData(){return b(this,null,function*(){this.loading=!0;try{yield Promise.all([this.loadTerapias(),this.loadUsuarios(),this.loadTerapeutas(),this.loadAsignaciones()])}catch(t){console.error("Error cargando datos iniciales:",t),this.error="Error al cargar los datos"}finally{this.loading=!1}})}loadTerapias(){return b(this,null,function*(){try{let t=yield this.supabaseService.getData("terapias");this.terapias=t?.filter(e=>e.status===1)||[]}catch(t){console.error("Error cargando terapias:",t)}})}loadUsuarios(){return b(this,null,function*(){try{let t=yield this.supabaseService.getData("profiles");this.usuarios=t?.filter(e=>e.status===1&&(e.id_perfil===1||e.id_perfil===2))||[]}catch(t){console.error("Error cargando usuarios:",t)}})}loadTerapeutas(){return b(this,null,function*(){try{let t=yield this.supabaseService.getData("profiles");this.terapeutas=t?.filter(e=>e.status===1&&(e.id_perfil===2||e.id_perfil===3))||[]}catch(t){console.error("Error cargando terapeutas:",t)}})}loadAsignaciones(){return b(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.client.from("terapia_asignaciones_masivas").select(`
          id,
          id_terapia,
          usuarios_asignados,
          fecha_inicio,
          fecha_fin,
          sesiones_por_semana,
          duracion_sesion,
          tipo_asignacion,
          estado,
          notas,
          objetivos_grupales,
          terapeuta_responsable,
          created_at,
          terapias(nombre, descripcion, tipo, area_especializacion),
          profiles!terapia_asignaciones_masivas_asignado_por_fkey(full_name),
          terapeuta:profiles!terapia_asignaciones_masivas_terapeuta_responsable_fkey(full_name)
        `).eq("status",1).order("created_at",{ascending:!1});if(e)throw e;this.asignaciones=(t||[]).map(i=>({asignacion_id:i.id,terapia_nombre:i.terapias?.nombre||"Terapia no encontrada",terapia_descripcion:i.terapias?.descripcion||"",terapia_tipo:i.terapias?.tipo||"",area_especializacion:i.terapias?.area_especializacion||"",fecha_inicio_programada:i.fecha_inicio,fecha_fin_programada:i.fecha_fin,usuarios_count:i.usuarios_asignados?.length||0,estado_asignacion:i.estado,asignado_por_nombre:i.profiles?.full_name||"Usuario no encontrado",terapeuta_nombre:i.terapeuta?.full_name||null,fecha_asignacion:i.created_at,notas_asignacion:i.notas,sesiones_por_semana:i.sesiones_por_semana,duracion_sesion:i.duracion_sesion,tipo_asignacion:i.tipo_asignacion}))}catch(t){console.error("Error cargando asignaciones:",t),yield this.loadAsignacionesAlternativo()}})}loadAsignacionesAlternativo(){return b(this,null,function*(){try{let[t,e,i]=yield Promise.all([this.supabaseService.getData("terapia_asignaciones_masivas"),this.supabaseService.getData("terapias"),this.supabaseService.getData("profiles")]),o=t?.filter(d=>d.status===1)||[];this.asignaciones=o.map(d=>{let f=e?.find(M=>M.id===d.id_terapia),S=i?.find(M=>M.id===d.asignado_por),P=i?.find(M=>M.id===d.terapeuta_responsable);return{asignacion_id:d.id,terapia_nombre:f?.nombre||"Terapia no encontrada",terapia_descripcion:f?.descripcion||"",terapia_tipo:f?.tipo||"",area_especializacion:f?.area_especializacion||"",fecha_inicio_programada:d.fecha_inicio,fecha_fin_programada:d.fecha_fin,usuarios_count:d.usuarios_asignados?.length||0,estado_asignacion:d.estado,asignado_por_nombre:S?.full_name||"Usuario no encontrado",terapeuta_nombre:P?.full_name||null,fecha_asignacion:d.created_at,notas_asignacion:d.notas,sesiones_por_semana:d.sesiones_por_semana,duracion_sesion:d.duracion_sesion,tipo_asignacion:d.tipo_asignacion}})}catch(t){console.error("Error en m\xE9todo alternativo:",t),this.asignaciones=[]}})}openAsignarModal(){this.asignacionForm={id_terapia:0,usuarios_seleccionados:[],terapeuta_responsable:void 0,fecha_inicio:this.getTomorrowDate(),fecha_fin:this.getNextWeekDate(),sesiones_por_semana:3,duracion_sesion:60,tipo_asignacion:"individual",notas:"",objetivos_grupales:""},this.error="",this.showAsignarModal=!0}closeAsignarModal(){this.showAsignarModal=!1,this.error=""}openVerModal(t){return b(this,null,function*(){this.selectedAsignacion=t,yield this.loadSeguimientoDetalle(t.asignacion_id),this.showVerModal=!0})}closeVerModal(){this.showVerModal=!1,this.selectedAsignacion=null,this.seguimientoDetalle=[]}loadSeguimientoDetalle(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.client.from("v_terapias_asignadas_usuarios").select("*").eq("asignacion_id",t).order("full_name");if(!i&&e){this.seguimientoDetalle=e;return}let{data:o,error:d}=yield this.supabaseService.client.from("terapia_seguimiento_individual").select(`
          id,
          id_asignacion_masiva,
          id_profile,
          progreso,
          estado_individual,
          fecha_inicio_real,
          fecha_fin_real,
          sesiones_completadas,
          sesiones_programadas,
          notas_individuales,
          adherencia_porcentaje,
          profiles(username, full_name)
        `).eq("id_asignacion_masiva",t);if(d)throw d;this.seguimientoDetalle=(o||[]).map(f=>({seguimiento_id:f.id,asignacion_id:f.id_asignacion_masiva,id_profile:f.id_profile,username:f.profiles?.username||"N/A",full_name:f.profiles?.full_name||"Usuario no encontrado",progreso:f.progreso,estado_individual:f.estado_individual,fecha_inicio_real:f.fecha_inicio_real,fecha_fin_real:f.fecha_fin_real,sesiones_completadas:f.sesiones_completadas||0,sesiones_programadas:f.sesiones_programadas||0,notas_individuales:f.notas_individuales,adherencia_porcentaje:f.adherencia_porcentaje||0}))}catch(e){console.error("Error cargando seguimiento detalle:",e),this.seguimientoDetalle=[]}})}toggleUsuario(t){let e=this.asignacionForm.usuarios_seleccionados.indexOf(t);e>-1?this.asignacionForm.usuarios_seleccionados.splice(e,1):this.asignacionForm.usuarios_seleccionados.push(t)}isUsuarioSelected(t){return this.asignacionForm.usuarios_seleccionados.includes(t)}selectAllUsuarios(){this.asignacionForm.usuarios_seleccionados=this.usuarios.map(t=>t.id)}clearAllUsuarios(){this.asignacionForm.usuarios_seleccionados=[]}asignarTerapia(){return b(this,null,function*(){try{if(this.error="",!this.asignacionForm.id_terapia){this.error="Debe seleccionar una terapia";return}if(this.asignacionForm.usuarios_seleccionados.length===0){this.error="Debe seleccionar al menos un usuario";return}if(!this.asignacionForm.fecha_inicio||!this.asignacionForm.fecha_fin){this.error="Debe especificar fechas de inicio y fin";return}if(new Date(this.asignacionForm.fecha_fin)<=new Date(this.asignacionForm.fecha_inicio)){this.error="La fecha de fin debe ser posterior a la fecha de inicio";return}this.loading=!0;let t=this.authService.getCurrentUser();if(!t?.id)throw new Error("Usuario no autenticado");let e;try{let{data:i,error:o}=yield this.supabaseService.client.rpc("asignar_terapia_a_usuarios",{p_id_terapia:this.asignacionForm.id_terapia,p_usuarios_ids:this.asignacionForm.usuarios_seleccionados,p_asignado_por:t.id,p_fecha_inicio:this.asignacionForm.fecha_inicio,p_fecha_fin:this.asignacionForm.fecha_fin,p_terapeuta_responsable:this.asignacionForm.terapeuta_responsable||null,p_sesiones_por_semana:this.asignacionForm.sesiones_por_semana,p_duracion_sesion:this.asignacionForm.duracion_sesion,p_tipo_asignacion:this.asignacionForm.tipo_asignacion,p_notas:this.asignacionForm.notas||null,p_objetivos_grupales:this.asignacionForm.objetivos_grupales||null});if(o)throw o;e=i}catch{console.log("Funci\xF3n RPC no disponible, usando m\xE9todo manual");let o={id_terapia:this.asignacionForm.id_terapia,usuarios_asignados:this.asignacionForm.usuarios_seleccionados,asignado_por:t.id,terapeuta_responsable:this.asignacionForm.terapeuta_responsable||null,fecha_inicio:this.asignacionForm.fecha_inicio,fecha_fin:this.asignacionForm.fecha_fin,sesiones_por_semana:this.asignacionForm.sesiones_por_semana,duracion_sesion:this.asignacionForm.duracion_sesion,tipo_asignacion:this.asignacionForm.tipo_asignacion,notas:this.asignacionForm.notas||null,objetivos_grupales:this.asignacionForm.objetivos_grupales||null,estado:"activa"},{data:d,error:f}=yield this.supabaseService.client.from("terapia_asignaciones_masivas").insert(o).select().single();if(f)throw f;e=d.id;let S=this.asignacionForm.usuarios_seleccionados.map(M=>({id_asignacion_masiva:e,id_profile:M,id_terapia:this.asignacionForm.id_terapia,progreso:0,estado_individual:"pendiente",sesiones_completadas:0,sesiones_programadas:this.calcularSesionesProgramadas(),adherencia_porcentaje:0})),{error:P}=yield this.supabaseService.client.from("terapia_seguimiento_individual").insert(S);if(P)throw P}console.log("Terapia asignada exitosamente, ID:",e),yield this.loadAsignaciones(),this.closeAsignarModal(),alert(`Terapia asignada exitosamente a ${this.asignacionForm.usuarios_seleccionados.length} usuarios`)}catch(t){console.error("Error asignando terapia:",t),this.error=t instanceof Error?t.message:"Error al asignar la terapia"}finally{this.loading=!1}})}calcularSesionesProgramadas(){let t=new Date(this.asignacionForm.fecha_inicio),e=new Date(this.asignacionForm.fecha_fin),i=Math.abs(e.getTime()-t.getTime()),o=Math.ceil(i/(1e3*60*60*24));return Math.ceil(o/7)*this.asignacionForm.sesiones_por_semana}cancelarAsignacion(t){return b(this,null,function*(){if(confirm("\xBFEst\xE1 seguro de cancelar esta asignaci\xF3n? Esta acci\xF3n afectar\xE1 a todos los usuarios asignados."))try{let{error:i}=yield this.supabaseService.client.from("terapia_asignaciones_masivas").update({estado:"cancelada",updated_at:new Date().toISOString()}).eq("id",t);if(i)throw i;yield this.loadAsignaciones(),alert("Asignaci\xF3n cancelada exitosamente")}catch(i){console.error("Error cancelando asignaci\xF3n:",i),alert("Error al cancelar la asignaci\xF3n")}})}actualizarProgreso(t,e){return b(this,null,function*(){try{let i=parseInt(e.target?.value||e)||0;if(i<0||i>100){alert("El progreso debe estar entre 0 y 100");return}let o={progreso:i,updated_at:new Date().toISOString()};if(i===0)o.estado_individual="pendiente";else if(i<100){o.estado_individual="en_progreso";let f=this.seguimientoDetalle.find(S=>S.seguimiento_id===t);f&&!f.fecha_inicio_real&&(o.fecha_inicio_real=new Date().toISOString().split("T")[0])}else o.estado_individual="completada",o.fecha_fin_real=new Date().toISOString().split("T")[0];let{error:d}=yield this.supabaseService.client.from("terapia_seguimiento_individual").update(o).eq("id",t);if(d)throw d;this.selectedAsignacion&&(yield this.loadSeguimientoDetalle(this.selectedAsignacion.asignacion_id))}catch(i){console.error("Error actualizando progreso:",i),alert("Error al actualizar el progreso")}})}editarNotasIndividuales(t){return b(this,null,function*(){let e=prompt("Ingrese las notas para este usuario:",t.notas_individuales||"");if(e!==null)try{let{error:i}=yield this.supabaseService.client.from("terapia_seguimiento_individual").update({notas_individuales:e,updated_at:new Date().toISOString()}).eq("id",t.seguimiento_id);if(i)throw i;this.selectedAsignacion&&(yield this.loadSeguimientoDetalle(this.selectedAsignacion.asignacion_id))}catch(i){console.error("Error actualizando notas:",i),alert("Error al actualizar las notas")}})}getEstadisticasProgreso(){if(!this.seguimientoDetalle||this.seguimientoDetalle.length===0)return{pendientes:0,enProgreso:0,completadas:0,promedioProgreso:0,promedioAdherencia:0};let t=this.seguimientoDetalle.filter(P=>P.estado_individual==="pendiente").length,e=this.seguimientoDetalle.filter(P=>P.estado_individual==="en_progreso").length,i=this.seguimientoDetalle.filter(P=>P.estado_individual==="completada").length,o=this.seguimientoDetalle.reduce((P,M)=>P+(M.progreso||0),0),d=Math.round(o/this.seguimientoDetalle.length),f=this.seguimientoDetalle.reduce((P,M)=>P+(M.adherencia_porcentaje||0),0),S=Math.round(f/this.seguimientoDetalle.length);return{pendientes:t,enProgreso:e,completadas:i,promedioProgreso:d,promedioAdherencia:S}}getTerapiaNombre(t){return this.terapias.find(i=>i.id===t)?.nombre||"Terapia no encontrada"}getUserName(t){let e=this.usuarios.find(i=>i.id===t);return e?.full_name||e?.username||"Usuario no encontrado"}getTerapeutaNombre(t){return t?this.terapeutas.find(i=>i.id===t)?.full_name||"Terapeuta no encontrado":"Sin asignar"}getEstadoColor(t){switch(t){case"activa":return"green";case"completada":return"blue";case"pausada":return"yellow";case"cancelada":return"red";default:return"gray"}}getEstadoIcon(t){switch(t){case"activa":return"fas fa-play-circle";case"completada":return"fas fa-check-circle";case"pausada":return"fas fa-pause-circle";case"cancelada":return"fas fa-times-circle";default:return"fas fa-circle"}}formatDate(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}formatDuracion(t){if(!t)return"Sin especificar";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getTomorrowDate(){let t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}getNextWeekDate(){let t=new Date;return t.setDate(t.getDate()+7),t.toISOString().split("T")[0]}get filteredAsignaciones(){let t=[...this.asignaciones];if(this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.terapia_nombre.toLowerCase().includes(e)||i.asignado_por_nombre.toLowerCase().includes(e)||i.terapeuta_nombre?.toLowerCase().includes(e)||i.area_especializacion?.toLowerCase().includes(e))}return this.estadoFilter!=="all"&&(t=t.filter(e=>e.estado_asignacion===this.estadoFilter)),this.terapiaFilter!=="all"&&(t=t.filter(e=>e.terapia_nombre===this.terapiaFilter)),this.tipoFilter!=="all"&&(t=t.filter(e=>e.tipo_asignacion===this.tipoFilter)),t}clearFilters(){this.searchTerm="",this.estadoFilter="all",this.terapiaFilter="all",this.tipoFilter="all"}refreshData(){return b(this,null,function*(){yield this.loadAsignaciones()})}canAssignTerapias(){return this.authService.isAdmin()||this.authService.hasProfile(3)}trackByAsignacionId(t,e){return e.asignacion_id}trackByUserId(t,e){return e.id}trackByTerapiaId(t,e){return e.id}static \u0275fac=function(e){return new(e||s)(O(Q),O(L))};static \u0275cmp=D({type:s,selectors:[["app-terapias-usuario"]],standalone:!1,decls:53,vars:11,consts:[["filtrosAplicados",""],["pluralUsuarios",""],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["class","inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",3,"click",4,"ngIf"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"md:col-span-2"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Buscar por terapia, asignador o terapeuta...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["value","all"],["value","activa"],["value","completada"],["value","pausada"],["value","cancelada"],["value","individual"],["value","grupal"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-red-600","hover:text-red-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","bg-white shadow overflow-hidden sm:rounded-md",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],["class","md:hidden fixed bottom-6 right-6 w-14 h-14 bg-red-600 text-white rounded-full shadow-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 z-40","title","Asignar terapia",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-red-600"],[1,"bg-white","shadow","overflow-hidden","sm:rounded-md"],[1,"px-4","py-5","sm:px-6","border-b","border-gray-200"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-12",4,"ngIf"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],["class","text-xs text-gray-400",4,"ngIf"],[1,"flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","text-gray-400","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"text-sm","text-gray-500","ml-1"],[1,"text-xs","text-gray-400","mt-1"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"text-gray-500"],["class","text-xs text-gray-400 mt-1",4,"ngIf"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","justify-end","space-x-2"],["title","Ver seguimiento",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["class","text-red-600 hover:text-red-900 p-2 rounded-full hover:bg-red-50","title","Cancelar asignaci\xF3n",3,"click",4,"ngIf"],[1,"text-xs","text-gray-400"],["title","Cancelar asignaci\xF3n",1,"text-red-600","hover:text-red-900","p-2","rounded-full","hover:bg-red-50",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[4,"ngIf","ngIfElse"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700",3,"click",4,"ngIf"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-red-600","hover:bg-red-700",3,"click"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-4xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"mt-2"],[1,"bg-white","px-4","pb-4","sm:px-6","max-h-96","overflow-y-auto"],[1,"space-y-6"],[1,"text-red-500"],["name","terapia",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["value","0"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["name","tipoAsignacion",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["name","terapeuta",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["type","date","name","fechaInicio",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","date","name","fechaFin",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","number","name","sesionesSemana","min","1","max","7",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["type","number","name","duracionSesion","min","15","max","180","step","15",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],["name","notas","rows","3","placeholder","Notas adicionales sobre la asignaci\xF3n...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[4,"ngIf"],[1,"flex","justify-between","items-center","mb-3"],[1,"block","text-sm","font-medium","text-gray-700"],["type","button",1,"text-xs","text-red-600","hover:text-red-800",3,"click"],["type","button",1,"text-xs","text-gray-600","hover:text-gray-800",3,"click"],[1,"border","border-gray-300","rounded-md","p-3","max-h-48","overflow-y-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-2"],["class","flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer",3,"bg-red-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","mt-4 bg-red-50 border border-red-200 rounded-md p-3",4,"ngIf"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","animate-spin -ml-1 mr-3 h-5 w-5 text-white","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:mt-0","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50",3,"click","disabled"],["name","objetivosGrupales","rows","3","placeholder","Objetivos espec\xEDficos para la terapia grupal...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-red-500","focus:border-red-500",3,"ngModelChange","ngModel"],[1,"flex","items-center","p-2","hover:bg-gray-50","rounded","cursor-pointer"],["type","checkbox",1,"h-4","w-4","text-red-600","focus:ring-red-500","border-gray-300","rounded",3,"change","checked"],[1,"ml-3","flex-1"],[1,"text-xs","text-gray-500"],[1,"mt-4","bg-red-50","border","border-red-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-6xl","sm:w-full"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900"],["class","text-xs text-gray-500",4,"ngIf"],["class","text-center py-8",4,"ngIf"],["class","mt-6 bg-gray-50 rounded-lg p-4",4,"ngIf"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"h-8","w-8","bg-gray-300","rounded-full","flex","items-center","justify-center","mr-3"],[1,"text-xs","font-medium","text-gray-700"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-3"],[1,"bg-blue-600","h-2","rounded-full"],["class","mt-2",4,"ngIf"],[1,"w-12","bg-gray-200","rounded-full","h-2","mr-2"],[1,"bg-purple-600","h-2","rounded-full"],["class","text-gray-500",4,"ngIf"],[1,"px-6","py-4"],[1,"text-sm","text-gray-900","max-w-xs"],["class","text-indigo-600 hover:text-indigo-900 p-1 rounded hover:bg-indigo-50","title","Editar notas",3,"click",4,"ngIf"],["type","range","min","0","max","100",1,"w-full","h-2","bg-gray-200","rounded-lg","appearance-none","cursor-pointer","slider",3,"input","value"],["title","Editar notas",1,"text-indigo-600","hover:text-indigo-900","p-1","rounded","hover:bg-indigo-50",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"text-center","py-8"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-8","w-8","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"mt-6","bg-gray-50","rounded-lg","p-4"],[1,"text-sm","font-medium","text-gray-900","mb-3"],[1,"grid","grid-cols-2","md:grid-cols-5","gap-4","text-center"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-2xl","font-bold","text-yellow-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-2xl","font-bold","text-blue-600"],[1,"text-2xl","font-bold","text-purple-600"],["title","Asignar terapia",1,"md:hidden","fixed","bottom-6","right-6","w-14","h-14","bg-red-600","text-white","rounded-full","shadow-lg","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-500","focus:ring-offset-2","transition-all","duration-200","z-40",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","mx-auto"]],template:function(e,i){e&1&&(n(0,"div",2)(1,"div",3)(2,"div",4)(3,"div")(4,"h1",5),a(5,"Asignaci\xF3n de Terapias a Usuarios"),r(),n(6,"p",6),a(7),r()(),n(8,"div",7)(9,"button",8),_("click",function(){return i.refreshData()}),h(),n(10,"svg",9),u(11,"path",10),r(),a(12," Refrescar "),r(),x(13,na,4,0,"button",11),r()()(),y(),n(14,"div",12)(15,"div",13)(16,"div",14)(17,"label",15),a(18,"Buscar"),r(),n(19,"input",16),T("ngModelChange",function(d){return k(i.searchTerm,d)||(i.searchTerm=d),d}),r()(),n(20,"div")(21,"label",15),a(22,"Estado"),r(),n(23,"select",17),T("ngModelChange",function(d){return k(i.estadoFilter,d)||(i.estadoFilter=d),d}),n(24,"option",18),a(25,"Todos los estados"),r(),n(26,"option",19),a(27,"Activa"),r(),n(28,"option",20),a(29,"Completada"),r(),n(30,"option",21),a(31,"Pausada"),r(),n(32,"option",22),a(33,"Cancelada"),r()()(),n(34,"div")(35,"label",15),a(36,"Tipo"),r(),n(37,"select",17),T("ngModelChange",function(d){return k(i.tipoFilter,d)||(i.tipoFilter=d),d}),n(38,"option",18),a(39,"Todos los tipos"),r(),n(40,"option",23),a(41,"Individual"),r(),n(42,"option",24),a(43,"Grupal"),r()()()(),n(44,"div",25)(45,"button",26),_("click",function(){return i.clearFilters()}),a(46," Limpiar filtros "),r()()(),x(47,ra,7,1,"div",27)(48,oa,2,0,"div",28)(49,fa,25,4,"div",29),r(),x(50,Sa,98,22,"div",30)(51,Da,68,12,"div",30)(52,Aa,3,0,"button",31)),e&2&&(l(7),v(" Gestiona las asignaciones masivas de terapias - Total: ",i.asignaciones.length," "),l(6),m("ngIf",i.canAssignTerapias()),l(6),E("ngModel",i.searchTerm),l(4),E("ngModel",i.estadoFilter),l(14),E("ngModel",i.tipoFilter),l(10),m("ngIf",i.error&&!i.showAsignarModal&&!i.showVerModal),l(),m("ngIf",i.loading&&!i.showAsignarModal&&!i.showVerModal),l(),m("ngIf",!i.loading),l(),m("ngIf",i.showAsignarModal),l(),m("ngIf",i.showVerModal),l(),m("ngIf",!i.showAsignarModal&&!i.showVerModal&&i.canAssignTerapias()))},dependencies:[$,z,R,te,ne,re,W,Ee,ie,G,ee,Te,ke,H,se,Ge],styles:[".container[_ngcontent-%COMP%]{max-width:100%;margin:0 auto;padding:0 1rem}.modal-enter[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalEnter .3s ease-out}@keyframes _ngcontent-%COMP%_modalEnter{0%{opacity:0;transform:scale(.95) translateY(-10px)}to{opacity:1;transform:scale(1) translateY(0)}}.modal-backdrop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_backdropEnter .3s ease-out}@keyframes _ngcontent-%COMP%_backdropEnter{0%{opacity:0}to{opacity:.75}}.terminal-container[_ngcontent-%COMP%]{background-color:#000;color:#0f0;font-family:Courier New,Monaco,Menlo,monospace;position:relative;border-radius:8px;overflow:hidden}.terminal-header[_ngcontent-%COMP%]{background-color:#1a1a1a;padding:.75rem 1rem;border-bottom:1px solid #333;display:flex;align-items:center;justify-content:space-between}.terminal-controls[_ngcontent-%COMP%]{display:flex;gap:.5rem}.terminal-control[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%}.terminal-control.close[_ngcontent-%COMP%]{background-color:#ff5f56}.terminal-control.minimize[_ngcontent-%COMP%]{background-color:#ffbd2e}.terminal-control.maximize[_ngcontent-%COMP%]{background-color:#27ca3f}.terminal-content[_ngcontent-%COMP%]{padding:1.5rem;font-size:.875rem;line-height:1.5;min-height:400px}.watermark[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(15deg);font-size:8rem;font-weight:700;color:#ffffff0d;pointer-events:none;-webkit-user-select:none;user-select:none;z-index:1}.terminal-text[_ngcontent-%COMP%]{position:relative;z-index:10}.therapy-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a;transition:all .2s ease-in-out;border:1px solid #e5e7eb}.therapy-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px #0000001a;transform:translateY(-1px)}.therapy-card-header[_ngcontent-%COMP%]{padding:1.25rem;border-bottom:1px solid #f3f4f6}.therapy-card-body[_ngcontent-%COMP%]{padding:1.25rem}.therapy-card-footer[_ngcontent-%COMP%]{padding:1rem 1.25rem;background-color:#f9fafb;border-top:1px solid #f3f4f6;border-radius:0 0 12px 12px}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .625rem;border-radius:9999px;font-size:.75rem;font-weight:500;text-transform:capitalize}.badge-fisica[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af}.badge-respiratoria[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.badge-neurologica[_ngcontent-%COMP%]{background-color:#f3e8ff;color:#7c3aed}.badge-ocupacional[_ngcontent-%COMP%]{background-color:#fed7aa;color:#ea580c}.badge-cardiaca[_ngcontent-%COMP%]{background-color:#fecaca;color:#dc2626}.status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .5rem;border-radius:.375rem;font-size:.75rem;font-weight:500}.status-activa[_ngcontent-%COMP%]{background-color:#d1fae5;color:#065f46}.status-completada[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af}.status-pausada[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.status-cancelada[_ngcontent-%COMP%]{background-color:#fecaca;color:#991b1b}.status-pendiente[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151}.status-en-progreso[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1d4ed8}.status-abandonada[_ngcontent-%COMP%]{background-color:#fee2e2;color:#dc2626}.progress-bar[_ngcontent-%COMP%]{width:100%;height:.5rem;background-color:#e5e7eb;border-radius:.25rem;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s ease-in-out;border-radius:.25rem}.progress-green[_ngcontent-%COMP%]{background-color:#10b981}.progress-blue[_ngcontent-%COMP%]{background-color:#3b82f6}.progress-yellow[_ngcontent-%COMP%]{background-color:#f59e0b}.progress-red[_ngcontent-%COMP%]{background-color:#ef4444}.form-section[_ngcontent-%COMP%]{background-color:#f9fafb;border:1px solid #e5e7eb;border-radius:.5rem;padding:1rem;margin-bottom:1rem}.form-section.active[_ngcontent-%COMP%]{border-color:#dc2626;background-color:#fef2f2}.section-selector[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1.5rem}.section-card[_ngcontent-%COMP%]{padding:1rem;border:2px solid #e5e7eb;border-radius:.5rem;cursor:pointer;transition:all .2s ease-in-out;text-align:center}.section-card[_ngcontent-%COMP%]:hover, .section-card.selected[_ngcontent-%COMP%]{border-color:#dc2626;background-color:#fef2f2}.section-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600;color:#374151;margin-bottom:.25rem}.section-card.selected[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#dc2626}.section-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.exercise-card[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #e5e7eb;border-radius:.5rem;padding:1rem;margin-bottom:.75rem}.exercise-header[_ngcontent-%COMP%]{display:flex;justify-content:between;align-items:center;margin-bottom:.75rem;padding-bottom:.5rem;border-bottom:1px solid #f3f4f6}.exercise-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.exercise-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.25rem;border:none;background:none;cursor:pointer;border-radius:.25rem;transition:background-color .2s ease-in-out}.exercise-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.exercise-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:.75rem}.fab[_ngcontent-%COMP%]{position:fixed;bottom:1.5rem;right:1.5rem;width:3.5rem;height:3.5rem;background-color:#dc2626;color:#fff;border:none;border-radius:50%;box-shadow:0 4px 6px #0000001a;cursor:pointer;transition:all .2s ease-in-out;z-index:1000}.fab[_ngcontent-%COMP%]:hover{background-color:#b91c1c;transform:scale(1.05);box-shadow:0 6px 8px #00000026}.fab[_ngcontent-%COMP%]:active{transform:scale(.95)}@media (min-width: 768px){.fab[_ngcontent-%COMP%]{display:none}}.loading-spinner[_ngcontent-%COMP%]{display:inline-block;width:2rem;height:2rem;border:3px solid #f3f4f6;border-radius:50%;border-top-color:#dc2626;animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}.tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip[_ngcontent-%COMP%]   .tooltip-text[_ngcontent-%COMP%]{visibility:hidden;width:120px;background-color:#374151;color:#fff;text-align:center;border-radius:6px;padding:5px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-60px;opacity:0;transition:opacity .3s;font-size:.75rem}.tooltip[_ngcontent-%COMP%]:hover   .tooltip-text[_ngcontent-%COMP%]{visibility:visible;opacity:1}@media (max-width: 640px){.container[_ngcontent-%COMP%]{padding:0 .5rem}.therapy-card[_ngcontent-%COMP%]{margin-bottom:1rem}.section-selector[_ngcontent-%COMP%], .exercise-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 768px){.terminal-content[_ngcontent-%COMP%]{padding:1rem;font-size:.75rem}.watermark[_ngcontent-%COMP%]{font-size:4rem}}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.focus-visible[_ngcontent-%COMP%]:focus{outline:2px solid #dc2626;outline-offset:2px}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;text-align:left;border-bottom:1px solid #e5e7eb}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f9fafb;font-weight:600;color:#374151}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.slide-in-right[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInRight .3s ease-out}@keyframes _ngcontent-%COMP%_slideInRight{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}.bounce[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce .5s ease-in-out}@keyframes _ngcontent-%COMP%_bounce{0%,20%,53%,80%,to{transform:translateZ(0)}40%,43%{transform:translate3d(0,-5px,0)}70%{transform:translate3d(0,-2px,0)}90%{transform:translate3d(0,-1px,0)}}"]})};function Ra(s,t){if(s&1&&(n(0,"div",31),a(1),r()),s&2){let e=t.$implicit;l(),v(" ",e," ")}}function ja(s,t){s&1&&u(0,"div",39)}function Ua(s,t){if(s&1&&(n(0,"span"),a(1),r()),s&2){let e=c(2).$implicit,i=c(2);l(),v(" ",i.getDiasRestantesTexto(e.seguimiento.dias_restantes)," ")}}function La(s,t){if(s&1&&(n(0,"div",42)(1,"div",33)(2,"div",43)(3,"span",44),a(4),r(),n(5,"span",45),a(6),r()(),n(7,"span",46),a(8),r()(),n(9,"div",47),a(10),r(),n(11,"div",48)(12,"div",3)(13,"span"),a(14),r(),x(15,Ua,2,1,"span",49),r(),n(16,"div",50),u(17,"div",51),r()()()),s&2){let e=c().$implicit,i=c(2);m("ngClass",i.getColorTerapia(e.seguimiento)),l(4),v(" ",i.getIconoEstado(e.seguimiento)," "),l(2),v(" ",i.getTipoTerapiaCorto(e.seguimiento.terapia_tipo)," "),l(2),v(" ",i.formatearProgreso(e.seguimiento.progreso)," "),l(),m("title",e.seguimiento.terapia_nombre),l(),v(" ",e.seguimiento.terapia_nombre," "),l(4),C(e.seguimiento.terapia_nivel),l(),m("ngIf",e.seguimiento.dias_restantes!==void 0),l(2),X("width",e.seguimiento.progreso,"%")}}function Na(s,t){if(s&1){let e=w();n(0,"div",40),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.onClickTerapia(o))}),x(1,La,18,10,"div",41),r()}if(s&2){let e=t.$implicit;l(),m("ngIf",e.tipoEvento==="inicio")}}function za(s,t){if(s&1&&(n(0,"div",52),a(1),r()),s&2){let e=c().$implicit;l(),v(" +",e.terapias.length-3," m\xE1s... ")}}function Ba(s,t){if(s&1&&(n(0,"div",32)(1,"div",33)(2,"span",34),a(3),r(),x(4,ja,1,0,"div",35),r(),n(5,"div",36),x(6,Na,2,1,"div",37),r(),x(7,za,2,1,"div",38),r()),s&2){let e=t.$implicit,i=c();F("bg-gray-50",!e.esMesActual)("bg-blue-50",i.esHoy(e.fecha)),l(2),F("text-gray-400",!e.esMesActual)("text-gray-900",e.esMesActual&&!i.esHoy(e.fecha))("text-blue-600",i.esHoy(e.fecha))("font-bold",i.esHoy(e.fecha)),l(),v(" ",e.fecha.getDate()," "),l(),m("ngIf",i.esHoy(e.fecha)),l(2),m("ngForOf",e.terapias)("ngForTrackBy",i.trackByTerapia),l(),m("ngIf",e.terapias.length>3)}}function $a(s,t){s&1&&(n(0,"div",92)(1,"div",93),h(),n(2,"svg",94),u(3,"path",95),r(),y(),n(4,"div",96)(5,"p",97),a(6,"\xA1Terapia copiada al portapapeles!"),r()()()())}function Wa(s,t){if(s&1){let e=w();n(0,"div",53)(1,"div",54)(2,"div",55),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),r(),n(3,"span",56),a(4,"\u200B"),r(),n(5,"div",57)(6,"div",58)(7,"div",59)(8,"div",60),h(),n(9,"svg",61),u(10,"path",62),r()(),y(),n(11,"div",63)(12,"h3",64),a(13),r(),n(14,"div",65)(15,"p",66),a(16),r()()()()(),n(17,"div",67)(18,"div",68)(19,"div",69)(20,"div")(21,"span",70),a(22,"Mi Progreso:"),r(),n(23,"div",71)(24,"div",72),u(25,"div",73),r(),a(26),r()(),n(27,"div")(28,"span",70),a(29,"Estado:"),r(),n(30,"div",74),a(31),r()(),n(32,"div")(33,"span",70),a(34,"Per\xEDodo:"),r(),n(35,"div",74),a(36),r()(),n(37,"div")(38,"span",70),a(39,"D\xEDas restantes:"),r(),n(40,"div",74),a(41),r()()()(),n(42,"div",75)(43,"div",76),u(44,"img",77),r(),n(45,"div",78)(46,"div",79),u(47,"div",80)(48,"div",81)(49,"div",82),r(),n(50,"div",83),a(51),r()(),n(52,"pre",84),a(53),r()(),x(54,$a,7,0,"div",85),n(55,"div",86)(56,"button",87),_("click",function(){let o;p(e);let d=c();return g(d.copyToClipboard(d.getFormattedTerapia(d.selectedTerapia,(o=d.selectedSeguimiento)!==null&&o!==void 0?o:void 0)))}),h(),n(57,"svg",5),u(58,"path",88),r(),a(59," Copiar "),r(),y(),n(60,"button",87),_("click",function(){let o;p(e);let d=c();return g(d.copyToClipboard(d.getFormattedTerapia(d.selectedTerapia,(o=d.selectedSeguimiento)!==null&&o!==void 0?o:void 0)))}),h(),n(61,"svg",5),u(62,"path",89),r(),a(63," Descargar "),r()()(),y(),n(64,"div",90)(65,"button",91),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),a(66," Cerrar "),r()()()()()}if(s&2){let e=c();l(13),v(" ",(e.selectedTerapia==null?null:e.selectedTerapia.nombre)||(e.selectedSeguimiento==null?null:e.selectedSeguimiento.terapia_nombre)," "),l(3),v(" Mi terapia asignada - Progreso: ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(9),X("width",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"%"),l(),v(" ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(5),C(e.getEstadoIndividualText((e.selectedSeguimiento==null?null:e.selectedSeguimiento.estado_individual)||"")),l(5),N(" ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_inicio_programada)," - ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_fin_programada)," "),l(4),F("text-green-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>7)("text-yellow-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=7&&((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0)("text-red-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=0),l(),v(" ",e.formatDiasRestantes((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)," "),l(10),v(" ",e.getFileName(e.selectedTerapia)," "),l(2),C(e.getFormattedTerapia(e.selectedTerapia,e.selectedSeguimiento||void 0)),l(),m("ngIf",e.copySuccess)}}var dt=class s{constructor(t){this.terapiasService=t}terapias=[];volverAVista=new Fe;abrirTerapia=new Fe;fechaActual=new Date;mesActual=new Date;diasCalendario=[];showViewModal=!1;selectedTerapia=null;selectedSeguimiento=null;copySuccess=!1;meses=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];diasSemana=["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"];ngOnInit(){this.generarCalendario()}ngOnChanges(){this.generarCalendario()}generarCalendario(){this.diasCalendario=[];let t=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth(),1),e=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()+1,0),i=t.getDay();for(let d=i-1;d>=0;d--){let f=new Date(t);f.setDate(f.getDate()-(d+1)),this.diasCalendario.push({fecha:new Date(f),esMesActual:!1,terapias:this.getTerapiasDelDia(f)})}for(let d=1;d<=e.getDate();d++){let f=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth(),d);this.diasCalendario.push({fecha:new Date(f),esMesActual:!0,terapias:this.getTerapiasDelDia(f)})}let o=42-this.diasCalendario.length;for(let d=1;d<=o;d++){let f=new Date(e);f.setDate(f.getDate()+d),this.diasCalendario.push({fecha:new Date(f),esMesActual:!1,terapias:this.getTerapiasDelDia(f)})}}getTerapiasDelDia(t){let e=[],i=this.formatDateForComparison(t);return console.log(`\u{1F5D3}\uFE0F Verificando terapias para fecha: ${i}`),this.terapias.forEach(o=>{let d=new Date(o.fecha_inicio_programada),f=this.formatDateForComparison(d);console.log(`   \u{1F50D} Terapia: ${o.terapia_nombre}, Inicio: ${f}, Comparando con: ${i}`),f===i?(console.log(`   \u2705 COINCIDENCIA! Agregando terapia: ${o.terapia_nombre}`),e.push({seguimiento:o,tipoEvento:"inicio",enRango:!0})):console.log("   \u274C No coincide. Saltando terapia.")}),console.log(`\u{1F4CA} Total terapias para ${i}: ${e.length}`),e}formatDateForComparison(t){let e=t.getFullYear(),i=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0");return`${e}-${i}-${o}`}mesAnterior(){this.mesActual=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()-1,1),this.generarCalendario()}mesSiguiente(){this.mesActual=new Date(this.mesActual.getFullYear(),this.mesActual.getMonth()+1,1),this.generarCalendario()}irAHoy(){this.mesActual=new Date,this.generarCalendario()}onVolverAVista(){this.volverAVista.emit()}onClickTerapia(t){console.log("Click en terapia desde calendario:",t.seguimiento.terapia_nombre),this.abrirModalTerapia(t.seguimiento)}abrirModalTerapia(t){return b(this,null,function*(){console.log("Abriendo modal del calendario para:",t.terapia_nombre),this.selectedSeguimiento=t;try{console.log("\u{1F50D} Cargando terapia completa desde BD para ID:",t.terapia_id);let e=yield this.terapiasService.getTerapiaById(t.terapia_id);e?(console.log("\u2705 Terapia completa cargada desde BD:",e),this.selectedTerapia=e):(console.warn("\u26A0\uFE0F No se encontr\xF3 terapia en BD, usando informaci\xF3n b\xE1sica"),this.selectedTerapia=this.crearTerapiaBasica(t))}catch(e){console.error("\u274C Error cargando terapia completa desde BD:",e),this.selectedTerapia=this.crearTerapiaBasica(t)}this.showViewModal=!0})}closeViewModal(){console.log("Cerrando modal del calendario"),this.showViewModal=!1,this.selectedTerapia=null,this.selectedSeguimiento=null,this.copySuccess=!1}esHoy(t){let e=new Date;return t.toDateString()===e.toDateString()}getColorByEstado(t){switch(t){case"vigente":return"bg-green-500";case"pendiente":return"bg-blue-500";case"vencida":return"bg-red-500";default:return"bg-gray-500"}}getColorByTipo(t){return"border-green-500 bg-green-100"}formatDate(t){if(!t)return"N/A";try{let e;return t instanceof Date?e=t:e=new Date(t),isNaN(e.getTime())?"Fecha inv\xE1lida":e.toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"Fecha inv\xE1lida"}}formatDuracion(t){if(!t)return"N/A";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}getEstadoTemporalText(t){switch(t){case"vigente":return"Vigente";case"pendiente":return"Pendiente";case"vencida":return"Vencida";default:return"Desconocido"}}getEstadoIndividualText(t){if(!t)return"Desconocido";switch(t){case"completada":return"Completada";case"en_progreso":return"En Progreso";case"pendiente":return"Sin Iniciar";case"abandonada":return"Abandonada";default:return"Desconocido"}}getFormattedTerapia(t,e){if(console.log("\u{1F5A8}\uFE0F Formateando terapia desde calendario:",{terapia:t,seguimiento:e}),!t&&!e)return console.warn("No hay datos de terapia ni seguimiento"),"No hay informaci\xF3n disponible para mostrar.";!t&&e&&(t=this.crearTerapiaBasica(e));let i=`${t.nombre||e?.terapia_nombre||"Terapia sin nombre"}
`;if(i+=`${t.descripcion||e?.terapia_descripcion||"Informaci\xF3n detallada disponible con el terapeuta"}
`,i+=`Tipo: ${t.tipo||e?.terapia_tipo||"No especificado"} | Nivel: ${t.nivel||e?.terapia_nivel||"No especificado"}
`,t.area_especializacion&&(i+=`\xC1rea: ${t.area_especializacion}
`),i+=`Duraci\xF3n estimada: ${this.formatDuracion(t.duracion_estimada||e?.duracion_estimada)}

`,e&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                          MI PROGRESO
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`Estado: ${this.getEstadoIndividualText(e.estado_individual)} (${e.progreso}%)
`,i+=`Per\xEDodo: ${this.formatDate(e.fecha_inicio_programada)} - ${this.formatDate(e.fecha_fin_programada)}
`,e.estado_temporal==="vigente"&&e.dias_restantes!==void 0&&(i+=`D\xEDas restantes: ${this.formatDiasRestantes(e.dias_restantes)}
`),e.fecha_inicio_real&&(i+=`Iniciado: ${this.formatDate(e.fecha_inicio_real)}
`),e.sesiones_completadas!==void 0&&e.sesiones_programadas!==void 0&&(i+=`Sesiones completadas: ${e.sesiones_completadas} / ${e.sesiones_programadas}
`),e.adherencia_porcentaje!==void 0&&(i+=`Adherencia: ${e.adherencia_porcentaje}%
`),i+=`
`),t.objetivo_principal&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      OBJETIVO PRINCIPAL
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.objetivo_principal}

`),t.ejercicios&&typeof t.ejercicios=="object"&&Object.keys(t.ejercicios).length>0){console.log("\u{1F4CB} Procesando ejercicios desde BD:",t.ejercicios),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      PLAN DE EJERCICIOS
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`;let o=["calentamiento","fortalecimiento","equilibrio","coordinacion","estiramiento","respiracion","flexibilidad","movilidad","resistencia"],d=0;o.forEach(f=>{let S=t.ejercicios[f];if(S&&S.ejercicios&&Array.isArray(S.ejercicios)&&S.ejercicios.length>0){d++,i+=`${f.toUpperCase()}
`,i+=`${"\u2500".repeat(f.length)}
`,S.descripcion&&(i+=`${S.descripcion}
`);let P=[];S.tiempo_total&&P.push(`Tiempo: ${S.tiempo_total}`),S.objetivos&&Array.isArray(S.objetivos)&&S.objetivos.length>0&&P.push(`Objetivos: ${S.objetivos.join(", ")}`),P.length>0&&(i+=`${P.join(" | ")}
`),i+=`
`,S.ejercicios.forEach((M,U)=>{i+=`${U+1}. ${M.nombre||"Ejercicio sin nombre"}
`,M.descripcion&&(i+=`   ${M.descripcion}
`);let I=[];M.series&&I.push(`${M.series} series`),M.repeticiones&&I.push(`${M.repeticiones} reps`),M.duracion&&I.push(`${M.duracion}`),M.resistencia&&I.push(`Resistencia: ${M.resistencia}`),M.equipamiento&&Array.isArray(M.equipamiento)&&M.equipamiento.length>0&&I.push(`Equipo: ${M.equipamiento.join(", ")}`),I.length>0&&(i+=`   ${I.join(" | ")}
`),M.ejecucion&&(i+=`   Ejecuci\xF3n: ${M.ejecucion}
`),M.precauciones&&(i+=`   \u26A0\uFE0F  ${M.precauciones}
`),M.modificaciones&&(M.modificaciones.principiante&&(i+=`   \u{1F4A1} Principiante: ${M.modificaciones.principiante}
`),M.modificaciones.limitaciones&&(i+=`   \u{1F527} Limitaciones: ${M.modificaciones.limitaciones}
`)),M.observaciones&&(i+=`   \u{1F4DD} ${M.observaciones}
`),i+=`
`}),i+=`
`}}),d===0&&(console.log("\u{1F50D} No se encontraron secciones organizadas, buscando ejercicios directos..."),Array.isArray(t.ejercicios)?(i+=`EJERCICIOS
`,i+=`\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500

`,t.ejercicios.forEach((f,S)=>{i+=`${S+1}. ${f.nombre||"Ejercicio sin nombre"}
`,f.descripcion&&(i+=`   ${f.descripcion}
`);let P=[];f.series&&P.push(`${f.series} series`),f.repeticiones&&P.push(`${f.repeticiones} reps`),f.duracion&&P.push(`${f.duracion}`),P.length>0&&(i+=`   ${P.join(" | ")}
`),f.observaciones&&(i+=`   \u{1F4DD} ${f.observaciones}
`),i+=`
`})):(console.log("\u26A0\uFE0F Estructura de ejercicios no reconocida:",typeof t.ejercicios),i+=`INFORMACI\xD3N DE EJERCICIOS
`,i+=`\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500

`,i+=`Los ejercicios est\xE1n disponibles en la base de datos.
`,i+=`Consulte con su terapeuta para obtener el plan de ejercicios detallado.

`))}else console.log("\u2139\uFE0F No hay ejercicios en BD o estructura vac\xEDa"),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                    PLAN DE EJERCICIOS
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`El plan de ejercicios detallado est\xE1 disponible con su terapeuta.
`,i+=`Consulte directamente para obtener las instrucciones espec\xEDficas.

`;return t.contraindicaciones&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                     CONTRAINDICACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.contraindicaciones}

`),t.criterios_progresion&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                   CRITERIOS DE PROGRESI\xD3N
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.criterios_progresion}

`),t.recomendaciones&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      RECOMENDACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.recomendaciones}

`),t.observaciones&&t.observaciones!=="Para informaci\xF3n detallada de ejercicios y contraindicaciones, consulte con su terapeuta"&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      OBSERVACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.observaciones}

`),e?.notas_individuales&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                   MIS NOTAS PERSONALES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${e.notas_individuales}

`),e&&(e.nivel_dolor_actual!==void 0||e.nivel_funcionalidad_actual!==void 0)&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                     EVALUACI\xD3N ACTUAL
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,e.nivel_dolor_actual!==void 0&&e.nivel_dolor_actual>0&&(i+=`Nivel de dolor: ${e.nivel_dolor_actual}/10
`),e.nivel_funcionalidad_actual!==void 0&&e.nivel_funcionalidad_actual>0&&(i+=`Funcionalidad: ${e.nivel_funcionalidad_actual}%
`),i+=`
`),t.tags&&Array.isArray(t.tags)&&t.tags.length>0&&(i+=`Tags: ${t.tags.map(o=>`#${o}`).join(" ")}

`),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`\xDAltima actualizaci\xF3n: ${this.formatDate(new Date().toISOString())}
`,i+=`Generado por: rehabiMovement - Sistema de Rehabilitaci\xF3n
`,i+=`ID de Terapia: ${t.id||e?.terapia_id||"N/A"}
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,console.log("\u2705 Texto generado con datos reales de BD"),i}crearTerapiaBasica(t){return{id:t.terapia_id,nombre:t.terapia_nombre,descripcion:t.terapia_descripcion||"Informaci\xF3n detallada disponible con el terapeuta",tipo:t.terapia_tipo,nivel:t.terapia_nivel,duracion_estimada:t.duracion_estimada,area_especializacion:this.obtenerAreaEspecializacion(t.terapia_tipo),ejercicios:null,objetivo_principal:null,contraindicaciones:null,criterios_progresion:null,recomendaciones:null,observaciones:"Para informaci\xF3n detallada de ejercicios y contraindicaciones, consulte con su terapeuta"}}obtenerAreaEspecializacion(t){switch(t.toLowerCase()){case"fisica":return"Fisioterapia";case"ocupacional":return"Terapia Ocupacional";case"respiratoria":return"Fisioterapia Respiratoria";case"neurologica":return"Neurorehabilitaci\xF3n";default:return"Rehabilitaci\xF3n General"}}formatDiasRestantes(t){return t==null?"No disponible":t<0?`Vencida hace ${Math.abs(t)} d\xEDa${Math.abs(t)!==1?"s":""}`:t===0?"Vence hoy":t===1?"Vence ma\xF1ana":`${t} d\xEDas restantes`}getFileName(t){return!t||!t.nombre?"mi_terapia.txt":t.nombre.replace(/\s+/g,"_")+"_mi_terapia.txt"}copyToClipboard(t){return b(this,null,function*(){try{yield navigator.clipboard.writeText(t),this.copySuccess=!0,console.log("Texto copiado al portapapeles"),setTimeout(()=>{this.copySuccess=!1},2e3)}catch(e){console.error("Error al copiar al portapapeles:",e),this.fallbackCopyTextToClipboard(t)}})}fallbackCopyTextToClipboard(t){let e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")&&(this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3))}catch(i){console.error("Fallback: Error al copiar al portapapeles:",i)}document.body.removeChild(e)}trackByDate(t,e){return e.fecha.toISOString()}trackByTerapia(t,e){return e.seguimiento.seguimiento_id||t}getColorTerapia(t){switch(t.estado_temporal){case"vigente":return"bg-green-500 border-green-600";case"pendiente":return"bg-blue-500 border-blue-600";case"vencida":return"bg-red-500 border-red-600";default:return"bg-gray-500 border-gray-600"}}getColorTextoTerapia(t){switch(t.estado_temporal){case"vigente":return"text-green-700";case"pendiente":return"text-blue-700";case"vencida":return"text-red-700";default:return"text-gray-700"}}getIconoEstado(t){switch(t.estado_individual){case"completada":return"\u2713";case"en_progreso":return"\u23F3";case"pendiente":return"\u25CB";case"abandonada":return"\u2717";default:return"\u25CB"}}formatearProgreso(t){return`${t}%`}getTipoTerapiaCorto(t){switch(t.toLowerCase()){case"fisica":return"FIS";case"ocupacional":return"OCP";case"respiratoria":return"RSP";case"neurologica":return"NEU";default:return t.substring(0,3).toUpperCase()}}getDiasRestantesTexto(t){return t<0?`Vencida hace ${Math.abs(t)} d\xEDas`:t===0?"Vence hoy":t===1?"Vence ma\xF1ana":`${t} d\xEDas restantes`}exportarTerapia(t,e){if(!t){console.warn("No hay terapia para exportar");return}let i=this.getFormattedTerapia(t,e);if(!i){console.warn("No se pudo generar el contenido para exportar");return}let o=new Blob([i],{type:"text/plain;charset=utf-8"}),d=window.URL.createObjectURL(o),f=document.createElement("a");f.href=d,f.download=`${t.nombre.replace(/\s+/g,"_")}_mi_terapia.txt`,f.click(),window.URL.revokeObjectURL(d),console.log("Mi terapia exportada desde calendario:",t.nombre),this.mostrarNotificacionExito("Terapia exportada correctamente")}mostrarNotificacionExito(t){this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3)}getEstadoColorClass(t){return this.getColorByEstado(t)}getEstadoTextColorClass(t){switch(t){case"vigente":return"text-green-600";case"pendiente":return"text-blue-600";case"vencida":return"text-red-600";default:return"text-gray-600"}}esFechaSeleccionada(t){return!1}formatearFecha(t){return t.toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}debugTerapias(){console.log("\u{1F50D} DEBUG: Informaci\xF3n del calendario de terapias"),console.log("Total de terapias:",this.terapias.length),console.log("Mes actual:",this.meses[this.mesActual.getMonth()],this.mesActual.getFullYear()),console.log("D\xEDas con terapias:",this.diasCalendario.filter(t=>t.terapias.length>0).length),this.terapias.forEach((t,e)=>{console.log(`Terapia ${e+1}:`,{nombre:t.terapia_nombre,tipo:t.terapia_tipo,estado:t.estado_temporal,progreso:t.progreso,inicio:t.fecha_inicio_programada,fin:t.fecha_fin_programada})})}hayTerapiasEnRango(t,e){return this.terapias.some(i=>{let o=new Date(i.fecha_inicio_programada),d=new Date(i.fecha_fin_programada);return o>=t&&o<=e||d>=t&&d<=e||o<=t&&d>=e})}static \u0275fac=function(e){return new(e||s)(O(Pe))};static \u0275cmp=D({type:s,selectors:[["app-calendario-terapias"]],inputs:{terapias:"terapias"},outputs:{volverAVista:"volverAVista",abrirTerapia:"abrirTerapia"},standalone:!1,features:[$e],decls:100,vars:9,consts:[[1,"max-w-7xl","mx-auto"],[1,"bg-white","rounded-lg","shadow","mb-6"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"flex","items-center","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"flex","items-center","space-x-4"],[1,"p-2","rounded-full","hover:bg-gray-100","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-xl","font-semibold","text-gray-900","min-w-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3a2 2 0 012-2h8a2 2 0 012 2v4m-4 0V3m-4 4h8m-8 0H6a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-2"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],[1,"grid","grid-cols-7","bg-gray-50","border-b","border-gray-200"],["class","px-4 py-3 text-center text-sm font-medium text-gray-700 border-r border-gray-200 last:border-r-0",4,"ngFor","ngForOf"],[1,"grid","grid-cols-7"],["class","min-h-[120px] border-r border-b border-gray-200 last:border-r-0 p-2 relative",3,"bg-gray-50","bg-blue-50",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-6","bg-white","rounded-lg","shadow","p-4"],[1,"text-sm","font-medium","text-gray-900","mb-3"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-xs","font-medium","text-gray-700","mb-2"],[1,"space-y-1","text-xs"],[1,"flex","items-center","space-x-2"],[1,"w-3","h-3","bg-green-500","rounded","border","border-green-600"],[1,"w-3","h-3","bg-blue-500","rounded","border","border-blue-600"],[1,"w-3","h-3","bg-red-500","rounded","border","border-red-600"],[1,"font-medium"],[1,"mt-4","text-center","text-sm","text-gray-500"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],[1,"px-4","py-3","text-center","text-sm","font-medium","text-gray-700","border-r","border-gray-200","last:border-r-0"],[1,"min-h-[120px]","border-r","border-b","border-gray-200","last:border-r-0","p-2","relative"],[1,"flex","items-center","justify-between","mb-1"],[1,"text-sm","font-medium"],["class","w-2 h-2 bg-blue-500 rounded-full",4,"ngIf"],[1,"space-y-1"],["class","group cursor-pointer",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-xs text-gray-500 text-center mt-1",4,"ngIf"],[1,"w-2","h-2","bg-blue-500","rounded-full"],[1,"group","cursor-pointer",3,"click"],["class","text-xs rounded-lg p-2 border-l-4 hover:shadow-md transition-all duration-200 transform hover:-translate-y-0.5",3,"ngClass",4,"ngIf"],[1,"text-xs","rounded-lg","p-2","border-l-4","hover:shadow-md","transition-all","duration-200","transform","hover:-translate-y-0.5",3,"ngClass"],[1,"flex","items-center","space-x-1"],[1,"font-medium","text-white"],[1,"font-medium","text-white","text-xs"],[1,"text-white","text-xs","font-medium"],[1,"text-white","font-medium","mb-1","line-clamp-2",3,"title"],[1,"text-white","text-xs","opacity-90","space-y-0.5"],[4,"ngIf"],[1,"w-full","bg-white","bg-opacity-20","rounded-full","h-1","mt-1"],[1,"bg-white","h-1","rounded-full","transition-all","duration-300"],[1,"text-xs","text-gray-500","text-center","mt-1"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-5xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"text-sm","text-gray-500"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900","flex","items-center"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-2"],[1,"bg-blue-600","h-2","rounded-full"],[1,"text-gray-900"],[1,"bg-gray-900","text-green-400","rounded-lg","p-6","font-mono","text-sm","overflow-auto","max-h-96","relative",2,"font-family","'Courier New', monospace","line-height","1.6"],[1,"absolute","inset-15","flex","items-center","justify-center","pointer-events-none","opacity-25"],["src","/rh.png","alt","RehabiMovement",1,"max-w-50","max-h-50","object-contain","transform","rotate-12","select-none"],[1,"flex","items-center","justify-between","mb-4","pb-2","border-b","border-gray-700","relative","z-10"],[1,"flex","space-x-2"],[1,"w-3","h-3","bg-red-500","rounded-full"],[1,"w-3","h-3","bg-yellow-500","rounded-full"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-gray-400","text-xs"],[1,"whitespace-pre-wrap","text-white","relative","z-10"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-green-700"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),_("click",function(){return i.onVolverAVista()}),h(),n(5,"svg",5),u(6,"path",6),r(),a(7," Volver a tarjetas "),r(),y(),n(8,"div",7)(9,"button",8),_("click",function(){return i.mesAnterior()}),h(),n(10,"svg",9),u(11,"path",10),r()(),y(),n(12,"h2",11),a(13),r(),n(14,"button",8),_("click",function(){return i.mesSiguiente()}),h(),n(15,"svg",9),u(16,"path",12),r()()(),y(),n(17,"button",4),_("click",function(){return i.irAHoy()}),h(),n(18,"svg",5),u(19,"path",13),r(),a(20," Hoy "),r()()()(),y(),n(21,"div",14)(22,"div",15),x(23,Ra,2,1,"div",16),r(),n(24,"div",17),x(25,Ba,8,17,"div",18),r()(),n(26,"div",19)(27,"h3",20),a(28,"Leyenda"),r(),n(29,"div",21)(30,"div")(31,"h4",22),a(32,"Estado Temporal:"),r(),n(33,"div",23)(34,"div",24),u(35,"div",25),n(36,"span"),a(37,"Vigente"),r()(),n(38,"div",24),u(39,"div",26),n(40,"span"),a(41,"Pendiente"),r()(),n(42,"div",24),u(43,"div",27),n(44,"span"),a(45,"Vencida"),r()()()(),n(46,"div")(47,"h4",22),a(48,"Estado Individual:"),r(),n(49,"div",23)(50,"div",24)(51,"span",28),a(52,"\u2713"),r(),n(53,"span"),a(54,"Completada"),r()(),n(55,"div",24)(56,"span",28),a(57,"\u23F3"),r(),n(58,"span"),a(59,"En Progreso"),r()(),n(60,"div",24)(61,"span",28),a(62,"\u25CB"),r(),n(63,"span"),a(64,"Sin Iniciar"),r()(),n(65,"div",24)(66,"span",28),a(67,"\u2717"),r(),n(68,"span"),a(69,"Abandonada"),r()()()(),n(70,"div")(71,"h4",22),a(72,"Tipos de Terapia:"),r(),n(73,"div",23)(74,"div",24)(75,"span",28),a(76,"FIS"),r(),n(77,"span"),a(78,"F\xEDsica"),r()(),n(79,"div",24)(80,"span",28),a(81,"OCP"),r(),n(82,"span"),a(83,"Ocupacional"),r()(),n(84,"div",24)(85,"span",28),a(86,"RSP"),r(),n(87,"span"),a(88,"Respiratoria"),r()(),n(89,"div",24)(90,"span",28),a(91,"NEU"),r(),n(92,"span"),a(93,"Neurol\xF3gica"),r()()()()()(),n(94,"div",29)(95,"p")(96,"strong"),a(97),r(),a(98),r()()(),x(99,Wa,67,18,"div",30)),e&2&&(l(13),N(" ",i.meses[i.mesActual.getMonth()]," ",i.mesActual.getFullYear()," "),l(10),m("ngForOf",i.diasSemana),l(2),m("ngForOf",i.diasCalendario)("ngForTrackBy",i.trackByDate),l(72),C(i.terapias.length),l(),N(" terapia",i.terapias.length!==1?"s":""," asignada",i.terapias.length!==1?"s":""," \u2022 Haz clic en una terapia para ver los detalles completos "),l(),m("ngIf",i.showViewModal))},dependencies:[$,z,R],styles:[".calendario-container[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.celda-calendario[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.celda-calendario[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.terapia-evento[_ngcontent-%COMP%]{font-size:.75rem;line-height:1.2;border-radius:.25rem;transition:all .15s ease-in-out}.terapia-evento[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.terapia-vigente[_ngcontent-%COMP%]{border-left:3px solid #10b981;background-color:#ecfdf5}.terapia-pendiente[_ngcontent-%COMP%]{border-left:3px solid #3b82f6;background-color:#eff6ff}.terapia-vencida[_ngcontent-%COMP%]{border-left:3px solid #ef4444;background-color:#fef2f2}.dia-actual[_ngcontent-%COMP%]{background-color:#dbeafe!important;border:2px solid #3b82f6}.dia-actual[_ngcontent-%COMP%]   .numero-dia[_ngcontent-%COMP%]{color:#1d4ed8;font-weight:700}.nav-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.nav-button[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;transform:scale(1.05)}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.terminal-display[_ngcontent-%COMP%]{font-family:Courier New,Consolas,Monaco,monospace;background:linear-gradient(135deg,#1f2937,#111827)}.terminal-display[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{white-space:pre-wrap;word-wrap:break-word}.terminal-display[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.terminal-display[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#374151;border-radius:4px}.terminal-display[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#6b7280;border-radius:4px}.terminal-display[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}@media (max-width: 768px){.terapia-evento[_ngcontent-%COMP%]{font-size:.65rem;padding:.25rem}.celda-calendario[_ngcontent-%COMP%]{min-height:6rem}}@media print{.nav-button[_ngcontent-%COMP%], .modal-backdrop[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]{display:none!important}.calendario-container[_ngcontent-%COMP%]{margin:0;box-shadow:none}}.terapia-evento[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}.nav-button[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}.loading-skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}.watermark[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;user-select:none;opacity:.1;filter:grayscale(100%)}",".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}"]})};var Ha=(s,t,e,i)=>({"bg-gray-100 text-gray-800":s,"bg-yellow-100 text-yellow-800":t,"bg-green-100 text-green-800":e,"bg-red-100 text-red-800":i});function qa(s,t){if(s&1){let e=w();n(0,"div")(1,"app-calendario-terapias",18),_("volverAVista",function(){p(e);let o=c();return g(o.onVolverDeCalendario())})("abrirTerapia",function(o){p(e);let d=c();return g(d.onAbrirTerapiaDesdeCalendario(o))}),r()()}if(s&2){let e=c();l(),m("terapias",e.filteredTerapias)}}function Ya(s,t){if(s&1&&(n(0,"div",40)(1,"div",41),h(),n(2,"svg",42),u(3,"path",43),r(),y(),n(4,"div",44)(5,"p",45),a(6),r()()()()),s&2){let e=c(2);l(6),C(e.error)}}function Qa(s,t){s&1&&(n(0,"div",46),u(1,"div",47),r())}function Ja(s,t){if(s&1&&(n(0,"div",69)(1,"span"),a(2,"Adherencia:"),r(),n(3,"span"),a(4),r()()),s&2){let e=c(2).$implicit;l(4),v("",e.adherencia_porcentaje,"%")}}function Za(s,t){if(s&1&&(n(0,"div",68)(1,"div",69)(2,"span"),a(3,"Sesiones:"),r(),n(4,"span"),a(5),r()(),x(6,Ja,5,1,"div",82),r()),s&2){let e=c().$implicit;l(5),N("",e.sesiones_completadas," / ",e.sesiones_programadas,""),l(),m("ngIf",e.adherencia_porcentaje!==void 0)}}function Xa(s,t){if(s&1&&(n(0,"div"),a(1),r()),s&2){let e=c(2).$implicit,i=c(3);l(),v(" Iniciado: ",i.formatDate(e.fecha_inicio_real)," ")}}function Ka(s,t){if(s&1&&(n(0,"div"),a(1),r()),s&2){let e=c(2).$implicit,i=c(3);l(),v(" Completado: ",i.formatDate(e.fecha_fin_real)," ")}}function es(s,t){if(s&1&&(n(0,"div",83),x(1,Xa,2,1,"div",15)(2,Ka,2,1,"div",15),r()),s&2){let e=c().$implicit;l(),m("ngIf",e.fecha_inicio_real),l(),m("ngIf",e.fecha_fin_real)}}function ts(s,t){if(s&1&&(n(0,"div",84)(1,"p",85)(2,"strong"),a(3,"Mis notas:"),r(),a(4),r()()),s&2){let e=c().$implicit;l(4),v(" ",e.notas_individuales," ")}}function is(s,t){if(s&1){let e=w();n(0,"div",50)(1,"div")(2,"div",51)(3,"div",52)(4,"h3",53),a(5),r(),n(6,"p",54),a(7),r()(),n(8,"span",55),a(9),r()()(),n(10,"div",56)(11,"div",57)(12,"div",58)(13,"span",59),a(14,"Mi Progreso"),r(),n(15,"span",60),a(16),r()(),n(17,"div",61),u(18,"div",62),r(),n(19,"div",63)(20,"input",64),_("input",function(o){let d=p(e).$implicit,f=c(3);return g(f.actualizarMiProgreso(d,+o.target.value))}),r()()(),n(21,"div",65)(22,"span",66),a(23),r(),n(24,"span",67),a(25),r()(),n(26,"div",68)(27,"div",69)(28,"span"),a(29,"Inicio:"),r(),n(30,"span"),a(31),r()(),n(32,"div",69)(33,"span"),a(34,"Fin:"),r(),n(35,"span"),a(36),r()(),n(37,"div",70)(38,"span"),a(39,"D\xEDas restantes:"),r(),n(40,"span"),a(41),r()()(),n(42,"div",65)(43,"span",71),a(44),r(),n(45,"span",67),a(46),r()(),x(47,Za,7,3,"div",72)(48,es,3,2,"div",73)(49,ts,5,1,"div",74),n(50,"div",75)(51,"button",76),_("click",function(){let o=p(e).$implicit,d=c(3);return g(d.openViewModal(o))}),h(),n(52,"svg",77),u(53,"path",78)(54,"path",79),r()(),y(),n(55,"button",80),_("click",function(){let o=p(e).$implicit,d=c(3);return g(d.safeExportTerapia(o))}),h(),n(56,"svg",77),u(57,"path",81),r()()()()()}if(s&2){let e=t.$implicit,i=c(3);F("border-green-500",e.estado_temporal==="vigente")("border-blue-500",e.estado_temporal==="pendiente")("border-red-500",e.estado_temporal==="vencida"),l(),A("px-6 py-4 "+(e.estado_temporal==="vigente"?"bg-gradient-to-r from-green-500 to-green-600":e.estado_temporal==="pendiente"?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gradient-to-r from-red-500 to-red-600")),l(4),C(e.terapia_nombre),l(2),C(e.terapia_descripcion),l(2),v(" ",i.getEstadoTemporalText(e.estado_temporal)," "),l(7),v("",e.progreso,"%"),l(2),X("width",e.progreso,"%"),F("bg-gray-400",e.progreso===0)("bg-red-400",e.progreso>0&&e.progreso<30)("bg-yellow-400",e.progreso>=30&&e.progreso<70)("bg-green-400",e.progreso>=70),l(2),m("value",e.progreso),l(2),m("ngClass",xe(40,Ha,e.estado_individual==="pendiente",e.estado_individual==="en_progreso",e.estado_individual==="completada",e.estado_individual==="abandonada")),l(),v(" ",i.getEstadoIndividualText(e.estado_individual)," "),l(2),C(e.terapia_nivel),l(6),C(i.formatDate(e.fecha_inicio_programada)),l(5),C(i.formatDate(e.fecha_fin_programada)),l(),F("text-green-600",e.dias_restantes>7)("text-yellow-600",e.dias_restantes<=7&&e.dias_restantes>0)("text-red-600",e.dias_restantes<=0),l(4),C(i.formatDiasRestantes(e.dias_restantes)),l(3),v(" ",e.terapia_tipo," "),l(2),C(i.formatDuracion(e.duracion_estimada)),l(),m("ngIf",e.sesiones_completadas!==void 0&&e.sesiones_programadas!==void 0),l(),m("ngIf",e.fecha_inicio_real||e.fecha_fin_real),l(),m("ngIf",e.notas_individuales)}}function ns(s,t){if(s&1&&(n(0,"div",48),x(1,is,58,45,"div",49),r()),s&2){let e=c(2);l(),m("ngForOf",e.filteredTerapias)("ngForTrackBy",e.trackByTerapiaId)}}function rs(s,t){s&1&&(fe(0),a(1," No tienes terapias asignadas en este momento. "),_e())}function os(s,t){s&1&&a(0," No se encontraron terapias con los filtros aplicados. ")}function as(s,t){if(s&1){let e=w();n(0,"button",94),_("click",function(){p(e);let o=c(3);return g(o.clearFilters())}),a(1," Limpiar filtros "),r()}}function ss(s,t){if(s&1&&(n(0,"div",86),h(),n(1,"svg",87),u(2,"path",88),r(),y(),n(3,"h3",89),a(4,"No hay terapias asignadas"),r(),n(5,"p",90),x(6,rs,2,0,"ng-container",91)(7,os,1,0,"ng-template",null,0,K),r(),n(9,"div",92),x(10,as,2,0,"button",93),r()()),s&2){let e=Y(8),i=c(2);l(6),m("ngIf",i.misTerapias.length===0)("ngIfElse",e),l(4),m("ngIf",i.misTerapias.length>0)}}function ls(s,t){if(s&1){let e=w();n(0,"div")(1,"div",19)(2,"div",20)(3,"div",21)(4,"label",22),a(5,"Buscar"),r(),n(6,"input",23),T("ngModelChange",function(o){p(e);let d=c();return k(d.searchTerm,o)||(d.searchTerm=o),g(o)}),_("input",function(){p(e);let o=c();return g(o.onSearch())}),r()(),n(7,"div")(8,"label",22),a(9,"Per\xEDodo"),r(),n(10,"select",24),T("ngModelChange",function(o){p(e);let d=c();return k(d.estadoFilter,o)||(d.estadoFilter=o),g(o)}),_("change",function(){p(e);let o=c();return g(o.onFilterChange())}),n(11,"option",25),a(12,"Todos"),r(),n(13,"option",26),a(14,"Vigentes"),r(),n(15,"option",27),a(16,"Pendientes"),r(),n(17,"option",28),a(18,"Vencidas"),r()()(),n(19,"div")(20,"label",22),a(21,"Mi Estado"),r(),n(22,"select",24),T("ngModelChange",function(o){p(e);let d=c();return k(d.estadoIndividualFilter,o)||(d.estadoIndividualFilter=o),g(o)}),_("change",function(){p(e);let o=c();return g(o.onFilterChange())}),n(23,"option",25),a(24,"Todos"),r(),n(25,"option",27),a(26,"Pendiente"),r(),n(27,"option",29),a(28,"En Progreso"),r(),n(29,"option",30),a(30,"Completada"),r(),n(31,"option",31),a(32,"Abandonada"),r()()(),n(33,"div")(34,"label",22),a(35,"Progreso"),r(),n(36,"select",24),T("ngModelChange",function(o){p(e);let d=c();return k(d.progresoFilter,o)||(d.progresoFilter=o),g(o)}),_("change",function(){p(e);let o=c();return g(o.onFilterChange())}),n(37,"option",25),a(38,"Todos"),r(),n(39,"option",32),a(40,"Sin Iniciar (0%)"),r(),n(41,"option",29),a(42,"En Progreso (1-99%)"),r(),n(43,"option",33),a(44,"Completado (100%)"),r()()()(),n(45,"div",34)(46,"button",35),_("click",function(){p(e);let o=c();return g(o.clearFilters())}),a(47," Limpiar filtros "),r()()(),x(48,Ya,7,1,"div",36)(49,Qa,2,0,"div",37)(50,ns,2,2,"div",38)(51,ss,11,3,"div",39),r()}if(s&2){let e=c();l(6),E("ngModel",e.searchTerm),l(4),E("ngModel",e.estadoFilter),l(12),E("ngModel",e.estadoIndividualFilter),l(14),E("ngModel",e.progresoFilter),l(12),m("ngIf",e.error&&!e.showViewModal),l(),m("ngIf",e.loading),l(),m("ngIf",!e.loading),l(),m("ngIf",!e.loading&&e.filteredTerapias.length===0)}}function ds(s,t){s&1&&(n(0,"div",130)(1,"div",41),h(),n(2,"svg",131),u(3,"path",132),r(),y(),n(4,"div",44)(5,"p",133),a(6,"\xA1Terapia copiada al portapapeles!"),r()()()())}function cs(s,t){if(s&1){let e=w();n(0,"div",95)(1,"div",96)(2,"div",97),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),r(),n(3,"span",98),a(4,"\u200B"),r(),n(5,"div",99)(6,"div",100)(7,"div",101)(8,"div",102),h(),n(9,"svg",103),u(10,"path",88),r()(),y(),n(11,"div",104)(12,"h3",105),a(13),r(),n(14,"div",106)(15,"p",67),a(16),r()()()()(),n(17,"div",107)(18,"div",108)(19,"div",109)(20,"div")(21,"span",110),a(22,"Mi Progreso:"),r(),n(23,"div",111)(24,"div",112),u(25,"div",113),r(),a(26),r()(),n(27,"div")(28,"span",110),a(29,"Estado:"),r(),n(30,"div",114),a(31),r()(),n(32,"div")(33,"span",110),a(34,"Per\xEDodo:"),r(),n(35,"div",114),a(36),r()(),n(37,"div")(38,"span",110),a(39,"D\xEDas restantes:"),r(),n(40,"div",114),a(41),r()()()(),n(42,"div",115)(43,"div",116),u(44,"img",117),r(),n(45,"div",118)(46,"div",6),u(47,"div",119)(48,"div",120)(49,"div",121),r(),n(50,"div",122),a(51),r()(),n(52,"pre",123),a(53),r()(),x(54,ds,7,0,"div",124),n(55,"div",125)(56,"button",126),_("click",function(){let o;p(e);let d=c();return g(d.copyToClipboard(d.getFormattedTerapia(d.selectedTerapia,(o=d.selectedSeguimiento)!==null&&o!==void 0?o:void 0)))}),h(),n(57,"svg",127),u(58,"path",81),r(),a(59," Descargar "),r()()(),y(),n(60,"div",128)(61,"button",129),_("click",function(){p(e);let o=c();return g(o.closeViewModal())}),a(62," Cerrar "),r()()()()()}if(s&2){let e=c();l(13),v(" ",e.selectedTerapia==null?null:e.selectedTerapia.nombre," "),l(3),v(" Mi terapia asignada - Progreso: ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(9),X("width",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"%"),l(),v(" ",e.selectedSeguimiento==null?null:e.selectedSeguimiento.progreso,"% "),l(5),C(e.getEstadoIndividualText((e.selectedSeguimiento==null?null:e.selectedSeguimiento.estado_individual)||"")),l(5),N(" ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_inicio_programada)," - ",e.formatDate(e.selectedSeguimiento==null?null:e.selectedSeguimiento.fecha_fin_programada)," "),l(4),F("text-green-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>7)("text-yellow-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=7&&((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)>0)("text-red-600",((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)<=0),l(),v(" ",e.formatDiasRestantes((e.selectedSeguimiento==null?null:e.selectedSeguimiento.dias_restantes)||0)," "),l(10),v(" ",e.getFileName(e.selectedTerapia)," "),l(2),C(e.getFormattedTerapia(e.selectedTerapia,e.selectedSeguimiento||void 0)),l(),m("ngIf",e.copySuccess)}}function ms(s,t){s&1&&(h(),n(0,"svg",145),u(1,"path",132),r())}function us(s,t){s&1&&(h(),n(0,"svg",145),u(1,"path",144),r())}function ps(s,t){s&1&&(h(),n(0,"svg",145),u(1,"path",146),r())}function gs(s,t){s&1&&(h(),n(0,"svg",145),u(1,"path",147),r())}function fs(s,t){if(s&1){let e=w();n(0,"div")(1,"div",134)(2,"div",135)(3,"div",136)(4,"div",137),x(5,ms,2,0,"svg",138)(6,us,2,0,"svg",138)(7,ps,2,0,"svg",138)(8,gs,2,0,"svg",138),r(),n(9,"div",139)(10,"p",140),a(11),r()(),n(12,"div",141)(13,"button",142),_("click",function(){p(e);let o=c();return g(o.cerrarNotificacion())}),h(),n(14,"svg",143),u(15,"path",144),r()()()()()()()}if(s&2){let e=c();A("fixed top-4 right-4 z-50 max-w-sm w-full shadow-lg rounded-lg pointer-events-auto "+(e.tipoMensaje==="success"?"bg-green-500":e.tipoMensaje==="error"?"bg-red-500":e.tipoMensaje==="warning"?"bg-yellow-500":"bg-blue-500")),l(5),m("ngIf",e.tipoMensaje==="success"),l(),m("ngIf",e.tipoMensaje==="error"),l(),m("ngIf",e.tipoMensaje==="info"),l(),m("ngIf",e.tipoMensaje==="warning"),l(3),C(e.mensaje)}}var ct=class s{constructor(t,e){this.terapiasService=t;this.authService=e}vistaActual="calendario";misTerapias=[];filteredTerapias=[];estadisticasPersonales;loading=!1;error="";showViewModal=!1;selectedTerapia=null;selectedSeguimiento=null;copySuccess=!1;mensaje="";tipoMensaje="info";mostrarMensaje=!1;searchTerm="";estadoFilter="all";estadoIndividualFilter="all";progresoFilter="all";ngOnInit(){return b(this,null,function*(){yield Promise.all([this.loadMisTerapias(),this.loadEstadisticasPersonales()])})}get mostrarVistaTarjetas(){return this.vistaActual==="tarjetas"}get mostrarVistaCalendario(){return this.vistaActual==="calendario"}onCambiarACalendario(){console.log("Cambiando a vista de calendario"),this.vistaActual="calendario"}onCambiarATarjetas(){console.log("Cambiando a vista de tarjetas"),this.vistaActual="tarjetas"}onVolverDeCalendario(){console.log("Volviendo de calendario a tarjetas"),this.vistaActual="tarjetas"}onAbrirTerapiaDesdeCalendario(t){console.log("Abriendo terapia desde calendario:",t.terapia_nombre),this.vistaActual="tarjetas",setTimeout(()=>{this.openViewModal(t)},100)}loadMisTerapias(){return b(this,null,function*(){this.loading=!0,this.error="";try{console.log("Cargando terapias asignadas al usuario...");let t=this.authService.getCurrentUser();if(!t?.id)throw new Error("No se pudo obtener el usuario actual");console.log("Usuario actual:",t.id);let e=[];try{e=(yield this.terapiasService.getTerapiasAsignadasUsuarios()).filter(o=>o.id_profile===t.id),console.log("Terapias filtradas para el usuario:",e.length)}catch(i){console.warn("Error con el servicio principal, intentando m\xE9todo alternativo:",i),e=[]}this.misTerapias=e.map(i=>{let o=this.convertirFechaAString(i.fecha_inicio_programada),d=this.convertirFechaAString(i.fecha_fin_programada),{estado:f,diasRestantes:S}=this.calcularEstadoTemporal(o,d);return{seguimiento_id:i.seguimiento_id,asignacion_id:i.asignacion_id,id_profile:i.id_profile,username:i.username||t.username||"",full_name:i.full_name||t.full_name||"",terapia_nombre:i.terapia_nombre,terapia_id:i.id_terapia||0,terapia_descripcion:i.terapia_descripcion,terapia_tipo:i.terapia_tipo,terapia_nivel:i.terapia_nivel,duracion_estimada:i.duracion_estimada,progreso:i.progreso||0,estado_individual:i.estado_individual||"pendiente",fecha_inicio_real:this.convertirFechaAString(i.fecha_inicio_real),fecha_fin_real:this.convertirFechaAString(i.fecha_fin_real),fecha_inicio_programada:o,fecha_fin_programada:d,notas_individuales:i.notas_individuales,estado_temporal:f,dias_restantes:S,sesiones_completadas:i.sesiones_completadas||0,sesiones_programadas:i.sesiones_programadas||0,adherencia_porcentaje:i.adherencia_porcentaje||0,nivel_dolor_actual:i.nivel_dolor_actual||0,nivel_funcionalidad_actual:i.nivel_funcionalidad_actual||0}}),this.filteredTerapias=[...this.misTerapias],this.applyFilters(),console.log("Mis terapias cargadas:",this.misTerapias.length)}catch(t){console.error("Error cargando mis terapias:",t),this.error="Error al cargar tus terapias asignadas",this.misTerapias=[],this.filteredTerapias=[]}finally{this.loading=!1}})}loadEstadisticasPersonales(){return b(this,null,function*(){try{if(this.misTerapias.length===0)return;let t=this.misTerapias.length,e=this.misTerapias.filter(B=>B.estado_temporal==="vigente").length,i=this.misTerapias.filter(B=>B.estado_individual==="completada").length,o=this.misTerapias.filter(B=>B.estado_individual==="en_progreso").length,d=this.misTerapias.filter(B=>B.estado_individual==="pendiente").length,f=this.misTerapias.filter(B=>B.estado_temporal==="vencida").length,S=this.misTerapias.reduce((B,J)=>B+J.progreso,0),P=t>0?Math.round(S/t):0,M=this.misTerapias.reduce((B,J)=>B+(J.adherencia_porcentaje||0),0),U=t>0?Math.round(M/t):0,I=this.misTerapias.reduce((B,J)=>B+(J.sesiones_completadas||0),0);this.estadisticasPersonales={total_terapias_asignadas:t,terapias_vigentes:e,terapias_completadas:i,terapias_en_progreso:o,terapias_pendientes:d,terapias_vencidas:f,progreso_promedio:P,adherencia_promedio:U,sesiones_completadas_total:I}}catch(t){console.error("Error calculando estad\xEDsticas personales:",t)}})}applyFilters(){let t=[...this.misTerapias];if(this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.terapia_nombre.toLowerCase().includes(e)||i.terapia_descripcion?.toLowerCase().includes(e)||i.terapia_tipo.toLowerCase().includes(e))}if(this.estadoFilter!=="all"&&(t=t.filter(e=>e.estado_temporal===this.estadoFilter)),this.estadoIndividualFilter!=="all"&&(t=t.filter(e=>e.estado_individual===this.estadoIndividualFilter)),this.progresoFilter!=="all")switch(this.progresoFilter){case"sin_iniciar":t=t.filter(e=>e.progreso===0);break;case"en_progreso":t=t.filter(e=>e.progreso>0&&e.progreso<100);break;case"completado":t=t.filter(e=>e.progreso===100);break}this.filteredTerapias=t}openViewModal(t){return b(this,null,function*(){console.log("Abriendo modal para ver terapia:",t.terapia_nombre),this.selectedSeguimiento=t;try{console.log("Cargando terapia completa desde BD para ID:",t.terapia_id);let e=yield this.terapiasService.getTerapiaById(t.terapia_id);e?(console.log("\u2705 Terapia completa cargada desde BD:",e),this.selectedTerapia=e):(console.warn("\u26A0\uFE0F No se encontr\xF3 terapia en BD, usando informaci\xF3n b\xE1sica"),this.selectedTerapia=this.crearTerapiaBasica(t))}catch(e){console.error("\u274C Error cargando terapia completa desde BD:",e),this.selectedTerapia=this.crearTerapiaBasica(t)}this.showViewModal=!0})}crearTerapiaBasica(t){return{id:t.terapia_id,nombre:t.terapia_nombre,descripcion:t.terapia_descripcion||"Informaci\xF3n detallada disponible con el terapeuta",tipo:t.terapia_tipo,nivel:t.terapia_nivel,duracion_estimada:t.duracion_estimada,area_especializacion:this.obtenerAreaEspecializacion(t.terapia_tipo),ejercicios:null,objetivo_principal:null,contraindicaciones:null,criterios_progresion:null,recomendaciones:null,observaciones:"Para informaci\xF3n detallada de ejercicios y contraindicaciones, consulte con su terapeuta"}}obtenerAreaEspecializacion(t){switch(t.toLowerCase()){case"fisica":return"Fisioterapia";case"ocupacional":return"Terapia Ocupacional";case"respiratoria":return"Fisioterapia Respiratoria";case"neurologica":return"Neurorehabilitaci\xF3n";default:return"Rehabilitaci\xF3n General"}}closeViewModal(){console.log("Cerrando modal de vista"),this.showViewModal=!1,this.selectedTerapia=null,this.selectedSeguimiento=null,this.copySuccess=!1}actualizarMiProgreso(t,e){return b(this,null,function*(){try{(yield this.terapiasService.actualizarProgresoTerapia(t.seguimiento_id,{progreso:e,estado_individual:this.determinarEstadoPorProgreso(e),sesiones_completadas:t.sesiones_completadas||0,adherencia_porcentaje:t.adherencia_porcentaje||0,nivel_dolor_actual:t.nivel_dolor_actual||0,nivel_funcionalidad_actual:t.nivel_funcionalidad_actual||0,notas_individuales:t.notas_individuales||""}))&&(t.progreso=e,t.estado_individual=this.determinarEstadoPorProgreso(e),e>0&&!t.fecha_inicio_real&&(t.fecha_inicio_real=new Date().toISOString().split("T")[0]),e===100&&(t.fecha_fin_real=new Date().toISOString().split("T")[0]),yield this.loadEstadisticasPersonales(),this.mostrarNotificacion("Progreso actualizado correctamente","success"))}catch(i){console.error("Error actualizando progreso:",i),this.error="Error al actualizar el progreso",this.mostrarNotificacion("Error al actualizar el progreso","error"),setTimeout(()=>this.error="",5e3)}})}convertirFechaAString(t){return t?t instanceof Date?t.toISOString().split("T")[0]:t:""}calcularEstadoTemporal(t,e){let i=new Date,o=new Date(t),d=new Date(e);i.setHours(0,0,0,0),o.setHours(0,0,0,0),d.setHours(0,0,0,0);let f=Math.ceil((d.getTime()-i.getTime())/(1e3*60*60*24)),S;return i<o?S="pendiente":i<=d?S="vigente":S="vencida",{estado:S,diasRestantes:f}}determinarEstadoPorProgreso(t){return t===0?"pendiente":t===100?"completada":"en_progreso"}getFormattedTerapia(t,e){if(console.log("\u{1F5A8}\uFE0F Formateando terapia desde BD:",{terapia:t,seguimiento:e}),!t&&!e)return console.warn("No hay datos de terapia ni seguimiento"),"No hay informaci\xF3n disponible para mostrar.";!t&&e&&(t=this.crearTerapiaBasica(e));let i=`${t.nombre||e?.terapia_nombre||"Terapia sin nombre"}
`;if(i+=`${t.descripcion||e?.terapia_descripcion||"Informaci\xF3n detallada disponible con el terapeuta"}
`,i+=`Tipo: ${t.tipo||e?.terapia_tipo||"No especificado"} | Nivel: ${t.nivel||e?.terapia_nivel||"No especificado"}
`,t.area_especializacion&&(i+=`\xC1rea: ${t.area_especializacion}
`),i+=`Duraci\xF3n estimada: ${this.formatDuracion(t.duracion_estimada||e?.duracion_estimada)}

`,e&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                          MI PROGRESO
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`Estado: ${this.getEstadoIndividualText(e.estado_individual)} (${e.progreso}%)
`,i+=`Per\xEDodo: ${this.formatDate(e.fecha_inicio_programada)} - ${this.formatDate(e.fecha_fin_programada)}
`,e.estado_temporal==="vigente"&&e.dias_restantes!==void 0&&(i+=`D\xEDas restantes: ${this.formatDiasRestantes(e.dias_restantes)}
`),e.fecha_inicio_real&&(i+=`Iniciado: ${this.formatDate(e.fecha_inicio_real)}
`),e.sesiones_completadas!==void 0&&e.sesiones_programadas!==void 0&&(i+=`Sesiones completadas: ${e.sesiones_completadas} / ${e.sesiones_programadas}
`),e.adherencia_porcentaje!==void 0&&(i+=`Adherencia: ${e.adherencia_porcentaje}%
`),i+=`
`),t.objetivo_principal&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      OBJETIVO PRINCIPAL
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.objetivo_principal}

`),t.ejercicios&&typeof t.ejercicios=="object"&&Object.keys(t.ejercicios).length>0){console.log("\u{1F4CB} Procesando ejercicios desde BD:",t.ejercicios),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      PLAN DE EJERCICIOS
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`;let o=["calentamiento","fortalecimiento","equilibrio","coordinacion","estiramiento","respiracion","flexibilidad","movilidad","resistencia"],d=0;o.forEach(f=>{let S=t.ejercicios[f];if(S&&S.ejercicios&&Array.isArray(S.ejercicios)&&S.ejercicios.length>0){d++,i+=`${f.toUpperCase()}
`,i+=`${"\u2500".repeat(f.length)}
`,S.descripcion&&(i+=`${S.descripcion}
`);let P=[];S.tiempo_total&&P.push(`Tiempo: ${S.tiempo_total}`),S.objetivos&&Array.isArray(S.objetivos)&&S.objetivos.length>0&&P.push(`Objetivos: ${S.objetivos.join(", ")}`),P.length>0&&(i+=`${P.join(" | ")}
`),i+=`
`,S.ejercicios.forEach((M,U)=>{i+=`${U+1}. ${M.nombre||"Ejercicio sin nombre"}
`,M.descripcion&&(i+=`   ${M.descripcion}
`);let I=[];M.series&&I.push(`${M.series} series`),M.repeticiones&&I.push(`${M.repeticiones} reps`),M.duracion&&I.push(`${M.duracion}`),M.resistencia&&I.push(`Resistencia: ${M.resistencia}`),M.equipamiento&&Array.isArray(M.equipamiento)&&M.equipamiento.length>0&&I.push(`Equipo: ${M.equipamiento.join(", ")}`),I.length>0&&(i+=`   ${I.join(" | ")}
`),M.ejecucion&&(i+=`   Ejecuci\xF3n: ${M.ejecucion}
`),M.precauciones&&(i+=`   \u26A0\uFE0F  ${M.precauciones}
`),M.modificaciones&&(M.modificaciones.principiante&&(i+=`   \u{1F4A1} Principiante: ${M.modificaciones.principiante}
`),M.modificaciones.limitaciones&&(i+=`   \u{1F527} Limitaciones: ${M.modificaciones.limitaciones}
`)),M.observaciones&&(i+=`   \u{1F4DD} ${M.observaciones}
`),i+=`
`}),i+=`
`}}),d===0&&(console.log("\u{1F50D} No se encontraron secciones organizadas, buscando ejercicios directos..."),Array.isArray(t.ejercicios)?(i+=`EJERCICIOS
`,i+=`\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500

`,t.ejercicios.forEach((f,S)=>{i+=`${S+1}. ${f.nombre||"Ejercicio sin nombre"}
`,f.descripcion&&(i+=`   ${f.descripcion}
`);let P=[];f.series&&P.push(`${f.series} series`),f.repeticiones&&P.push(`${f.repeticiones} reps`),f.duracion&&P.push(`${f.duracion}`),P.length>0&&(i+=`   ${P.join(" | ")}
`),f.observaciones&&(i+=`   \u{1F4DD} ${f.observaciones}
`),i+=`
`})):(console.log("\u26A0\uFE0F Estructura de ejercicios no reconocida:",typeof t.ejercicios),i+=`INFORMACI\xD3N DE EJERCICIOS
`,i+=`\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500

`,i+=`Los ejercicios est\xE1n disponibles en la base de datos.
`,i+=`Consulte con su terapeuta para obtener el plan de ejercicios detallado.

`))}else console.log("\u2139\uFE0F No hay ejercicios en BD o estructura vac\xEDa"),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                    PLAN DE EJERCICIOS
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`El plan de ejercicios detallado est\xE1 disponible con su terapeuta.
`,i+=`Consulte directamente para obtener las instrucciones espec\xEDficas.

`;return t.contraindicaciones&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                     CONTRAINDICACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.contraindicaciones}

`),t.criterios_progresion&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                   CRITERIOS DE PROGRESI\xD3N
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.criterios_progresion}

`),t.recomendaciones&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      RECOMENDACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.recomendaciones}

`),t.observaciones&&t.observaciones!=="Para informaci\xF3n detallada de ejercicios y contraindicaciones, consulte con su terapeuta"&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                      OBSERVACIONES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${t.observaciones}

`),e?.notas_individuales&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                   MIS NOTAS PERSONALES
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,i+=`${e.notas_individuales}

`),e&&(e.nivel_dolor_actual!==void 0||e.nivel_funcionalidad_actual!==void 0)&&(i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`                     EVALUACI\xD3N ACTUAL
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501

`,e.nivel_dolor_actual!==void 0&&e.nivel_dolor_actual>0&&(i+=`Nivel de dolor: ${e.nivel_dolor_actual}/10
`),e.nivel_funcionalidad_actual!==void 0&&e.nivel_funcionalidad_actual>0&&(i+=`Funcionalidad: ${e.nivel_funcionalidad_actual}%
`),i+=`
`),t.tags&&Array.isArray(t.tags)&&t.tags.length>0&&(i+=`Tags: ${t.tags.map(o=>`#${o}`).join(" ")}

`),i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,i+=`\xDAltima actualizaci\xF3n: ${this.formatDate(new Date().toISOString())}
`,i+=`Generado por: rehabiMovement - Sistema de Rehabilitaci\xF3n
`,i+=`ID de Terapia: ${t.id||e?.terapia_id||"N/A"}
`,i+=`\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
`,console.log("\u2705 Texto generado con datos reales de BD"),i}getFileName(t){return!t||!t.nombre?"mi_terapia.txt":t.nombre.replace(/\s+/g,"_")+"_mi_terapia.txt"}safeExportTerapia(t){let e=t.terapia_completa||this.selectedTerapia||{nombre:t.terapia_nombre,descripcion:t.terapia_descripcion,tipo:t.terapia_tipo,nivel:t.terapia_nivel,duracion_estimada:t.duracion_estimada};e?this.exportarTerapia(e,t):console.warn("No hay terapia disponible para exportar")}exportarTerapia(t,e){if(!t){console.warn("No hay terapia para exportar");return}let i=this.getFormattedTerapia(t,e);if(!i){console.warn("No se pudo generar el contenido para exportar");return}let o=new Blob([i],{type:"text/plain;charset=utf-8"}),d=window.URL.createObjectURL(o),f=document.createElement("a");f.href=d,f.download=`${t.nombre.replace(/\s+/g,"_")}_mi_terapia.txt`,f.click(),window.URL.revokeObjectURL(d),console.log("Mi terapia exportada:",t.nombre),this.mostrarNotificacion("Terapia exportada correctamente","success")}onSearch(){this.applyFilters()}onFilterChange(){this.applyFilters()}clearFilters(){this.searchTerm="",this.estadoFilter="all",this.estadoIndividualFilter="all",this.progresoFilter="all",this.applyFilters()}refreshMisTerapias(){return b(this,null,function*(){yield Promise.all([this.loadMisTerapias(),this.loadEstadisticasPersonales()]),this.mostrarNotificacion("Terapias actualizadas","success")})}mostrarNotificacion(t,e="info"){this.mensaje=t,this.tipoMensaje=e,this.mostrarMensaje=!0,setTimeout(()=>{this.mostrarMensaje=!1},3e3)}cerrarNotificacion(){this.mostrarMensaje=!1}formatDuracion(t){if(!t)return"N/A";let e=Math.floor(t/60),i=t%60;return e>0?`${e}h ${i}m`:`${i}m`}formatDate(t){if(!t)return"N/A";try{let e;return t instanceof Date?e=t:e=new Date(t),isNaN(e.getTime())?"Fecha inv\xE1lida":e.toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"Fecha inv\xE1lida"}}formatDiasRestantes(t){return t==null?"No disponible":t<0?`Vencida hace ${Math.abs(t)} d\xEDa${Math.abs(t)!==1?"s":""}`:t===0?"Vence hoy":t===1?"Vence ma\xF1ana":`${t} d\xEDas restantes`}getEstadoTemporalText(t){switch(t){case"vigente":return"Vigente";case"pendiente":return"Pendiente";case"vencida":return"Vencida";default:return"Desconocido"}}getEstadoIndividualText(t){if(!t)return"Desconocido";switch(t){case"completada":return"Completada";case"en_progreso":return"En Progreso";case"pendiente":return"Sin Iniciar";case"abandonada":return"Abandonada";default:return"Desconocido"}}getEstadoTemporalColor(t){switch(t){case"vigente":return"green";case"pendiente":return"blue";case"vencida":return"red";default:return"gray"}}getEstadoIndividualColor(t){switch(t){case"pendiente":return"gray";case"en_progreso":return"yellow";case"completada":return"green";case"abandonada":return"red";default:return"gray"}}getProgresoColor(t){return t===0?"gray":t<30?"red":t<70?"yellow":"green"}copyToClipboard(t){return b(this,null,function*(){try{yield navigator.clipboard.writeText(t),this.copySuccess=!0,console.log("Texto copiado al portapapeles"),setTimeout(()=>{this.copySuccess=!1},2e3)}catch(e){console.error("Error al copiar al portapapeles:",e),this.fallbackCopyTextToClipboard(t)}})}fallbackCopyTextToClipboard(t){let e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")&&(this.copySuccess=!0,setTimeout(()=>{this.copySuccess=!1},2e3))}catch(i){console.error("Fallback: Error al copiar al portapapeles:",i)}document.body.removeChild(e)}trackByTerapiaId(t,e){return e.seguimiento_id||t}static \u0275fac=function(e){return new(e||s)(O(Pe),O(L))};static \u0275cmp=D({type:s,selectors:[["app-mis-terapias"]],standalone:!1,decls:26,vars:9,consts:[["filtrosAplicados",""],[1,"max-w-7xl","mx-auto","py-6","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-sm","text-gray-600"],[1,"flex","space-x-2"],[1,"flex","bg-gray-100","rounded-lg","p-1"],[3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1","inline"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3a2 2 0 012-2h8a2 2 0 012 2v4m-4 0V3m-4 4h8m-8 0H6a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"],["title","Refrescar lista",1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto",4,"ngIf"],[3,"class",4,"ngIf"],[3,"volverAVista","abrirTerapia","terapias"],[1,"bg-white","rounded-lg","shadow","mb-6","p-6"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4"],[1,"md:col-span-2"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","placeholder","Buscar terapias...",1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","input","ngModel"],[1,"block","w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","change","ngModel"],["value","all"],["value","vigente"],["value","pendiente"],["value","vencida"],["value","en_progreso"],["value","completada"],["value","abandonada"],["value","sin_iniciar"],["value","completado"],[1,"mt-4","flex","justify-end"],[1,"text-sm","text-blue-600","hover:text-blue-800",3,"click"],["class","bg-red-50 border border-red-200 rounded-md p-4 mb-6",4,"ngIf"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf"],["class","text-center py-12",4,"ngIf"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4","mb-6"],[1,"flex"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 border-l-4",3,"border-green-500","border-blue-500","border-red-500",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-white","rounded-lg","shadow-lg","overflow-hidden","hover:shadow-xl","transition-shadow","duration-300","border-l-4"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"text-xl","font-bold","text-white"],[1,"text-white","text-opacity-90","text-sm"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-white","bg-opacity-20","text-white"],[1,"p-6"],[1,"mb-4"],[1,"flex","justify-between","items-center","mb-2"],[1,"text-sm","font-medium","text-gray-700"],[1,"text-sm","font-bold","text-gray-900"],[1,"w-full","bg-gray-200","rounded-full","h-3"],[1,"h-3","rounded-full","transition-all","duration-300"],[1,"mt-3"],["type","range","min","0","max","100","step","5","title","Desliza para actualizar tu progreso",1,"w-full","h-2","bg-gray-200","rounded-lg","appearance-none","cursor-pointer","slider",3,"input","value"],[1,"flex","justify-between","items-center","mb-4"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-600","mb-4"],[1,"flex","justify-between"],[1,"flex","justify-between","font-medium"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],["class","text-sm text-gray-600 mb-4",4,"ngIf"],["class","text-xs text-gray-500 mb-4",4,"ngIf"],["class","mb-4 p-3 bg-gray-50 rounded-md",4,"ngIf"],[1,"flex","justify-end","space-x-2"],["title","Ver terapia completa",1,"text-blue-600","hover:text-blue-900","p-2","rounded-full","hover:bg-blue-50","transition-colors","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Descargar mi terapia",1,"text-purple-600","hover:text-purple-900","p-2","rounded-full","hover:bg-purple-50","transition-colors","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["class","flex justify-between",4,"ngIf"],[1,"text-xs","text-gray-500","mb-4"],[1,"mb-4","p-3","bg-gray-50","rounded-md"],[1,"text-sm","text-gray-700"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[4,"ngIf","ngIfElse"],[1,"mt-6"],["class","inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","shadow-sm","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-center","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-5xl","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],[1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"bg-white","px-4","pb-4","sm:px-6"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"text-gray-900","flex","items-center"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-2"],[1,"bg-blue-600","h-2","rounded-full"],[1,"text-gray-900"],[1,"bg-gray-900","text-green-400","rounded-lg","p-6","font-mono","text-sm","overflow-auto","max-h-96","relative",2,"font-family","'Courier New', monospace","line-height","1.6"],[1,"absolute","inset-15","flex","items-center","justify-center","pointer-events-none","opacity-25"],["src","/rh.png","alt","RehabiMovement",1,"max-w-50","max-h-50","object-contain","transform","rotate-12","select-none"],[1,"flex","items-center","justify-between","mb-4","pb-2","border-b","border-gray-700","relative","z-10"],[1,"w-3","h-3","bg-red-500","rounded-full"],[1,"w-3","h-3","bg-yellow-500","rounded-full"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-gray-400","text-xs"],[1,"whitespace-pre-wrap","text-white","relative","z-10"],["class","mt-4 bg-green-50 border border-green-200 rounded-md p-3",4,"ngIf"],[1,"mt-4","flex","justify-between"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-2"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:w-auto","sm:text-sm",3,"click"],[1,"mt-4","bg-green-50","border","border-green-200","rounded-md","p-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-green-700"],[1,"rounded-lg","shadow-xs","overflow-hidden"],[1,"p-4"],[1,"flex","items-start"],[1,"flex-shrink-0"],["class","h-6 w-6 text-white","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"ml-3","w-0","flex-1","pt-0.5"],[1,"text-sm","leading-5","font-medium","text-white"],[1,"ml-4","flex-shrink-0","flex"],[1,"inline-flex","text-white","hover:text-gray-200","focus:outline-none","focus:text-gray-200","transition","ease-in-out","duration-150",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z"]],template:function(e,i){e&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"h1",4),a(5,"Mis Terapias Asignadas"),r(),n(6,"p",5),a(7),r()(),n(8,"div",6)(9,"div",7)(10,"button",8),_("click",function(){return i.onCambiarACalendario()}),h(),n(11,"svg",9),u(12,"path",10),r(),a(13," Calendario "),r(),y(),n(14,"button",8),_("click",function(){return i.onCambiarATarjetas()}),h(),n(15,"svg",9),u(16,"path",11),r(),a(17," Tarjetas "),r()(),y(),n(18,"button",12),_("click",function(){return i.refreshMisTerapias()}),h(),n(19,"svg",13),u(20,"path",14),r(),a(21," Refrescar "),r()()()(),x(22,qa,2,1,"div",15)(23,ls,52,8,"div",15),r(),x(24,cs,63,18,"div",16)(25,fs,16,7,"div",17)),e&2&&(l(7),v(" Terapias que me han sido asignadas - Total: ",i.misTerapias.length," "),l(3),A("px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 "+(i.vistaActual==="calendario"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900")),l(4),A("px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 "+(i.vistaActual==="tarjetas"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900")),l(8),m("ngIf",i.mostrarVistaCalendario),l(),m("ngIf",i.mostrarVistaTarjetas),l(),m("ngIf",i.showViewModal),l(),m("ngIf",i.mostrarMensaje))},dependencies:[$,z,R,ne,re,W,ie,G,H,dt],styles:['.mis-terapias-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#f9fafb}.terapia-card[_ngcontent-%COMP%]{transition:all .3s ease;border:1px solid #e5e7eb}.terapia-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000001a}.terapia-header-vigente[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#1d4ed8)}.terapia-header-vencida[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626)}.terapia-header-pendiente[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563)}.progress-bar-container[_ngcontent-%COMP%]{position:relative;overflow:hidden}.progress-bar[_ngcontent-%COMP%]{transition:width .6s ease-in-out;position:relative}.progress-bar[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);animation:_ngcontent-%COMP%_shimmer 2s infinite}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.badge-terapia-tipo[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#1e40af);color:#fff;font-weight:500;text-shadow:0 1px 2px rgba(0,0,0,.1)}.badge-nivel[_ngcontent-%COMP%]{background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:#fff;font-weight:500;text-shadow:0 1px 2px rgba(0,0,0,.1)}.badge-tag[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);color:#fff;font-weight:500;transition:all .2s ease}.badge-tag[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.estado-punto[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;display:inline-block;box-shadow:0 0 0 2px #ffffff4d;animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.7}}.terminal-display[_ngcontent-%COMP%]{font-family:Monaco,Menlo,Ubuntu Mono,monospace;background:#1a1a1a;color:#0f0;border-radius:8px;padding:20px;position:relative;overflow:auto;max-height:400px}.terminal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;padding-bottom:8px;border-bottom:1px solid #333}.terminal-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.terminal-button[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%}.terminal-button.red[_ngcontent-%COMP%]{background:#ff5f56}.terminal-button.yellow[_ngcontent-%COMP%]{background:#ffbd2e}.terminal-button.green[_ngcontent-%COMP%]{background:#27ca3f}.terminal-title[_ngcontent-%COMP%]{color:#666;font-size:12px}.terminal-content[_ngcontent-%COMP%]{line-height:1.6}.terminal-prompt[_ngcontent-%COMP%]{color:#ff0}.terminal-command[_ngcontent-%COMP%]{color:#0ff}.terminal-output[_ngcontent-%COMP%]{color:#fff;margin-left:16px}.terminal-separator[_ngcontent-%COMP%]{color:#09f;margin:8px 0}.progress-slider[_ngcontent-%COMP%]{width:100%;height:8px;border-radius:4px;background:#e5e7eb;outline:none;-webkit-appearance:none;appearance:none}.progress-slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;border-radius:50%;background:#3b82f6;cursor:pointer;box-shadow:0 2px 4px #0003;transition:all .2s ease}.progress-slider[_ngcontent-%COMP%]::-webkit-slider-thumb:hover{background:#1d4ed8;transform:scale(1.1)}.progress-slider[_ngcontent-%COMP%]::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:#3b82f6;cursor:pointer;border:none;box-shadow:0 2px 4px #0003}.stats-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;box-shadow:0 2px 4px #0000001a;border:1px solid #e5e7eb;transition:all .3s ease}.stats-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.stats-number[_ngcontent-%COMP%]{font-size:24px;font-weight:700;line-height:1}.stats-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500;text-transform:uppercase;letter-spacing:.05em}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.slide-in-left[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInLeft .5s ease-out}@keyframes _ngcontent-%COMP%_slideInLeft{0%{opacity:0;transform:translate(-30px)}to{opacity:1;transform:translate(0)}}@media (max-width: 768px){.stats-card[_ngcontent-%COMP%]{padding:12px}.stats-number[_ngcontent-%COMP%]{font-size:20px}.terapia-card[_ngcontent-%COMP%]{margin-bottom:16px}.terminal-display[_ngcontent-%COMP%]{font-size:12px;padding:16px}}@media (max-width: 640px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:8px}.filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.terapia-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px}}.loading-spinner[_ngcontent-%COMP%]{display:inline-block;width:20px;height:20px;border:3px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#fff;animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.nota-paciente[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);border-left:4px solid #f59e0b;padding:12px;border-radius:6px;margin:12px 0}.nota-paciente[_ngcontent-%COMP%]   .nota-titulo[_ngcontent-%COMP%]{color:#92400e;font-weight:600;font-size:14px}.nota-paciente[_ngcontent-%COMP%]   .nota-contenido[_ngcontent-%COMP%]{color:#78350f;font-size:13px;line-height:1.5;margin-top:4px}.btn-terapia[_ngcontent-%COMP%]{transition:all .2s ease;font-weight:500;position:relative;overflow:hidden}.btn-terapia[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.btn-terapia[_ngcontent-%COMP%]:hover:before{left:100%}.btn-primary-terapia[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#1e40af);color:#fff}.btn-primary-terapia[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#1e40af,#1e3a8a);transform:translateY(-1px)}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:48px 24px;color:#6b7280}.empty-state-icon[_ngcontent-%COMP%]{width:64px;height:64px;margin:0 auto 16px;opacity:.5}.empty-state-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#374151;margin-bottom:8px}.empty-state-description[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;line-height:1.5}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.focus\\:ring-terapia[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px;box-shadow:0 0 0 3px #3b82f680}.tooltip[_ngcontent-%COMP%]{position:relative;display:inline-block}.tooltip[_ngcontent-%COMP%]   .tooltiptext[_ngcontent-%COMP%]{visibility:hidden;width:200px;background-color:#1f2937;color:#fff;text-align:center;border-radius:6px;padding:8px;font-size:12px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-100px;opacity:0;transition:opacity .3s}.tooltip[_ngcontent-%COMP%]:hover   .tooltiptext[_ngcontent-%COMP%]{visibility:visible;opacity:1}']})};var mt=class s{constructor(t,e){this.supabaseService=t;this.authService=e}getInformacionMedicaConPermisos(t){return b(this,null,function*(){try{let e=this.authService.getCurrentUser();if(!e||!e.id)throw new Error("Usuario no autenticado");if(e.id_perfil===1)return yield this.getAllUsuariosConInformacionMedica();{if(t&&t!==e.id)throw new Error("No tienes permisos para ver la informaci\xF3n de este usuario");let o=yield this.getUsuarioConInformacionMedica(e.id);return o?[o]:[]}}catch(e){throw console.error("Error al obtener informaci\xF3n m\xE9dica con permisos:",e),e}})}getAllUsuariosConInformacionMedica(){return b(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.from("profiles").select("id, username, full_name, id_perfil").eq("status",1).order("full_name",{ascending:!0});if(e)throw e;if(!t||t.length===0)return[];let{data:i,error:o}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").select("*");o&&console.warn("Error al obtener informaci\xF3n m\xE9dica:",o);let d=t.map(f=>{let S=i?.find(P=>P.usuario_id===f.id)||null;return{id:f.id,username:f.username||"",full_name:f.full_name||"",id_perfil:f.id_perfil||2,informacion_medica:S}});return console.log("Usuarios cargados:",d),d}catch(t){throw console.error("Error al obtener todos los usuarios:",t),t}})}getUsuarioConInformacionMedica(t){return b(this,null,function*(){try{let{data:e,error:i}=yield this.supabaseService.supabase.from("profiles").select("id, username, full_name, id_perfil").eq("id",t).eq("status",1).single();if(i)return console.error("Error al obtener usuario:",i),null;if(!e)return null;let{data:o,error:d}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").select("*").eq("usuario_id",t).single();return d&&d.code!=="PGRST116"&&console.warn("Error al obtener informaci\xF3n m\xE9dica:",d),{id:e.id,username:e.username||"",full_name:e.full_name||"",id_perfil:e.id_perfil||2,informacion_medica:o||null}}catch(e){return console.error("Error al obtener usuario con informaci\xF3n m\xE9dica:",e),null}})}saveInformacionMedica(t){return b(this,null,function*(){try{let e=this.authService.getCurrentUser();if(!e||!e.id)throw new Error("Usuario no autenticado");let i=e.id_perfil===1,o=t.usuario_id===e.id;if(!i&&!o)throw new Error("No tienes permisos para editar la informaci\xF3n de este usuario");let d=null;t.peso&&t.altura&&(d=t.peso/Math.pow(t.altura/100,2));let f={usuario_id:t.usuario_id,fecha_nacimiento:t.fecha_nacimiento||null,genero:t.genero||null,telefono:t.telefono||null,direccion:t.direccion||null,diagnostico_principal:t.diagnostico_principal||null,diagnosticos_secundarios:t.diagnosticos_secundarios||null,historial_medico:t.historial_medico||null,medicamentos_actuales:t.medicamentos_actuales||null,alergias:t.alergias||null,limitaciones_fisicas:t.limitaciones_fisicas||null,observaciones_generales:t.observaciones_generales||null,contacto_emergencia_nombre:t.contacto_emergencia_nombre||null,contacto_emergencia_telefono:t.contacto_emergencia_telefono||null,contacto_emergencia_relacion:t.contacto_emergencia_relacion||null,peso:t.peso||null,altura:t.altura||null,imc:d,updated_at:new Date().toISOString()};console.log("Datos a guardar:",f);let{data:S,error:P}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").upsert(f,{onConflict:"usuario_id",ignoreDuplicates:!1}).select().single();if(P)throw console.error("Error en upsert:",P),P;return console.log("Datos guardados exitosamente:",S),S}catch(e){throw console.error("Error al guardar informaci\xF3n m\xE9dica:",e),e}})}canEditUser(t){let e=this.authService.getCurrentUser();if(!e||!e.id)return!1;let i=e.id_perfil===1,o=t===e.id;return i||o}canViewUser(t){let e=this.authService.getCurrentUser();if(!e||!e.id)return!1;let i=e.id_perfil===1,o=t===e.id;return i||o}getInformacionMedicaUsuario(t){return b(this,null,function*(){try{if(!this.canViewUser(t))throw new Error("No tienes permisos para ver la informaci\xF3n de este usuario");let{data:e,error:i}=yield this.supabaseService.supabase.from("informacion_medica_usuarios").select("*").eq("usuario_id",t).single();if(i&&i.code!=="PGRST116")throw i;return e}catch(e){throw console.error("Error al obtener informaci\xF3n m\xE9dica:",e),e}})}getEstadisticasInformacionMedica(){return b(this,null,function*(){try{let{data:t,error:e}=yield this.supabaseService.supabase.rpc("get_estadisticas_informacion_medica");if(e)throw e;return t}catch(t){return console.error("Error al obtener estad\xEDsticas:",t),null}})}static \u0275fac=function(e){return new(e||s)(Ce(Q),Ce(L))};static \u0275prov=Ve({token:s,factory:s.\u0275fac,providedIn:"root"})};var xs=(s,t)=>({"border-blue-500 ring-2 ring-blue-100 shadow-lg":s,"border-gray-200 hover:border-blue-300":t}),hs=(s,t)=>({"bg-green-500":s,"bg-yellow-500":t}),vs=(s,t)=>({"bg-green-100 text-green-800":s,"bg-yellow-100 text-yellow-800":t}),bs=(s,t)=>({"bg-blue-500":s,"bg-gray-300":t}),ws=(s,t)=>({"bg-green-400":s,"bg-yellow-400":t});function ys(s,t){s&1&&(n(0,"span"),a(1,"Gestiona la informaci\xF3n m\xE9dica de todos los usuarios del sistema"),r())}function Cs(s,t){s&1&&(n(0,"span"),a(1,"Visualiza y edita tu informaci\xF3n m\xE9dica personal"),r())}function Ss(s,t){if(s&1){let e=w();n(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"div",15),h(),n(5,"svg",16),u(6,"path",17),r()(),y(),n(7,"input",18),T("ngModelChange",function(o){p(e);let d=c();return k(d.searchTerm,o)||(d.searchTerm=o),g(o)}),_("input",function(){p(e);let o=c();return g(o.filterUsuarios())}),r()()()()()}if(s&2){let e=c();l(7),E("ngModel",e.searchTerm)}}function Ms(s,t){s&1&&(n(0,"div",19)(1,"div",20),u(2,"div",21),r(),n(3,"p",22),a(4,"Cargando informaci\xF3n..."),r()())}function Es(s,t){if(s&1){let e=w();n(0,"div",19)(1,"div",23)(2,"div",24),h(),n(3,"svg",25),u(4,"path",26),r()(),y(),n(5,"h3",27),a(6,"Error al cargar datos"),r(),n(7,"p",28),a(8),r(),n(9,"button",29),_("click",function(){p(e);let o=c();return g(o.reloadData())}),h(),n(10,"svg",30),u(11,"path",31),r(),a(12," Reintentar "),r()()()}if(s&2){let e=c();l(8),C(e.errorMessage)}}function ks(s,t){if(s&1&&(n(0,"div",55)(1,"p",47),a(2,"Diagn\xF3stico principal:"),r(),n(3,"p",56),a(4),r()()),s&2){let e=c().$implicit;l(4),v(" ",e.informacion_medica==null?null:e.informacion_medica.diagnostico_principal," ")}}function Ts(s,t){if(s&1&&(n(0,"div",47)(1,"span",57),h(),n(2,"svg",58),u(3,"path",59),r(),a(4),r()()),s&2){let e,i=c().$implicit,o=c(2);l(4),v(" ",o.getAge((e=i.informacion_medica==null?null:i.informacion_medica.fecha_nacimiento)!==null&&e!==void 0?e:"")," a\xF1os ")}}function Ps(s,t){if(s&1){let e=w();n(0,"div",37),_("click",function(){let o=p(e).$implicit,d=c(2);return g(d.selectUsuario(o))}),n(1,"div",13)(2,"div",38)(3,"div",14)(4,"div",39)(5,"span",40),a(6),r()(),u(7,"div",41),r(),n(8,"div",42)(9,"h3",43),a(10),r(),n(11,"p",44),a(12),r()()(),n(13,"div",45)(14,"div",46)(15,"span",47),a(16,"Estado m\xE9dico:"),r(),n(17,"span",48),a(18),r()(),x(19,ks,5,1,"div",49)(20,Ts,5,1,"div",50),r(),n(21,"div",51)(22,"span",52),a(23," Ver ficha m\xE9dica "),h(),n(24,"svg",53),u(25,"path",54),r()()()()()}if(s&2){let e=t.$implicit,i=c(2);m("ngClass",ue(9,xs,(i.selectedUsuario==null?null:i.selectedUsuario.id)===e.id,(i.selectedUsuario==null?null:i.selectedUsuario.id)!==e.id)),l(6),v(" ",(e.full_name||e.username).charAt(0).toUpperCase()," "),l(),m("ngClass",ue(12,hs,e.informacion_medica,!e.informacion_medica)),l(3),v(" ",e.full_name||e.username," "),l(2),v(" ",e.email||e.username," "),l(5),m("ngClass",ue(15,vs,e.informacion_medica,!e.informacion_medica)),l(),v(" ",e.informacion_medica?"Completo":"Pendiente"," "),l(),m("ngIf",e.informacion_medica==null?null:e.informacion_medica.diagnostico_principal),l(),m("ngIf",e.informacion_medica==null?null:e.informacion_medica.fecha_nacimiento)}}function Is(s,t){if(s&1&&u(0,"div",60),s&2){let e=t.index,i=c(2);m("ngClass",ue(1,bs,e===i.currentScrollPage,e!==i.currentScrollPage))}}function Os(s,t){if(s&1&&(n(0,"div",11)(1,"div",32)(2,"div",33),x(3,Ps,26,18,"div",34),r()(),n(4,"div",35),x(5,Is,1,4,"div",36),r()()),s&2){let e=c();l(3),m("ngForOf",e.filteredUsuarios),l(2),m("ngForOf",e.getScrollPages())}}function Vs(s,t){if(s&1&&(n(0,"div",61)(1,"div",62)(2,"div",63),h(),n(3,"svg",64),u(4,"path",17),r()(),y(),n(5,"h3",65),a(6,"No se encontraron usuarios"),r(),n(7,"p",66),a(8),r()()()),s&2){let e=c();l(8),v('No hay usuarios que coincidan con tu b\xFAsqueda "',e.searchTerm,'"')}}function Fs(s,t){s&1&&(n(0,"div",61)(1,"div",67)(2,"div",68),h(),n(3,"svg",69),u(4,"path",70),r()(),y(),n(5,"h3",71),a(6,"Selecciona un usuario"),r(),n(7,"p",72),a(8,"Elige un usuario de las tarjetas de arriba para ver o editar su informaci\xF3n m\xE9dica completa"),r()()())}function Ds(s,t){if(s&1&&(n(0,"span",149),a(1),r()),s&2){let e,i=c(3);l(),v(" ",i.getAge((e=i.selectedUsuario.informacion_medica==null?null:i.selectedUsuario.informacion_medica.fecha_nacimiento)!==null&&e!==void 0?e:"")," a\xF1os ")}}function As(s,t){if(s&1){let e=w();n(0,"div",150)(1,"button",151),_("click",function(){p(e);let o=c(3);return g(o.selectedUsuario=null)}),h(),n(2,"svg",152),u(3,"path",153),r()()()}}function Rs(s,t){if(s&1&&(n(0,"div",136)(1,"div",137)(2,"div",138)(3,"div",139)(4,"span",140),a(5),r()(),n(6,"div",141)(7,"h2",142),a(8),r(),n(9,"p",143),a(10),r(),n(11,"div",144)(12,"span",145),u(13,"div",146),a(14),r(),x(15,Ds,2,1,"span",147),r()(),x(16,As,4,0,"div",148),r()()()),s&2){let e=c(2);l(5),v(" ",(e.selectedUsuario.full_name||e.selectedUsuario.username).charAt(0).toUpperCase()," "),l(3),v(" ",e.selectedUsuario.full_name||e.selectedUsuario.username," "),l(2),C(e.selectedUsuario.email||e.selectedUsuario.username),l(3),m("ngClass",ue(7,ws,e.selectedUsuario.informacion_medica,!e.selectedUsuario.informacion_medica)),l(),v(" ",e.selectedUsuario.informacion_medica?"Informaci\xF3n Completa":"Informaci\xF3n Pendiente"," "),l(),m("ngIf",e.selectedUsuario.informacion_medica==null?null:e.selectedUsuario.informacion_medica.fecha_nacimiento),l(),m("ngIf",e.isAdmin)}}function js(s,t){if(s&1){let e=w();n(0,"div",154)(1,"div",57),h(),n(2,"svg",155),u(3,"path",156),r(),y(),n(4,"p",157),a(5),r(),n(6,"button",158),_("click",function(){p(e);let o=c(2);return g(o.errorMessage="")}),h(),n(7,"svg",159),u(8,"path",153),r()()()()}if(s&2){let e=c(2);l(5),C(e.errorMessage)}}function Us(s,t){if(s&1){let e=w();n(0,"div",160)(1,"div",57),h(),n(2,"svg",161),u(3,"path",162),r(),y(),n(4,"p",163),a(5),r(),n(6,"button",164),_("click",function(){p(e);let o=c(2);return g(o.successMessage="")}),h(),n(7,"svg",159),u(8,"path",153),r()()()()}if(s&2){let e=c(2);l(5),C(e.successMessage)}}function Ls(s,t){if(s&1&&(n(0,"div",165)(1,"div",166),a(2),he(3,"number"),r(),n(4,"div",47),a(5),r()()),s&2){let e=c(2);l(),m("ngClass",e.getIMCColor()),l(),v(" ",Mt(3,3,e.getIMC(),"1.1-1")," "),l(3),v(" ",e.getIMCClassification()," ")}}function Ns(s,t){s&1&&(n(0,"div",167),a(1," Ingrese peso y altura "),r())}function zs(s,t){s&1&&(n(0,"span",57),h(),n(1,"svg",172),u(2,"path",173),r(),a(3," Guardar Informaci\xF3n "),r())}function Bs(s,t){s&1&&(n(0,"span",57),h(),n(1,"svg",174),u(2,"circle",175)(3,"path",176),r(),a(4," Guardando... "),r())}function $s(s,t){if(s&1){let e=w();n(0,"div",168)(1,"button",169),_("click",function(){p(e);let o=c(2);return g(o.resetForm())}),a(2," Cancelar "),r(),n(3,"button",170),x(4,zs,4,0,"span",171)(5,Bs,5,0,"span",171),r()()}if(s&2){let e=c(2);l(3),m("disabled",e.saving||e.informacionMedicaForm.invalid),l(),m("ngIf",!e.saving),l(),m("ngIf",e.saving)}}function Ws(s,t){s&1&&(n(0,"div",177)(1,"div",57)(2,"div",178),h(),n(3,"svg",179),u(4,"path",26),r()(),y(),n(5,"div",180)(6,"h3",181),a(7,"Solo lectura"),r(),n(8,"p",182),a(9," Solo puedes visualizar esta informaci\xF3n. No tienes permisos para editarla. "),r()()()())}function Gs(s,t){if(s&1){let e=w();n(0,"div",73),x(1,Rs,17,10,"div",74)(2,js,9,1,"div",75)(3,Us,9,1,"div",76),n(4,"div",77)(5,"form",78),_("ngSubmit",function(){p(e);let o=c();return g(o.saveInformacionMedica())}),n(6,"div",79)(7,"div",80)(8,"div",81),h(),n(9,"svg",82),u(10,"path",83),r()(),y(),n(11,"h3",84),a(12,"Informaci\xF3n Personal"),r()(),n(13,"div",85)(14,"div",45)(15,"label",86),a(16,"Fecha de Nacimiento"),r(),u(17,"input",87),r(),n(18,"div",45)(19,"label",86),a(20,"G\xE9nero"),r(),n(21,"select",88)(22,"option",89),a(23,"Seleccionar"),r(),n(24,"option",90),a(25,"Masculino"),r(),n(26,"option",91),a(27,"Femenino"),r(),n(28,"option",92),a(29,"Otro"),r()()(),n(30,"div",45)(31,"label",86),a(32,"Tel\xE9fono"),r(),u(33,"input",93),r(),n(34,"div",94)(35,"label",86),a(36,"Direcci\xF3n"),r(),u(37,"textarea",95),r()()(),n(38,"div",79)(39,"div",80)(40,"div",96),h(),n(41,"svg",97),u(42,"path",98),r()(),y(),n(43,"h3",84),a(44,"Informaci\xF3n M\xE9dica"),r()(),n(45,"div",99)(46,"div",100)(47,"div",45)(48,"label",86),a(49,"Diagn\xF3stico Principal"),r(),u(50,"input",101),r(),n(51,"div",45)(52,"label",86),a(53,"Diagn\xF3sticos Secundarios"),r(),n(54,"input",102),_("input",function(o){p(e);let d=c();return g(d.setDiagnosticosFromString(o.target.value))}),r(),n(55,"p",103),a(56,"Separar m\xFAltiples diagn\xF3sticos con comas"),r()()(),n(57,"div",45)(58,"label",86),a(59,"Historial M\xE9dico"),r(),u(60,"textarea",104),r(),n(61,"div",100)(62,"div",45)(63,"label",86),a(64,"Medicamentos Actuales"),r(),u(65,"textarea",105),r(),n(66,"div",45)(67,"label",86),a(68,"Alergias"),r(),u(69,"textarea",106),r()(),n(70,"div",45)(71,"label",86),a(72,"Limitaciones F\xEDsicas"),r(),u(73,"textarea",107),r(),n(74,"div",45)(75,"label",86),a(76,"Observaciones Generales"),r(),u(77,"textarea",108),r()()(),n(78,"div",79)(79,"div",80)(80,"div",109),h(),n(81,"svg",110),u(82,"path",111),r()(),y(),n(83,"h3",84),a(84,"Informaci\xF3n F\xEDsica"),r()(),n(85,"div",112)(86,"div",45)(87,"label",86),a(88,"Peso (kg)"),r(),n(89,"input",113),_("input",function(){p(e);let o=c();return g(o.calculateIMC())}),r()(),n(90,"div",45)(91,"label",86),a(92,"Altura (cm)"),r(),n(93,"input",114),_("input",function(){p(e);let o=c();return g(o.calculateIMC())}),r()(),n(94,"div",45)(95,"label",86),a(96,"IMC"),r(),n(97,"div",115),x(98,Ls,6,6,"div",116)(99,Ns,2,0,"div",117),r()()()(),n(100,"div",79)(101,"div",80)(102,"div",118),h(),n(103,"svg",119),u(104,"path",120),r()(),y(),n(105,"h3",84),a(106,"Contacto de Emergencia"),r()(),n(107,"div",112)(108,"div",45)(109,"label",86),a(110,"Nombre Completo"),r(),u(111,"input",121),r(),n(112,"div",45)(113,"label",86),a(114,"Tel\xE9fono"),r(),u(115,"input",122),r(),n(116,"div",45)(117,"label",86),a(118,"Relaci\xF3n"),r(),n(119,"select",123)(120,"option",89),a(121,"Seleccionar"),r(),n(122,"option",124),a(123,"Padre"),r(),n(124,"option",125),a(125,"Madre"),r(),n(126,"option",126),a(127,"Esposo"),r(),n(128,"option",127),a(129,"Esposa"),r(),n(130,"option",128),a(131,"Hijo"),r(),n(132,"option",129),a(133,"Hija"),r(),n(134,"option",130),a(135,"Hermano"),r(),n(136,"option",131),a(137,"Hermana"),r(),n(138,"option",132),a(139,"Amigo"),r(),n(140,"option",92),a(141,"Otro"),r()()()()(),n(142,"div",133),x(143,$s,6,3,"div",134)(144,Ws,10,0,"div",135),r()()()()}if(s&2){let e=c();l(),m("ngIf",e.selectedUsuario),l(),m("ngIf",e.errorMessage),l(),m("ngIf",e.successMessage),l(2),m("formGroup",e.informacionMedicaForm),l(12),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(12),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(13),m("disabled",!e.canEditCurrentUser()),l(4),m("value",e.getDiagnosticosAsString())("disabled",!e.canEditCurrentUser()),l(6),m("disabled",!e.canEditCurrentUser()),l(5),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(12),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(5),m("ngIf",e.getIMC()),l(),m("ngIf",!e.getIMC()),l(12),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(4),m("disabled",!e.canEditCurrentUser()),l(24),m("ngIf",e.canEditCurrentUser()),l(),m("ngIf",!e.canEditCurrentUser())}}var ut=class s{constructor(t,e,i){this.fb=t;this.informacionMedicaService=e;this.authService=i;this.informacionMedicaForm=this.createForm()}usuarios=[];filteredUsuarios=[];selectedUsuario=null;informacionMedicaForm;loading=!1;saving=!1;isAdmin=!1;currentUserId=null;showModal=!1;errorMessage="";successMessage="";searchTerm="";currentScrollPage=0;itemsPerPage=4;ngOnInit(){this.initializeComponent(),this.loadUsuarios()}initializeComponent(){let t=this.authService.getCurrentUser();t&&(this.isAdmin=t.id_perfil===1,this.currentUserId=t.id||null)}createForm(){return this.fb.group({usuario_id:[null,Me.required],fecha_nacimiento:[""],genero:[""],telefono:["",[Me.pattern(/^\+?[\d\s\-\(\)]+$/)]],direccion:[""],diagnostico_principal:[""],diagnosticos_secundarios:[[]],historial_medico:[""],medicamentos_actuales:[""],alergias:[""],limitaciones_fisicas:[""],observaciones_generales:[""],contacto_emergencia_nombre:[""],contacto_emergencia_telefono:["",[Me.pattern(/^\+?[\d\s\-\(\)]+$/)]],contacto_emergencia_relacion:[""],peso:[null,[Me.min(1),Me.max(300)]],altura:[null,[Me.min(50),Me.max(250)]]})}loadUsuarios(){return b(this,null,function*(){this.loading=!0,this.errorMessage="";try{if(this.usuarios=yield this.informacionMedicaService.getInformacionMedicaConPermisos(),this.filteredUsuarios=[...this.usuarios],!this.isAdmin&&this.usuarios.length===1)this.selectUsuario(this.usuarios[0]);else if(!this.isAdmin&&this.usuarios.length===0&&this.currentUserId){let t=this.authService.getCurrentUser();if(t&&t.id){let e={id:t.id,username:t.username||"",full_name:t.full_name||"",email:"",id_perfil:t.id_perfil||2,informacion_medica:null};this.usuarios=[e],this.filteredUsuarios=[e],this.selectUsuario(e)}}}catch(t){console.error("Error al cargar usuarios:",t),this.errorMessage=t?.message||"Error al cargar la informaci\xF3n de usuarios"}finally{this.loading=!1}})}filterUsuarios(){if(!this.searchTerm.trim()){this.filteredUsuarios=[...this.usuarios],this.currentScrollPage=0;return}let t=this.searchTerm.toLowerCase().trim();this.filteredUsuarios=this.usuarios.filter(e=>{let i=(e.full_name||"").toLowerCase().includes(t),o=(e.username||"").toLowerCase().includes(t),d=(e.email||"").toLowerCase().includes(t),f=!1;if(e.informacion_medica){let S=e.informacion_medica;f=(S.diagnostico_principal||"").toLowerCase().includes(t)||(S.historial_medico||"").toLowerCase().includes(t)||(S.medicamentos_actuales||"").toLowerCase().includes(t)||(S.alergias||"").toLowerCase().includes(t)||(S.limitaciones_fisicas||"").toLowerCase().includes(t)||(S.observaciones_generales||"").toLowerCase().includes(t)||(S.diagnosticos_secundarios||[]).some(P=>P.toLowerCase().includes(t))}return i||o||d||f}),this.currentScrollPage=0}selectUsuario(t){this.selectedUsuario=t,this.loadInformacionMedica(t),this.clearMessages()}loadInformacionMedica(t){let e=t.informacion_medica;if(console.log("Cargando informaci\xF3n para usuario:",t.username,"Info:",e),this.informacionMedicaForm.reset(),this.informacionMedicaForm.patchValue({usuario_id:t.id}),e){let i="";if(e.fecha_nacimiento)try{let d=new Date(e.fecha_nacimiento);isNaN(d.getTime())||(i=d.toISOString().split("T")[0])}catch(d){console.warn("Error al procesar fecha:",d)}let o={usuario_id:t.id,fecha_nacimiento:i,genero:e.genero||"",telefono:e.telefono||"",direccion:e.direccion||"",diagnostico_principal:e.diagnostico_principal||"",diagnosticos_secundarios:e.diagnosticos_secundarios||[],historial_medico:e.historial_medico||"",medicamentos_actuales:e.medicamentos_actuales||"",alergias:e.alergias||"",limitaciones_fisicas:e.limitaciones_fisicas||"",observaciones_generales:e.observaciones_generales||"",contacto_emergencia_nombre:e.contacto_emergencia_nombre||"",contacto_emergencia_telefono:e.contacto_emergencia_telefono||"",contacto_emergencia_relacion:e.contacto_emergencia_relacion||"",peso:e.peso||null,altura:e.altura||null};console.log("Datos del formulario a cargar:",o),this.informacionMedicaForm.patchValue(o),this.informacionMedicaForm.markAsPristine()}this.calculateIMC()}calculateIMC(){let t=this.informacionMedicaForm.get("peso")?.value,e=this.informacionMedicaForm.get("altura")?.value;if(t&&e&&e>0){let i=e/100,o=t/(i*i)}}saveInformacionMedica(){return b(this,null,function*(){if(this.informacionMedicaForm.invalid){this.markFormGroupTouched(),this.errorMessage="Por favor complete los campos requeridos correctamente";return}this.saving=!0,this.errorMessage="",this.successMessage="";try{let t=this.informacionMedicaForm.value,e=null;if(t.peso&&t.altura){let o=t.altura/100;e=t.peso/(o*o)}let i={usuario_id:t.usuario_id,fecha_nacimiento:t.fecha_nacimiento||null,genero:t.genero||null,telefono:t.telefono||null,direccion:t.direccion||null,diagnostico_principal:t.diagnostico_principal||null,historial_medico:t.historial_medico||null,medicamentos_actuales:t.medicamentos_actuales||null,alergias:t.alergias||null,limitaciones_fisicas:t.limitaciones_fisicas||null,observaciones_generales:t.observaciones_generales||null,contacto_emergencia_nombre:t.contacto_emergencia_nombre||null,contacto_emergencia_telefono:t.contacto_emergencia_telefono||null,contacto_emergencia_relacion:t.contacto_emergencia_relacion||null,peso:t.peso||null,altura:t.altura||null,imc:e,diagnosticos_secundarios:this.processDiagnosticosSecundarios(t.diagnosticos_secundarios)};if(yield this.informacionMedicaService.saveInformacionMedica(i),this.successMessage="Informaci\xF3n m\xE9dica guardada exitosamente",yield this.loadUsuarios(),this.selectedUsuario){let o=this.usuarios.find(d=>d.id===this.selectedUsuario.id);o&&this.selectUsuario(o)}setTimeout(()=>{this.successMessage=""},3e3)}catch(t){console.error("Error al guardar informaci\xF3n m\xE9dica:",t),this.errorMessage=t?.message||"Error al guardar la informaci\xF3n m\xE9dica"}finally{this.saving=!1}})}processDiagnosticosSecundarios(t){return t?Array.isArray(t)?t.filter(e=>e&&e.trim().length>0):typeof t=="string"?t.split(",").map(e=>e.trim()).filter(e=>e.length>0):null:null}markFormGroupTouched(){Object.keys(this.informacionMedicaForm.controls).forEach(t=>{this.informacionMedicaForm.get(t)?.markAsTouched()})}canEditCurrentUser(){return this.selectedUsuario?this.informacionMedicaService.canEditUser(this.selectedUsuario.id):!1}openModal(){this.showModal=!0}closeModal(){this.showModal=!1}getIMC(){let t=this.informacionMedicaForm.get("peso")?.value,e=this.informacionMedicaForm.get("altura")?.value;if(t&&e&&e>0){let i=e/100;return t/(i*i)}return null}getIMCClassification(){let t=this.getIMC();return t?t<18.5?"Bajo peso":t<25?"Peso normal":t<30?"Sobrepeso":"Obesidad":""}getIMCColor(){let t=this.getIMC();return t?t<18.5?"text-blue-600":t<25?"text-green-600":t<30?"text-yellow-600":"text-red-600":"text-gray-500"}getDiagnosticosAsString(){let t=this.informacionMedicaForm.get("diagnosticos_secundarios")?.value;return Array.isArray(t)?t.join(", "):t||""}setDiagnosticosFromString(t){let e=t.split(",").map(i=>i.trim()).filter(i=>i.length>0);this.informacionMedicaForm.patchValue({diagnosticos_secundarios:e})}getAge(t){if(!t)return 0;let e=new Date,i=new Date(t);if(isNaN(i.getTime()))return 0;let o=e.getFullYear()-i.getFullYear(),d=e.getMonth()-i.getMonth();return(d<0||d===0&&e.getDate()<i.getDate())&&o--,o}clearMessages(){this.errorMessage="",this.successMessage=""}reloadData(){return b(this,null,function*(){this.clearMessages(),this.searchTerm="",yield this.loadUsuarios()})}resetForm(){this.selectedUsuario?this.loadInformacionMedica(this.selectedUsuario):this.informacionMedicaForm.reset(),this.clearMessages()}hasFormChanges(){return this.informacionMedicaForm.dirty}getUserDisplayName(t){return t.full_name||t.username||t.email||"Usuario"}hasFieldError(t){let e=this.informacionMedicaForm.get(t);return!!(e&&e.invalid&&e.touched)}getFieldError(t){let e=this.informacionMedicaForm.get(t);return!e||!e.errors||!e.touched?"":e.errors.required?"Este campo es requerido":e.errors.pattern?"Formato inv\xE1lido":e.errors.min?`Valor m\xEDnimo: ${e.errors.min.min}`:e.errors.max?`Valor m\xE1ximo: ${e.errors.max.max}`:"Campo inv\xE1lido"}getShortDiagnosis(t){return t?t.length>50?t.substring(0,50)+"...":t:""}isProfileComplete(t){let e=t.informacion_medica;return e?!!(e.fecha_nacimiento&&e.genero&&e.telefono&&e.contacto_emergencia_nombre&&e.contacto_emergencia_telefono):!1}getProfileCompleteness(t){let e=t.informacion_medica;if(!e)return 0;let i=["fecha_nacimiento","genero","telefono","direccion","diagnostico_principal","historial_medico","contacto_emergencia_nombre","contacto_emergencia_telefono","contacto_emergencia_relacion","peso","altura"],o=0;return i.forEach(d=>{e[d]&&o++}),Math.round(o/i.length*100)}getScrollPages(){let t=this.filteredUsuarios.length,e=Math.ceil(t/this.itemsPerPage);return Array.from({length:e},(i,o)=>o)}getCurrentPageItems(){let t=this.currentScrollPage*this.itemsPerPage,e=t+this.itemsPerPage;return this.filteredUsuarios.slice(t,e)}nextScrollPage(){let t=Math.ceil(this.filteredUsuarios.length/this.itemsPerPage);this.currentScrollPage<t-1&&this.currentScrollPage++}prevScrollPage(){this.currentScrollPage>0&&this.currentScrollPage--}goToScrollPage(t){let e=Math.ceil(this.filteredUsuarios.length/this.itemsPerPage);t>=0&&t<e&&(this.currentScrollPage=t)}static \u0275fac=function(e){return new(e||s)(O(Ot),O(mt),O(L))};static \u0275cmp=D({type:s,selectors:[["app-informacion-medica-usuarios"]],standalone:!1,decls:16,vars:9,consts:[[1,"min-h-screen","bg-gradient-to-br","from-blue-50","via-white","to-indigo-50"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-6","text-center"],[1,"bg-gradient-to-r","from-blue-600","to-indigo-600","rounded-xl","shadow-lg","p-4","mb-4"],[1,"text-2xl","font-bold","text-white","mb-1"],[1,"text-blue-100","text-sm"],[4,"ngIf"],["class","mb-6",4,"ngIf"],["class","text-center py-16",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","space-y-8",4,"ngIf"],[1,"mb-6"],[1,"bg-white","rounded-xl","shadow-md","border","border-gray-100","overflow-hidden"],[1,"p-4"],[1,"relative"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","placeholder","Buscar usuario por nombre, email o informaci\xF3n m\xE9dica...",1,"block","w-full","pl-10","pr-3","py-3","text-base","border-0","bg-gray-50","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:bg-white","transition-all","duration-200",3,"ngModelChange","input","ngModel"],[1,"text-center","py-16"],[1,"inline-flex","items-center","justify-center","w-20","h-20","bg-blue-100","rounded-full","mb-4"],[1,"animate-spin","rounded-full","h-12","w-12","border-4","border-blue-600","border-t-transparent"],[1,"text-lg","text-gray-600"],[1,"bg-red-50","border","border-red-200","rounded-2xl","p-8","max-w-md","mx-auto"],[1,"flex","items-center","justify-center","w-16","h-16","bg-red-100","rounded-full","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 15.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-lg","font-semibold","text-red-900","mb-2"],[1,"text-red-700","mb-4"],[1,"inline-flex","items-center","px-4","py-2","bg-red-600","text-white","rounded-lg","hover:bg-red-700","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"overflow-x-auto","pb-4"],[1,"flex","space-x-4",2,"width","max-content"],["class","flex-none w-80 bg-white rounded-lg shadow-md hover:shadow-lg transform hover:-translate-y-1 transition-all duration-300 cursor-pointer border-2 overflow-hidden",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"flex","justify-center","mt-2","space-x-1"],["class","w-2 h-2 rounded-full transition-colors",3,"ngClass",4,"ngFor","ngForOf"],[1,"flex-none","w-80","bg-white","rounded-lg","shadow-md","hover:shadow-lg","transform","hover:-translate-y-1","transition-all","duration-300","cursor-pointer","border-2","overflow-hidden",3,"click","ngClass"],[1,"flex","items-center","space-x-3","mb-3"],[1,"w-10","h-10","bg-gradient-to-br","from-blue-500","to-indigo-600","rounded-full","flex","items-center","justify-center"],[1,"text-white","font-bold","text-sm"],[1,"absolute","-bottom-0.5","-right-0.5","w-3","h-3","rounded-full","border-2","border-white",3,"ngClass"],[1,"flex-1","min-w-0"],[1,"font-semibold","text-gray-900","truncate","text-sm"],[1,"text-xs","text-gray-500","truncate"],[1,"space-y-2"],[1,"flex","items-center","justify-between"],[1,"text-xs","text-gray-600"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["class","border-t pt-2",4,"ngIf"],["class","text-xs text-gray-600",4,"ngIf"],[1,"mt-3","pt-3","border-t"],[1,"text-xs","text-blue-600","font-medium","flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","ml-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"border-t","pt-2"],[1,"text-xs","font-medium","text-gray-900","truncate"],[1,"flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"w-2","h-2","rounded-full","transition-colors",3,"ngClass"],[1,"text-center","py-12"],[1,"bg-gray-50","border","border-gray-200","rounded-xl","p-6","max-w-md","mx-auto"],[1,"w-12","h-12","bg-gray-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-gray-400"],[1,"text-base","font-medium","text-gray-900","mb-1"],[1,"text-sm","text-gray-500"],[1,"bg-gradient-to-br","from-blue-50","to-indigo-50","border-2","border-dashed","border-blue-300","rounded-xl","p-8","max-w-lg","mx-auto"],[1,"w-16","h-16","bg-blue-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-lg","font-bold","text-gray-900","mb-2"],[1,"text-sm","text-gray-600"],[1,"space-y-8"],["class","bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",4,"ngIf"],["class","bg-red-50 border-l-4 border-red-400 p-4 rounded-lg",4,"ngIf"],["class","bg-green-50 border-l-4 border-green-400 p-4 rounded-lg",4,"ngIf"],[1,"bg-white","rounded-2xl","shadow-lg","border","border-gray-100","overflow-hidden"],[3,"ngSubmit","formGroup"],[1,"p-8","border-b","border-gray-100"],[1,"flex","items-center","mb-6"],[1,"w-8","h-8","bg-blue-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[1,"text-xl","font-bold","text-gray-900"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"block","text-sm","font-medium","text-gray-700"],["type","date","formControlName","fecha_nacimiento",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["formControlName","genero",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["value",""],["value","masculino"],["value","femenino"],["value","otro"],["type","tel","formControlName","telefono","placeholder","+502 1234-5678",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],[1,"md:col-span-3","space-y-2"],["formControlName","direccion","rows","2","placeholder","Direcci\xF3n completa",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],[1,"w-8","h-8","bg-red-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"],[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["type","text","formControlName","diagnostico_principal","placeholder","Diagn\xF3stico m\xE9dico principal",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["type","text","placeholder","Separar m\xFAltiples diagn\xF3sticos con comas",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"input","value","disabled"],[1,"text-xs","text-gray-500"],["formControlName","historial_medico","rows","3","placeholder","Historial m\xE9dico relevante, cirug\xEDas previas, etc.",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],["formControlName","medicamentos_actuales","rows","3","placeholder","Lista de medicamentos que toma actualmente",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],["formControlName","alergias","rows","3","placeholder","Alergias conocidas a medicamentos, alimentos, etc.",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],["formControlName","limitaciones_fisicas","rows","2","placeholder","Limitaciones o restricciones f\xEDsicas",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],["formControlName","observaciones_generales","rows","3","placeholder","Observaciones adicionales relevantes",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","resize-none",3,"disabled"],[1,"w-8","h-8","bg-green-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],["type","number","formControlName","peso","step","0.1","min","1","max","300","placeholder","70.5",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"input","disabled"],["type","number","formControlName","altura","min","50","max","250","placeholder","175",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"input","disabled"],[1,"bg-gray-50","border","border-gray-300","rounded-lg","p-4","h-14","flex","items-center","justify-center"],["class","text-center",4,"ngIf"],["class","text-center text-gray-500 text-sm",4,"ngIf"],[1,"w-8","h-8","bg-orange-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"],["type","text","formControlName","contacto_emergencia_nombre","placeholder","Nombre del contacto de emergencia",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["type","tel","formControlName","contacto_emergencia_telefono","placeholder","+502 1234-5678",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["formControlName","contacto_emergencia_relacion",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"disabled"],["value","padre"],["value","madre"],["value","esposo"],["value","esposa"],["value","hijo"],["value","hija"],["value","hermano"],["value","hermana"],["value","amigo"],[1,"p-8"],["class","flex justify-end space-x-4",4,"ngIf"],["class","bg-yellow-50 border border-yellow-200 rounded-lg p-6",4,"ngIf"],[1,"bg-white","rounded-xl","shadow-lg","border","border-gray-100","overflow-hidden"],[1,"bg-gradient-to-r","from-blue-600","to-indigo-600","p-4"],[1,"flex","items-center","space-x-4"],[1,"w-14","h-14","bg-white/20","backdrop-blur-sm","rounded-full","flex","items-center","justify-center"],[1,"text-xl","font-bold","text-white"],[1,"flex-1"],[1,"text-xl","font-bold","text-white","mb-1"],[1,"text-blue-100","mb-1","text-sm"],[1,"flex","items-center","space-x-3"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium","bg-white/20","text-white"],[1,"w-1.5","h-1.5","rounded-full","mr-1.5",3,"ngClass"],["class","text-blue-100 text-xs",4,"ngIf"],["class","text-right",4,"ngIf"],[1,"text-blue-100","text-xs"],[1,"text-right"],[1,"p-1.5","rounded-full","bg-white/20","hover:bg-white/30","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"bg-red-50","border-l-4","border-red-400","p-4","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-400","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-red-700"],[1,"ml-auto","text-red-400","hover:text-red-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],[1,"bg-green-50","border-l-4","border-green-400","p-4","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-400","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-green-700"],[1,"ml-auto","text-green-400","hover:text-green-600",3,"click"],[1,"text-center"],[1,"text-lg","font-bold",3,"ngClass"],[1,"text-center","text-gray-500","text-sm"],[1,"flex","justify-end","space-x-4"],["type","button",1,"px-6","py-3","border","border-gray-300","rounded-lg","text-gray-700","font-medium","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-500","transition-all",3,"click"],["type","submit",1,"px-6","py-3","bg-gradient-to-r","from-blue-600","to-indigo-600","text-white","font-medium","rounded-lg","hover:from-blue-700","hover:to-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50","disabled:cursor-not-allowed","transition-all",3,"disabled"],["class","flex items-center",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-5","h-5","mr-2"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"bg-yellow-50","border","border-yellow-200","rounded-lg","p-6"],[1,"flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-yellow-400"],[1,"ml-3"],[1,"text-sm","font-medium","text-yellow-800"],[1,"text-sm","text-yellow-700","mt-1"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),a(5,"Informaci\xF3n M\xE9dica de Usuarios"),r(),n(6,"p",5),x(7,ys,2,0,"span",6)(8,Cs,2,0,"span",6),r()()(),x(9,Ss,8,1,"div",7)(10,Ms,5,0,"div",8)(11,Es,13,1,"div",8)(12,Os,6,2,"div",7)(13,Vs,9,1,"div",9)(14,Fs,9,0,"div",9)(15,Gs,145,25,"div",10),r()()),e&2&&(l(7),m("ngIf",i.isAdmin),l(),m("ngIf",!i.isAdmin),l(),m("ngIf",i.isAdmin),l(),m("ngIf",i.loading),l(),m("ngIf",i.errorMessage&&!i.loading),l(),m("ngIf",i.isAdmin&&!i.loading&&i.usuarios.length>0),l(),m("ngIf",i.filteredUsuarios.length===0&&i.searchTerm),l(),m("ngIf",!i.selectedUsuario&&i.isAdmin&&!i.loading),l(),m("ngIf",i.selectedUsuario||!i.isAdmin))},dependencies:[$,z,R,te,ne,re,W,Ee,ie,G,ee,Te,ke,Pt,It,H,Et],styles:[".transition-all[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.hover\\:-translate-y-1[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}.bg-gradient-to-br[_ngcontent-%COMP%]{background:linear-gradient(to bottom right,var(--tw-gradient-stops))}.focus\\:ring-2[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 2px #3b82f680}.shadow-xl[_ngcontent-%COMP%]{box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.animate-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}.focus\\:outline-none[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px}@media (max-width: 768px){.grid[_ngcontent-%COMP%]{gap:1rem}.p-8[_ngcontent-%COMP%]{padding:1.5rem}.text-4xl[_ngcontent-%COMP%]{font-size:2rem}}"]})};var Hs=[{path:"",component:Le},{path:"home",component:Le},{path:"login",component:Qe},{path:"register",component:Je},{path:"",component:et,canActivate:[Oe],children:[{path:"dashboard",component:Xe},{path:"usuarios",component:Ke,canActivate:[je],data:{permissions:["view","admin"],profiles:[1,3]}},{path:"rutinas",component:tt,canActivate:[je],data:{permissions:["view"],profiles:[1,3]}},{path:"tipos-seccion",component:it,canActivate:[ht],data:{profiles:[1]}},{path:"rutinas-usuario",component:nt,canActivate:[ht],data:{profiles:[1]}},{path:"mis-rutinas",component:at,canActivate:[Oe]},{path:"terapias",component:st,canActivate:[je],data:{permissions:["view"],profiles:[1,3]}},{path:"terapias-asignadas",component:lt,canActivate:[je],data:{permissions:["view"],profiles:[1,3]}},{path:"mis-terapias",component:ct,canActivate:[Oe]},{path:"informacion-medica",component:ut,canActivate:[Oe]},{path:"paquetes",loadChildren:()=>import("./chunk-IVFFASQ3.js").then(s=>s.PaquetesModule),canActivate:[Oe],data:{title:"Gesti\xF3n de Paquetes"}},{path:"chat-discussions",loadChildren:()=>import("./chunk-NZKLHPUC.js").then(s=>s.ChatDiscussionModule),canActivate:[Oe],data:{title:"Sistema de Discusiones",requiredPermissions:["view"]}},{path:"discusiones",redirectTo:"chat-discussions",pathMatch:"full"},{path:"chat",redirectTo:"chat-discussions",pathMatch:"full"}]},{path:"**",redirectTo:"/"}],pt=class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=We({type:s});static \u0275inj=Be({imports:[xt.forRoot(Hs,{enableTracing:!1,scrollPositionRestoration:"top",anchorScrolling:"enabled",preloadingStrategy:void 0}),xt]})};var gt=class s{title="Rehabimovementgt";static \u0275fac=function(e){return new(e||s)};static \u0275cmp=D({type:s,selectors:[["app-root"]],standalone:!1,decls:1,vars:0,template:function(e,i){e&1&&u(0,"router-outlet")},dependencies:[qe],encapsulation:2})};var qs="@vercel/analytics",Ys="1.5.0",Qs=()=>{window.va||(window.va=function(...t){(window.vaq=window.vaq||[]).push(t)})};function jt(){return typeof window<"u"}function Ut(){try{let s="production";if(s==="development"||s==="test")return"development"}catch{}return"production"}function Js(s="auto"){if(s==="auto"){window.vam=Ut();return}window.vam=s}function Zs(){return(jt()?window.vam:Ut())||"production"}function bt(){return Zs()==="development"}function Xs(s){return s.scriptSrc?s.scriptSrc:bt()?"https://va.vercel-scripts.com/v1/script.debug.js":s.basePath?`${s.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function Lt(s={debug:!0}){var t;if(!jt())return;Js(s.mode),Qs(),s.beforeSend&&((t=window.va)==null||t.call(window,"beforeSend",s.beforeSend));let e=Xs(s);if(document.head.querySelector(`script[src*="${e}"]`))return;let i=document.createElement("script");i.src=e,i.defer=!0,i.dataset.sdkn=qs+(s.framework?`/${s.framework}`:""),i.dataset.sdkv=Ys,s.disableAutoTrack&&(i.dataset.disableAutoTrack="1"),s.endpoint?i.dataset.endpoint=s.endpoint:s.basePath&&(i.dataset.endpoint=`${s.basePath}/insights`),s.dsn&&(i.dataset.dsn=s.dsn),i.onerror=()=>{let o=bt()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${e}. ${o}`)},bt()&&s.debug===!1&&(i.dataset.debug="false"),document.head.appendChild(i)}Lt();var ft=class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=We({type:s,bootstrap:[gt]});static \u0275inj=Be({imports:[Tt,pt,Ft,Vt]})};kt().bootstrapModule(ft,{ngZoneEventCoalescing:!0}).catch(s=>console.error(s));
